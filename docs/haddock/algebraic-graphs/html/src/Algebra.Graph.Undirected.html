<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module     : Algebra.Graph.Undirected</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2016-2022</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- __Alga__ is a library for algebraic construction and manipulation of graphs</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- in Haskell. See &lt;https://github.com/snowleopard/alga-paper this paper&gt; for the</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- motivation behind the library, the underlying theory, and implementation details.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- This module defines an undirected version of algebraic graphs. Undirected</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- graphs satisfy all laws of the 'Algebra.Graph.Class.Undirected' type class,</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- including the commutativity of 'connect'.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- To avoid name clashes with &quot;Algebra.Graph&quot;, this module can be imported</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- qualified:</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- import qualified Algebra.Graph.Undirected as Undirected</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algebra.Graph.Undirected</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Algebraic data type for graphs</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier">Graph</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#fromUndirected"><span class="hs-identifier">fromUndirected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#toUndirected"><span class="hs-identifier">toUndirected</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic graph construction primitives</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertex"><span class="hs-identifier">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edge"><span class="hs-identifier">edge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier">overlay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#connect"><span class="hs-identifier">connect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertices"><span class="hs-identifier">vertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edges"><span class="hs-identifier">edges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#overlays"><span class="hs-identifier">overlays</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#connects"><span class="hs-identifier">connects</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph folding</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#foldg"><span class="hs-identifier">foldg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Relations on graphs</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#isSubgraphOf"><span class="hs-identifier">isSubgraphOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier">toRelation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph properties</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasVertex"><span class="hs-identifier">hasVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasEdge"><span class="hs-identifier">hasEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexCount"><span class="hs-identifier">vertexCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeCount"><span class="hs-identifier">edgeCount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexList"><span class="hs-identifier">vertexList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeList"><span class="hs-identifier">edgeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexSet"><span class="hs-identifier">vertexSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeSet"><span class="hs-identifier">edgeSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#adjacencyList"><span class="hs-identifier">adjacencyList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#neighbours"><span class="hs-identifier">neighbours</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Standard families of graphs</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#path"><span class="hs-identifier">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#circuit"><span class="hs-identifier">circuit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#clique"><span class="hs-identifier">clique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#biclique"><span class="hs-identifier">biclique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#star"><span class="hs-identifier">star</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#stars"><span class="hs-identifier">stars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#tree"><span class="hs-identifier">tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#forest"><span class="hs-identifier">forest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph transformation</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeVertex"><span class="hs-identifier">removeVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeEdge"><span class="hs-identifier">removeEdge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#replaceVertex"><span class="hs-identifier">replaceVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#mergeVertices"><span class="hs-identifier">mergeVertices</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#induce"><span class="hs-identifier">induce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#induceJust"><span class="hs-identifier">induceJust</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Algebra.Graph.Undirected.html#complement"><span class="hs-identifier">complement</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Graph.Internal.html"><span class="hs-identifier">Algebra.Graph.Internal</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Algebra.Graph.ToGraph.html"><span class="hs-identifier">Algebra.Graph.ToGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.ToGraph.html#toGraph"><span class="hs-identifier">toGraph</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Alternative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">tails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Tree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Forest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.html"><span class="hs-identifier">Algebra.Graph</span></a></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Algebra.Graph.Relation.Symmetric.html"><span class="hs-identifier">Algebra.Graph.Relation.Symmetric</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SR</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- TODO: Specialise the API for graphs with vertices of type 'Int'.</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">{-| The 'Graph' data type provides the four algebraic graph construction
primitives 'empty', 'vertex', 'overlay' and 'connect', as well as various
derived functions. The only difference compared to the 'Algebra.Graph.Graph'
data type defined in &quot;Algebra.Graph&quot; is that the 'connect' operation is
/commutative/. We define a 'Num' instance as a convenient notation for working
with undirected graphs:

@
0           == 'vertex' 0
1 + 2       == 'overlay' ('vertex' 1) ('vertex' 2)
1 * 2       == 'connect' ('vertex' 1) ('vertex' 2)
1 + 2 * 3   == 'overlay' ('vertex' 1) ('connect' ('vertex' 2) ('vertex' 3))
1 * (2 + 3) == 'connect' ('vertex' 1) ('overlay' ('vertex' 2) ('vertex' 3))
@

__Note:__ the 'Num' instance does not satisfy several &quot;customary laws&quot; of 'Num',
which dictate that 'fromInteger' @0@ and 'fromInteger' @1@ should act as
additive and multiplicative identities, and 'negate' as additive inverse.
Nevertheless, overloading 'fromInteger', '+' and '*' is very convenient when
working with algebraic graphs; we hope that in future Haskell's Prelude will
provide a more fine-grained class hierarchy for algebraic structures, which we
would be able to utilise without violating any laws.

The 'Eq' instance is currently implemented using the 'SR.Relation' as the
/canonical graph representation/ and satisfies all axioms of algebraic graphs:

    * 'overlay' is commutative and associative:

        &gt;       x + y == y + x
        &gt; x + (y + z) == (x + y) + z

    * 'connect' is associative, commutative and has 'empty' as the identity:

        &gt;   x * empty == x
        &gt;   empty * x == x
        &gt;       x * y == y * x
        &gt; x * (y * z) == (x * y) * z

    * 'connect' distributes over 'overlay':

        &gt; x * (y + z) == x * y + x * z
        &gt; (x + y) * z == x * z + y * z

    * 'connect' can be decomposed:

        &gt; x * y * z == x * y + x * z + y * z

The following useful theorems can be proved from the above set of axioms.

    * 'overlay' has 'empty' as the identity and is idempotent:

        &gt;   x + empty == x
        &gt;   empty + x == x
        &gt;       x + x == x

    * Absorption and saturation of 'connect':

        &gt; x * y + x + y == x * y
        &gt;     x * x * x == x * x

When specifying the time and memory complexity of graph algorithms, /n/ will
denote the number of vertices in the graph, /m/ will denote the number of edges
in the graph, and /s/ will denote the /size/ of the corresponding 'Graph'
expression. For example, if @g@ is a 'Graph' then /n/, /m/ and /s/ can be
computed as follows:

@n == 'vertexCount' g
m == 'edgeCount' g
s == 'size' g@

Note that 'size' counts all leaves of the expression:

@'vertexCount' 'empty'           == 0
'size'        'empty'           == 1
'vertexCount' ('vertex' x)      == 1
'size'        ('vertex' x)      == 1
'vertexCount' ('empty' + 'empty') == 0
'size'        ('empty' + 'empty') == 2@

Converting an undirected 'Graph' to the corresponding 'SR.Relation' takes
/O(s + m * log(m))/ time and /O(s + m)/ memory. This is also the complexity of
the graph equality test, because it is currently implemented by converting graph
expressions to canonical representations based on adjacency maps.

The total order on graphs is defined using /size-lexicographic/ comparison:

* Compare the number of vertices. In case of a tie, continue.
* Compare the sets of vertices. In case of a tie, continue.
* Compare the number of edges. In case of a tie, continue.
* Compare the sets of edges.

Here are a few examples:

@'vertex' 1 &lt; 'vertex' 2
'vertex' 3 &lt; 'edge' 1 2
'vertex' 1 &lt; 'edge' 1 1
'edge' 1 1 &lt; 'edge' 1 2
'edge' 1 2 &lt; 'edge' 1 1 + 'edge' 2 2
'edge' 1 2 &lt; 'edge' 1 3
'edge' 1 2 == 'edge' 2 1@

Note that the resulting order refines the 'isSubgraphOf' relation and is
compatible with 'overlay' and 'connect' operations:

@'isSubgraphOf' x y ==&gt; x &lt;= y@

@'empty' &lt;= x
x     &lt;= x + y
x + y &lt;= x * y@
-}</span><span>
</span><span id="line-178"></span><span id="local-6989586621679130793"><span id="local-6989586621679130794"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Graph"><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-var">Graph</span></a></span></span><span> </span><span id="local-6989586621679131091"><span class="annot"><a href="#local-6989586621679131091"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UG"><span class="annot"><a href="Algebra.Graph.Undirected.html#UG"><span class="hs-identifier hs-var">UG</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679130774"><span id="local-6989586621679130778"><span id="local-6989586621679130782"><span id="local-6989586621679130787"><span class="annot"><span class="annottext">Applicative Graph
forall a. Graph a
forall a. Graph a -&gt; Graph [a]
forall a. Graph a -&gt; Graph a -&gt; Graph a
forall (f :: * -&gt; *).
Applicative f
-&gt; (forall a. f a)
-&gt; (forall a. f a -&gt; f a -&gt; f a)
-&gt; (forall a. f a -&gt; f [a])
-&gt; (forall a. f a -&gt; f [a])
-&gt; Alternative f
many :: forall a. Graph a -&gt; Graph [a]
$cmany :: forall a. Graph a -&gt; Graph [a]
some :: forall a. Graph a -&gt; Graph [a]
$csome :: forall a. Graph a -&gt; Graph [a]
&lt;|&gt; :: forall a. Graph a -&gt; Graph a -&gt; Graph a
$c&lt;|&gt; :: forall a. Graph a -&gt; Graph a -&gt; Graph a
empty :: forall a. Graph a
$cempty :: forall a. Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Alternative</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130748"><span id="local-6989586621679130752"><span id="local-6989586621679130756"><span id="local-6989586621679130760"><span id="local-6989586621679130765"><span class="annot"><span class="annottext">Functor Graph
forall a. a -&gt; Graph a
forall a b. Graph a -&gt; Graph b -&gt; Graph a
forall a b. Graph a -&gt; Graph b -&gt; Graph b
forall a b. Graph (a -&gt; b) -&gt; Graph a -&gt; Graph b
forall a b c. (a -&gt; b -&gt; c) -&gt; Graph a -&gt; Graph b -&gt; Graph c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. Graph a -&gt; Graph b -&gt; Graph a
$c&lt;* :: forall a b. Graph a -&gt; Graph b -&gt; Graph a
*&gt; :: forall a b. Graph a -&gt; Graph b -&gt; Graph b
$c*&gt; :: forall a b. Graph a -&gt; Graph b -&gt; Graph b
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Graph a -&gt; Graph b -&gt; Graph c
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Graph a -&gt; Graph b -&gt; Graph c
&lt;*&gt; :: forall a b. Graph (a -&gt; b) -&gt; Graph a -&gt; Graph b
$c&lt;*&gt; :: forall a b. Graph (a -&gt; b) -&gt; Graph a -&gt; Graph b
pure :: forall a. a -&gt; Graph a
$cpure :: forall a. a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130738"><span id="local-6989586621679130743"><span class="annot"><span class="annottext">forall a b. a -&gt; Graph b -&gt; Graph a
forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Graph b -&gt; Graph a
$c&lt;$ :: forall a b. a -&gt; Graph b -&gt; Graph a
fmap :: forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
$cfmap :: forall a b. (a -&gt; b) -&gt; Graph a -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Graph a) x -&gt; Graph a
forall a x. Graph a -&gt; Rep (Graph a) x
$cto :: forall a x. Rep (Graph a) x -&gt; Graph a
$cfrom :: forall a x. Graph a -&gt; Rep (Graph a) x
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130728"><span class="annot"><span class="annottext">String -&gt; Graph a
forall a. IsString a =&gt; String -&gt; Graph a
forall a. (String -&gt; a) -&gt; IsString a
fromString :: String -&gt; Graph a
$cfromString :: forall a. IsString a =&gt; String -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">IsString</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130710"><span id="local-6989586621679130714"><span id="local-6989586621679130719"><span class="annot"><span class="annottext">Applicative Graph
forall a. a -&gt; Graph a
forall a b. Graph a -&gt; Graph b -&gt; Graph b
forall a b. Graph a -&gt; (a -&gt; Graph b) -&gt; Graph b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; Graph a
$creturn :: forall a. a -&gt; Graph a
&gt;&gt; :: forall a b. Graph a -&gt; Graph b -&gt; Graph b
$c&gt;&gt; :: forall a b. Graph a -&gt; Graph b -&gt; Graph b
&gt;&gt;= :: forall a b. Graph a -&gt; (a -&gt; Graph b) -&gt; Graph b
$c&gt;&gt;= :: forall a b. Graph a -&gt; (a -&gt; Graph b) -&gt; Graph b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span>
</span><span id="line-180"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130695"><span id="local-6989586621679130700"><span class="annot"><span class="annottext">Monad Graph
Alternative Graph
forall a. Graph a
forall a. Graph a -&gt; Graph a -&gt; Graph a
forall (m :: * -&gt; *).
Alternative m
-&gt; Monad m
-&gt; (forall a. m a)
-&gt; (forall a. m a -&gt; m a -&gt; m a)
-&gt; MonadPlus m
mplus :: forall a. Graph a -&gt; Graph a -&gt; Graph a
$cmplus :: forall a. Graph a -&gt; Graph a -&gt; Graph a
mzero :: forall a. Graph a
$cmzero :: forall a. Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadPlus</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130688"><span class="annot"><span class="annottext">Graph a -&gt; ()
forall a. NFData a =&gt; Graph a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Graph a -&gt; ()
$crnf :: forall a. NFData a =&gt; Graph a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130678"><span id="local-6989586621679130681"><span id="local-6989586621679131064"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131064"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679130673"><span class="annot"><span class="annottext">show :: Graph a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | __Note:__ this does not satisfy the usual ring laws; see 'Graph' for more</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- details.</span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130668"><span id="local-6989586621679131056"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131056"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679130660"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#vertex"><span class="hs-identifier hs-var">vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679130659"><span class="annot"><span class="annottext">+ :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679130657"><span class="annot"><span class="annottext">* :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#connect"><span class="hs-identifier hs-var">connect</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679130655"><span class="annot"><span class="annottext">signum :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679130652"><span class="annot"><span class="annottext">abs :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679130649"><span class="annot"><span class="annottext">negate :: Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130646"><span id="local-6989586621679131051"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131051"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679130643"><span class="annot"><span class="annottext">== :: Graph a -&gt; Graph a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#eqR"><span class="hs-identifier hs-var">eqR</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130627"><span id="local-6989586621679130629"><span id="local-6989586621679130631"><span id="local-6989586621679130633"><span id="local-6989586621679130635"><span id="local-6989586621679130637"><span id="local-6989586621679131049"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131049"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679130624"><span class="annot"><span class="annottext">compare :: Graph a -&gt; Graph a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.Undirected.html#ordR"><span class="hs-identifier hs-var">ordR</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Defined via 'overlay'.</span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130617"><span id="local-6989586621679130619"><span id="local-6989586621679131046"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131046"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679130615"><span class="annot"><span class="annottext">&lt;&gt; :: Graph a -&gt; Graph a -&gt; Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Defined via 'overlay' and 'empty'.</span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679130608"><span id="local-6989586621679130610"><span id="local-6989586621679131044"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679130606"><span class="annot"><span class="annottext">mempty :: Graph a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- TODO: Find a more efficient equality check.</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- Check if two graphs are equal by converting them to symmetric relations.</span><span>
</span><span id="line-211"></span><span id="local-6989586621679130605"><span class="annot"><a href="Algebra.Graph.Undirected.html#eqR"><span class="hs-identifier hs-type">eqR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-212"></span><span id="eqR"><span class="annot"><span class="annottext">eqR :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#eqR"><span class="hs-identifier hs-var hs-var">eqR</span></a></span></span><span> </span><span id="local-6989586621679130597"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130597"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130596"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130596"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130597"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130596"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- TODO: Find a more efficient comparison.</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- Compare two graphs by converting them to their symmetric relations.</span><span>
</span><span id="line-216"></span><span id="local-6989586621679130595"><span class="annot"><a href="Algebra.Graph.Undirected.html#ordR"><span class="hs-identifier hs-type">ordR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130595"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130595"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130595"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ordering</span></a></span></span><span>
</span><span id="line-217"></span><span id="ordR"><span class="annot"><span class="annottext">ordR :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Ordering
</span><a href="Algebra.Graph.Undirected.html#ordR"><span class="hs-identifier hs-var hs-var">ordR</span></a></span></span><span> </span><span id="local-6989586621679130589"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130589"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130588"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130588"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130589"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130588"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Construct an undirected graph from a given &quot;Algebra.Graph&quot;.</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- Complexity: /O(1)/ time.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- toUndirected ('Algebra.Graph.edge' 1 2)         == 'edge' 1 2</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- toUndirected . 'fromUndirected'   == id</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- 'vertexCount' . toUndirected      == 'Algebra.Graph.vertexCount'</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- (*2) . 'edgeCount' . toUndirected &gt;= 'Algebra.Graph.edgeCount'</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-228"></span><span id="local-6989586621679131039"><span class="annot"><a href="Algebra.Graph.Undirected.html#toUndirected"><span class="hs-identifier hs-type">toUndirected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131039"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-229"></span><span id="toUndirected"><span class="annot"><span class="annottext">toUndirected :: forall a. Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#toUndirected"><span class="hs-identifier hs-var hs-var">toUndirected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">coerce :: forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">coerce</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Extract the underlying &quot;Algebra.Graph&quot;.</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- fromUndirected ('Algebra.Graph.edge' 1 2)     == 'Algebra.Graph.edges' [(1,2),(2,1)]</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- 'toUndirected' . 'fromUndirected' == id</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- 'Algebra.Graph.vertexCount' . fromUndirected  == 'vertexCount'</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- 'Algebra.Graph.edgeCount' . fromUndirected    &lt;= (*2) . 'edgeCount'</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-240"></span><span id="local-6989586621679131034"><span class="annot"><a href="Algebra.Graph.Undirected.html#fromUndirected"><span class="hs-identifier hs-type">fromUndirected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131034"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-241"></span><span id="fromUndirected"><span class="annot"><span class="annottext">fromUndirected :: forall a. Ord a =&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#fromUndirected"><span class="hs-identifier hs-var hs-var">fromUndirected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. ToGraph t =&gt; t -&gt; Graph (ToVertex t)
</span><a href="Algebra.Graph.ToGraph.html#toGraph"><span class="hs-identifier hs-var">toGraph</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Relation a -&gt; Relation a
</span><a href="Algebra.Graph.Relation.Symmetric.html#fromSymmetric"><span class="hs-identifier hs-var">SR.fromSymmetric</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Construct the /empty graph/.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- 'isEmpty'     empty == True</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- 'hasVertex' x empty == False</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- 'vertexCount' empty == 0</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- 'edgeCount'   empty == 0</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- 'size'        empty == 1</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-252"></span><span id="local-6989586621679130581"><span class="annot"><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130581"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span id="empty"><span class="annot"><span class="annottext">empty :: forall a. Graph a
</span><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) x. Coercible f g =&gt; f x -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce00"><span class="hs-identifier hs-var">coerce00</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a
</span><a href="Algebra.Graph.html#empty"><span class="hs-identifier hs-var">G.empty</span></a></span><span>
</span><span id="line-254"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#empty"><span class="hs-pragma hs-type">empty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Construct the graph comprising /a single isolated vertex/.</span><span>
</span><span id="line-257"></span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- 'isEmpty'     (vertex x) == False</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- 'hasVertex' x (vertex y) == (x == y)</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- 'vertexCount' (vertex x) == 1</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- 'edgeCount'   (vertex x) == 0</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- 'size'        (vertex x) == 1</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-265"></span><span id="local-6989586621679130577"><span class="annot"><a href="Algebra.Graph.Undirected.html#vertex"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130577"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-266"></span><span id="vertex"><span class="annot"><span class="annottext">vertex :: forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#vertex"><span class="hs-identifier hs-var hs-var">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Graph a
</span><a href="Algebra.Graph.html#vertex"><span class="hs-identifier hs-var">G.vertex</span></a></span><span>
</span><span id="line-267"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertex"><span class="hs-pragma hs-type">vertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Construct the graph comprising /a single edge/.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- edge x y               == 'connect' ('vertex' x) ('vertex' y)</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- edge x y               == 'edge' y x</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- edge x y               == 'edges' [(x,y), (y,x)]</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- 'hasEdge' x y (edge x y) == True</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- 'edgeCount'   (edge x y) == 1</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- 'vertexCount' (edge 1 1) == 1</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- 'vertexCount' (edge 1 2) == 2</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-280"></span><span id="local-6989586621679131016"><span class="annot"><a href="Algebra.Graph.Undirected.html#edge"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679131016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679131016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131016"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-281"></span><span id="edge"><span class="annot"><span class="annottext">edge :: forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#edge"><span class="hs-identifier hs-var hs-var">edge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Graph a
</span><a href="Algebra.Graph.html#edge"><span class="hs-identifier hs-var">G.edge</span></a></span><span>
</span><span id="line-282"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edge"><span class="hs-pragma hs-type">edge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | /Overlay/ two graphs. This is a commutative, associative and idempotent</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- operation with the identity 'empty'.</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- 'isEmpty'     (overlay x y) == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- 'hasVertex' z (overlay x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- 'vertexCount' (overlay x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- 'edgeCount'   (overlay x y) &lt;= 'edgeCount' x   + 'edgeCount' y</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- 'size'        (overlay x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- 'vertexCount' (overlay 1 2) == 2</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- 'edgeCount'   (overlay 1 2) == 0</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-299"></span><span id="local-6989586621679130567"><span class="annot"><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier hs-type">overlay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130567"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130567"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130567"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-300"></span><span id="overlay"><span class="annot"><span class="annottext">overlay :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#overlay"><span class="hs-identifier hs-var">G.overlay</span></a></span><span>
</span><span id="line-301"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-pragma hs-type">overlay</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | /Connect/ two graphs. This is a commutative and associative operation with</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- the identity 'empty', which distributes over 'overlay' and obeys the</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- decomposition axiom.</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- Complexity: /O(1)/ time and memory, /O(s1 + s2)/ size. Note that the number</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- of edges in the resulting graph is quadratic with respect to the number of</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- vertices of the arguments: /m = O(m1 + m2 + n1 * n2)/.</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- 'connect' x y               == 'connect' y x</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- 'isEmpty'     (connect x y) == 'isEmpty'   x   &amp;&amp; 'isEmpty'   y</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- 'hasVertex' z (connect x y) == 'hasVertex' z x || 'hasVertex' z y</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &gt;= 'vertexCount' x</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- 'vertexCount' (connect x y) &lt;= 'vertexCount' x + 'vertexCount' y</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' x</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'edgeCount' y</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'vertexCount' x * 'vertexCount' y</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- 'edgeCount'   (connect x y) &gt;= 'vertexCount' x * 'vertexCount' y `div` 2</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- 'size'        (connect x y) == 'size' x        + 'size' y</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- 'vertexCount' (connect 1 2) == 2</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- 'edgeCount'   (connect 1 2) == 1</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-324"></span><span id="local-6989586621679130562"><span class="annot"><a href="Algebra.Graph.Undirected.html#connect"><span class="hs-identifier hs-type">connect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130562"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-325"></span><span id="connect"><span class="annot"><span class="annottext">connect :: forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#connect"><span class="hs-identifier hs-var hs-var">connect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#connect"><span class="hs-identifier hs-var">G.connect</span></a></span><span>
</span><span id="line-326"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#connect"><span class="hs-pragma hs-type">connect</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Construct the graph comprising a given list of isolated vertices.</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- vertices []            == 'empty'</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- vertices [x]           == 'vertex' x</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- vertices               == 'overlays' . map 'vertex'</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- 'hasVertex' x . vertices == 'elem' x</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- 'vertexCount' . vertices == 'length' . 'Data.List.nub'</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- 'vertexSet'   . vertices == Set . 'Set.fromList'</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-340"></span><span id="local-6989586621679131003"><span class="annot"><a href="Algebra.Graph.Undirected.html#vertices"><span class="hs-identifier hs-type">vertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679131003"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131003"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-341"></span><span id="vertices"><span class="annot"><span class="annottext">vertices :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#vertices"><span class="hs-identifier hs-var hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#vertices"><span class="hs-identifier hs-var">G.vertices</span></a></span><span>
</span><span id="line-342"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertices"><span class="hs-pragma hs-type">vertices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Construct the graph from a list of edges.</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-347"></span><span class="hs-comment">--</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- edges []             == 'empty'</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- edges [(x,y)]        == 'edge' x y</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- edges [(x,y), (y,x)] == 'edge' x y</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-353"></span><span id="local-6989586621679131000"><span class="annot"><a href="Algebra.Graph.Undirected.html#edges"><span class="hs-identifier hs-type">edges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679131000"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679131000"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131000"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-354"></span><span id="edges"><span class="annot"><span class="annottext">edges :: forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#edges"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.html#edges"><span class="hs-identifier hs-var">G.edges</span></a></span><span>
</span><span id="line-355"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edges"><span class="hs-pragma hs-type">edges</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Overlay a given list of graphs.</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-360"></span><span class="hs-comment">--</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- overlays []        == 'empty'</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- overlays [x]       == x</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- overlays [x,y]     == 'overlay' x y</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- overlays           == 'foldr' 'overlay' 'empty'</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- 'isEmpty' . overlays == 'all' 'isEmpty'</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-368"></span><span id="local-6989586621679130551"><span class="annot"><a href="Algebra.Graph.Undirected.html#overlays"><span class="hs-identifier hs-type">overlays</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130551"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130551"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-369"></span><span id="overlays"><span class="annot"><span class="annottext">overlays :: forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#overlays"><span class="hs-identifier hs-var hs-var">overlays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.html#overlays"><span class="hs-identifier hs-var">G.overlays</span></a></span><span>
</span><span id="line-370"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#overlays"><span class="hs-pragma hs-type">overlays</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | Connect a given list of graphs.</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- Complexity: /O(L)/ time and memory, and /O(S)/ size, where /L/ is the length</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- of the given list, and /S/ is the sum of sizes of the graphs in the list.</span><span>
</span><span id="line-375"></span><span class="hs-comment">--</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- connects []        == 'empty'</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- connects [x]       == x</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- connects [x,y]     == 'connect' x y</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- connects           == 'foldr' 'connect' 'empty'</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- 'isEmpty' . connects == 'all' 'isEmpty'</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- connects           == connects . 'reverse'</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-384"></span><span id="local-6989586621679130547"><span class="annot"><a href="Algebra.Graph.Undirected.html#connects"><span class="hs-identifier hs-type">connects</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130547"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-385"></span><span id="connects"><span class="annot"><span class="annottext">connects :: forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#connects"><span class="hs-identifier hs-var hs-var">connects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [Graph a] -&gt; Graph a
</span><a href="Algebra.Graph.html#connects"><span class="hs-identifier hs-var">G.connects</span></a></span><span>
</span><span id="line-386"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#connects"><span class="hs-pragma hs-type">connects</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Generalised 'Graph' folding: recursively collapse a 'Graph' by applying</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- the provided functions to the leaves and internal nodes of the expression.</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- The order of arguments is: empty, vertex, overlay and connect.</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- Complexity: /O(s)/ applications of the given functions. As an example, the</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- complexity of 'size' is /O(s)/, since 'const' and '+' have constant costs.</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- foldg 'empty' 'vertex'        'overlay' 'connect'        == id</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- foldg 'empty' 'vertex'        'overlay' ('flip' 'connect') == id</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- foldg 1     ('const' 1)     (+)     (+)            == 'size'</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- foldg True  ('const' False) (&amp;&amp;)    (&amp;&amp;)           == 'isEmpty'</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- foldg False (== x)        (||)    (||)           == 'hasVertex' x</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-401"></span><span id="local-6989586621679130993"><span id="local-6989586621679130994"><span class="annot"><a href="Algebra.Graph.Undirected.html#foldg"><span class="hs-identifier hs-type">foldg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130993"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130993"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130994"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-402"></span><span id="foldg"><span class="annot"><span class="annottext">foldg :: forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.Undirected.html#foldg"><span class="hs-identifier hs-var hs-var">foldg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
(b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b)
-&gt; b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="#local-6989586621679130543"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.html#foldg"><span class="hs-identifier hs-var">G.foldg</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679130991"><span id="local-6989586621679130992"><span class="annot"><a href="#local-6989586621679130543"><span class="hs-identifier hs-type">coerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.html#Graph"><span class="hs-identifier hs-type">G.Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130992"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621679130543"><span class="annot"><span class="annottext">coerce :: forall b a.
(b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b)
-&gt; b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="#local-6989586621679130543"><span class="hs-identifier hs-var hs-var">coerce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">coerce :: forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Data.Coerce.coerce</span></a></span><span>
</span><span id="line-407"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#foldg"><span class="hs-pragma hs-type">foldg</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- | The 'isSubgraphOf' function takes two graphs and returns 'True' if the</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- first graph is a /subgraph/ of the second.</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- isSubgraphOf 'empty'         x             ==  True</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- isSubgraphOf ('vertex' x)    'empty'         ==  False</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- isSubgraphOf x             ('overlay' x y) ==  True</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- isSubgraphOf ('overlay' x y) ('connect' x y) ==  True</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- isSubgraphOf ('path' xs)     ('circuit' xs)  ==  True</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- isSubgraphOf ('edge' x y)    ('edge' y x)    ==  True</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- isSubgraphOf x y                         ==&gt; x &lt;= y</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-423"></span><span id="local-6989586621679130540"><span class="annot"><a href="Algebra.Graph.Undirected.html#isSubgraphOf"><span class="hs-identifier hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-424"></span><span id="isSubgraphOf"><span class="annot"><span class="annottext">isSubgraphOf :: forall a. Ord a =&gt; Graph a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#isSubgraphOf"><span class="hs-identifier hs-var hs-var">isSubgraphOf</span></a></span></span><span> </span><span id="local-6989586621679130535"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130535"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679130534"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130534"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; Relation a -&gt; Bool
</span><a href="Algebra.Graph.Relation.Symmetric.html#isSubgraphOf"><span class="hs-identifier hs-var">SR.isSubgraphOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130535"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130534"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#isSubgraphOf"><span class="hs-pragma hs-type">isSubgraphOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- TODO: This is a very inefficient implementation. Find a way to construct a</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- symmetric relation directly, without building intermediate representations</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- for all subgraphs.</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- | Convert an undirected graph to a symmetric 'SR.Relation'.</span><span>
</span><span id="line-431"></span><span id="local-6989586621679131058"><span class="annot"><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-type">toRelation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131058"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131058"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Relation.Symmetric.html#Relation"><span class="hs-identifier hs-type">SR.Relation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679131058"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-432"></span><span id="toRelation"><span class="annot"><span class="annottext">toRelation :: forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var hs-var">toRelation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a.
b -&gt; (a -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; (b -&gt; b -&gt; b) -&gt; Graph a -&gt; b
</span><a href="Algebra.Graph.Undirected.html#foldg"><span class="hs-identifier hs-var">foldg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Relation a
</span><a href="Algebra.Graph.Relation.Symmetric.html#empty"><span class="hs-identifier hs-var">SR.empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Relation a
</span><a href="Algebra.Graph.Relation.Symmetric.html#vertex"><span class="hs-identifier hs-var">SR.vertex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; Relation a -&gt; Relation a
</span><a href="Algebra.Graph.Relation.Symmetric.html#overlay"><span class="hs-identifier hs-var">SR.overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; Relation a -&gt; Relation a
</span><a href="Algebra.Graph.Relation.Symmetric.html#connect"><span class="hs-identifier hs-var">SR.connect</span></a></span><span>
</span><span id="line-433"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-pragma hs-type">toRelation</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Check if a graph is empty.</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-437"></span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- isEmpty 'empty'                       == True</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- isEmpty ('overlay' 'empty' 'empty')       == True</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- isEmpty ('vertex' x)                  == False</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- isEmpty ('removeVertex' x $ 'vertex' x) == True</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- isEmpty ('removeEdge' x y $ 'edge' x y) == False</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-445"></span><span id="local-6989586621679130980"><span class="annot"><a href="Algebra.Graph.Undirected.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130980"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-446"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: forall a. Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(f x -&gt; a) -&gt; g x -&gt; b
</span><a href="Algebra.Graph.Internal.html#coerce01"><span class="hs-identifier hs-var">coerce01</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#isEmpty"><span class="hs-identifier hs-var">G.isEmpty</span></a></span><span>
</span><span id="line-447"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#isEmpty"><span class="hs-pragma hs-type">isEmpty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">-- | The /size/ of a graph, i.e. the number of leaves of the expression</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- including 'empty' leaves.</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-452"></span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- size 'empty'         == 1</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- size ('vertex' x)    == 1</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- size ('overlay' x y) == size x + size y</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- size ('connect' x y) == size x + size y</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- size x             &gt;= 1</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- size x             &gt;= 'vertexCount' x</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-461"></span><span id="local-6989586621679130973"><span class="annot"><a href="Algebra.Graph.Undirected.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130973"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-462"></span><span id="size"><span class="annot"><span class="annottext">size :: forall a. Graph a -&gt; Int
</span><a href="Algebra.Graph.Undirected.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(f x -&gt; a) -&gt; g x -&gt; b
</span><a href="Algebra.Graph.Internal.html#coerce01"><span class="hs-identifier hs-var">coerce01</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Int
</span><a href="Algebra.Graph.html#size"><span class="hs-identifier hs-var">G.size</span></a></span><span>
</span><span id="line-463"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#size"><span class="hs-pragma hs-type">size</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Check if a graph contains a given vertex.</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-467"></span><span class="hs-comment">--</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- hasVertex x 'empty'            == False</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- hasVertex x ('vertex' y)       == (x == y)</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- hasVertex x . 'removeVertex' x == 'const' False</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-473"></span><span id="local-6989586621679130971"><span class="annot"><a href="Algebra.Graph.Undirected.html#hasVertex"><span class="hs-identifier hs-type">hasVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130971"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130971"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130971"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-474"></span><span id="hasVertex"><span class="annot"><span class="annottext">hasVertex :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#hasVertex"><span class="hs-identifier hs-var hs-var">hasVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; f x -&gt; c) -&gt; b -&gt; g x -&gt; d
</span><a href="Algebra.Graph.Internal.html#coerce11"><span class="hs-identifier hs-var">coerce11</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#hasVertex"><span class="hs-identifier hs-var">G.hasVertex</span></a></span><span>
</span><span id="line-475"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasVertex"><span class="hs-pragma hs-type">hasVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-476"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasVertex"><span class="hs-pragma hs-type">hasVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- TODO: Optimise this further.</span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | Check if a graph contains a given edge.</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- Complexity: /O(s)/ time.</span><span>
</span><span id="line-481"></span><span class="hs-comment">--</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- hasEdge x y 'empty'            == False</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- hasEdge x y ('vertex' z)       == False</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- hasEdge x y ('edge' x y)       == True</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- hasEdge x y ('edge' y x)       == True</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- hasEdge x y . 'removeEdge' x y == 'const' False</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- hasEdge x y                  == 'elem' (min x y, max x y) . 'edgeList'</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-490"></span><span id="local-6989586621679130961"><span class="annot"><a href="Algebra.Graph.Undirected.html#hasEdge"><span class="hs-identifier hs-type">hasEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130961"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-491"></span><span id="hasEdge"><span class="annot"><span class="annottext">hasEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.Undirected.html#hasEdge"><span class="hs-identifier hs-var hs-var">hasEdge</span></a></span></span><span> </span><span id="local-6989586621679130508"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130508"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679130507"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Algebra.Graph.Undirected.html#UG"><span class="hs-identifier hs-type">UG</span></a></span><span> </span><span id="local-6989586621679130506"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130506"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#hasEdge"><span class="hs-identifier hs-var">G.hasEdge</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130508"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130506"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Bool
</span><a href="Algebra.Graph.html#hasEdge"><span class="hs-identifier hs-var">G.hasEdge</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130508"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130506"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-492"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasEdge"><span class="hs-pragma hs-type">hasEdge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-493"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#hasEdge"><span class="hs-pragma hs-type">hasEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | The number of vertices in a graph.</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time.</span><span>
</span><span id="line-497"></span><span class="hs-comment">--</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- vertexCount 'empty'             ==  0</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- vertexCount ('vertex' x)        ==  1</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- vertexCount                   ==  'length' . 'vertexList'</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- vertexCount x \&lt; vertexCount y ==&gt; x \&lt; y</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-504"></span><span id="local-6989586621679130958"><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexCount"><span class="hs-identifier hs-type">vertexCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-505"></span><span id="vertexCount"><span class="annot"><span class="annottext">vertexCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.Undirected.html#vertexCount"><span class="hs-identifier hs-var hs-var">vertexCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(f x -&gt; a) -&gt; g x -&gt; b
</span><a href="Algebra.Graph.Internal.html#coerce01"><span class="hs-identifier hs-var">coerce01</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.html#vertexCount"><span class="hs-identifier hs-var">G.vertexCount</span></a></span><span>
</span><span id="line-506"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexCount"><span class="hs-pragma hs-type">vertexCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-comment">-- | The number of edges in a graph.</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time. Note that the number of edges /m/ of a</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- edgeCount 'empty'      == 0</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- edgeCount ('vertex' x) == 0</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- edgeCount ('edge' x y) == 1</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- edgeCount            == 'length' . 'edgeList'</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-518"></span><span id="local-6989586621679130498"><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeCount"><span class="hs-identifier hs-type">edgeCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-519"></span><span id="edgeCount"><span class="annot"><span class="annottext">edgeCount :: forall a. Ord a =&gt; Graph a -&gt; Int
</span><a href="Algebra.Graph.Undirected.html#edgeCount"><span class="hs-identifier hs-var hs-var">edgeCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; Int
</span><a href="Algebra.Graph.Relation.Symmetric.html#edgeCount"><span class="hs-identifier hs-var">SR.edgeCount</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-520"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeCount"><span class="hs-pragma hs-type">edgeCount</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- | The sorted list of vertices of a given graph.</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-524"></span><span class="hs-comment">--</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- vertexList 'empty'      == []</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- vertexList ('vertex' x) == [x]</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- vertexList . 'vertices' == 'Data.List.nub' . 'Data.List.sort'</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-530"></span><span id="local-6989586621679130953"><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexList"><span class="hs-identifier hs-type">vertexList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130953"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130953"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-531"></span><span id="vertexList"><span class="annot"><span class="annottext">vertexList :: forall a. Ord a =&gt; Graph a -&gt; [a]
</span><a href="Algebra.Graph.Undirected.html#vertexList"><span class="hs-identifier hs-var hs-var">vertexList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(f x -&gt; a) -&gt; g x -&gt; b
</span><a href="Algebra.Graph.Internal.html#coerce01"><span class="hs-identifier hs-var">coerce01</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; [a]
</span><a href="Algebra.Graph.html#vertexList"><span class="hs-identifier hs-var">G.vertexList</span></a></span><span>
</span><span id="line-532"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexList"><span class="hs-pragma hs-type">vertexList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | The sorted list of edges of a graph.</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- Complexity: /O(s + m * log(m))/ time and /O(m)/ memory. Note that the number of</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- edges /m/ of a graph can be quadratic with respect to the expression size /s/.</span><span>
</span><span id="line-537"></span><span class="hs-comment">--</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- edgeList 'empty'          == []</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- edgeList ('vertex' x)     == []</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- edgeList ('edge' x y)     == [(min x y, max y x)]</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- edgeList ('star' 2 [3,1]) == [(1,2), (2,3)]</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-544"></span><span id="local-6989586621679130950"><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeList"><span class="hs-identifier hs-type">edgeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130950"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679130950"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-545"></span><span id="edgeList"><span class="annot"><span class="annottext">edgeList :: forall a. Ord a =&gt; Graph a -&gt; [(a, a)]
</span><a href="Algebra.Graph.Undirected.html#edgeList"><span class="hs-identifier hs-var hs-var">edgeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; [(a, a)]
</span><a href="Algebra.Graph.Relation.Symmetric.html#edgeList"><span class="hs-identifier hs-var">SR.edgeList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-546"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeList"><span class="hs-pragma hs-type">edgeList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | The set of vertices of a given graph.</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- Complexity: /O(s * log(n))/ time and /O(n)/ memory.</span><span>
</span><span id="line-550"></span><span class="hs-comment">--</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- vertexSet 'empty'      == Set.'Set.empty'</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- vertexSet . 'vertex'   == Set.'Set.singleton'</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- vertexSet . 'vertices' == Set.'Set.fromList'</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-556"></span><span id="local-6989586621679130947"><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexSet"><span class="hs-identifier hs-type">vertexSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130947"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130947"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-557"></span><span id="vertexSet"><span class="annot"><span class="annottext">vertexSet :: forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.Undirected.html#vertexSet"><span class="hs-identifier hs-var hs-var">vertexSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(f x -&gt; a) -&gt; g x -&gt; b
</span><a href="Algebra.Graph.Internal.html#coerce01"><span class="hs-identifier hs-var">coerce01</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.html#vertexSet"><span class="hs-identifier hs-var">G.vertexSet</span></a></span><span>
</span><span id="line-558"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#vertexSet"><span class="hs-pragma hs-type">vertexSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-comment">-- | The set of edges of a given graph.</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- Complexity: /O(s * log(m))/ time and /O(m)/ memory.</span><span>
</span><span id="line-562"></span><span class="hs-comment">--</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- edgeSet 'empty'      == Set.'Set.empty'</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- edgeSet ('vertex' x) == Set.'Set.empty'</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- edgeSet ('edge' x y) == Set.'Set.singleton' ('min' x y, 'max' x y)</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-568"></span><span id="local-6989586621679130943"><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeSet"><span class="hs-identifier hs-type">edgeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130943"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130943"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679130943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-569"></span><span id="edgeSet"><span class="annot"><span class="annottext">edgeSet :: forall a. Ord a =&gt; Graph a -&gt; Set (a, a)
</span><a href="Algebra.Graph.Undirected.html#edgeSet"><span class="hs-identifier hs-var hs-var">edgeSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Relation a -&gt; Set (a, a)
</span><a href="Algebra.Graph.Relation.Symmetric.html#edgeSet"><span class="hs-identifier hs-var">SR.edgeSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-570"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#edgeSet"><span class="hs-pragma hs-type">edgeSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="hs-comment">-- | The sorted /adjacency list/ of a graph.</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- Complexity: /O(n + m)/ time and memory.</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-576"></span><span class="hs-comment">-- adjacencyList 'empty'          == []</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- adjacencyList ('vertex' x)     == [(x, [])]</span><span>
</span><span id="line-578"></span><span class="hs-comment">-- adjacencyList ('edge' 1 2)     == [(1, [2]), (2, [1])]</span><span>
</span><span id="line-579"></span><span class="hs-comment">-- adjacencyList ('star' 2 [3,1]) == [(1, [2]), (2, [1,3]), (3, [2])]</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- 'stars' . adjacencyList        == id</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-582"></span><span id="local-6989586621679130940"><span class="annot"><a href="Algebra.Graph.Undirected.html#adjacencyList"><span class="hs-identifier hs-type">adjacencyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130940"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130940"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130940"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130940"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-583"></span><span id="adjacencyList"><span class="annot"><span class="annottext">adjacencyList :: forall a. Ord a =&gt; Graph a -&gt; [(a, [a])]
</span><a href="Algebra.Graph.Undirected.html#adjacencyList"><span class="hs-identifier hs-var hs-var">adjacencyList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Relation a -&gt; [(a, [a])]
</span><a href="Algebra.Graph.Relation.Symmetric.html#adjacencyList"><span class="hs-identifier hs-var">SR.adjacencyList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-584"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#adjacencyList"><span class="hs-pragma hs-type">adjacencyList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-585"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#adjacencyList"><span class="hs-pragma hs-type">adjacencyList</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | The set of vertices /adjacent/ to a given vertex.</span><span>
</span><span id="line-588"></span><span class="hs-comment">--</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- neighbours x 'empty'      == Set.'Set.empty'</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- neighbours x ('vertex' x) == Set.'Set.empty'</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- neighbours x ('edge' x y) == Set.'Set.fromList' [y]</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- neighbours y ('edge' x y) == Set.'Set.fromList' [x]</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-595"></span><span id="local-6989586621679130937"><span class="annot"><a href="Algebra.Graph.Undirected.html#neighbours"><span class="hs-identifier hs-type">neighbours</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130937"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130937"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-596"></span><span id="neighbours"><span class="annot"><span class="annottext">neighbours :: forall a. Ord a =&gt; a -&gt; Graph a -&gt; Set a
</span><a href="Algebra.Graph.Undirected.html#neighbours"><span class="hs-identifier hs-var hs-var">neighbours</span></a></span></span><span> </span><span id="local-6989586621679130467"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130467"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Relation a -&gt; Set a
</span><a href="Algebra.Graph.Relation.Symmetric.html#neighbours"><span class="hs-identifier hs-var">SR.neighbours</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130467"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Relation a
</span><a href="Algebra.Graph.Undirected.html#toRelation"><span class="hs-identifier hs-var">toRelation</span></a></span><span>
</span><span id="line-597"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#neighbours"><span class="hs-pragma hs-type">neighbours</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- | The /path/ on a list of vertices.</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-602"></span><span class="hs-comment">--</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- path []        == 'empty'</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- path [x]       == 'vertex' x</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- path [x,y]     == 'edge' x y</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- path . 'reverse' == path</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-609"></span><span id="local-6989586621679130465"><span class="annot"><a href="Algebra.Graph.Undirected.html#path"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130465"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-610"></span><span id="path"><span class="annot"><span class="annottext">path :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#path"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#path"><span class="hs-identifier hs-var">G.path</span></a></span><span>
</span><span id="line-611"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#path"><span class="hs-pragma hs-type">path</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | The /circuit/ on a list of vertices.</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-616"></span><span class="hs-comment">--</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- circuit []        == 'empty'</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- circuit [x]       == 'edge' x x</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- circuit [x,y]     == 'edge' (x,y)</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- circuit . 'reverse' == circuit</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-623"></span><span id="local-6989586621679130461"><span class="annot"><a href="Algebra.Graph.Undirected.html#circuit"><span class="hs-identifier hs-type">circuit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130461"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-624"></span><span id="circuit"><span class="annot"><span class="annottext">circuit :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#circuit"><span class="hs-identifier hs-var hs-var">circuit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#circuit"><span class="hs-identifier hs-var">G.circuit</span></a></span><span>
</span><span id="line-625"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#circuit"><span class="hs-pragma hs-type">circuit</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- | The /clique/ on a list of vertices.</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-630"></span><span class="hs-comment">--</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-632"></span><span class="hs-comment">-- clique []         == 'empty'</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- clique [x]        == 'vertex' x</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- clique [x,y]      == 'edge' x y</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- clique [x,y,z]    == 'edges' [(x,y), (x,z), (y,z)]</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- clique (xs ++ ys) == 'connect' (clique xs) (clique ys)</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- clique . 'reverse'  == clique</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-639"></span><span id="local-6989586621679130457"><span class="annot"><a href="Algebra.Graph.Undirected.html#clique"><span class="hs-identifier hs-type">clique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130457"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-640"></span><span id="clique"><span class="annot"><span class="annottext">clique :: forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#clique"><span class="hs-identifier hs-var hs-var">clique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#clique"><span class="hs-identifier hs-var">G.clique</span></a></span><span>
</span><span id="line-641"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#clique"><span class="hs-pragma hs-type">clique</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | The /biclique/ on two lists of vertices.</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- Complexity: /O(L1 + L2)/ time, memory and size, where /L1/ and /L2/ are the</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- lengths of the given lists.</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- biclique []      []      == 'empty'</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- biclique [x]     []      == 'vertex' x</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- biclique []      [y]     == 'vertex' y</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- biclique [x1,x2] [y1,y2] == 'edges' [(x1,y1), (x1,y2), (x2,x2), (x2,y2)]</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- biclique xs      ys      == 'connect' ('vertices' xs) ('vertices' ys)</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-654"></span><span id="local-6989586621679130931"><span class="annot"><a href="Algebra.Graph.Undirected.html#biclique"><span class="hs-identifier hs-type">biclique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130931"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130931"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130931"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-655"></span><span id="biclique"><span class="annot"><span class="annottext">biclique :: forall a. [a] -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#biclique"><span class="hs-identifier hs-var hs-var">biclique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#biclique"><span class="hs-identifier hs-var">G.biclique</span></a></span><span>
</span><span id="line-656"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#biclique"><span class="hs-pragma hs-type">biclique</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | The /star/ formed by a centre vertex connected to a list of leaves.</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the length of the</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- given list.</span><span>
</span><span id="line-661"></span><span class="hs-comment">--</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- star x []    == 'vertex' x</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- star x [y]   == 'edge' x y</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- star x [y,z] == 'edges' [(x,y), (x,z)]</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- star x ys    == 'connect' ('vertex' x) ('vertices' ys)</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-668"></span><span id="local-6989586621679130928"><span class="annot"><a href="Algebra.Graph.Undirected.html#star"><span class="hs-identifier hs-type">star</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679130928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130928"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130928"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-669"></span><span id="star"><span class="annot"><span class="annottext">star :: forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#star"><span class="hs-identifier hs-var hs-var">star</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; Graph a
</span><a href="Algebra.Graph.html#star"><span class="hs-identifier hs-var">G.star</span></a></span><span>
</span><span id="line-670"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#star"><span class="hs-pragma hs-type">star</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-comment">-- | The /stars/ formed by overlaying a list of 'star's. An inverse of</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- 'adjacencyList'.</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- Complexity: /O(L)/ time, memory and size, where /L/ is the total size of the</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- input.</span><span>
</span><span id="line-676"></span><span class="hs-comment">--</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- stars []                      == 'empty'</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- stars [(x, [])]               == 'vertex' x</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- stars [(x, [y])]              == 'edge' x y</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- stars [(x, ys)]               == 'star' x ys</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- stars                         == 'overlays' . 'map' ('uncurry' 'star')</span><span>
</span><span id="line-683"></span><span class="hs-comment">-- stars . 'adjacencyList'         == id</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- 'overlay' (stars xs) (stars ys) == stars (xs ++ ys)</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-686"></span><span id="local-6989586621679130925"><span class="annot"><a href="Algebra.Graph.Undirected.html#stars"><span class="hs-identifier hs-type">stars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679130925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130925"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-687"></span><span id="stars"><span class="annot"><span class="annottext">stars :: forall a. [(a, [a])] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#stars"><span class="hs-identifier hs-var hs-var">stars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [(a, [a])] -&gt; Graph a
</span><a href="Algebra.Graph.html#stars"><span class="hs-identifier hs-var">G.stars</span></a></span><span>
</span><span id="line-688"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#stars"><span class="hs-pragma hs-type">stars</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="hs-comment">-- | The /tree graph/ constructed from a given 'Tree' data structure.</span><span>
</span><span id="line-691"></span><span class="hs-comment">-- Complexity: /O(T)/ time, memory and size, where /T/ is the size of the</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- given tree (i.e. the number of vertices in the tree).</span><span>
</span><span id="line-693"></span><span class="hs-comment">--</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- tree (Node x [])                                         == 'vertex' x</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- tree (Node x [Node y [Node z []]])                       == 'path' [x,y,z]</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- tree (Node x [Node y [], Node z []])                     == 'star' x [y,z]</span><span>
</span><span id="line-698"></span><span class="hs-comment">-- tree (Node 1 [Node 2 [], Node 3 [Node 4 [], Node 5 []]]) == 'edges' [(1,2), (1,3), (3,4), (3,5)]</span><span>
</span><span id="line-699"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-700"></span><span id="local-6989586621679130922"><span class="annot"><a href="Algebra.Graph.Undirected.html#tree"><span class="hs-identifier hs-type">tree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130922"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130922"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-701"></span><span id="tree"><span class="annot"><span class="annottext">tree :: forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#tree"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; Graph a
</span><a href="Algebra.Graph.html#tree"><span class="hs-identifier hs-var">G.tree</span></a></span><span>
</span><span id="line-702"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#tree"><span class="hs-pragma hs-type">tree</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="hs-comment">-- | The /forest graph/ constructed from a given 'Forest' data structure.</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- Complexity: /O(F)/ time, memory and size, where /F/ is the size of the</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- given forest (i.e. the number of vertices in the forest).</span><span>
</span><span id="line-707"></span><span class="hs-comment">--</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- forest []                                                  == 'empty'</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- forest [x]                                                 == 'tree' x</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- forest [Node 1 [Node 2 [], Node 3 []], Node 4 [Node 5 []]] == 'edges' [(1,2), (1,3), (4,5)]</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- forest                                                     == 'overlays' . 'map' 'tree'</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-714"></span><span id="local-6989586621679130918"><span class="annot"><a href="Algebra.Graph.Undirected.html#forest"><span class="hs-identifier hs-type">forest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Forest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130918"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130918"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-715"></span><span id="forest"><span class="annot"><span class="annottext">forest :: forall a. Forest a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#forest"><span class="hs-identifier hs-var hs-var">forest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Forest a -&gt; Graph a
</span><a href="Algebra.Graph.html#forest"><span class="hs-identifier hs-var">G.forest</span></a></span><span>
</span><span id="line-716"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#forest"><span class="hs-pragma hs-type">forest</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="hs-comment">-- | Remove a vertex from a given graph.</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-720"></span><span class="hs-comment">--</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- removeVertex x ('vertex' x)       == 'empty'</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- removeVertex 1 ('vertex' 2)       == 'vertex' 2</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- removeVertex x ('edge' x x)       == 'empty'</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- removeVertex 1 ('edge' 1 2)       == 'vertex' 2</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- removeVertex x . removeVertex x == removeVertex x</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-728"></span><span id="local-6989586621679130914"><span class="annot"><a href="Algebra.Graph.Undirected.html#removeVertex"><span class="hs-identifier hs-type">removeVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130914"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-729"></span><span id="removeVertex"><span class="annot"><span class="annottext">removeVertex :: forall a. Eq a =&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#removeVertex"><span class="hs-identifier hs-var hs-var">removeVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; f x -&gt; c) -&gt; b -&gt; g x -&gt; d
</span><a href="Algebra.Graph.Internal.html#coerce11"><span class="hs-identifier hs-var">coerce11</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#removeVertex"><span class="hs-identifier hs-var">G.removeVertex</span></a></span><span>
</span><span id="line-730"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeVertex"><span class="hs-pragma hs-type">removeVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-731"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeVertex"><span class="hs-pragma hs-type">removeVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- TODO: Optimise by doing a single graph traversal.</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- | Remove an edge from a given graph.</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-736"></span><span class="hs-comment">--</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- removeEdge x y ('edge' x y)       == 'vertices' [x,y]</span><span>
</span><span id="line-739"></span><span class="hs-comment">-- removeEdge x y . removeEdge x y == removeEdge x y</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- removeEdge x y                  == removeEdge y x</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- removeEdge x y . 'removeVertex' x == 'removeVertex' x</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- removeEdge 1 1 (1 * 1 * 2 * 2)  == 1 * 2 * 2</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- removeEdge 1 2 (1 * 1 * 2 * 2)  == 1 * 1 + 2 * 2</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-745"></span><span id="local-6989586621679130911"><span class="annot"><a href="Algebra.Graph.Undirected.html#removeEdge"><span class="hs-identifier hs-type">removeEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130911"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-746"></span><span id="removeEdge"><span class="annot"><span class="annottext">removeEdge :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#removeEdge"><span class="hs-identifier hs-var hs-var">removeEdge</span></a></span></span><span> </span><span id="local-6989586621679130426"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679130425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">coerce :: forall a b. Coercible a b =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Data.Coerce.coerce</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#removeEdge"><span class="hs-identifier hs-var">G.removeEdge</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#removeEdge"><span class="hs-identifier hs-var">G.removeEdge</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-747"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeEdge"><span class="hs-pragma hs-type">removeEdge</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-748"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#removeEdge"><span class="hs-pragma hs-type">removeEdge</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="hs-comment">-- | The function @'replaceVertex' x y@ replaces vertex @x@ with vertex @y@ in a</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- given 'Graph'. If @y@ already exists, @x@ and @y@ will be merged.</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-753"></span><span class="hs-comment">--</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- replaceVertex x x            == id</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- replaceVertex x y ('vertex' x) == 'vertex' y</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- replaceVertex x y            == 'mergeVertices' (== x) y</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-759"></span><span id="local-6989586621679130423"><span class="annot"><a href="Algebra.Graph.Undirected.html#replaceVertex"><span class="hs-identifier hs-type">replaceVertex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130423"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-760"></span><span id="replaceVertex"><span class="annot"><span class="annottext">replaceVertex :: forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#replaceVertex"><span class="hs-identifier hs-var hs-var">replaceVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d p q (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible p q, Coercible f g) =&gt;
(a -&gt; c -&gt; f x -&gt; p) -&gt; b -&gt; d -&gt; g x -&gt; q
</span><a href="Algebra.Graph.Internal.html#coerce21"><span class="hs-identifier hs-var">coerce21</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#replaceVertex"><span class="hs-identifier hs-var">G.replaceVertex</span></a></span><span>
</span><span id="line-761"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#replaceVertex"><span class="hs-pragma hs-type">replaceVertex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-762"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#replaceVertex"><span class="hs-pragma hs-type">replaceVertex</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-pragma hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-pragma hs-type">Int</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">-- | Merge vertices satisfying a given predicate into a given vertex.</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-767"></span><span class="hs-comment">--</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-769"></span><span class="hs-comment">-- mergeVertices ('const' False) x    == id</span><span>
</span><span id="line-770"></span><span class="hs-comment">-- mergeVertices (== x) y           == 'replaceVertex' x y</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- mergeVertices 'even' 1 (0 * 2)     == 1 * 1</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- mergeVertices 'odd'  1 (3 + 4 * 5) == 4 * 1</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-774"></span><span id="local-6989586621679130895"><span class="annot"><a href="Algebra.Graph.Undirected.html#mergeVertices"><span class="hs-identifier hs-type">mergeVertices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130895"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-775"></span><span id="mergeVertices"><span class="annot"><span class="annottext">mergeVertices :: forall a. (a -&gt; Bool) -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#mergeVertices"><span class="hs-identifier hs-var hs-var">mergeVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d p q (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible p q, Coercible f g) =&gt;
(a -&gt; c -&gt; f x -&gt; p) -&gt; b -&gt; d -&gt; g x -&gt; q
</span><a href="Algebra.Graph.Internal.html#coerce21"><span class="hs-identifier hs-var">coerce21</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#mergeVertices"><span class="hs-identifier hs-var">G.mergeVertices</span></a></span><span>
</span><span id="line-776"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#mergeVertices"><span class="hs-pragma hs-type">mergeVertices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- vertices that do not satisfy a given predicate.</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size, assuming that the predicate takes</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- constant time.</span><span>
</span><span id="line-782"></span><span class="hs-comment">--</span><span>
</span><span id="line-783"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- induce ('const' True ) x      == x</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- induce ('const' False) x      == 'empty'</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- induce (/= x)               == 'removeVertex' x</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- induce p . induce q         == induce (\\x -&gt; p x &amp;&amp; q x)</span><span>
</span><span id="line-788"></span><span class="hs-comment">-- 'isSubgraphOf' (induce p x) x == True</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-790"></span><span id="local-6989586621679130892"><span class="annot"><a href="Algebra.Graph.Undirected.html#induce"><span class="hs-identifier hs-type">induce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679130892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130892"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-791"></span><span id="induce"><span class="annot"><span class="annottext">induce :: forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#induce"><span class="hs-identifier hs-var hs-var">induce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c d (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible c d, Coercible f g) =&gt;
(a -&gt; c -&gt; f x) -&gt; b -&gt; d -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce20"><span class="hs-identifier hs-var">coerce20</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.html#induce"><span class="hs-identifier hs-var">G.induce</span></a></span><span>
</span><span id="line-792"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#induce"><span class="hs-pragma hs-type">induce</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span class="hs-comment">-- | Construct the /induced subgraph/ of a given graph by removing the vertices</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- that are 'Nothing'.</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- Complexity: /O(s)/ time, memory and size.</span><span>
</span><span id="line-797"></span><span class="hs-comment">--</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- induceJust ('vertex' 'Nothing')                               == 'empty'</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- induceJust ('edge' ('Just' x) 'Nothing')                        == 'vertex' x</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- induceJust . 'fmap' 'Just'                                    == 'id'</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- induceJust . 'fmap' (\\x -&gt; if p x then 'Just' x else 'Nothing') == 'induce' p</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-804"></span><span id="local-6989586621679130889"><span class="annot"><a href="Algebra.Graph.Undirected.html#induceJust"><span class="hs-identifier hs-type">induceJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130889"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-805"></span><span id="induceJust"><span class="annot"><span class="annottext">induceJust :: forall a. Graph (Maybe a) -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#induceJust"><span class="hs-identifier hs-var hs-var">induceJust</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b (f :: * -&gt; *) (g :: * -&gt; *) x.
(Coercible a b, Coercible f g) =&gt;
(a -&gt; f x) -&gt; b -&gt; g x
</span><a href="Algebra.Graph.Internal.html#coerce10"><span class="hs-identifier hs-var">coerce10</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Graph (Maybe a) -&gt; Graph a
</span><a href="Algebra.Graph.html#induceJust"><span class="hs-identifier hs-var">G.induceJust</span></a></span><span>
</span><span id="line-806"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#induceJust"><span class="hs-pragma hs-type">induceJust</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="hs-comment">-- | The edge complement of a graph. Note that, as can be seen from the examples</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- below, this operation ignores self-loops.</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- Complexity: /O(n^2 * log n)/ time, /O(n^2)/ memory.</span><span>
</span><span id="line-811"></span><span class="hs-comment">--</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- complement 'empty'           == 'empty'</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- complement ('vertex' x)      == ('vertex' x)</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- complement ('edge' 1 2)      == ('vertices' [1, 2])</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- complement ('edge' 0 0)      == ('edge' 0 0)</span><span>
</span><span id="line-817"></span><span class="hs-comment">-- complement ('star' 1 [2, 3]) == ('overlay' ('vertex' 1) ('edge' 2 3))</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- complement . complement    == id</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-820"></span><span id="local-6989586621679130886"><span class="annot"><a href="Algebra.Graph.Undirected.html#complement"><span class="hs-identifier hs-type">complement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130886"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Algebra.Graph.Undirected.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679130886"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-821"></span><span id="complement"><span class="annot"><span class="annottext">complement :: forall a. Ord a =&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#complement"><span class="hs-identifier hs-var hs-var">complement</span></a></span></span><span> </span><span id="local-6989586621679130392"><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130392"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Graph a -&gt; Graph a -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679130391"><span class="hs-identifier hs-var">vsOld</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [(a, a)] -&gt; Graph a
</span><a href="Algebra.Graph.Undirected.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toAscList</span></a></span><span> </span><span class="annot"><span class="annottext">Set (a, a)
</span><a href="#local-6989586621679130389"><span class="hs-identifier hs-var">esNew</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-823"></span><span>    </span><span id="local-6989586621679130391"><span class="annot"><span class="annottext">vsOld :: [a]
</span><a href="#local-6989586621679130391"><span class="hs-identifier hs-var hs-var">vsOld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; [a]
</span><a href="Algebra.Graph.Undirected.html#vertexList"><span class="hs-identifier hs-var">vertexList</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130392"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-824"></span><span>    </span><span id="local-6989586621679130388"><span class="annot"><span class="annottext">esOld :: Set (a, a)
</span><a href="#local-6989586621679130388"><span class="hs-identifier hs-var hs-var">esOld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Graph a -&gt; Set (a, a)
</span><a href="Algebra.Graph.Undirected.html#edgeSet"><span class="hs-identifier hs-var">edgeSet</span></a></span><span> </span><span class="annot"><span class="annottext">Graph a
</span><a href="#local-6989586621679130392"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-825"></span><span>    </span><span id="local-6989586621679130387"><span class="annot"><span class="annottext">loops :: Set (a, a)
</span><a href="#local-6989586621679130387"><span class="hs-identifier hs-var hs-var">loops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">(==)</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (a, a)
</span><a href="#local-6989586621679130388"><span class="hs-identifier hs-var">esOld</span></a></span><span>
</span><span id="line-826"></span><span>    </span><span id="local-6989586621679130384"><span class="annot"><span class="annottext">esAll :: Set (a, a)
</span><a href="#local-6989586621679130384"><span class="hs-identifier hs-var hs-var">esAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromAscList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130382"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130381"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679130382"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130382"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679130380"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679130380"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [[a]]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679130391"><span class="hs-identifier hs-var">vsOld</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130381"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679130381"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679130380"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-827"></span><span>    </span><span id="local-6989586621679130389"><span class="annot"><span class="annottext">esNew :: Set (a, a)
</span><a href="#local-6989586621679130389"><span class="hs-identifier hs-var hs-var">esNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set (a, a)
</span><a href="#local-6989586621679130387"><span class="hs-identifier hs-var">loops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.difference</span></a></span><span> </span><span class="annot"><span class="annottext">Set (a, a)
</span><a href="#local-6989586621679130384"><span class="hs-identifier hs-var">esAll</span></a></span><span> </span><span class="annot"><span class="annottext">Set (a, a)
</span><a href="#local-6989586621679130388"><span class="hs-identifier hs-var">esOld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span></pre></body></html>
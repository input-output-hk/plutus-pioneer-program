<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.Math.Edwards25519</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : Edwards 25519 arithmetics</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : vincent@typed.io</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Simple module to play with the arithmetics of the twisted edwards curve Ed25519</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- using Extended Twisted Edwards Coordinates. Compared to the normal implementation</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- this allow to use standard DH property:</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- for all valid s1 and s2 scalar:</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- &gt; scalarToPoint (s1 + s2) = pointAdd (scalarToPoint s1) (scalarToPoint s2)</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- For further useful references about Ed25519:</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- * RFC 8032</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- * &lt;http://ed25519.cr.yp.to/&gt;</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- * &lt;http://ed25519.cr.yp.to/ed25519-20110926.pdf&gt;</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- * &lt;http://eprint.iacr.org/2008/522.pdf&gt;</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Math.Edwards25519</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic types</span></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier">Scalar</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier">PointCompressed</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier">Signature</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * smart constructor &amp; destructor</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalar"><span class="hs-identifier">scalar</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarP"><span class="hs-identifier">scalarP</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#unScalar"><span class="hs-identifier">unScalar</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointCompressed"><span class="hs-identifier">pointCompressed</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointCompressedP"><span class="hs-identifier">pointCompressedP</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier">unPointCompressed</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#unPointCompressedP"><span class="hs-identifier">unPointCompressedP</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Arithmetic</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarFromInteger"><span class="hs-identifier">scalarFromInteger</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarAdd"><span class="hs-identifier">scalarAdd</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarToPoint"><span class="hs-identifier">scalarToPoint</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointAdd"><span class="hs-identifier">pointAdd</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Signature &amp; Verify</span></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#sign"><span class="hs-identifier">sign</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">NFData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Hash</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Number.ModArithmetic</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Number.Serialize</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span class="hs-cpp">
#if MIN_VERSION_memory(0,14,18)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">append</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">reverse</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteArray</span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">append</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">append</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">reverse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Data.Hashable</span></a></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Hashable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Math.Bytes.html"><span class="hs-identifier">Crypto.Math.Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier">Bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html"><span class="hs-identifier">Crypto.Math.Bytes</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bytes</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Represent a scalar in the base field</span><span>
</span><span id="line-68"></span><span class="hs-keyword">newtype</span><span> </span><span id="Scalar"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Scalar"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unScalar"><span class="annot"><span class="annottext">Scalar -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unScalar"><span class="hs-identifier hs-var hs-var">unScalar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Represent a point on the Edwards 25519 curve</span><span>
</span><span id="line-71"></span><span class="hs-keyword">newtype</span><span> </span><span id="PointCompressed"><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PointCompressed"><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unPointCompressed"><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var hs-var">unPointCompressed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094975"><span id="local-6989586621679094977"><span id="local-6989586621679094983"><span class="annot"><span class="annottext">Int -&gt; PointCompressed -&gt; ShowS
[PointCompressed] -&gt; ShowS
PointCompressed -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PointCompressed] -&gt; ShowS
$cshowList :: [PointCompressed] -&gt; ShowS
show :: PointCompressed -&gt; String
$cshow :: PointCompressed -&gt; String
showsPrec :: Int -&gt; PointCompressed -&gt; ShowS
$cshowsPrec :: Int -&gt; PointCompressed -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094967"><span id="local-6989586621679094972"><span class="annot"><span class="annottext">PointCompressed -&gt; PointCompressed -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c/= :: PointCompressed -&gt; PointCompressed -&gt; Bool
== :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c== :: PointCompressed -&gt; PointCompressed -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094934"><span id="local-6989586621679094938"><span id="local-6989586621679094942"><span id="local-6989586621679094946"><span id="local-6989586621679094950"><span id="local-6989586621679094954"><span id="local-6989586621679094959"><span class="annot"><span class="annottext">Eq PointCompressed
PointCompressed -&gt; PointCompressed -&gt; Bool
PointCompressed -&gt; PointCompressed -&gt; Ordering
PointCompressed -&gt; PointCompressed -&gt; PointCompressed
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PointCompressed -&gt; PointCompressed -&gt; PointCompressed
$cmin :: PointCompressed -&gt; PointCompressed -&gt; PointCompressed
max :: PointCompressed -&gt; PointCompressed -&gt; PointCompressed
$cmax :: PointCompressed -&gt; PointCompressed -&gt; PointCompressed
&gt;= :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c&gt;= :: PointCompressed -&gt; PointCompressed -&gt; Bool
&gt; :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c&gt; :: PointCompressed -&gt; PointCompressed -&gt; Bool
&lt;= :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c&lt;= :: PointCompressed -&gt; PointCompressed -&gt; Bool
&lt; :: PointCompressed -&gt; PointCompressed -&gt; Bool
$c&lt; :: PointCompressed -&gt; PointCompressed -&gt; Bool
compare :: PointCompressed -&gt; PointCompressed -&gt; Ordering
$ccompare :: PointCompressed -&gt; PointCompressed -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094928"><span class="annot"><span class="annottext">PointCompressed -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: PointCompressed -&gt; ()
$crnf :: PointCompressed -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094914"><span id="local-6989586621679094919"><span class="annot"><span class="annottext">Eq PointCompressed
Int -&gt; PointCompressed -&gt; Int
PointCompressed -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: PointCompressed -&gt; Int
$chash :: PointCompressed -&gt; Int
hashWithSalt :: Int -&gt; PointCompressed -&gt; Int
$chashWithSalt :: Int -&gt; PointCompressed -&gt; Int
</span><a href="../../../../hashable/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Represent a signature</span><span>
</span><span id="line-75"></span><span class="hs-keyword">newtype</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unSignature"><span class="annot"><span class="annottext">Signature -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unSignature"><span class="hs-identifier hs-var hs-var">unSignature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094900"><span id="local-6989586621679094902"><span id="local-6989586621679094906"><span class="annot"><span class="annottext">Int -&gt; Signature -&gt; ShowS
[Signature] -&gt; ShowS
Signature -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Signature] -&gt; ShowS
$cshowList :: [Signature] -&gt; ShowS
show :: Signature -&gt; String
$cshow :: Signature -&gt; String
showsPrec :: Int -&gt; Signature -&gt; ShowS
$cshowsPrec :: Int -&gt; Signature -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094894"><span id="local-6989586621679094898"><span class="annot"><span class="annottext">Signature -&gt; Signature -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Signature -&gt; Signature -&gt; Bool
$c/= :: Signature -&gt; Signature -&gt; Bool
== :: Signature -&gt; Signature -&gt; Bool
$c== :: Signature -&gt; Signature -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094863"><span id="local-6989586621679094867"><span id="local-6989586621679094871"><span id="local-6989586621679094875"><span id="local-6989586621679094879"><span id="local-6989586621679094883"><span id="local-6989586621679094887"><span class="annot"><span class="annottext">Eq Signature
Signature -&gt; Signature -&gt; Bool
Signature -&gt; Signature -&gt; Ordering
Signature -&gt; Signature -&gt; Signature
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Signature -&gt; Signature -&gt; Signature
$cmin :: Signature -&gt; Signature -&gt; Signature
max :: Signature -&gt; Signature -&gt; Signature
$cmax :: Signature -&gt; Signature -&gt; Signature
&gt;= :: Signature -&gt; Signature -&gt; Bool
$c&gt;= :: Signature -&gt; Signature -&gt; Bool
&gt; :: Signature -&gt; Signature -&gt; Bool
$c&gt; :: Signature -&gt; Signature -&gt; Bool
&lt;= :: Signature -&gt; Signature -&gt; Bool
$c&lt;= :: Signature -&gt; Signature -&gt; Bool
&lt; :: Signature -&gt; Signature -&gt; Bool
$c&lt; :: Signature -&gt; Signature -&gt; Bool
compare :: Signature -&gt; Signature -&gt; Ordering
$ccompare :: Signature -&gt; Signature -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094858"><span class="annot"><span class="annottext">Signature -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Signature -&gt; ()
$crnf :: Signature -&gt; ()
</span><a href="#local-6989586621679094858"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094847"><span id="local-6989586621679094851"><span class="annot"><span class="annottext">Eq Signature
Int -&gt; Signature -&gt; Int
Signature -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Signature -&gt; Int
$chash :: Signature -&gt; Int
hashWithSalt :: Int -&gt; Signature -&gt; Int
$chashWithSalt :: Int -&gt; Signature -&gt; Int
</span><a href="#local-6989586621679094847"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">newtype</span><span> </span><span id="Fq"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-var">Fq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fq"><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-var">Fq</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFq"><span class="annot"><span class="annottext">Fq -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#unFq"><span class="hs-identifier hs-var hs-var">unFq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- newtype Fp = Fp { unFp :: Integer }</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">{- for debugging
fq :: HasCallStack =&gt; Integer -&gt; Fq
fq n
    | n &gt;= 0 &amp;&amp; n &lt; q = Fq n
    | otherwise       = error &quot;fq&quot;
-}</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#fq"><span class="hs-identifier hs-type">fq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-type">Fq</span></a></span><span>
</span><span id="line-89"></span><span id="fq"><span class="annot"><span class="annottext">fq :: Integer -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#fq"><span class="hs-identifier hs-var hs-var">fq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-var">Fq</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Create a Ed25519 scalar</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- Only check that the length is of expected size (32 bytes), no effort is made for the scalar</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- to be in the right base field range on purpose.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalar"><span class="hs-identifier hs-type">scalar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span>
</span><span id="line-96"></span><span id="scalar"><span class="annot"><span class="annottext">scalar :: ByteString -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalar"><span class="hs-identifier hs-var hs-var">scalar</span></a></span></span><span> </span><span id="local-6989586621679094840"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094840"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094840"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid scalar&quot;</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094840"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarP"><span class="hs-identifier hs-type">scalarP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span>
</span><span id="line-101"></span><span id="scalarP"><span class="annot"><span class="annottext">scalarP :: Bytes 32 -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalarP"><span class="hs-identifier hs-var hs-var">scalarP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalar"><span class="hs-identifier hs-var">scalar</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ByteArray a =&gt; [Word8] -&gt; a
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var">Bytes.unpack</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Check if a scalar is valid and all the bits properly set/cleared</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- scalarValid :: Scalar -&gt; Bool</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- scalarValid _s = True -- TODO</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Smart constructor to create a compress point binary</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- Check if the length is of expected size</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointCompressed"><span class="hs-identifier hs-type">pointCompressed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-112"></span><span id="pointCompressed"><span class="annot"><span class="annottext">pointCompressed :: HasCallStack =&gt; ByteString -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointCompressed"><span class="hs-identifier hs-var hs-var">pointCompressed</span></a></span></span><span> </span><span id="local-6989586621679094824"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid compressed point: expecting 32 bytes, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094824"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointCompressedP"><span class="hs-identifier hs-type">pointCompressedP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-117"></span><span id="pointCompressedP"><span class="annot"><span class="annottext">pointCompressedP :: Bytes 32 -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointCompressedP"><span class="hs-identifier hs-var hs-var">pointCompressedP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointCompressed"><span class="hs-identifier hs-var">pointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ByteArray a =&gt; [Word8] -&gt; a
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat). Bytes n -&gt; [Word8]
</span><a href="Crypto.Math.Bytes.html#unpack"><span class="hs-identifier hs-var">Bytes.unpack</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#unPointCompressedP"><span class="hs-identifier hs-type">unPointCompressedP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Bytes.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span>
</span><span id="line-120"></span><span id="unPointCompressedP"><span class="annot"><span class="annottext">unPointCompressedP :: PointCompressed -&gt; Bytes 32
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressedP"><span class="hs-identifier hs-var hs-var">unPointCompressedP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span id="local-6989586621679094822"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094822"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (n :: Nat). KnownNat n =&gt; [Word8] -&gt; Bytes n
</span><a href="Crypto.Math.Bytes.html#pack"><span class="hs-identifier hs-var">Bytes.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ByteArrayAccess a =&gt; a -&gt; [Word8]
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094822"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Create a signature using a variant of ED25519 signature</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- we don't hash the secret key to derive a key + prefix, but</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- instead we take an explicit salt and compute a prefix</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- using the secret key + salt.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679095095"><span class="annot"><a href="Crypto.Math.Edwards25519.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">B.ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095095"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095095"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span><span>
</span><span id="line-128"></span><span id="sign"><span class="annot"><span class="annottext">sign :: forall msg.
ByteArrayAccess msg =&gt;
Scalar -&gt; ByteString -&gt; msg -&gt; Signature
</span><a href="Crypto.Math.Edwards25519.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679094818"><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621679094818"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679094817"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094817"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span id="local-6989586621679094816"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679094816"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Signature
</span><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var">unPointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094815"><span class="hs-identifier hs-var">pR</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094813"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679094809"><span class="annot"><span class="annottext">prefix :: Digest SHA512
</span><a href="#local-6989586621679094809"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unScalar"><span class="hs-identifier hs-var">unScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621679094818"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094817"><span class="hs-identifier hs-var">salt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">SHA512</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679094807"><span class="annot"><span class="annottext">pA :: PointCompressed
</span><a href="#local-6989586621679094807"><span class="hs-identifier hs-var hs-var">pA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#scalarToPoint"><span class="hs-identifier hs-var">scalarToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621679094818"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679094800"><span class="annot"><span class="annottext">r :: Fq
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#sha512_modq"><span class="hs-identifier hs-var">sha512_modq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">Digest SHA512
</span><a href="#local-6989586621679094809"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679094816"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679094815"><span class="annot"><span class="annottext">pR :: PointCompressed
</span><a href="#local-6989586621679094815"><span class="hs-identifier hs-var hs-var">pR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#ePointCompress"><span class="hs-identifier hs-var">ePointCompress</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Fq -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-var">ePointMul</span></a></span><span> </span><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#pG"><span class="hs-identifier hs-var">pG</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679094791"><span class="annot"><span class="annottext">h :: Fq
</span><a href="#local-6989586621679094791"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#sha512_modq"><span class="hs-identifier hs-var">sha512_modq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var">unPointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094815"><span class="hs-identifier hs-var">pR</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var">unPointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094807"><span class="hs-identifier hs-var">pA</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679094816"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679094813"><span class="annot"><span class="annottext">s :: Integer
</span><a href="#local-6989586621679094813"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fq -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#unFq"><span class="hs-identifier hs-var">unFq</span></a></span><span> </span><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094800"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Fq -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#unFq"><span class="hs-identifier hs-var">unFq</span></a></span><span> </span><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094791"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unScalar"><span class="hs-identifier hs-var">unScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621679094818"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Verify a signature</span><span>
</span><span id="line-139"></span><span id="local-6989586621679095082"><span class="annot"><a href="Crypto.Math.Edwards25519.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">B.ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095082"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095082"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-140"></span><span id="verify"><span class="annot"><span class="annottext">verify :: forall msg.
ByteArrayAccess msg =&gt;
PointCompressed -&gt; msg -&gt; Signature -&gt; Bool
</span><a href="Crypto.Math.Edwards25519.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span id="local-6989586621679094781"><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094781"><span class="hs-identifier hs-var">pA</span></a></span></span><span> </span><span id="local-6989586621679094780"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679094780"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679094779"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094779"><span class="hs-keyword hs-var">signature</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094778"><span class="hs-identifier hs-var">pS</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
</span><a href="#local-6989586621679094777"><span class="hs-operator hs-var">`pointEqual`</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-var">ePointDecompress</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">pR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var">hA</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679094774"><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">pR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094772"><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094770"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">sig0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679094769"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094769"><span class="hs-identifier hs-var">sig1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094779"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-145"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094770"><span class="hs-identifier hs-var">sig0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#fq"><span class="hs-identifier hs-var">fq</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094769"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679094777"><span class="annot"><span class="annottext">pointEqual :: ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
</span><a href="#local-6989586621679094777"><span class="hs-identifier hs-var hs-var">pointEqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span id="local-6989586621679094753"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094753"><span class="hs-identifier hs-var">pX</span></a></span></span><span> </span><span id="local-6989586621679094752"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094752"><span class="hs-identifier hs-var">pY</span></a></span></span><span> </span><span id="local-6989586621679094751"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span id="local-6989586621679094750"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">qX</span></a></span></span><span> </span><span id="local-6989586621679094749"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">qY</span></a></span></span><span> </span><span id="local-6989586621679094748"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">qZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094753"><span class="hs-identifier hs-var">pX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">qZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094750"><span class="hs-identifier hs-var">qX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pZ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094752"><span class="hs-identifier hs-var">pY</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094748"><span class="hs-identifier hs-var">qZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094749"><span class="hs-identifier hs-var">qY</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094751"><span class="hs-identifier hs-var">pZ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679094742"><span class="annot"><span class="annottext">h :: Fq
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#sha512_modq"><span class="hs-identifier hs-var">sha512_modq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var">unPointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094774"><span class="hs-identifier hs-var">pR</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#unPointCompressed"><span class="hs-identifier hs-var">unPointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094781"><span class="hs-identifier hs-var">pA</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679094780"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679094778"><span class="annot"><span class="annottext">pS :: ExtendedPoint
</span><a href="#local-6989586621679094778"><span class="hs-identifier hs-var hs-var">pS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fq -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-var">ePointMul</span></a></span><span> </span><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094772"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#pG"><span class="hs-identifier hs-var">pG</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679094773"><span class="annot"><span class="annottext">hA :: ExtendedPoint
</span><a href="#local-6989586621679094773"><span class="hs-identifier hs-var hs-var">hA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fq -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-var">ePointMul</span></a></span><span> </span><span class="annot"><span class="annottext">Fq
</span><a href="#local-6989586621679094742"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-var">ePointDecompress</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094781"><span class="hs-identifier hs-var">pA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Add 2 scalar in the base field together</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarAdd"><span class="hs-identifier hs-type">scalarAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span>
</span><span id="line-156"></span><span id="scalarAdd"><span class="annot"><span class="annottext">scalarAdd :: Scalar -&gt; Scalar -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalarAdd"><span class="hs-identifier hs-var hs-var">scalarAdd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span id="local-6989586621679094741"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span id="local-6989586621679094740"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094740"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094739"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679094739"><span class="annot"><span class="annottext">r :: Integer
</span><a href="#local-6989586621679094739"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094741"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094740"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Create a scalar from integer. mainly for debugging purpose.</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarFromInteger"><span class="hs-identifier hs-type">scalarFromInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span>
</span><span id="line-162"></span><span id="scalarFromInteger"><span class="annot"><span class="annottext">scalarFromInteger :: Integer -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#scalarFromInteger"><span class="hs-identifier hs-var hs-var">scalarFromInteger</span></a></span></span><span> </span><span id="local-6989586621679094736"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094736"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Scalar
</span><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094736"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Add 2 points together</span><span>
</span><span id="line-165"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pointAdd"><span class="hs-identifier hs-type">pointAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-166"></span><span id="pointAdd"><span class="annot"><span class="annottext">pointAdd :: PointCompressed -&gt; PointCompressed -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#pointAdd"><span class="hs-identifier hs-var hs-var">pointAdd</span></a></span></span><span> </span><span id="local-6989586621679094735"><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094735"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679094734"><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094734"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#ePointCompress"><span class="hs-identifier hs-var">ePointCompress</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-var">ePointDecompress</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094735"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PointCompressed -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-var">ePointDecompress</span></a></span><span> </span><span class="annot"><span class="annottext">PointCompressed
</span><a href="#local-6989586621679094734"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Lift a scalar to the curve, and returning a compressed point</span><span>
</span><span id="line-169"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#scalarToPoint"><span class="hs-identifier hs-type">scalarToPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-170"></span><span id="scalarToPoint"><span class="annot"><span class="annottext">scalarToPoint :: Scalar -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#scalarToPoint"><span class="hs-identifier hs-var hs-var">scalarToPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span id="local-6989586621679094733"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094733"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#ePointCompress"><span class="hs-identifier hs-var">ePointCompress</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Fq -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-var">ePointMul</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#fq"><span class="hs-identifier hs-var">fq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094733"><span class="hs-identifier hs-var">sec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#pG"><span class="hs-identifier hs-var">pG</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Point represented by (X, Y, Z, T) in extended twisted edward coordinates.</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   x = X/Z</span><span>
</span><span id="line-175"></span><span class="hs-comment">--   y = Y/Z</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- x*y = T/Z</span><span>
</span><span id="line-177"></span><span class="hs-keyword">data</span><span> </span><span id="ExtendedPoint"><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtendedPoint"><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679094721"><span id="local-6989586621679094723"><span id="local-6989586621679094731"><span class="annot"><span class="annottext">Int -&gt; ExtendedPoint -&gt; ShowS
[ExtendedPoint] -&gt; ShowS
ExtendedPoint -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtendedPoint] -&gt; ShowS
$cshowList :: [ExtendedPoint] -&gt; ShowS
show :: ExtendedPoint -&gt; String
$cshow :: ExtendedPoint -&gt; String
showsPrec :: Int -&gt; ExtendedPoint -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtendedPoint -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679094713"><span id="local-6989586621679094719"><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
$c/= :: ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
== :: ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
$c== :: ExtendedPoint -&gt; ExtendedPoint -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-type">ePointAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span>
</span><span id="line-181"></span><span id="ePointAdd"><span class="annot"><span class="annottext">ePointAdd :: ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var hs-var">ePointAdd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span id="local-6989586621679094712"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094712"><span class="hs-identifier hs-var">pX</span></a></span></span><span> </span><span id="local-6989586621679094711"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094711"><span class="hs-identifier hs-var">pY</span></a></span></span><span> </span><span id="local-6989586621679094710"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094710"><span class="hs-identifier hs-var">pZ</span></a></span></span><span> </span><span id="local-6989586621679094709"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094709"><span class="hs-identifier hs-var">pT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span id="local-6989586621679094708"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094708"><span class="hs-identifier hs-var">qX</span></a></span></span><span> </span><span id="local-6989586621679094707"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094707"><span class="hs-identifier hs-var">qY</span></a></span></span><span> </span><span id="local-6989586621679094706"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094706"><span class="hs-identifier hs-var">qZ</span></a></span></span><span> </span><span id="local-6989586621679094705"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094705"><span class="hs-identifier hs-var">qT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094704"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094703"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094702"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094701"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094703"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094702"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094704"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094701"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679094696"><span class="annot"><span class="annottext">a :: Integer
</span><a href="#local-6989586621679094696"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094711"><span class="hs-identifier hs-var">pY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094712"><span class="hs-identifier hs-var">pX</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094707"><span class="hs-identifier hs-var">qY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094708"><span class="hs-identifier hs-var">qX</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679094691"><span class="annot"><span class="annottext">b :: Integer
</span><a href="#local-6989586621679094691"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094711"><span class="hs-identifier hs-var">pY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094712"><span class="hs-identifier hs-var">pX</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094707"><span class="hs-identifier hs-var">qY</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094708"><span class="hs-identifier hs-var">qX</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679094685"><span class="annot"><span class="annottext">c :: Integer
</span><a href="#local-6989586621679094685"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094709"><span class="hs-identifier hs-var">pT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094705"><span class="hs-identifier hs-var">qT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#curveD"><span class="hs-identifier hs-var">curveD</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679094679"><span class="annot"><span class="annottext">d :: Integer
</span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094710"><span class="hs-identifier hs-var">pZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094706"><span class="hs-identifier hs-var">qZ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679094704"><span class="annot"><span class="annottext">e :: Integer
</span><a href="#local-6989586621679094704"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094691"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094696"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679094703"><span class="annot"><span class="annottext">f :: Integer
</span><a href="#local-6989586621679094703"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094685"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679094702"><span class="annot"><span class="annottext">g :: Integer
</span><a href="#local-6989586621679094702"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094679"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094685"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679094701"><span class="annot"><span class="annottext">h :: Integer
</span><a href="#local-6989586621679094701"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094691"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094696"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-type">ePointMul</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-type">Fq</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span>
</span><span id="line-194"></span><span id="ePointMul"><span class="annot"><span class="annottext">ePointMul :: Fq -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointMul"><span class="hs-identifier hs-var hs-var">ePointMul</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-type">Fq</span></a></span><span> </span><span id="local-6989586621679094674"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094674"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679094673"><span class="annot"><span class="annottext">loop :: Int -&gt; ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679094665"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679094664"><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679094663"><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094674"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="#local-6989586621679094673"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679094665"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtendedPoint -&gt; ExtendedPoint -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointAdd"><span class="hs-identifier hs-var">ePointAdd</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094664"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">ExtendedPoint
</span><a href="#local-6989586621679094663"><span class="hs-identifier hs-var">pP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ePointCompress"><span class="hs-identifier hs-type">ePointCompress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span>
</span><span id="line-202"></span><span id="ePointCompress"><span class="annot"><span class="annottext">ePointCompress :: ExtendedPoint -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#ePointCompress"><span class="hs-identifier hs-var hs-var">ePointCompress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span> </span><span id="local-6989586621679094660"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094660"><span class="hs-identifier hs-var">pX</span></a></span></span><span> </span><span id="local-6989586621679094659"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094659"><span class="hs-identifier hs-var">pY</span></a></span></span><span> </span><span id="local-6989586621679094658"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094658"><span class="hs-identifier hs-var">pZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; PointCompressed
</span><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-var">PointCompressed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-var">toBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094657"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094655"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0x1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679094652"><span class="annot"><span class="annottext">zinv :: Integer
</span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var hs-var">zinv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-var">modp_inv</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094658"><span class="hs-identifier hs-var">pZ</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679094655"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679094655"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094660"><span class="hs-identifier hs-var">pX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var">zinv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679094657"><span class="annot"><span class="annottext">y :: Integer
</span><a href="#local-6989586621679094657"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094659"><span class="hs-identifier hs-var">pY</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094652"><span class="hs-identifier hs-var">zinv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-type">ePointDecompress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span>
</span><span id="line-210"></span><span id="ePointDecompress"><span class="annot"><span class="annottext">ePointDecompress :: PointCompressed -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ePointDecompress"><span class="hs-identifier hs-var hs-var">ePointDecompress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Math.Edwards25519.html#PointCompressed"><span class="hs-identifier hs-type">PointCompressed</span></a></span><span> </span><span id="local-6989586621679094646"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679094645"><span class="annot"><span class="annottext">cy :: Integer
</span><a href="#local-6989586621679094645"><span class="hs-identifier hs-var hs-var">cy</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679094646"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679094643"><span class="annot"><span class="annottext">xSign :: Bool
</span><a href="#local-6989586621679094643"><span class="hs-identifier hs-var hs-var">xSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094645"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621679094641"><span class="annot"><span class="annottext">y :: Integer
</span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094645"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679094639"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#recoverX"><span class="hs-identifier hs-var">recoverX</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679094643"><span class="hs-identifier hs-var">xSign</span></a></span><span>
</span><span id="line-215"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094639"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094641"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Given y and the sign of x, recover x</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#recoverX"><span class="hs-identifier hs-type">recoverX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-219"></span><span id="recoverX"><span class="annot"><span class="annottext">recoverX :: Integer -&gt; Bool -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#recoverX"><span class="hs-identifier hs-var hs-var">recoverX</span></a></span></span><span> </span><span id="local-6989586621679094637"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679094636"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679094636"><span class="hs-identifier hs-var">xSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094635"><span class="hs-identifier hs-var">x''</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679094626"><span class="annot"><span class="annottext">x2 :: Integer
</span><a href="#local-6989586621679094626"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-var">modp_inv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#curveD"><span class="hs-identifier hs-var">curveD</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094637"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span id="local-6989586621679094621"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">expFast</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094626"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679094611"><span class="annot"><span class="annottext">x' :: Integer
</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094626"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094610"><span class="hs-identifier hs-var">modp_sqrt_m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094621"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679094635"><span class="annot"><span class="annottext">x'' :: Integer
</span><a href="#local-6989586621679094635"><span class="hs-identifier hs-var hs-var">x''</span></a></span></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">odd</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679094636"><span class="hs-identifier hs-var">xSign</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094611"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="#local-6989586621679094610"><span class="hs-identifier hs-type">modp_sqrt_m1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679094610"><span class="annot"><span class="annottext">modp_sqrt_m1 :: Integer
</span><a href="#local-6989586621679094610"><span class="hs-identifier hs-var hs-var">modp_sqrt_m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">expFast</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Unserialize little endian</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-type">fromBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-237"></span><span id="fromBytes"><span class="annot"><span class="annottext">fromBytes :: ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var hs-var">fromBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">os2ip</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.reverse</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Serialize little endian of a given size (32 bytes)</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-type">toBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-241"></span><span id="toBytes"><span class="annot"><span class="annottext">toBytes :: Integer -&gt; ByteString
</span><a href="Crypto.Math.Edwards25519.html#toBytes"><span class="hs-identifier hs-var hs-var">toBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.reverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArray ba =&gt; Int -&gt; Integer -&gt; ba
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">i2ospOf_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Inverse modular p</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-type">modp_inv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-245"></span><span id="modp_inv"><span class="annot"><span class="annottext">modp_inv :: Integer -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-var hs-var">modp_inv</span></a></span></span><span> </span><span id="local-6989586621679094602"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094602"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">expFast</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094602"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Base field 2^255-19 =&gt; 25519</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-249"></span><span id="p"><span class="annot"><span class="annottext">p :: Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span> </span><span class="hs-glyph">::</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">19</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Curve constant d</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#curveD"><span class="hs-identifier hs-type">curveD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-253"></span><span id="curveD"><span class="annot"><span class="annottext">curveD :: Integer
</span><a href="Crypto.Math.Edwards25519.html#curveD"><span class="hs-identifier hs-var hs-var">curveD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">121665</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-var">modp_inv</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">121666</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | Group order</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-257"></span><span id="q"><span class="annot"><span class="annottext">q :: Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">252</span></span><span> </span><span class="hs-glyph">::</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">27742317777372353535851937790883648493</span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Base Point in extended form</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Crypto.Math.Edwards25519.html#pG"><span class="hs-identifier hs-type">pG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-type">ExtendedPoint</span></a></span><span>
</span><span id="line-261"></span><span id="pG"><span class="annot"><span class="annottext">pG :: ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#pG"><span class="hs-identifier hs-var hs-var">pG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; ExtendedPoint
</span><a href="Crypto.Math.Edwards25519.html#ExtendedPoint"><span class="hs-identifier hs-var">ExtendedPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094600"><span class="hs-identifier hs-var">g_x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var">g_y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094600"><span class="hs-identifier hs-var">g_x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var">g_y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679094599"><span class="annot"><span class="annottext">g_y :: Integer
</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var hs-var">g_y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#modp_inv"><span class="hs-identifier hs-var">modp_inv</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#p"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679094600"><span class="annot"><span class="annottext">g_x :: Integer
</span><a href="#local-6989586621679094600"><span class="hs-identifier hs-var hs-var">g_x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#recoverX"><span class="hs-identifier hs-var">recoverX</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679094599"><span class="hs-identifier hs-var">g_y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621679095087"><span class="annot"><a href="Crypto.Math.Edwards25519.html#sha512_modq"><span class="hs-identifier hs-type">sha512_modq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">B.ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095087"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095087"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-type">Fq</span></a></span></span><span>
</span><span id="line-267"></span><span id="sha512_modq"><span class="annot"><span class="annottext">sha512_modq :: forall ba. ByteArrayAccess ba =&gt; ba -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#sha512_modq"><span class="hs-identifier hs-var hs-var">sha512_modq</span></a></span></span><span> </span><span id="local-6989586621679094589"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679094589"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Fq
</span><a href="Crypto.Math.Edwards25519.html#Fq"><span class="hs-identifier hs-var">Fq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Crypto.Math.Edwards25519.html#fromBytes"><span class="hs-identifier hs-var">fromBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679094589"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">SHA512</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="Crypto.Math.Edwards25519.html#q"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span></pre></body></html>
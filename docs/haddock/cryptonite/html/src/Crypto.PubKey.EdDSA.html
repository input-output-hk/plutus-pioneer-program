<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.PubKey.EdDSA</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- EdDSA signature generation and verification, implemented in Haskell and</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- parameterized with elliptic curve and hash algorithm.  Only edwards25519 is</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- supported at the moment.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- The module provides \&quot;context\&quot; and \&quot;prehash\&quot; variants defined in</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &lt;https://tools.ietf.org/html/rfc8032 RFC 8032&gt;.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- This implementation is most useful when wanting to customize the hash</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- algorithm.  See module &quot;Crypto.PubKey.Ed25519&quot; for faster Ed25519 with</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- SHA-512.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes                 #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.PubKey.EdDSA</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier">SecretKey</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier">PublicKey</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier">Signature</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Curves with EdDSA implementation</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier">EllipticCurveEdDSA</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier">CurveDigestSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier">publicKeySize</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier">secretKeySize</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier">signatureSize</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Smart constructors</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword">signature</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier">publicKey</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier">secretKey</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Methods</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier">toPublic</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier">sign</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier">signCtx</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier">signPh</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier">verifyCtx</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier">verifyPh</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier">generateSecretKey</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">ByteArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">ByteArrayAccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Bytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">ScrubbedBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">View</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.ECC.html"><span class="hs-identifier">Crypto.ECC</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.ECC.Edwards25519.html"><span class="hs-identifier">Crypto.ECC.Edwards25519</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Edwards25519</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Error.html"><span class="hs-identifier">Crypto.Error</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Hash.html"><span class="hs-identifier">Crypto.Hash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier">Digest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Hash.IO.html"><span class="hs-identifier">Crypto.Hash.IO</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Random.html"><span class="hs-identifier">Crypto.Random</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">KnownNat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Builder.html"><span class="hs-identifier">Crypto.Internal.Builder</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Compat.html"><span class="hs-identifier">Crypto.Internal.Compat</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Imports.html"><span class="hs-identifier">Crypto.Internal.Imports</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Nat.html"><span class="hs-identifier">Crypto.Internal.Nat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier">integralNatVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Foreign.Storable</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- API</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | An EdDSA Secret key</span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="SecretKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span></span><span> </span><span id="local-6989586621679233551"><span class="annot"><a href="#local-6989586621679233551"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SecretKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span></span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ScrubbedBytes</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679233187"><span id="local-6989586621679233189"><span id="local-6989586621679233195"><span class="annot"><span class="annottext">Int -&gt; SecretKey curve -&gt; ShowS
forall curve. Int -&gt; SecretKey curve -&gt; ShowS
forall curve. [SecretKey curve] -&gt; ShowS
forall curve. SecretKey curve -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SecretKey curve] -&gt; ShowS
$cshowList :: forall curve. [SecretKey curve] -&gt; ShowS
show :: SecretKey curve -&gt; String
$cshow :: forall curve. SecretKey curve -&gt; String
showsPrec :: Int -&gt; SecretKey curve -&gt; ShowS
$cshowsPrec :: forall curve. Int -&gt; SecretKey curve -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233179"><span id="local-6989586621679233184"><span class="annot"><span class="annottext">SecretKey curve -&gt; SecretKey curve -&gt; Bool
forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SecretKey curve -&gt; SecretKey curve -&gt; Bool
$c/= :: forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
== :: SecretKey curve -&gt; SecretKey curve -&gt; Bool
$c== :: forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233164"><span id="local-6989586621679233168"><span id="local-6989586621679233173"><span class="annot"><span class="annottext">SecretKey curve -&gt; Int
forall curve. SecretKey curve -&gt; Int
forall p. SecretKey curve -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve p. SecretKey curve -&gt; Ptr p -&gt; IO ()
forall p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: forall p. SecretKey curve -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve p. SecretKey curve -&gt; Ptr p -&gt; IO ()
withByteArray :: forall p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: SecretKey curve -&gt; Int
$clength :: forall curve. SecretKey curve -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233158"><span class="annot"><span class="annottext">SecretKey curve -&gt; ()
forall curve. SecretKey curve -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: SecretKey curve -&gt; ()
$crnf :: forall curve. SecretKey curve -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | An EdDSA public key</span><span>
</span><span id="line-80"></span><span class="hs-keyword">newtype</span><span> </span><span id="PublicKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span id="local-6989586621679233536"><span class="annot"><a href="#local-6989586621679233536"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679233535"><span class="annot"><a href="#local-6989586621679233535"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PublicKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679233143"><span id="local-6989586621679233145"><span id="local-6989586621679233150"><span class="annot"><span class="annottext">Int -&gt; PublicKey curve hash -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall curve hash. Int -&gt; PublicKey curve hash -&gt; ShowS
forall curve hash. [PublicKey curve hash] -&gt; ShowS
forall curve hash. PublicKey curve hash -&gt; String
showList :: [PublicKey curve hash] -&gt; ShowS
$cshowList :: forall curve hash. [PublicKey curve hash] -&gt; ShowS
show :: PublicKey curve hash -&gt; String
$cshow :: forall curve hash. PublicKey curve hash -&gt; String
showsPrec :: Int -&gt; PublicKey curve hash -&gt; ShowS
$cshowsPrec :: forall curve hash. Int -&gt; PublicKey curve hash -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233136"><span id="local-6989586621679233141"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
/= :: PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
$c/= :: forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
== :: PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
$c== :: forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233122"><span id="local-6989586621679233126"><span id="local-6989586621679233131"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; Int
forall p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve hash. PublicKey curve hash -&gt; Int
forall p a. PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve hash p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
forall curve hash p a.
PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: forall p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve hash p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
withByteArray :: forall p a. PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve hash p a.
PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: PublicKey curve hash -&gt; Int
$clength :: forall curve hash. PublicKey curve hash -&gt; Int
</span><a href="#local-6989586621679233122"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233117"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
forall curve hash. PublicKey curve hash -&gt; ()
rnf :: PublicKey curve hash -&gt; ()
$crnf :: forall curve hash. PublicKey curve hash -&gt; ()
</span><a href="#local-6989586621679233117"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | An EdDSA signature</span><span>
</span><span id="line-84"></span><span class="hs-keyword">newtype</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span id="local-6989586621679233525"><span class="annot"><a href="#local-6989586621679233525"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679233524"><span class="annot"><a href="#local-6989586621679233524"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679233104"><span id="local-6989586621679233106"><span id="local-6989586621679233110"><span class="annot"><span class="annottext">Int -&gt; Signature curve hash -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall curve hash. Int -&gt; Signature curve hash -&gt; ShowS
forall curve hash. [Signature curve hash] -&gt; ShowS
forall curve hash. Signature curve hash -&gt; String
showList :: [Signature curve hash] -&gt; ShowS
$cshowList :: forall curve hash. [Signature curve hash] -&gt; ShowS
show :: Signature curve hash -&gt; String
$cshow :: forall curve hash. Signature curve hash -&gt; String
showsPrec :: Int -&gt; Signature curve hash -&gt; ShowS
$cshowsPrec :: forall curve hash. Int -&gt; Signature curve hash -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233098"><span id="local-6989586621679233102"><span class="annot"><span class="annottext">Signature curve hash -&gt; Signature curve hash -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
/= :: Signature curve hash -&gt; Signature curve hash -&gt; Bool
$c/= :: forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
== :: Signature curve hash -&gt; Signature curve hash -&gt; Bool
$c== :: forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233085"><span id="local-6989586621679233089"><span id="local-6989586621679233093"><span class="annot"><span class="annottext">Signature curve hash -&gt; Int
forall p. Signature curve hash -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve hash. Signature curve hash -&gt; Int
forall p a. Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve hash p. Signature curve hash -&gt; Ptr p -&gt; IO ()
forall curve hash p a.
Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: forall p. Signature curve hash -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve hash p. Signature curve hash -&gt; Ptr p -&gt; IO ()
withByteArray :: forall p a. Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve hash p a.
Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: Signature curve hash -&gt; Int
$clength :: forall curve hash. Signature curve hash -&gt; Int
</span><a href="#local-6989586621679233085"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679233080"><span class="annot"><span class="annottext">Signature curve hash -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
forall curve hash. Signature curve hash -&gt; ()
rnf :: Signature curve hash -&gt; ()
$crnf :: forall curve hash. Signature curve hash -&gt; ()
</span><a href="#local-6989586621679233080"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Elliptic curves with an implementation of EdDSA</span><span>
</span><span id="line-88"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.ECC.html#EllipticCurveBasepointArith"><span class="hs-identifier hs-type">EllipticCurveBasepointArith</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">KnownNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="EllipticCurveEdDSA"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-var">EllipticCurveEdDSA</span></a></span></span><span> </span><span id="local-6989586621679233514"><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- | Size of the digest for this curve (in bytes)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CurveDigestSize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-var">CurveDigestSize</span></a></span></span><span> </span><span id="local-6989586621679233514"><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- | Size of secret keys for this curve (in bytes)</span><span>
</span><span id="line-96"></span><span>    </span><span id="secretKeySize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-type">secretKeySize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233470"><span class="annot"><a href="#local-6989586621679233470"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- hash with specified parameters</span><span>
</span><span id="line-99"></span><span>    </span><span id="hashWithDom"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-type">hashWithDom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233341"><span id="local-6989586621679233342"><span id="local-6989586621679233343"><span id="local-6989586621679233344"><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233344"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233343"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233342"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233341"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233344"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233343"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Internal.Builder.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233342"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span></span></span></span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- conversion between scalar, point and public key</span><span>
</span><span id="line-103"></span><span>    </span><span id="pointPublic"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#pointPublic"><span class="hs-identifier hs-type">pointPublic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233433"><span id="local-6989586621679233434"><span class="annot"><a href="#local-6989586621679233434"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233433"><span class="hs-identifier hs-type">hash</span></a></span></span></span><span>
</span><span id="line-104"></span><span>    </span><span id="publicPoint"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicPoint"><span class="hs-identifier hs-type">publicPoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233310"><span id="local-6989586621679233311"><span class="annot"><a href="#local-6989586621679233311"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233310"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-105"></span><span>    </span><span id="encodeScalarLE"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#encodeScalarLE"><span class="hs-identifier hs-type">encodeScalarLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233295"><span id="local-6989586621679233296"><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233296"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233295"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233296"><span class="hs-identifier hs-type">bs</span></a></span></span></span><span>
</span><span id="line-106"></span><span>    </span><span id="decodeScalarLE"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-type">decodeScalarLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233286"><span id="local-6989586621679233287"><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233287"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233286"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233287"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- how to use bits in a secret key</span><span>
</span><span id="line-109"></span><span>    </span><span id="scheduleSecret"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-type">scheduleSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679233426"><span id="local-6989586621679233427"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233427"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-110"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233427"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-111"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233426"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-113"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233427"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-114"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-115"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233514"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">View</span></a></span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Size of public keys for this curve (in bytes)</span><span>
</span><span id="line-118"></span><span id="local-6989586621679233509"><span id="local-6989586621679233510"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-type">publicKeySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233510"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233509"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233510"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-119"></span><span id="publicKeySize"><span class="annot"><span class="annottext">publicKeySize :: forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var hs-var">publicKeySize</span></a></span></span><span> </span><span id="local-6989586621679233062"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233062"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233062"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Size of signatures for this curve (in bytes)</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-type">signatureSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679233505"><span class="annot"><a href="#local-6989586621679233505"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679233506"><span class="annot"><a href="#local-6989586621679233506"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233506"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-123"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233505"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233506"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-124"></span><span id="signatureSize"><span class="annot"><span class="annottext">signatureSize :: forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var hs-var">signatureSize</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (bitlen :: Nat) a (proxy :: Nat -&gt; *).
(KnownNat bitlen, Num a) =&gt;
proxy bitlen -&gt; a
</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233506"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Constructors</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Try to build a public key from a bytearray</span><span>
</span><span id="line-130"></span><span id="local-6989586621679233489"><span id="local-6989586621679233490"><span id="local-6989586621679233493"><span id="local-6989586621679233494"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier hs-type">publicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233494"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-131"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233493"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-132"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233493"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233494"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-133"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233490"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-134"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233489"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233494"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233493"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233490"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233494"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233493"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-136"></span><span id="publicKey"><span class="annot"><span class="annottext">publicKey :: forall curve hash ba (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ba) =&gt;
proxy curve -&gt; hash -&gt; ba -&gt; CryptoFailable (PublicKey curve hash)
</span><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier hs-var hs-var">publicKey</span></a></span></span><span> </span><span id="local-6989586621679233045"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233045"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="annot"><span class="annottext">hash
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679233044"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233044"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233044"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233045"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve hash. Bytes -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233044"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_PublicKeySizeInvalid"><span class="hs-identifier hs-var">CryptoError_PublicKeySizeInvalid</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Try to build a secret key from a bytearray</span><span>
</span><span id="line-143"></span><span id="local-6989586621679233474"><span id="local-6989586621679233475"><span id="local-6989586621679233476"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier hs-type">secretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233476"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233475"><span class="hs-identifier hs-type">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233474"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233476"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233475"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233476"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-145"></span><span id="secretKey"><span class="annot"><span class="annottext">secretKey :: forall curve ba (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess ba) =&gt;
proxy curve -&gt; ba -&gt; CryptoFailable (SecretKey curve)
</span><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier hs-var hs-var">secretKey</span></a></span></span><span> </span><span id="local-6989586621679233030"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233030"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679233029"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233029"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233029"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-var">secretKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233030"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve. ScrubbedBytes -&gt; SecretKey curve
</span><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233029"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                        </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_SecretKeyStructureInvalid"><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Try to build a signature from a bytearray</span><span>
</span><span id="line-152"></span><span id="local-6989586621679233466"><span id="local-6989586621679233467"><span id="local-6989586621679233468"><span id="local-6989586621679233469"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword hs-type">signature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233469"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-153"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233468"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-154"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233468"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233469"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-155"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233467"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-156"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233466"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233469"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233468"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233467"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233469"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233468"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-158"></span><span id="signature"><span class="annot"><span class="annottext">signature :: forall curve hash ba (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ba) =&gt;
proxy curve -&gt; hash -&gt; ba -&gt; CryptoFailable (Signature curve hash)
</span><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span id="local-6989586621679233018"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233018"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="annot"><span class="annottext">hash
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679233017"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233017"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233017"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233018"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve hash. Bytes -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679233017"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_SecretKeyStructureInvalid"><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Conversions</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Generate a secret key</span><span>
</span><span id="line-168"></span><span id="local-6989586621679233458"><span id="local-6989586621679233460"><span id="local-6989586621679233461"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier hs-type">generateSecretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233461"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Random.Types.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233460"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233458"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233461"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233460"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233461"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-170"></span><span id="generateSecretKey"><span class="annot"><span class="annottext">generateSecretKey :: forall curve (m :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, MonadRandom m) =&gt;
proxy curve -&gt; m (SecretKey curve)
</span><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier hs-var hs-var">generateSecretKey</span></a></span></span><span> </span><span id="local-6989586621679233004"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233004"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve. ScrubbedBytes -&gt; SecretKey curve
</span><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><a href="Crypto.Random.Types.html#getRandomBytes"><span class="hs-identifier hs-var">getRandomBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-var">secretKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679233004"><span class="hs-identifier hs-var">prx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Create a public key from a secret key</span><span>
</span><span id="line-173"></span><span id="local-6989586621679233445"><span id="local-6989586621679233446"><span id="local-6989586621679233447"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier hs-type">toPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233447"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233446"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233446"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233447"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233445"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233447"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233446"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233447"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233447"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233446"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span><span>
</span><span id="line-178"></span><span id="toPublic"><span class="annot"><span class="annottext">toPublic :: forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve -&gt; hash -&gt; SecretKey curve -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier hs-var hs-var">toPublic</span></a></span></span><span> </span><span id="local-6989586621679232990"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232990"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232989"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232989"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232988"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232988"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232987"><span class="annot"><span class="annottext">p :: Point curve
</span><a href="#local-6989586621679232987"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointBaseSmul"><span class="hs-identifier hs-var">pointBaseSmul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232990"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve -&gt; hash -&gt; SecretKey curve -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-var">secretScalar</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232990"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232989"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232988"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Point curve -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#pointPublic"><span class="hs-identifier hs-var">pointPublic</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232990"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232987"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679233435"><span id="local-6989586621679233436"><span id="local-6989586621679233437"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-type">secretScalar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233437"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233436"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233436"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233437"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233435"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233437"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233436"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233437"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233437"><span class="hs-identifier hs-type">curve</span></a></span></span></span></span><span>
</span><span id="line-187"></span><span id="secretScalar"><span class="annot"><span class="annottext">secretScalar :: forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve -&gt; hash -&gt; SecretKey curve -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-var hs-var">secretScalar</span></a></span></span><span> </span><span id="local-6989586621679232976"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232976"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232975"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232975"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232974"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232974"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
</span><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-var">scheduleSecret</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232976"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232975"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232974"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- EdDSA signature generation &amp; verification</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Sign a message using the key pair</span><span>
</span><span id="line-193"></span><span id="local-6989586621679233421"><span id="local-6989586621679233422"><span id="local-6989586621679233423"><span id="local-6989586621679233424"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233423"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233423"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233422"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233421"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233423"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233422"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233424"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233423"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span><span>
</span><span id="line-199"></span><span id="sign"><span class="annot"><span class="annottext">sign :: forall curve hash msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679232962"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232962"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-var">signCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232962"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var">emptyCtx</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Verify a message</span><span>
</span><span id="line-202"></span><span id="local-6989586621679233408"><span id="local-6989586621679233409"><span id="local-6989586621679233410"><span id="local-6989586621679233411"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233411"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233410"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233410"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233411"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233409"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233408"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233411"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233411"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233410"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233409"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233411"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233410"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span><span>
</span><span id="line-208"></span><span id="verify"><span class="annot"><span class="annottext">verify :: forall curve hash msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; PublicKey curve hash -&gt; msg -&gt; Signature curve hash -&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span id="local-6989586621679232949"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232949"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-var">verifyCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232949"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var">emptyCtx</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Sign a message using the key pair under context @ctx@</span><span>
</span><span id="line-211"></span><span id="local-6989586621679233412"><span id="local-6989586621679233413"><span id="local-6989586621679233414"><span id="local-6989586621679233415"><span id="local-6989586621679233416"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-type">signCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-212"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233415"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-213"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233415"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-214"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233414"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-215"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233413"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-216"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233412"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233414"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233415"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233413"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233416"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233415"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span></span><span>
</span><span id="line-218"></span><span id="signCtx"><span class="annot"><span class="annottext">signCtx :: forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-var hs-var">signCtx</span></a></span></span><span> </span><span id="local-6989586621679232936"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232936"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var">signPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232936"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Verify a message under context @ctx@</span><span>
</span><span id="line-221"></span><span id="local-6989586621679233399"><span id="local-6989586621679233400"><span id="local-6989586621679233401"><span id="local-6989586621679233402"><span id="local-6989586621679233403"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-type">verifyCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233403"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-222"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233402"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-223"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233402"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233403"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-224"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233401"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-225"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233400"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-226"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233399"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233403"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233401"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233403"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233402"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233400"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233403"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233402"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-228"></span><span id="verifyCtx"><span class="annot"><span class="annottext">verifyCtx :: forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-var hs-var">verifyCtx</span></a></span></span><span> </span><span id="local-6989586621679232922"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232922"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var">verifyPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232922"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Sign a prehashed message using the key pair under context @ctx@</span><span>
</span><span id="line-231"></span><span id="local-6989586621679233374"><span id="local-6989586621679233375"><span id="local-6989586621679233376"><span id="local-6989586621679233377"><span id="local-6989586621679233378"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier hs-type">signPh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233377"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233377"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233376"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233375"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233376"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233377"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233374"><span class="hs-identifier hs-type">prehash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233378"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233377"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span></span><span>
</span><span id="line-237"></span><span id="signPh"><span class="annot"><span class="annottext">signPh :: forall curve hash ctx (proxy :: * -&gt; *) prehash.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve,
 ByteArrayAccess ctx) =&gt;
proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier hs-var hs-var">signPh</span></a></span></span><span> </span><span id="local-6989586621679232908"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232908"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var">signPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232908"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Verify a prehashed message under context @ctx@</span><span>
</span><span id="line-240"></span><span id="local-6989586621679233362"><span id="local-6989586621679233363"><span id="local-6989586621679233364"><span id="local-6989586621679233365"><span id="local-6989586621679233366"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier hs-type">verifyPh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233366"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233365"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233365"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233366"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233364"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233363"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233366"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233364"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233366"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233365"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233362"><span class="hs-identifier hs-type">prehash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233366"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233365"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-246"></span><span id="verifyPh"><span class="annot"><span class="annottext">verifyPh :: forall curve hash ctx (proxy :: * -&gt; *) prehash.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve,
 ByteArrayAccess ctx) =&gt;
proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier hs-var hs-var">verifyPh</span></a></span></span><span> </span><span id="local-6989586621679232896"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232896"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var">verifyPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232896"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-type">signPhCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679233389"><span class="annot"><a href="#local-6989586621679233389"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679233393"><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679233392"><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span id="local-6989586621679233391"><span class="annot"><a href="#local-6989586621679233391"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679233390"><span class="annot"><a href="#local-6989586621679233390"><span class="hs-identifier hs-type">msg</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-249"></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-250"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-251"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-252"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233391"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-253"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233390"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-254"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233389"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233391"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233390"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233393"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-256"></span><span id="signPhCtx"><span class="annot"><span class="annottext">signPhCtx :: forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var hs-var">signPhCtx</span></a></span></span><span> </span><span id="local-6989586621679232858"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232857"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232857"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679232856"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232856"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679232855"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232855"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span id="local-6989586621679232854"><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679232854"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679232853"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232853"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232852"><span class="annot"><span class="annottext">alg :: hash
</span><a href="#local-6989586621679232852"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679233392"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679232850"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232850"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232849"><span class="annot"><span class="annottext">View Bytes
</span><a href="#local-6989586621679232849"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
</span><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-var">scheduleSecret</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232852"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679232855"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679232848"><span class="annot"><span class="annottext">digR :: Bytes
</span><a href="#local-6989586621679232848"><span class="hs-identifier hs-var hs-var">digR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-var">hashWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232852"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232857"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232856"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">View Bytes
</span><a href="#local-6989586621679232849"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232853"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679232846"><span class="annot"><span class="annottext">r :: Scalar curve
</span><a href="#local-6989586621679232846"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232848"><span class="hs-identifier hs-var">digR</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span id="local-6989586621679232844"><span class="annot"><span class="annottext">pR :: Point curve
</span><a href="#local-6989586621679232844"><span class="hs-identifier hs-var hs-var">pR</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointBaseSmul"><span class="hs-identifier hs-var">pointBaseSmul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232846"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span id="local-6989586621679232843"><span class="annot"><span class="annottext">bsR :: Bytes
</span><a href="#local-6989586621679232843"><span class="hs-identifier hs-var hs-var">bsR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
</span><a href="Crypto.ECC.html#encodePoint"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232844"><span class="hs-identifier hs-var">pR</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span id="local-6989586621679232841"><span class="annot"><span class="annottext">sK :: Scalar curve
</span><a href="#local-6989586621679232841"><span class="hs-identifier hs-var hs-var">sK</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var">getK</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232857"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232856"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679232854"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232843"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232853"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679232839"><span class="annot"><span class="annottext">sS :: Scalar curve
</span><a href="#local-6989586621679232839"><span class="hs-identifier hs-var hs-var">sS</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
</span><a href="Crypto.ECC.html#scalarAdd"><span class="hs-identifier hs-var">scalarAdd</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232846"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
</span><a href="Crypto.ECC.html#scalarMul"><span class="hs-identifier hs-var">scalarMul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232841"><span class="hs-identifier hs-var">sK</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232850"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve
-&gt; (Bytes, Point curve, Scalar curve) -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-var">encodeSignature</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232858"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232843"><span class="hs-identifier hs-var">bsR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232844"><span class="hs-identifier hs-var">pR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232839"><span class="hs-identifier hs-var">sS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679233379"><span id="local-6989586621679233380"><span id="local-6989586621679233381"><span id="local-6989586621679233382"><span id="local-6989586621679233383"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-type">verifyPhCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233383"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-268"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233382"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-269"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233382"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233383"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-270"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233381"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-271"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233380"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-272"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233379"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233383"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233381"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233383"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233382"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233380"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233383"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233382"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-274"></span><span id="verifyPhCtx"><span class="annot"><span class="annottext">verifyPhCtx :: forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var hs-var">verifyPhCtx</span></a></span></span><span> </span><span id="local-6989586621679232807"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232806"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232806"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679232805"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232805"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679232804"><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679232804"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679232803"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232803"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679232802"><span class="annot"><span class="annottext">Signature curve hash
</span><a href="#local-6989586621679232802"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CryptoFailable Bool
</span><a href="#local-6989586621679232801"><span class="hs-identifier hs-var">doVerify</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-type">CryptoPassed</span></a></span><span> </span><span id="local-6989586621679232800"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232800"><span class="hs-identifier hs-var">verified</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232800"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-type">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679232801"><span class="annot"><span class="annottext">doVerify :: CryptoFailable Bool
</span><a href="#local-6989586621679232801"><span class="hs-identifier hs-var hs-var">doVerify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679232799"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232799"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232798"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232798"><span class="hs-identifier hs-var">pR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232797"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232797"><span class="hs-identifier hs-var">sS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; Signature curve hash
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-var">decodeSignature</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Signature curve hash
</span><a href="#local-6989586621679232802"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621679232795"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232795"><span class="hs-identifier hs-var">nPub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveArith curve =&gt;
proxy curve -&gt; Point curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointNegate"><span class="hs-identifier hs-var">pointNegate</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">`fmap`</span></a></span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; PublicKey curve hash -&gt; CryptoFailable (Point curve)
</span><a href="Crypto.PubKey.EdDSA.html#publicPoint"><span class="hs-identifier hs-var">publicPoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679232804"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232793"><span class="annot"><span class="annottext">sK :: Scalar curve
</span><a href="#local-6989586621679232793"><span class="hs-identifier hs-var hs-var">sK</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var">getK</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232806"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232805"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679232804"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232799"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232803"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span id="local-6989586621679232792"><span class="annot"><span class="annottext">pR' :: Point curve
</span><a href="#local-6989586621679232792"><span class="hs-identifier hs-var hs-var">pR'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve
-&gt; Scalar curve -&gt; Scalar curve -&gt; Point curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointsSmulVarTime"><span class="hs-identifier hs-var">pointsSmulVarTime</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232807"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232797"><span class="hs-identifier hs-var">sS</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232793"><span class="hs-identifier hs-var">sK</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232795"><span class="hs-identifier hs-var">nPub</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232798"><span class="hs-identifier hs-var">pR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232792"><span class="hs-identifier hs-var">pR'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-type">emptyCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span>
</span><span id="line-287"></span><span id="emptyCtx"><span class="annot"><span class="annottext">emptyCtx :: Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var hs-var">emptyCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ByteArray a =&gt; a
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.empty</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-type">getK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679233328"><span class="annot"><a href="#local-6989586621679233328"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679233332"><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679233331"><span class="annot"><a href="#local-6989586621679233331"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span id="local-6989586621679233330"><span class="annot"><a href="#local-6989586621679233330"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679233329"><span class="annot"><a href="#local-6989586621679233329"><span class="hs-identifier hs-type">msg</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233331"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233331"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233330"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233329"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233328"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233330"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233331"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233329"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233332"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-297"></span><span id="getK"><span class="annot"><span class="annottext">getK :: forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var hs-var">getK</span></a></span></span><span> </span><span id="local-6989586621679232772"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232772"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232771"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232771"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679232770"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232770"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span id="local-6989586621679232769"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232769"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679232768"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232768"><span class="hs-identifier hs-var">bsR</span></a></span></span><span> </span><span id="local-6989586621679232767"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232767"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232766"><span class="annot"><span class="annottext">alg :: hash
</span><a href="#local-6989586621679232766"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679233331"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621679232765"><span class="annot"><span class="annottext">digK :: Bytes
</span><a href="#local-6989586621679232765"><span class="hs-identifier hs-var hs-var">digK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-var">hashWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232772"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232766"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232771"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232770"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232768"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232769"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232767"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-300"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232772"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232765"><span class="hs-identifier hs-var">digK</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621679233324"><span id="local-6989586621679233325"><span id="local-6989586621679233326"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-type">encodeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233326"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-303"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233325"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233326"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-304"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233326"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233326"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233326"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233324"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span><span>
</span><span id="line-306"></span><span id="encodeSignature"><span class="annot"><span class="annottext">encodeSignature :: forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve
-&gt; (Bytes, Point curve, Scalar curve) -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-var hs-var">encodeSignature</span></a></span></span><span> </span><span id="local-6989586621679232751"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232751"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232750"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232750"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232749"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232749"><span class="hs-identifier hs-var">sS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash. Bytes -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArray ba =&gt; Builder -&gt; ba
</span><a href="Crypto.Internal.Builder.html#buildAndFreeze"><span class="hs-identifier hs-var">buildAndFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232750"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232747"><span class="hs-identifier hs-var">bsS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679232745"><span class="hs-identifier hs-var">len0</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679232747"><span class="annot"><span class="annottext">bsS :: Bytes
</span><a href="#local-6989586621679232747"><span class="hs-identifier hs-var hs-var">bsS</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArray bs) =&gt;
proxy curve -&gt; Scalar curve -&gt; bs
</span><a href="Crypto.PubKey.EdDSA.html#encodeScalarLE"><span class="hs-identifier hs-var">encodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232751"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232749"><span class="hs-identifier hs-var">sS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679232745"><span class="annot"><span class="annottext">len0 :: Int
</span><a href="#local-6989586621679232745"><span class="hs-identifier hs-var hs-var">len0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232751"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232750"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232747"><span class="hs-identifier hs-var">bsS</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span id="local-6989586621679233316"><span id="local-6989586621679233317"><span id="local-6989586621679233318"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-type">decodeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-313"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233317"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-314"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233316"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-316"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233317"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-317"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233318"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-318"></span><span id="decodeSignature"><span class="annot"><span class="annottext">decodeSignature :: forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; Signature curve hash
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-var hs-var">decodeSignature</span></a></span></span><span> </span><span id="local-6989586621679232730"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232730"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679232729"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232729"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232728"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232728"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232727"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232727"><span class="hs-identifier hs-var">bsS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232730"><span class="hs-identifier hs-var">prx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232729"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679232725"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232725"><span class="hs-identifier hs-var">pR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
</span><a href="Crypto.ECC.html#decodePoint"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232730"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232728"><span class="hs-identifier hs-var">bsR</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679232723"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232723"><span class="hs-identifier hs-var">sS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-var">decodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232730"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232727"><span class="hs-identifier hs-var">bsS</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232728"><span class="hs-identifier hs-var">bsR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679232725"><span class="hs-identifier hs-var">pR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679232723"><span class="hs-identifier hs-var">sS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- implementations are supposed to decode any scalar up to the size of the digest</span><span>
</span><span id="line-325"></span><span id="local-6989586621679233336"><span id="local-6989586621679233337"><span id="local-6989586621679233338"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-type">decodeScalarNoErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233338"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233337"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233336"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233338"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233337"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233338"><span class="hs-identifier hs-type">curve</span></a></span></span></span></span><span>
</span><span id="line-327"></span><span id="decodeScalarNoErr"><span class="annot"><span class="annottext">decodeScalarNoErr :: forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var hs-var">decodeScalarNoErr</span></a></span></span><span> </span><span id="local-6989586621679232718"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232718"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; CryptoFailable a -&gt; a
</span><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeScalarNoErr&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-var">decodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679232718"><span class="hs-identifier hs-var">prx</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="local-6989586621679233282"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-type">unwrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233282"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="unwrap"><span class="annot"><span class="annottext">unwrap :: forall a. String -&gt; CryptoFailable a -&gt; a
</span><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621679232710"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679232710"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-type">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679232710"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: assumption failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-type">CryptoPassed</span></a></span><span> </span><span id="local-6989586621679232708"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232708"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232708"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- Ed25519 implementation</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.html#Curve_Edwards25519"><span class="hs-identifier hs-type">Curve_Edwards25519</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CurveDigestSize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-var">CurveDigestSize</span></a></span></span><span> </span><span class="annot"><a href="Crypto.ECC.html#Curve_Edwards25519"><span class="hs-identifier hs-type">Curve_Edwards25519</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679232692"><span class="annot"><span class="annottext">secretKeySize :: forall (proxy :: * -&gt; *). proxy Curve_Edwards25519 -&gt; Int
</span><a href="#local-6989586621679232692"><span class="hs-identifier hs-var hs-var hs-var hs-var">secretKeySize</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679232668"><span class="annot"><span class="annottext">hashWithDom :: forall hash ctx msg (proxy :: * -&gt; *).
(HashAlgorithm hash, ByteArrayAccess ctx, ByteArrayAccess msg) =&gt;
proxy Curve_Edwards25519
-&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="#local-6989586621679232668"><span class="hs-identifier hs-var hs-var hs-var hs-var">hashWithDom</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679232667"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232667"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232666"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232666"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679232665"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232665"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679232664"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232664"><span class="hs-identifier hs-var">bss</span></a></span></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232666"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ByteArrayAccess a =&gt; a -&gt; Bool
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.null</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232665"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall alg msg.
(HashAlgorithm alg, ByteArrayAccess msg) =&gt;
alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var">digestDomMsg</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232667"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232664"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall alg msg.
(HashAlgorithm alg, ByteArrayAccess msg) =&gt;
alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var">digestDomMsg</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232667"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232659"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232664"><span class="hs-identifier hs-var">bss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679232659"><span class="annot"><span class="annottext">dom :: Builder
</span><a href="#local-6989586621679232659"><span class="hs-identifier hs-var hs-var">dom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;SigEd25519 no Ed25519 collisions&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-344"></span><span>                  </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#byte"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679232666"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-345"></span><span>                  </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#byte"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232665"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-346"></span><span>                  </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679232665"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679232656"><span class="annot"><span class="annottext">pointPublic :: forall (proxy :: * -&gt; *) hash.
proxy Curve_Edwards25519
-&gt; Point Curve_Edwards25519 -&gt; PublicKey Curve_Edwards25519 hash
</span><a href="#local-6989586621679232656"><span class="hs-identifier hs-var hs-var hs-var hs-var">pointPublic</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall curve hash. Bytes -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Point -&gt; bs
</span><a href="Crypto.ECC.Edwards25519.html#pointEncode"><span class="hs-identifier hs-var">Edwards25519.pointEncode</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679232653"><span class="annot"><span class="annottext">publicPoint :: forall (proxy :: * -&gt; *) hash.
proxy Curve_Edwards25519
-&gt; PublicKey Curve_Edwards25519 hash
-&gt; CryptoFailable (Point Curve_Edwards25519)
</span><a href="#local-6989586621679232653"><span class="hs-identifier hs-var hs-var hs-var hs-var">publicPoint</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable Point
</span><a href="Crypto.ECC.Edwards25519.html#pointDecode"><span class="hs-identifier hs-var">Edwards25519.pointDecode</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679232649"><span class="annot"><span class="annottext">encodeScalarLE :: forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_Edwards25519 -&gt; Scalar Curve_Edwards25519 -&gt; bs
</span><a href="#local-6989586621679232649"><span class="hs-identifier hs-var hs-var hs-var hs-var">encodeScalarLE</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Scalar -&gt; bs
</span><a href="Crypto.ECC.Edwards25519.html#scalarEncode"><span class="hs-identifier hs-var">Edwards25519.scalarEncode</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679232645"><span class="annot"><span class="annottext">decodeScalarLE :: forall bs (proxy :: * -&gt; *).
ByteArrayAccess bs =&gt;
proxy Curve_Edwards25519
-&gt; bs -&gt; CryptoFailable (Scalar Curve_Edwards25519)
</span><a href="#local-6989586621679232645"><span class="hs-identifier hs-var hs-var hs-var hs-var">decodeScalarLE</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable Scalar
</span><a href="Crypto.ECC.Edwards25519.html#scalarDecodeLong"><span class="hs-identifier hs-var">Edwards25519.scalarDecodeLong</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621679232616"><span class="annot"><span class="annottext">scheduleSecret :: forall hash (proxy :: * -&gt; *).
(HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize Curve_Edwards25519) =&gt;
proxy Curve_Edwards25519
-&gt; hash
-&gt; SecretKey Curve_Edwards25519
-&gt; (Scalar Curve_Edwards25519, View Bytes)
</span><a href="#local-6989586621679232616"><span class="hs-identifier hs-var hs-var hs-var hs-var">scheduleSecret</span></a></span></span><span> </span><span id="local-6989586621679232615"><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><a href="#local-6989586621679232615"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679232614"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232614"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232613"><span class="annot"><span class="annottext">SecretKey Curve_Edwards25519
</span><a href="#local-6989586621679232613"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><a href="#local-6989586621679232615"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232612"><span class="hs-identifier hs-var">clamped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall bytes. ByteArrayAccess bytes =&gt; bytes -&gt; Int -&gt; View bytes
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.dropView</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232610"><span class="hs-identifier hs-var">hashed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>        </span><span id="local-6989586621679232610"><span class="annot"><span class="annottext">hashed :: Bytes
</span><a href="#local-6989586621679232610"><span class="hs-identifier hs-var hs-var">hashed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall alg.
HashAlgorithm alg =&gt;
alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679232614"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232608"><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679232608"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679232608"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey Curve_Edwards25519
</span><a href="#local-6989586621679232613"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="#local-6989586621679232612"><span class="hs-identifier hs-type">clamped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621679232612"><span class="annot"><span class="annottext">clamped :: Bytes
</span><a href="#local-6989586621679232612"><span class="hs-identifier hs-var hs-var">clamped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs1 bs2 p.
(ByteArrayAccess bs1, ByteArray bs2) =&gt;
bs1 -&gt; (Ptr p -&gt; IO ()) -&gt; bs2
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.copyAndFreeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall bytes. ByteArrayAccess bytes =&gt; bytes -&gt; Int -&gt; View bytes
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.takeView</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679232610"><span class="hs-identifier hs-var">hashed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232605"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679232605"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>                      </span><span id="local-6989586621679232604"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679232604"><span class="hs-identifier hs-var">b0</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679232605"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-361"></span><span>                      </span><span id="local-6989586621679232602"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679232602"><span class="hs-identifier hs-var">b31</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679232605"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-362"></span><span>                      </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679232605"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679232602"><span class="hs-identifier hs-var">b31</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x7F</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x40</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                      </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679232605"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679232604"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0xF8</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">{-
  Optimize hashing by limiting the number of roundtrips between Haskell and C.
  Hash &quot;update&quot; functions do not use unsafe FFI call, so better concanetate
  small fragments together and call the update function once.

  Using the IO hash interface avoids context buffer copies.

  Data type Digest is not used directly but converted to Bytes early. Any use of
  withByteArray on the unpinned Digest backend would require copy through a
  pinned trampoline.
-}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span id="local-6989586621679233264"><span id="local-6989586621679233265"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-type">digestDomMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233265"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233264"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233265"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Internal.Builder.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233264"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span></span></span><span>
</span><span id="line-380"></span><span id="digestDomMsg"><span class="annot"><span class="annottext">digestDomMsg :: forall alg msg.
(HashAlgorithm alg, ByteArrayAccess msg) =&gt;
alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var hs-var">digestDomMsg</span></a></span></span><span> </span><span id="local-6989586621679232591"><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679232591"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232590"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232590"><span class="hs-identifier hs-var">bss</span></a></span></span><span> </span><span id="local-6989586621679232589"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232589"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall alg.
HashAlgorithm alg =&gt;
alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679232591"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232588"><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679232588"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679232588"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArray ba =&gt; Builder -&gt; ba
</span><a href="Crypto.Internal.Builder.html#buildAndFreeze"><span class="hs-identifier hs-var">buildAndFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679232590"><span class="hs-identifier hs-var">bss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679232588"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679232589"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621679233242"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-type">digest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233242"><span class="hs-identifier hs-type">alg</span></a></span><span>
</span><span id="line-384"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233242"><span class="hs-identifier hs-type">alg</span></a></span><span>
</span><span id="line-385"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679233241"><span class="annot"><a href="#local-6989586621679233241"><span class="hs-identifier hs-type">bs</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233241"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233241"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Bytes</span></a></span></span><span>
</span><span id="line-387"></span><span id="digest"><span class="annot"><span class="annottext">digest :: forall alg.
HashAlgorithm alg =&gt;
alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var hs-var">digest</span></a></span></span><span> </span><span id="local-6989586621679232580"><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679232580"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679232579"><span class="annot"><span class="annottext">(forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ()
</span><a href="#local-6989586621679232579"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.convert</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IO a -&gt; a
</span><a href="Crypto.Internal.Compat.html#unsafeDoIO"><span class="hs-identifier hs-var">unsafeDoIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621679232577"><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679232577"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall alg. HashAlgorithm alg =&gt; alg -&gt; IO (MutableContext alg)
</span><a href="Crypto.Hash.IO.html#hashMutableInitWith"><span class="hs-identifier hs-var">hashMutableInitWith</span></a></span><span> </span><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679232580"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">(forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ()
</span><a href="#local-6989586621679232579"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
MutableContext a -&gt; ba -&gt; IO ()
</span><a href="Crypto.Hash.IO.html#hashMutableUpdate"><span class="hs-identifier hs-var">hashMutableUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679232577"><span class="hs-identifier hs-var">mc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">forall a. HashAlgorithm a =&gt; MutableContext a -&gt; IO (Digest a)
</span><a href="Crypto.Hash.IO.html#hashMutableFinalize"><span class="hs-identifier hs-var">hashMutableFinalize</span></a></span><span> </span><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679232577"><span class="hs-identifier hs-var">mc</span></a></span><span>
</span><span id="line-391"></span></pre></body></html>
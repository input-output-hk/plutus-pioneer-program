<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Distribution/Package.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE DeriveGeneric #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span>
<a name="line-4"></a>
<a name="line-5"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-6"></a><span class='hs-comment'>-- |</span>
<a name="line-7"></a><span class='hs-comment'>-- Module      :  Distribution.Package</span>
<a name="line-8"></a><span class='hs-comment'>-- Copyright   :  Isaac Jones 2003-2004</span>
<a name="line-9"></a><span class='hs-comment'>-- License     :  BSD3</span>
<a name="line-10"></a><span class='hs-comment'>--</span>
<a name="line-11"></a><span class='hs-comment'>-- Maintainer  :  cabal-devel@haskell.org</span>
<a name="line-12"></a><span class='hs-comment'>-- Portability :  portable</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-- Defines a package identifier along with a parser and pretty printer for it.</span>
<a name="line-15"></a><span class='hs-comment'>-- 'PackageIdentifier's consist of a name and an exact version. It also defines</span>
<a name="line-16"></a><span class='hs-comment'>-- a 'Dependency' data type. A dependency is a package name and a version</span>
<a name="line-17"></a><span class='hs-comment'>-- range, like @\"foo &gt;= 1.2 &amp;&amp; &lt; 2\"@.</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Package</span>
<a name="line-20"></a>  <span class='hs-layout'>(</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.AbiHash</span>
<a name="line-21"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.ComponentId</span>
<a name="line-22"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.PackageId</span>
<a name="line-23"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.UnitId</span>
<a name="line-24"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.Module</span>
<a name="line-25"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.PackageName</span>
<a name="line-26"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.PkgconfigName</span>
<a name="line-27"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Distribution.Types.Dependency</span>
<a name="line-28"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Package</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>packageName</span><span class='hs-layout'>,</span> <span class='hs-varid'>packageVersion</span>
<a name="line-29"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>HasMungedPackageId</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>mungedName'</span><span class='hs-layout'>,</span> <span class='hs-varid'>mungedVersion'</span>
<a name="line-30"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>HasUnitId</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-31"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>PackageInstalled</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-32"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-33"></a>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-conid'>()</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Compat.Prelude</span>
<a name="line-36"></a>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Version</span>
<a name="line-38"></a>         <span class='hs-layout'>(</span> <span class='hs-conid'>Version</span> <span class='hs-layout'>)</span>
<a name="line-39"></a>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.AbiHash</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.ComponentId</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.Dependency</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.MungedPackageId</span>
<a name="line-44"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.PackageId</span>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.UnitId</span>
<a name="line-46"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.Module</span>
<a name="line-47"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.MungedPackageName</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.PackageName</span>
<a name="line-49"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Distribution.Types.PkgconfigName</span>
<a name="line-50"></a>
<a name="line-51"></a><span class='hs-comment'>-- | Class of things that have a 'PackageIdentifier'</span>
<a name="line-52"></a><span class='hs-comment'>--</span>
<a name="line-53"></a><span class='hs-comment'>-- Types in this class are all notions of a package. This allows us to have</span>
<a name="line-54"></a><span class='hs-comment'>-- different types for the different phases that packages go though, from</span>
<a name="line-55"></a><span class='hs-comment'>-- simple name\/id, package description, configured or installed packages.</span>
<a name="line-56"></a><span class='hs-comment'>--</span>
<a name="line-57"></a><span class='hs-comment'>-- Not all kinds of packages can be uniquely identified by a</span>
<a name="line-58"></a><span class='hs-comment'>-- 'PackageIdentifier'. In particular, installed packages cannot, there may be</span>
<a name="line-59"></a><span class='hs-comment'>-- many installed instances of the same source package.</span>
<a name="line-60"></a><span class='hs-comment'>--</span>
<a name="line-61"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>Package</span> <span class='hs-varid'>pkg</span> <span class='hs-keyword'>where</span>
<a name="line-62"></a>  <span class='hs-varid'>packageId</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PackageIdentifier</span>
<a name="line-63"></a>
<a name="line-64"></a><a name="mungedName'"></a><span class='hs-definition'>mungedName'</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HasMungedPackageId</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MungedPackageName</span>
<a name="line-65"></a><span class='hs-definition'>mungedName'</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mungedName</span>    <span class='hs-varop'>.</span> <span class='hs-varid'>mungedId</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="mungedVersion'"></a><span class='hs-definition'>mungedVersion'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HasMungedPackageId</span> <span class='hs-varid'>munged</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>munged</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Version</span>
<a name="line-68"></a><span class='hs-definition'>mungedVersion'</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mungedVersion</span> <span class='hs-varop'>.</span> <span class='hs-varid'>mungedId</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="HasMungedPackageId"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HasMungedPackageId</span> <span class='hs-varid'>pkg</span> <span class='hs-keyword'>where</span>
<a name="line-71"></a>  <span class='hs-varid'>mungedId</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MungedPackageId</span>
<a name="line-72"></a>
<a name="line-73"></a><a name="instance%20Package%20PackageIdentifier"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Package</span> <span class='hs-conid'>PackageIdentifier</span> <span class='hs-keyword'>where</span>
<a name="line-74"></a>  <span class='hs-varid'>packageId</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>id</span>
<a name="line-75"></a>
<a name="line-76"></a><a name="packageName"></a><span class='hs-definition'>packageName</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Package</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PackageName</span>
<a name="line-77"></a><span class='hs-definition'>packageName</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pkgName</span>    <span class='hs-varop'>.</span> <span class='hs-varid'>packageId</span>
<a name="line-78"></a>
<a name="line-79"></a><a name="packageVersion"></a><span class='hs-definition'>packageVersion</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Package</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Version</span>
<a name="line-80"></a><span class='hs-definition'>packageVersion</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pkgVersion</span> <span class='hs-varop'>.</span> <span class='hs-varid'>packageId</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="instance%20HasMungedPackageId%20MungedPackageId"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HasMungedPackageId</span> <span class='hs-conid'>MungedPackageId</span> <span class='hs-keyword'>where</span>
<a name="line-83"></a>  <span class='hs-varid'>mungedId</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>id</span>
<a name="line-84"></a>
<a name="line-85"></a><a name="HasUnitId"></a><span class='hs-comment'>-- | Packages that have an installed unit ID</span>
<a name="line-86"></a><a name="HasUnitId"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>Package</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HasUnitId</span> <span class='hs-varid'>pkg</span> <span class='hs-keyword'>where</span>
<a name="line-87"></a>  <span class='hs-varid'>installedUnitId</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UnitId</span>
<a name="line-88"></a>
<a name="line-89"></a><a name="PackageInstalled"></a><span class='hs-comment'>-- | Class of installed packages.</span>
<a name="line-90"></a><a name="PackageInstalled"></a><span class='hs-comment'>--</span>
<a name="line-91"></a><a name="PackageInstalled"></a><span class='hs-comment'>-- The primary data type which is an instance of this package is</span>
<a name="line-92"></a><a name="PackageInstalled"></a><span class='hs-comment'>-- 'InstalledPackageInfo', but when we are doing install plans in Cabal install</span>
<a name="line-93"></a><a name="PackageInstalled"></a><span class='hs-comment'>-- we may have other, installed package-like things which contain more metadata.</span>
<a name="line-94"></a><a name="PackageInstalled"></a><span class='hs-comment'>-- Installed packages have exact dependencies 'installedDepends'.</span>
<a name="line-95"></a><a name="PackageInstalled"></a><span class='hs-keyword'>class</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasUnitId</span> <span class='hs-varid'>pkg</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PackageInstalled</span> <span class='hs-varid'>pkg</span> <span class='hs-keyword'>where</span>
<a name="line-96"></a>  <span class='hs-varid'>installedDepends</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>pkg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>UnitId</span><span class='hs-keyglyph'>]</span>
</pre></body>
</html>

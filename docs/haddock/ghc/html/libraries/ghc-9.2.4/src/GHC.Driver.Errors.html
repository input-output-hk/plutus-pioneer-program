<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Driver.Errors</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>    </span><span class="annot"><a href="GHC.Driver.Errors.html#warningsToMessages"><span class="hs-identifier">warningsToMessages</span></a></span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.html#printOrThrowWarnings"><span class="hs-identifier">printOrThrowWarnings</span></a></span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.html#printBagOfErrors"><span class="hs-identifier">printBagOfErrors</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier">isWarnMsgFatal</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Driver.Errors.html#handleFlagWarnings"><span class="hs-identifier">handleFlagWarnings</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html"><span class="hs-identifier">GHC.Data.Bag</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Exception.html"><span class="hs-identifier">GHC.Utils.Exception</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#formatBulleted"><span class="hs-identifier">formatBulleted</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html#sortMsgBag"><span class="hs-identifier">sortMsgBag</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceError.html"><span class="hs-identifier">GHC.Types.SourceError</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.SourceError.html#mkSrcErr"><span class="hs-identifier">mkSrcErr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Error.html"><span class="hs-identifier">GHC.Types.Error</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier">text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier">withPprStyle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#mkErrStyle"><span class="hs-identifier">mkErrStyle</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html"><span class="hs-identifier">GHC.Driver.CmdLine</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CmdLine</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | Converts a list of 'WarningMessages' into a tuple where the second element contains only</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- error, i.e. warnings that are considered fatal by GHC based on the input 'DynFlags'.</span><span>
</span><span id="line-23"></span><span class="annot"><a href="GHC.Driver.Errors.html#warningsToMessages"><span class="hs-identifier hs-type">warningsToMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#WarningMessages"><span class="hs-identifier hs-type">WarningMessages</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#WarningMessages"><span class="hs-identifier hs-type">WarningMessages</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#ErrorMessages"><span class="hs-identifier hs-type">ErrorMessages</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span id="warningsToMessages"><span class="annot"><span class="annottext">warningsToMessages :: DynFlags -&gt; WarningMessages -&gt; (WarningMessages, WarningMessages)
</span><a href="GHC.Driver.Errors.html#warningsToMessages"><span class="hs-identifier hs-var hs-var">warningsToMessages</span></a></span></span><span> </span><span id="local-6989586621681142259"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142259"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; Either b c) -&gt; Bag a -&gt; (Bag b, Bag c)
</span><a href="GHC.Data.Bag.html#partitionBagWith"><span class="hs-identifier hs-var">partitionBagWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681142257"><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142257"><span class="hs-identifier hs-var">warn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; MsgEnvelope DecoratedSDoc -&gt; Maybe (Maybe WarningFlag)
</span><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier hs-var">isWarnMsgFatal</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142259"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142257"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Maybe WarningFlag)
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../base-4.16.3.0/src/Data-Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142257"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681142256"><span class="annot"><span class="annottext">Maybe WarningFlag
</span><a href="#local-6989586621681142256"><span class="hs-identifier hs-var">err_reason</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../base-4.16.3.0/src/Data-Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142257"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errMsgSeverity :: Severity
</span><a href="GHC.Types.Error.html#errMsgSeverity"><span class="hs-identifier hs-var">errMsgSeverity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="GHC.Types.Error.html#SevError"><span class="hs-identifier hs-var">SevError</span></a></span><span>
</span><span id="line-30"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errMsgReason :: WarnReason
</span><a href="GHC.Types.Error.html#errMsgReason"><span class="hs-identifier hs-var">errMsgReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#ErrReason"><span class="hs-identifier hs-var">ErrReason</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe WarningFlag
</span><a href="#local-6989586621681142256"><span class="hs-identifier hs-var">err_reason</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span id="local-6989586621681142306"><span class="annot"><a href="GHC.Driver.Errors.html#printBagOfErrors"><span class="hs-identifier hs-type">printBagOfErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#RenderableDiagnostic"><span class="hs-identifier hs-type">RenderableDiagnostic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681142306"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681142306"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-33"></span><span id="printBagOfErrors"><span class="annot"><span class="annottext">printBagOfErrors :: forall a.
RenderableDiagnostic a =&gt;
Logger -&gt; DynFlags -&gt; Bag (MsgEnvelope a) -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#printBagOfErrors"><span class="hs-identifier hs-var hs-var">printBagOfErrors</span></a></span></span><span> </span><span id="local-6989586621681142245"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142245"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681142244"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142244"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681142243"><span class="annot"><span class="annottext">Bag (MsgEnvelope a)
</span><a href="#local-6989586621681142243"><span class="hs-identifier hs-var">bag_of_errors</span></a></span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#sequence_"><span class="hs-identifier hs-var">sequence_</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681142241"><span class="annot"><span class="annottext">style :: PprStyle
</span><a href="#local-6989586621681142241"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrintUnqualified -&gt; PprStyle
</span><a href="GHC.Utils.Outputable.html#mkErrStyle"><span class="hs-identifier hs-var">mkErrStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PrintUnqualified
</span><a href="#local-6989586621681142240"><span class="hs-identifier hs-var">unqual</span></a></span><span>
</span><span id="line-35"></span><span>                    </span><span id="local-6989586621681142239"><span class="annot"><span class="annottext">ctx :: SDocContext
</span><a href="#local-6989586621681142239"><span class="hs-identifier hs-var hs-var">ctx</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; PprStyle -&gt; SDocContext
</span><a href="GHC.Driver.Session.html#initSDocContext"><span class="hs-identifier hs-var">initSDocContext</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142244"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681142241"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-36"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; LogAction
</span><a href="GHC.Utils.Logger.html#putLogMsg"><span class="hs-identifier hs-var">putLogMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142245"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142244"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="#local-6989586621681142236"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621681142235"><span class="hs-identifier hs-var">sev</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681142234"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-37"></span><span>                   </span><span class="annot"><span class="annottext">PprStyle -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#withPprStyle"><span class="hs-identifier hs-var">withPprStyle</span></a></span><span> </span><span class="annot"><span class="annottext">PprStyle
</span><a href="#local-6989586621681142241"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDocContext -&gt; DecoratedSDoc -&gt; SDoc
</span><a href="GHC.Utils.Error.html#formatBulleted"><span class="hs-identifier hs-var">formatBulleted</span></a></span><span> </span><span class="annot"><span class="annottext">SDocContext
</span><a href="#local-6989586621681142239"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. RenderableDiagnostic a =&gt; a -&gt; DecoratedSDoc
</span><a href="GHC.Types.Error.html#renderDiagnostic"><span class="hs-identifier hs-var">renderDiagnostic</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681142232"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errMsgSpan :: forall e. MsgEnvelope e -&gt; SrcSpan
</span><a href="GHC.Types.Error.html#errMsgSpan"><span class="hs-identifier hs-var">errMsgSpan</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681142234"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681142234"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>                              </span><span class="annot"><span class="annottext">errMsgDiagnostic :: forall e. MsgEnvelope e -&gt; e
</span><a href="GHC.Types.Error.html#errMsgDiagnostic"><span class="hs-identifier hs-var">errMsgDiagnostic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681142232"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681142232"><span class="hs-identifier hs-var">doc</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>                              </span><span class="annot"><span class="annottext">errMsgSeverity :: forall e. MsgEnvelope e -&gt; Severity
</span><a href="GHC.Types.Error.html#errMsgSeverity"><span class="hs-identifier hs-var">errMsgSeverity</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681142235"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621681142235"><span class="hs-identifier hs-var">sev</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>                              </span><span class="annot"><span class="annottext">errMsgReason :: forall e. MsgEnvelope e -&gt; WarnReason
</span><a href="GHC.Types.Error.html#errMsgReason"><span class="hs-identifier hs-var">errMsgReason</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681142236"><span class="annot"><span class="annottext">WarnReason
</span><a href="#local-6989586621681142236"><span class="hs-identifier hs-var">reason</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>                              </span><span class="annot"><span class="annottext">errMsgContext :: forall e. MsgEnvelope e -&gt; PrintUnqualified
</span><a href="GHC.Types.Error.html#errMsgContext"><span class="hs-identifier hs-var">errMsgContext</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681142240"><span class="annot"><span class="annottext">PrintUnqualified
</span><a href="#local-6989586621681142240"><span class="hs-identifier hs-var">unqual</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall e. Maybe DynFlags -&gt; Bag (MsgEnvelope e) -&gt; [MsgEnvelope e]
</span><a href="GHC.Utils.Error.html#sortMsgBag"><span class="hs-identifier hs-var">sortMsgBag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142244"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>                                                                       </span><span class="annot"><span class="annottext">Bag (MsgEnvelope a)
</span><a href="#local-6989586621681142243"><span class="hs-identifier hs-var">bag_of_errors</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="GHC.Driver.Errors.html#handleFlagWarnings"><span class="hs-identifier hs-type">handleFlagWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier hs-type">CmdLine.Warn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span id="handleFlagWarnings"><span class="annot"><span class="annottext">handleFlagWarnings :: Logger -&gt; DynFlags -&gt; [Warn] -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#handleFlagWarnings"><span class="hs-identifier hs-var hs-var">handleFlagWarnings</span></a></span></span><span> </span><span id="local-6989586621681142227"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142227"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681142226"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142226"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681142225"><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621681142225"><span class="hs-identifier hs-var">warns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681142224"><span class="annot"><span class="annottext">warns' :: [Warn]
</span><a href="#local-6989586621681142224"><span class="hs-identifier hs-var hs-var">warns'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; WarnReason -&gt; Bool
</span><a href="GHC.Driver.Errors.html#shouldPrintWarning"><span class="hs-identifier hs-var">shouldPrintWarning</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142226"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Warn -&gt; WarnReason
</span><a href="GHC.Driver.CmdLine.html#warnReason"><span class="hs-identifier hs-var">CmdLine.warnReason</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621681142225"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>      </span><span id="local-6989586621681142220"><span class="annot"><span class="annottext">toWarnReason :: WarnReason -&gt; WarnReason
</span><a href="#local-6989586621681142220"><span class="hs-identifier hs-var hs-var">toWarnReason</span></a></span></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.CmdLine.html#ReasonDeprecatedFlag"><span class="hs-identifier hs-var">CmdLine.ReasonDeprecatedFlag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDeprecatedFlags"><span class="hs-identifier hs-var">Opt_WarnDeprecatedFlags</span></a></span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><a href="#local-6989586621681142220"><span class="hs-identifier hs-var">toWarnReason</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.CmdLine.html#ReasonUnrecognisedFlag"><span class="hs-identifier hs-var">CmdLine.ReasonUnrecognisedFlag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnUnrecognisedWarningFlags"><span class="hs-identifier hs-var">Opt_WarnUnrecognisedWarningFlags</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><a href="#local-6989586621681142220"><span class="hs-identifier hs-var">toWarnReason</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.CmdLine.html#NoReason"><span class="hs-identifier hs-var">CmdLine.NoReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.Flags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>      </span><span class="hs-comment">-- It would be nicer if warns :: [Located SDoc], but that</span><span>
</span><span id="line-54"></span><span>      </span><span class="hs-comment">-- has circular import problems.</span><span>
</span><span id="line-55"></span><span>      </span><span id="local-6989586621681142212"><span class="annot"><span class="annottext">bag :: WarningMessages
</span><a href="#local-6989586621681142212"><span class="hs-identifier hs-var hs-var">bag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Bag a
</span><a href="GHC.Data.Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall e. WarnReason -&gt; MsgEnvelope e -&gt; MsgEnvelope e
</span><a href="GHC.Types.Error.html#makeIntoWarning"><span class="hs-identifier hs-var">makeIntoWarning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarnReason -&gt; WarnReason
</span><a href="#local-6989586621681142220"><span class="hs-identifier hs-var">toWarnReason</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="#local-6989586621681142209"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SDoc -&gt; MsgEnvelope DecoratedSDoc
</span><a href="GHC.Types.Error.html#mkPlainWarnMsg"><span class="hs-identifier hs-var">mkPlainWarnMsg</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681142207"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681142206"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#Warn"><span class="hs-identifier hs-type">CmdLine.Warn</span></a></span><span> </span><span id="local-6989586621681142209"><span class="annot"><span class="annottext">WarnReason
</span><a href="#local-6989586621681142209"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681142207"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681142207"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681142206"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681142206"><span class="hs-identifier hs-var">warn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Warn]
</span><a href="#local-6989586621681142224"><span class="hs-identifier hs-var">warns'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; WarningMessages -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#printOrThrowWarnings"><span class="hs-identifier hs-var">printOrThrowWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142227"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142226"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142212"><span class="hs-identifier hs-var">bag</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Checks if given 'WarnMsg' is a fatal warning.</span><span>
</span><span id="line-61"></span><span class="annot"><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier hs-type">isWarnMsgFatal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Error.html#WarnMsg"><span class="hs-identifier hs-type">WarnMsg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span id="isWarnMsgFatal"><span class="annot"><span class="annottext">isWarnMsgFatal :: DynFlags -&gt; MsgEnvelope DecoratedSDoc -&gt; Maybe (Maybe WarningFlag)
</span><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier hs-var hs-var">isWarnMsgFatal</span></a></span></span><span> </span><span id="local-6989586621681142202"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142202"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Error.html#MsgEnvelope"><span class="hs-identifier hs-type">MsgEnvelope</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">errMsgReason :: forall e. MsgEnvelope e -&gt; WarnReason
</span><a href="GHC.Types.Error.html#errMsgReason"><span class="hs-identifier hs-var">errMsgReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-type">Reason</span></a></span><span> </span><span id="local-6989586621681142201"><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681142201"><span class="hs-identifier hs-var">wflag</span></a></span></span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#wopt_fatal"><span class="hs-identifier hs-var">wopt_fatal</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681142201"><span class="hs-identifier hs-var">wflag</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142202"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681142201"><span class="hs-identifier hs-var">wflag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier hs-var">isWarnMsgFatal</span></a></span><span> </span><span id="local-6989586621681142199"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142199"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnIsError"><span class="hs-identifier hs-var">Opt_WarnIsError</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142199"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- Given a warn reason, check to see if it's associated -W opt is enabled</span><span>
</span><span id="line-72"></span><span class="annot"><a href="GHC.Driver.Errors.html#shouldPrintWarning"><span class="hs-identifier hs-type">shouldPrintWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.CmdLine.html#WarnReason"><span class="hs-identifier hs-type">CmdLine.WarnReason</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-73"></span><span id="shouldPrintWarning"><span class="annot"><span class="annottext">shouldPrintWarning :: DynFlags -&gt; WarnReason -&gt; Bool
</span><a href="GHC.Driver.Errors.html#shouldPrintWarning"><span class="hs-identifier hs-var hs-var">shouldPrintWarning</span></a></span></span><span> </span><span id="local-6989586621681142196"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142196"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.CmdLine.html#ReasonDeprecatedFlag"><span class="hs-identifier hs-var">CmdLine.ReasonDeprecatedFlag</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#wopt"><span class="hs-identifier hs-var">wopt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDeprecatedFlags"><span class="hs-identifier hs-var">Opt_WarnDeprecatedFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142196"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-75"></span><span class="annot"><a href="GHC.Driver.Errors.html#shouldPrintWarning"><span class="hs-identifier hs-var">shouldPrintWarning</span></a></span><span> </span><span id="local-6989586621681142194"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142194"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.CmdLine.html#ReasonUnrecognisedFlag"><span class="hs-identifier hs-var">CmdLine.ReasonUnrecognisedFlag</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#wopt"><span class="hs-identifier hs-var">wopt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnUnrecognisedWarningFlags"><span class="hs-identifier hs-var">Opt_WarnUnrecognisedWarningFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142194"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="GHC.Driver.Errors.html#shouldPrintWarning"><span class="hs-identifier hs-var">shouldPrintWarning</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Given a bag of warnings, turn them into an exception if</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- -Werror is enabled, or print them out otherwise.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="GHC.Driver.Errors.html#printOrThrowWarnings"><span class="hs-identifier hs-type">printOrThrowWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Error.html#WarnMsg"><span class="hs-identifier hs-type">WarnMsg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="printOrThrowWarnings"><span class="annot"><span class="annottext">printOrThrowWarnings :: Logger -&gt; DynFlags -&gt; WarningMessages -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#printOrThrowWarnings"><span class="hs-identifier hs-var hs-var">printOrThrowWarnings</span></a></span></span><span> </span><span id="local-6989586621681142193"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142193"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681142192"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142192"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681142191"><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142191"><span class="hs-identifier hs-var">warns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681142190"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681142190"><span class="hs-identifier hs-var">make_error</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681142189"><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142189"><span class="hs-identifier hs-var">warns'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">forall acc x y.
(acc -&gt; x -&gt; (acc, y)) -&gt; acc -&gt; Bag x -&gt; (acc, Bag y)
</span><a href="GHC.Data.Bag.html#mapAccumBagL"><span class="hs-identifier hs-var">mapAccumBagL</span></a></span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681142187"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681142187"><span class="hs-identifier hs-var">make_err</span></a></span></span><span> </span><span id="local-6989586621681142186"><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142186"><span class="hs-identifier hs-var">warn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; MsgEnvelope DecoratedSDoc -&gt; Maybe (Maybe WarningFlag)
</span><a href="GHC.Driver.Errors.html#isWarnMsgFatal"><span class="hs-identifier hs-var">isWarnMsgFatal</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142192"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142186"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-88"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Maybe WarningFlag)
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681142187"><span class="hs-identifier hs-var">make_err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142186"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>              </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681142185"><span class="annot"><span class="annottext">Maybe WarningFlag
</span><a href="#local-6989586621681142185"><span class="hs-identifier hs-var">err_reason</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MsgEnvelope DecoratedSDoc
</span><a href="#local-6989586621681142186"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errMsgSeverity :: Severity
</span><a href="GHC.Types.Error.html#errMsgSeverity"><span class="hs-identifier hs-var">errMsgSeverity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="GHC.Types.Error.html#SevError"><span class="hs-identifier hs-var">SevError</span></a></span><span>
</span><span id="line-92"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errMsgReason :: WarnReason
</span><a href="GHC.Types.Error.html#errMsgReason"><span class="hs-identifier hs-var">errMsgReason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#ErrReason"><span class="hs-identifier hs-var">ErrReason</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe WarningFlag
</span><a href="#local-6989586621681142185"><span class="hs-identifier hs-var">err_reason</span></a></span><span>
</span><span id="line-93"></span><span>                           </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142191"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681142190"><span class="hs-identifier hs-var">make_error</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningMessages -&gt; SourceError
</span><a href="GHC.Types.SourceError.html#mkSrcErr"><span class="hs-identifier hs-var">mkSrcErr</span></a></span><span> </span><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142189"><span class="hs-identifier hs-var">warns'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a.
RenderableDiagnostic a =&gt;
Logger -&gt; DynFlags -&gt; Bag (MsgEnvelope a) -&gt; IO ()
</span><a href="GHC.Driver.Errors.html#printBagOfErrors"><span class="hs-identifier hs-var">printBagOfErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681142193"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681142192"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">WarningMessages
</span><a href="#local-6989586621681142191"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-98"></span></pre></body></html>
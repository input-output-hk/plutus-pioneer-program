<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span> </span><span class="hs-comment">-- Wrinkle in Note [Trees That Grow]</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">{-
%
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Tc.Gen.Head</span><span>
</span><span id="line-19"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier">HsExprArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier">EValArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier">TcPass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier">AppCtxt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier">appCtxtLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier">insideExpansion</span></a></span><span>
</span><span id="line-21"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier">splitHsApps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier">rebuildHsApps</span></a></span><span>
</span><span id="line-22"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier">addArgWrap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier">isHsValArg</span></a></span><span>
</span><span id="line-23"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier">countLeadingValArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier">isVisibleArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier">pprHsExprArgTc</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier">tcInferAppHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier">tcInferAppHead_maybe</span></a></span><span>
</span><span id="line-26"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier">tcInferId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier">tcCheckId</span></a></span><span>
</span><span id="line-27"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier">obviousSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addAmbiguousNameErr"><span class="hs-identifier">addAmbiguousNameErr</span></a></span><span>
</span><span id="line-28"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier">tyConOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier">tyConOfET</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier">lookupParents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier">fieldNotInType</span></a></span><span>
</span><span id="line-29"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier">notSelector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier">nonBidirectionalErr</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier">addExprCtxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier">addFunResCtxt</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html"><span class="hs-identifier">GHC.Tc.Gen.Expr</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcExpr"><span class="hs-identifier">tcExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcCheckMonoExprNC"><span class="hs-identifier">tcCheckMonoExprNC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Expr.html#tcCheckPolyExprNC"><span class="hs-identifier">tcCheckPolyExprNC</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.HsType.html"><span class="hs-identifier">GHC.Tc.Gen.HsType</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Pat.html"><span class="hs-identifier">GHC.Tc.Gen.Pat</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Bind.html"><span class="hs-identifier">GHC.Tc.Gen.Bind</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Bind.html#chooseInferredQuantifiers"><span class="hs-identifier">chooseInferredQuantifiers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html"><span class="hs-identifier">GHC.Tc.Gen.Sig</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier">tcUserTypeSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier">tcInstSig</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.TyCl.PatSyn.html"><span class="hs-identifier">GHC.Tc.TyCl.PatSyn</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.TyCl.PatSyn.html#patSynBuilderOcc"><span class="hs-identifier">patSynBuilderOcc</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Unify.html"><span class="hs-identifier">GHC.Tc.Utils.Unify</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html"><span class="hs-identifier">GHC.Tc.Utils.Instantiate</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html"><span class="hs-identifier">GHC.Tc.Instance.Family</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html#tcGetFamInstEnvs"><span class="hs-identifier">tcGetFamInstEnvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier">tcLookupDataFamInst</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier">FamInstEnvs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html"><span class="hs-identifier">GHC.Core.UsageEnv</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.UsageEnv.html#unitUE"><span class="hs-identifier">unitUE</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html"><span class="hs-identifier">GHC.Rename.Env</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html#addUsedGRE"><span class="hs-identifier">addUsedGRE</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html"><span class="hs-identifier">GHC.Rename.Utils</span></a></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#addNameClashErrRn"><span class="hs-identifier">addNameClashErrRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#unknownSubordinateErr"><span class="hs-identifier">unknownSubordinateErr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html"><span class="hs-identifier">GHC.Tc.Solver</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#InferMode"><span class="hs-identifier">InferMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#simplifyInfer"><span class="hs-identifier">simplifyInfer</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Zonk.html"><span class="hs-identifier">GHC.Tc.Utils.Zonk</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Zonk.html#hsLitType"><span class="hs-identifier">hsLitType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html"><span class="hs-identifier">GHC.Tc.Utils.TcMType</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TcType</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html"><span class="hs-identifier">GHC.Types.Id.Info</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.ConLike.html"><span class="hs-identifier">GHC.Core.ConLike</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html"><span class="hs-identifier">GHC.Tc.Types.Evidence</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier">multiplicityTy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html"><span class="hs-identifier">GHC.Builtin.Names.TH</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html#liftStringName"><span class="hs-identifier">liftStringName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.TH.html#liftName"><span class="hs-identifier">liftName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Function.html#"><span class="hs-identifier">Data.Function</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-List-NonEmpty.html#"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
              HsExprArg: auxiliary data type
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">{- Note [HsExprArg]
~~~~~~~~~~~~~~~~~~~
The data type HsExprArg :: TcPass -&gt; Type
is a very local type, used only within this module and GHC.Tc.Gen.App

* It's really a zipper for an application chain
  See Note [Application chains and heads] in GHC.Tc.Gen.App for
  what an &quot;application chain&quot; is.

* It's a GHC-specific type, so using TTG only where necessary

* It is indexed by TcPass, meaning
  - HsExprArg TcpRn:
      The result of splitHsApps, which decomposes a HsExpr GhcRn

  - HsExprArg TcpInst:
      The result of tcInstFun, which instantiates the function type
      Adds EWrap nodes, the argument type in EValArg,
      and the kind-checked type in ETypeArg

  - HsExprArg TcpTc:
      The result of tcArg, which typechecks the value args
      In EValArg we now have a (LHsExpr GhcTc)

* rebuildPrefixApps is dual to splitHsApps, and zips an application
  back into a HsExpr

Note [EValArg]
~~~~~~~~~~~~~~
The data type EValArg is the payload of the EValArg constructor of
HsExprArg; i.e. a value argument of the application.  EValArg has two
forms:

* ValArg: payload is just the expression itself. Simple.

* ValArgQL: captures the results of applying quickLookArg to the
  argument in a ValArg.  When we later want to typecheck that argument
  we can just carry on from where quick-look left off.  The fields of
  ValArgQL exactly capture what is needed to complete the job.

Invariants:

1. With QL switched off, all arguments are ValArg; no ValArgQL

2. With QL switched on, tcInstFun converts some ValArgs to ValArgQL,
   under the conditions when quick-look should happen (eg the argument
   type is guarded) -- see quickLookArg

Note [splitHsApps]
~~~~~~~~~~~~~~~~~~
The key function
  splitHsApps :: HsExpr GhcRn -&gt; (HsExpr GhcRn, HsExpr GhcRn, [HsExprArg 'TcpRn])
takes apart either an HsApp, or an infix OpApp, returning

* The &quot;head&quot; of the application, an expression that is often a variable;
  this is used for typechecking

* The &quot;user head&quot; or &quot;error head&quot; of the application, to be reported to the
  user in case of an error.  Example:
         (`op` e)
  expands (via HsExpanded) to
         (rightSection op e)
  but we don't want to see 'rightSection' in error messages. So we keep the
  innermost un-expanded head as the &quot;error head&quot;.

* A list of HsExprArg, the arguments
-}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="TcPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-var">TcPass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TcpRn"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-var">TcpRn</span></a></span></span><span>     </span><span class="hs-comment">-- Arguments decomposed</span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="TcpInst"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-var">TcpInst</span></a></span></span><span>   </span><span class="hs-comment">-- Function instantiated</span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span id="TcpTc"><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-var">TcpTc</span></a></span></span><span>     </span><span class="hs-comment">-- Typechecked</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="HsExprArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-var">HsExprArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681388622"><span class="annot"><a href="#local-6989586621681388622"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-type">TcPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- See Note [HsExprArg]</span><span>
</span><span id="line-165"></span><span>    </span><span id="EValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-var">EValArg</span></a></span></span><span>  </span><span class="hs-special">{</span><span> </span><span id="eva_ctxt"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var hs-var">eva_ctxt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-166"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_arg"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var hs-var">eva_arg</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388622"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-167"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_arg_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; XEVAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var hs-var">eva_arg_ty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-type">XEVAType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388622"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ETypeArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-var">ETypeArg</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="eva_ctxt"><span class="annot"><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-170"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_hs_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var hs-var">eva_hs_ty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>  </span><span class="hs-comment">-- The type arg</span><span>
</span><span id="line-171"></span><span>             </span><span class="hs-special">,</span><span> </span><span id="eva_ty"><span class="annot"><span class="annottext">forall (p :: TcPass). HsExprArg p -&gt; XETAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var hs-var">eva_ty</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-type">XETAType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388622"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-comment">-- Kind-checked type arg</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EPrag"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-var">EPrag</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-174"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388622"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="EWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EPar"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-var">EPar</span></a></span></span><span>    </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-179"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="EExpand"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="EHsWrap"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-var">EHsWrap</span></a></span></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="EValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-var">EValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681388136"><span class="annot"><a href="#local-6989586621681388136"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcPass"><span class="hs-identifier hs-type">TcPass</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- See Note [EValArg]</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621681388605"><span id="ValArg"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-var">ValArg</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388605"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388605"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span id="ValArgQL"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArgQL"><span class="hs-identifier hs-var">ValArgQL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><span id="va_expr"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; LHsExpr (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#va_expr"><span class="hs-identifier hs-var hs-var">va_expr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>        </span><span class="hs-comment">-- Original application</span><span>
</span><span id="line-187"></span><span>                                                </span><span class="hs-comment">-- For location and error msgs</span><span>
</span><span id="line-188"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_fun"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; (HsExpr GhcTc, AppCtxt)
</span><a href="GHC.Tc.Gen.Head.html#va_fun"><span class="hs-identifier hs-var hs-var">va_fun</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Function of the application,</span><span>
</span><span id="line-189"></span><span>                                                   </span><span class="hs-comment">-- typechecked, plus its context</span><span>
</span><span id="line-190"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_args"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#va_args"><span class="hs-identifier hs-var hs-var">va_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Args, instantiated</span><span>
</span><span id="line-191"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="va_ty"><span class="annot"><span class="annottext">EValArg 'TcpInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Gen.Head.html#va_ty"><span class="hs-identifier hs-var hs-var">va_ty</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span> </span><span class="hs-special">}</span><span>          </span><span class="hs-comment">-- Result type</span><span>
</span><span id="line-192"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span>  </span><span class="hs-comment">-- Only exists in TcpInst phase</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="AppCtxt"><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-var">AppCtxt</span></a></span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VAExpansion"><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-var">VAExpansion</span></a></span></span><span>
</span><span id="line-196"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Inside an expansion of this expression</span><span>
</span><span id="line-197"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>           </span><span class="hs-comment">-- The SrcSpan of the expression</span><span>
</span><span id="line-198"></span><span>                         </span><span class="hs-comment">--    noSrcSpan if outermost</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VACall"><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span></span><span>
</span><span id="line-201"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- In the third argument of function f</span><span>
</span><span id="line-202"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>             </span><span class="hs-comment">-- The SrcSpan of the application (f e1 e2 e3)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-type">appCtxtLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>
</span><span id="line-205"></span><span id="appCtxtLoc"><span class="annot"><span class="annottext">appCtxtLoc :: AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var hs-var">appCtxtLoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388122"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681388122"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681388122"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-206"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388121"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681388121"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681388121"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-type">insideExpansion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-209"></span><span id="insideExpansion"><span class="annot"><span class="annottext">insideExpansion :: AppCtxt -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-var hs-var">insideExpansion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-210"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#insideExpansion"><span class="hs-identifier hs-var">insideExpansion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621681388115"><span class="annot"><span class="annottext">ppr :: AppCtxt -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span id="local-6989586621681388113"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388113"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VAExpansion&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388113"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621681388110"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388110"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681388109"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388109"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;VACall&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#int"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388109"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388110"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span id="local-6989586621681388107"><span class="annot"><a href="#local-6989586621681388107"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span id="XPass"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-var">XPass</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Hs.Extension.html#Typechecked"><span class="hs-identifier hs-type">Typechecked</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span id="local-6989586621681388106"><span class="annot"><a href="#local-6989586621681388106"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- Type arguments</span><span>
</span><span id="line-222"></span><span>  </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoExtField"><span class="hs-identifier hs-type">NoExtField</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span id="XETAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XETAType"><span class="hs-identifier hs-var">XETAType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span id="local-6989586621681388104"><span class="annot"><a href="#local-6989586621681388104"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>  </span><span class="hs-comment">-- Value arguments</span><span>
</span><span id="line-226"></span><span>  </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoExtField"><span class="hs-identifier hs-type">NoExtField</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span id="XEVAType"><span class="annot"><a href="GHC.Tc.Gen.Head.html#XEVAType"><span class="hs-identifier hs-var">XEVAType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-type">mkEValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>
</span><span id="line-230"></span><span id="mkEValArg"><span class="annot"><span class="annottext">mkEValArg :: AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var hs-var">mkEValArg</span></a></span></span><span> </span><span id="local-6989586621681388102"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388102"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388101"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388101"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: EValArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: TcPass). LHsExpr (GhcPass (XPass p)) -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-var">ValArg</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388101"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388102"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-231"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_arg_ty :: XEVAType 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var">eva_arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-type">mkETypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span>
</span><span id="line-234"></span><span id="mkETypeArg"><span class="annot"><span class="annottext">mkETypeArg :: AppCtxt -&gt; LHsWcType (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-var hs-var">mkETypeArg</span></a></span></span><span> </span><span id="local-6989586621681388098"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388098"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388097"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681388097"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388098"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681388097"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-235"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ty :: XETAType 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var">eva_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier hs-type">addArgWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span id="addArgWrap"><span class="annot"><span class="annottext">addArgWrap :: HsWrapper -&gt; [HsExprArg 'TcpInst] -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#addArgWrap"><span class="hs-identifier hs-var hs-var">addArgWrap</span></a></span></span><span> </span><span id="local-6989586621681388096"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681388096"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621681388095"><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621681388095"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-239"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; Bool
</span><a href="GHC.Tc.Types.Evidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681388096"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621681388095"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-240"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-var">EHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681388096"><span class="hs-identifier hs-var">wrap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621681388095"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier hs-type">splitHsApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Head</span><span>
</span><span id="line-244"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- Args</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- See Note [splitHsApps]</span><span>
</span><span id="line-246"></span><span id="splitHsApps"><span class="annot"><span class="annottext">splitHsApps :: HsExpr (GhcPass 'Renamed)
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="GHC.Tc.Gen.Head.html#splitHsApps"><span class="hs-identifier hs-var hs-var">splitHsApps</span></a></span></span><span> </span><span id="local-6989586621681388093"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388093"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388093"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388093"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621681388091"><span class="annot"><span class="annottext">top_ctxt :: ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621681388091"><span class="hs-identifier hs-var hs-var">top_ctxt</span></a></span></span><span> </span><span id="local-6989586621681388086"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388086"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388084"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388084"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621681388083"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388086"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388084"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621681388082"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388082"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388080"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388080"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621681388083"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388082"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388080"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621681388079"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388079"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388077"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388077"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621681388083"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388079"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388077"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621681388075"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388075"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388073"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388073"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621681388083"><span class="hs-identifier hs-var">top_lctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388075"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388073"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621681388072"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388072"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-type">HsExpanded</span></a></span><span> </span><span id="local-6989586621681388069"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388069"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388069"><span class="hs-identifier hs-var">orig</span></a></span><span>      </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388072"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span id="local-6989586621681388067"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388067"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681388066"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388066"><span class="hs-identifier hs-var">other_fun</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388066"><span class="hs-identifier hs-var">other_fun</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388067"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621681388083"><span class="annot"><span class="annottext">top_lctxt :: ThLevel
-&gt; GenLocated SrcSpanAnnA (HsExpr (GhcPass 'Renamed)) -&gt; AppCtxt
</span><a href="#local-6989586621681388083"><span class="hs-identifier hs-var hs-var">top_lctxt</span></a></span></span><span> </span><span id="local-6989586621681388065"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388065"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388063"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388063"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; HsExpr (GhcPass 'Renamed) -&gt; AppCtxt
</span><a href="#local-6989586621681388091"><span class="hs-identifier hs-var">top_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388065"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388063"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621681388092"><span class="annot"><span class="annottext">go :: HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681388062"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388062"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681388061"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388061"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span id="local-6989586621681388060"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388060"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388059"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388059"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388061"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388058"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388062"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388060"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-var">EPar</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388060"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388059"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388057"><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><a href="#local-6989586621681388057"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681388056"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388056"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681388055"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388055"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span id="local-6989586621681388054"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388054"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388053"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388053"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388055"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388058"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388056"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388054"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: TcPass).
AppCtxt -&gt; HsPragE (GhcPass (XPass p)) -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-var">EPrag</span></a></span><span>      </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388054"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><a href="#local-6989586621681388057"><span class="hs-identifier hs-var">p</span></a></span><span>   </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388053"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-type">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTypeE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681388052"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388052"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681388051"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388051"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681388050"><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681388050"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681388049"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388049"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388048"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388048"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388051"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388047"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388052"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388049"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsWcType (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkETypeArg"><span class="hs-identifier hs-var">mkETypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388049"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681388050"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388048"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-type">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">XApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681388046"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388046"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681388045"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388045"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681388044"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388044"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621681388043"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388043"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388042"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388042"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388045"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388047"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388046"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388043"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span>  </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388043"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388044"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388042"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- See Note [Looking through HsExpanded]</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-type">HsExpanded</span></a></span><span> </span><span id="local-6989586621681388041"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388041"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span id="local-6989586621681388040"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388040"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681388039"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388039"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388038"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388038"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; AppCtxt
-&gt; [HsExprArg 'TcpRn]
-&gt; ((HsExpr (GhcPass 'Renamed), AppCtxt), [HsExprArg 'TcpRn])
</span><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388040"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-var">VAExpansion</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388041"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388039"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388041"><span class="hs-identifier hs-var">orig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388038"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-comment">-- See Note [Desugar OpApp in the typechecker]</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681388037"><span class="annot"><span class="annottext">e :: HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388037"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#OpApp"><span class="hs-identifier hs-type">OpApp</span></a></span><span> </span><span class="annot"><span class="annottext">XOpApp (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388035"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388035"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681388034"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388034"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681388033"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388033"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681388032"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388032"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388031"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388031"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388033"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388033"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388034"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388033"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388035"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">AppCtxt -&gt; LHsExpr (GhcPass 'Renamed) -&gt; HsExprArg 'TcpRn
</span><a href="GHC.Tc.Gen.Head.html#mkEValArg"><span class="hs-identifier hs-var">mkEValArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388033"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#generatedSrcSpan"><span class="hs-identifier hs-var">generatedSrcSpan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388032"><span class="hs-identifier hs-var">arg2</span></a></span><span>
</span><span id="line-273"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall (p :: TcPass). EWrap -&gt; HsExprArg p
</span><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-var">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; EWrap
</span><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-var">EExpand</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388037"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388031"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621681388092"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681388028"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388028"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681388027"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388027"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681388026"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388026"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388028"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388027"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681388026"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621681388058"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#SrcSpanAnnA"><span class="hs-identifier hs-type">SrcSpanAnnA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621681388058"><span class="annot"><span class="annottext">set :: SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388058"><span class="hs-identifier hs-var hs-var">set</span></a></span></span><span> </span><span id="local-6989586621681388025"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388025"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621681388024"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388024"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681388023"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388023"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388024"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388023"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388025"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="#local-6989586621681388058"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388022"><span class="annot"><span class="annottext">ctxt :: AppCtxt
</span><a href="#local-6989586621681388022"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388022"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621681388047"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#SrcSpanAnnA"><span class="hs-identifier hs-type">SrcSpanAnnA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621681388047"><span class="annot"><span class="annottext">dec :: SrcSpanAnnA -&gt; AppCtxt -&gt; AppCtxt
</span><a href="#local-6989586621681388047"><span class="hs-identifier hs-var hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621681388021"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388021"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-type">VACall</span></a></span><span> </span><span id="local-6989586621681388020"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388020"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681388019"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388019"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ThLevel -&gt; SrcSpan -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#VACall"><span class="hs-identifier hs-var">VACall</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388020"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681388019"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681388021"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621681388047"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681388018"><span class="annot"><span class="annottext">ctxt :: AppCtxt
</span><a href="#local-6989586621681388018"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#VAExpansion"><span class="hs-identifier hs-type">VAExpansion</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388018"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-type">rebuildHsApps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpTc"><span class="hs-identifier hs-type">TcpTc</span></a></span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-287"></span><span id="rebuildHsApps"><span class="annot"><span class="annottext">rebuildHsApps :: HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var hs-var">rebuildHsApps</span></a></span></span><span> </span><span id="local-6989586621681388017"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388017"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388017"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-288"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span id="local-6989586621681388016"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388016"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681388015"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388015"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681388014"><span class="annot"><span class="annottext">HsExprArg 'TcpTc
</span><a href="#local-6989586621681388014"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681388013"><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpTc
</span><a href="#local-6989586621681388014"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-type">ValArg</span></a></span><span> </span><span id="local-6989586621681388012"><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621681388012"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681388011"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388011"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681388009"><span class="hs-identifier hs-var">lfun</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621681388012"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388011"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681388008"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681388008"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ty :: forall (p :: TcPass). HsExprArg p -&gt; XETAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_ty"><span class="hs-identifier hs-var">eva_ty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681388007"><span class="annot"><span class="annottext">XETAType 'TcpTc
</span><a href="#local-6989586621681388007"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_ctxt :: forall (p :: TcPass). HsExprArg p -&gt; AppCtxt
</span><a href="GHC.Tc.Gen.Head.html#eva_ctxt"><span class="hs-identifier hs-var">eva_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681388006"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388006"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p.
XAppTypeE p -&gt; LHsExpr p -&gt; LHsWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsAppType"><span class="hs-identifier hs-var">HsAppType</span></a></span><span> </span><span class="annot"><span class="annottext">XETAType 'TcpTc
</span><a href="#local-6989586621681388007"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681388009"><span class="hs-identifier hs-var">lfun</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681388008"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388006"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span id="local-6989586621681388005"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388005"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span> </span><span id="local-6989586621681388004"><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621681388004"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XPragE p -&gt; HsPragE p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-var">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass 'TcpTc))
</span><a href="#local-6989586621681388004"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681388009"><span class="hs-identifier hs-var">lfun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388005"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-type">EPar</span></a></span><span> </span><span id="local-6989586621681388003"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388003"><span class="hs-identifier hs-var">ctxt'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XPar p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681388009"><span class="hs-identifier hs-var">lfun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388003"><span class="hs-identifier hs-var">ctxt'</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-type">EExpand</span></a></span><span> </span><span id="local-6989586621681388002"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388002"><span class="hs-identifier hs-var">orig</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XXExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-var">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpansion (HsExpr (GhcPass 'Renamed)) (HsExpr GhcTc)
-&gt; XXExprGhcTc
</span><a href="GHC.Hs.Expr.html#ExpansionExpr"><span class="hs-identifier hs-var">ExpansionExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; HsExpansion a b
</span><a href="GHC.Hs.Expr.html#HsExpanded"><span class="hs-identifier hs-var">HsExpanded</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681388002"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388016"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388015"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-type">EHsWrap</span></a></span><span> </span><span id="local-6989586621681388000"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681388000"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; AppCtxt -&gt; [HsExprArg 'TcpTc] -&gt; HsExpr GhcTc
</span><a href="GHC.Tc.Gen.Head.html#rebuildHsApps"><span class="hs-identifier hs-var">rebuildHsApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681388000"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388016"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388015"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpTc]
</span><a href="#local-6989586621681388013"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621681388009"><span class="annot"><span class="annottext">lfun :: GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681388009"><span class="hs-identifier hs-var hs-var">lfun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. SrcSpan -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681388015"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681388016"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621681388578"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-type">isHsValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388578"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-306"></span><span id="isHsValArg"><span class="annot"><span class="annottext">isHsValArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-var hs-var">isHsValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isHsValArg"><span class="hs-identifier hs-var">isHsValArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621681388576"><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-type">countLeadingValArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388576"><span class="hs-identifier hs-type">id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-310"></span><span id="countLeadingValArgs"><span class="annot"><span class="annottext">countLeadingValArgs :: forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var hs-var">countLeadingValArgs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-311"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681387995"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387995"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387995"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-312"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681387994"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387994"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387994"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-313"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681387993"><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387993"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (id :: TcPass). [HsExprArg id] -&gt; ThLevel
</span><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><a href="#local-6989586621681387993"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-314"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#countLeadingValArgs"><span class="hs-identifier hs-var">countLeadingValArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span id="local-6989586621681387992"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-type">isValArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681387992"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-317"></span><span id="isValArg"><span class="annot"><span class="annottext">isValArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var hs-var">isValArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-318"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621681387990"><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-type">isVisibleArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681387990"><span class="hs-identifier hs-type">id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-321"></span><span id="isVisibleArg"><span class="annot"><span class="annottext">isVisibleArg :: forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var hs-var">isVisibleArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var">isVisibleArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-323"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var">isVisibleArg</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg id
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681388623"><span class="annot"><a href="GHC.Hs.Extension.html#OutputableBndrId"><span class="hs-identifier hs-type">OutputableBndrId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388623"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388623"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621681387973"><span class="annot"><span class="annottext">ppr :: HsExprArg p -&gt; SDoc
</span><a href="#local-6989586621681387973"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387972"><span class="annot"><span class="annottext">EValArg p
</span><a href="#local-6989586621681387972"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EValArg&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EValArg p
</span><a href="#local-6989586621681387972"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPrag"><span class="hs-identifier hs-type">EPrag</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387971"><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass p))
</span><a href="#local-6989586621681387971"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EPrag&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass (XPass p))
</span><a href="#local-6989586621681387971"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ETypeArg"><span class="hs-identifier hs-type">ETypeArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_hs_ty :: forall (p :: TcPass). HsExprArg p -&gt; LHsWcType (GhcPass 'Renamed)
</span><a href="GHC.Tc.Gen.Head.html#eva_hs_ty"><span class="hs-identifier hs-var">eva_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387970"><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681387970"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681387970"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span id="local-6989586621681387967"><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621681387967"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EWrap
</span><a href="#local-6989586621681387967"><span class="hs-identifier hs-var">wrap</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EWrap"><span class="hs-identifier hs-type">EWrap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621681387962"><span class="annot"><span class="annottext">ppr :: EWrap -&gt; SDoc
</span><a href="#local-6989586621681387962"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EPar"><span class="hs-identifier hs-type">EPar</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EPar&quot;</span></span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EHsWrap"><span class="hs-identifier hs-type">EHsWrap</span></a></span><span> </span><span id="local-6989586621681387961"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387961"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EHsWrap&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387961"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EExpand"><span class="hs-identifier hs-type">EExpand</span></a></span><span> </span><span id="local-6989586621681387960"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387960"><span class="hs-identifier hs-var">orig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EExpand&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387960"><span class="hs-identifier hs-var">orig</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681388624"><span class="annot"><a href="GHC.Hs.Extension.html#OutputableBndrId"><span class="hs-identifier hs-type">OutputableBndrId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#XPass"><span class="hs-identifier hs-type">XPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388624"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388624"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621681387953"><span class="annot"><span class="annottext">ppr :: EValArg p -&gt; SDoc
</span><a href="#local-6989586621681387953"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-type">ValArg</span></a></span><span> </span><span id="local-6989586621681387952"><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass p))
</span><a href="#local-6989586621681387952"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass (XPass p))
</span><a href="#local-6989586621681387952"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArgQL"><span class="hs-identifier hs-type">ValArgQL</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">va_fun :: EValArg 'TcpInst -&gt; (HsExpr GhcTc, AppCtxt)
</span><a href="GHC.Tc.Gen.Head.html#va_fun"><span class="hs-identifier hs-var">va_fun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387939"><span class="annot"><span class="annottext">(HsExpr GhcTc, AppCtxt)
</span><a href="#local-6989586621681387939"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">va_args :: EValArg 'TcpInst -&gt; [HsExprArg 'TcpInst]
</span><a href="GHC.Tc.Gen.Head.html#va_args"><span class="hs-identifier hs-var">va_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387938"><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621681387938"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">va_ty :: EValArg 'TcpInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Gen.Head.html#va_ty"><span class="hs-identifier hs-var">va_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387937"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387937"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ValArgQL&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(HsExpr GhcTc, AppCtxt)
</span><a href="#local-6989586621681387939"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>         </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpInst]
</span><a href="#local-6989586621681387938"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;va_ty:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387937"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-type">pprHsExprArgTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpInst"><span class="hs-identifier hs-type">TcpInst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-343"></span><span id="pprHsExprArgTc"><span class="annot"><span class="annottext">pprHsExprArgTc :: HsExprArg 'TcpInst -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-var hs-var">pprHsExprArgTc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387934"><span class="annot"><span class="annottext">EValArg 'TcpInst
</span><a href="#local-6989586621681387934"><span class="hs-identifier hs-var">tm</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eva_arg_ty :: forall (p :: TcPass). HsExprArg p -&gt; XEVAType p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg_ty"><span class="hs-identifier hs-var">eva_arg_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387933"><span class="annot"><span class="annottext">XEVAType 'TcpInst
</span><a href="#local-6989586621681387933"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EValArg&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EValArg 'TcpInst
</span><a href="#local-6989586621681387934"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">XEVAType 'TcpInst
</span><a href="#local-6989586621681387933"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#pprHsExprArgTc"><span class="hs-identifier hs-var">pprHsExprArgTc</span></a></span><span> </span><span id="local-6989586621681387931"><span class="annot"><span class="annottext">HsExprArg 'TcpInst
</span><a href="#local-6989586621681387931"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpInst
</span><a href="#local-6989586621681387931"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">{- Note [Desugar OpApp in the typechecker]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Operator sections are desugared in the renamer; see GHC.Rename.Expr
Note [Handling overloaded and rebindable constructs].
But for reasons explained there, we rename OpApp to OpApp.  Then,
here in the typechecker, we desugar it to a use of HsExpanded.
That makes it possible to typecheck something like
     e1 `f` e2
where
   f :: forall a. t1 -&gt; forall b. t2 -&gt; t3

Note [Looking through HsExpanded]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When creating an application chain in splitHsApps, we must deal with
     HsExpanded f1 (f `HsApp` e1) `HsApp` e2 `HsApp` e3

as a single application chain `f e1 e2 e3`.  Otherwise stuff like overloaded
labels (#19154) won't work.

It's easy to achieve this: `splitHsApps` unwraps `HsExpanded`.
-}</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 tcInferAppHead
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier hs-type">tcInferAppHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#AppCtxt"><span class="hs-identifier hs-type">AppCtxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-377"></span><span>               </span><span class="hs-comment">-- These two args are solely for tcInferRecSelId</span><span>
</span><span id="line-378"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- Infer type of the head of an application</span><span>
</span><span id="line-380"></span><span class="hs-comment">--   i.e. the 'f' in (f e1 ... en)</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- We get back a /SigmaType/ because we have special cases for</span><span>
</span><span id="line-383"></span><span class="hs-comment">--   * A bare identifier (just look it up)</span><span>
</span><span id="line-384"></span><span class="hs-comment">--     This case also covers a record selector HsRecFld</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   * An expression with a type signature (e :: ty)</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- Why do we need the arguments to infer the type of the head of</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- the application?  For two reasons:</span><span>
</span><span id="line-390"></span><span class="hs-comment">--   * (Legitimate) The first arg has the source location of the head</span><span>
</span><span id="line-391"></span><span class="hs-comment">--   * (Disgusting) Needed for record disambiguation; see tcInferRecSelId</span><span>
</span><span id="line-392"></span><span class="hs-comment">--</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- Note that [] and (,,) are both HsVar:</span><span>
</span><span id="line-394"></span><span class="hs-comment">--   see Note [Empty lists] and [ExplicitTuple] in GHC.Hs.Expr</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- NB: 'e' cannot be HsApp, HsTyApp, HsPrag, HsPar, because those</span><span>
</span><span id="line-397"></span><span class="hs-comment">--     cases are dealt with by splitHsApps.</span><span>
</span><span id="line-398"></span><span class="hs-comment">--</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- See Note [tcApp: typechecking applications] in GHC.Tc.Gen.App</span><span>
</span><span id="line-400"></span><span id="tcInferAppHead"><span class="annot"><span class="annottext">tcInferAppHead :: (HsExpr (GhcPass 'Renamed), AppCtxt)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead"><span class="hs-identifier hs-var hs-var">tcInferAppHead</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387930"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387930"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681387929"><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681387929"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681387928"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387928"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387927"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387927"><span class="hs-identifier hs-var">mb_res_ty</span></a></span></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AppCtxt -&gt; SrcSpan
</span><a href="GHC.Tc.Gen.Head.html#appCtxtLoc"><span class="hs-identifier hs-var">appCtxtLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AppCtxt
</span><a href="#local-6989586621681387929"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387925"><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621681387925"><span class="hs-identifier hs-var">mb_tc_fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var">tcInferAppHead_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387930"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387928"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387927"><span class="hs-identifier hs-var">mb_res_ty</span></a></span><span>
</span><span id="line-403"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621681387925"><span class="hs-identifier hs-var">mb_tc_fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-404"></span><span>            </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387924"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387924"><span class="hs-identifier hs-var">fun'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387923"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387923"><span class="hs-identifier hs-var">fun_sigma</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387924"><span class="hs-identifier hs-var">fun'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387923"><span class="hs-identifier hs-var">fun_sigma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a.
HsExpr (GhcPass 'Renamed) -&gt; [HsExprArg 'TcpRn] -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#add_head_ctxt"><span class="hs-identifier hs-var">add_head_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387930"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387928"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-406"></span><span>                       </span><span class="annot"><span class="annottext">forall a. (ExpRhoType -&gt; TcM a) -&gt; TcM (a, TcSigmaType)
</span><a href="GHC.Tc.Utils.TcMType.html#tcInfer"><span class="hs-identifier hs-var">tcInfer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; ExpRhoType -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcExpr"><span class="hs-identifier hs-var">tcExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387930"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-type">tcInferAppHead_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-409"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-410"></span><span>                        </span><span class="hs-comment">-- These two args are solely for tcInferRecSelId</span><span>
</span><span id="line-411"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- See Note [Application chains and heads] in GHC.Tc.Gen.App</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- Returns Nothing for a complicated head</span><span>
</span><span id="line-414"></span><span id="tcInferAppHead_maybe"><span class="annot"><span class="annottext">tcInferAppHead_maybe :: HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var hs-var">tcInferAppHead_maybe</span></a></span></span><span> </span><span id="local-6989586621681387920"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387920"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681387919"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387919"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387918"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387918"><span class="hs-identifier hs-var">mb_res_ty</span></a></span></span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387920"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387916"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387916"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var">tcInferId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387916"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsRecFld"><span class="hs-identifier hs-type">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">XRecFld (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387913"><span class="annot"><span class="annottext">AmbiguousFieldOcc (GhcPass 'Renamed)
</span><a href="#local-6989586621681387913"><span class="hs-identifier hs-var">f</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousFieldOcc (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-var">tcInferRecSelId</span></a></span><span> </span><span class="annot"><span class="annottext">AmbiguousFieldOcc (GhcPass 'Renamed)
</span><a href="#local-6989586621681387913"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387919"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387918"><span class="hs-identifier hs-var">mb_res_ty</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387910"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387910"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681387909"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387909"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a.
HsExpr (GhcPass 'Renamed) -&gt; [HsExprArg 'TcpRn] -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#add_head_ctxt"><span class="hs-identifier hs-var">add_head_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387920"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387919"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-419"></span><span>                                   </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
-&gt; LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-var">tcExprWithSig</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387910"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387909"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387906"><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387906"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-var">tcInferOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387906"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsSpliceE"><span class="hs-identifier hs-type">HsSpliceE</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsSpliced"><span class="hs-identifier hs-type">HsSpliced</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliced (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThModFinalizers
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsSplicedExpr"><span class="hs-identifier hs-type">HsSplicedExpr</span></a></span><span> </span><span id="local-6989586621681387901"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387901"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (Maybe (HsExpr GhcTc, TcSigmaType))
</span><a href="GHC.Tc.Gen.Head.html#tcInferAppHead_maybe"><span class="hs-identifier hs-var">tcInferAppHead_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387901"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387919"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387918"><span class="hs-identifier hs-var">mb_res_ty</span></a></span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span id="local-6989586621681388556"><span class="annot"><a href="GHC.Tc.Gen.Head.html#add_head_ctxt"><span class="hs-identifier hs-type">add_head_ctxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388556"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388556"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- Don't push an expression context if the arguments are empty,</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- because it has already been pushed by tcExpr</span><span>
</span><span id="line-428"></span><span id="add_head_ctxt"><span class="annot"><span class="annottext">add_head_ctxt :: forall a.
HsExpr (GhcPass 'Renamed) -&gt; [HsExprArg 'TcpRn] -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#add_head_ctxt"><span class="hs-identifier hs-var hs-var">add_head_ctxt</span></a></span></span><span> </span><span id="local-6989586621681387899"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387899"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681387898"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387898"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387897"><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621681387897"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387898"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621681387897"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HsExpr (GhcPass 'Renamed) -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-var">addExprCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387899"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621681387897"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Record selectors
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">{-
Note [Deprecating ambiguous fields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the future, the -XDuplicateRecordFields extension will no longer support
disambiguating record fields during type-checking (as described in Note
[Disambiguating record fields]).  For now, the -Wambiguous-fields option will
emit a warning whenever an ambiguous field is resolved using type information.
In a subsequent GHC release, this functionality will be removed and the warning
will turn into an ambiguity error in the renamer.

For background information, see GHC proposal #366
(https://github.com/ghc-proposals/ghc-proposals/pull/366).


Note [Disambiguating record fields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
NB. The following is going to be removed: see
Note [Deprecating ambiguous fields].

When the -XDuplicateRecordFields extension is used, and the renamer
encounters a record selector or update that it cannot immediately
disambiguate (because it involves fields that belong to multiple
datatypes), it will defer resolution of the ambiguity to the
typechecker.  In this case, the `Ambiguous` constructor of
`AmbiguousFieldOcc` is used.

Consider the following definitions:

        data S = MkS { foo :: Int }
        data T = MkT { foo :: Int, bar :: Int }
        data U = MkU { bar :: Int, baz :: Int }

When the renamer sees `foo` as a selector or an update, it will not
know which parent datatype is in use.

For selectors, there are two possible ways to disambiguate:

1. Check if the pushed-in type is a function whose domain is a
   datatype, for example:

       f s = (foo :: S -&gt; Int) s

       g :: T -&gt; Int
       g = foo

    This is checked by `tcCheckRecSelId` when checking `HsRecFld foo`.

2. Check if the selector is applied to an argument that has a type
   signature, for example:

       h = foo (s :: S)

    This is checked by `tcInferRecSelId`.


Updates are slightly more complex.  The `disambiguateRecordBinds`
function tries to determine the parent datatype in three ways:

1. Check for types that have all the fields being updated. For example:

        f x = x { foo = 3, bar = 2 }

   Here `f` must be updating `T` because neither `S` nor `U` have
   both fields. This may also discover that no possible type exists.
   For example the following will be rejected:

        f' x = x { foo = 3, baz = 3 }

2. Use the type being pushed in, if it is already a TyConApp. The
   following are valid updates to `T`:

        g :: T -&gt; T
        g x = x { foo = 3 }

        g' x = x { foo = 3 } :: T

3. Use the type signature of the record expression, if it exists and
   is a TyConApp. Thus this is valid update to `T`:

        h x = (x :: T) { foo = 3 }


Note that we do not look up the types of variables being updated, and
no constraint-solving is performed, so for example the following will
be rejected as ambiguous:

     let bad (s :: S) = foo s

     let r :: T
         r = blah
     in r { foo = 3 }

     \r. (r { foo = 3 },  r :: T )

We could add further tests, of a more heuristic nature. For example,
rather than looking for an explicit signature, we could try to infer
the type of the argument to a selector or the record expression being
updated, in case we are lucky enough to get a TyConApp straight
away. However, it might be hard for programmers to predict whether a
particular update is sufficiently obvious for the signature to be
omitted. Moreover, this might change the behaviour of typechecker in
non-obvious ways.

See also Note [HsRecField and HsRecUpdField] in GHC.Hs.Pat.
-}</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-type">tcInferRecSelId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#AmbiguousFieldOcc"><span class="hs-identifier hs-type">AmbiguousFieldOcc</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-546"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-547"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span id="tcInferRecSelId"><span class="annot"><span class="annottext">tcInferRecSelId :: AmbiguousFieldOcc (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; Maybe TcSigmaType
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-var hs-var">tcInferRecSelId</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#Unambiguous"><span class="hs-identifier hs-type">Unambiguous</span></a></span><span> </span><span id="local-6989586621681387894"><span class="annot"><span class="annottext">XUnambiguous (GhcPass 'Renamed)
</span><a href="#local-6989586621681387894"><span class="hs-identifier hs-var">sel_name</span></a></span></span><span> </span><span id="local-6989586621681387893"><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387893"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681387892"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387892"><span class="hs-identifier hs-var">_args</span></a></span></span><span> </span><span id="local-6989586621681387891"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387891"><span class="hs-identifier hs-var">_mb_res_ty</span></a></span></span><span>
</span><span id="line-549"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387890"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387890"><span class="hs-identifier hs-var">sel_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; Name -&gt; TcM Id
</span><a href="GHC.Tc.Gen.Head.html#tc_rec_sel_id"><span class="hs-identifier hs-var">tc_rec_sel_id</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387893"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">XUnambiguous (GhcPass 'Renamed)
</span><a href="#local-6989586621681387894"><span class="hs-identifier hs-var">sel_name</span></a></span><span>
</span><span id="line-550"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387888"><span class="annot"><span class="annottext">expr :: HsExpr GhcTc
</span><a href="#local-6989586621681387888"><span class="hs-identifier hs-var hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. XRecFld p -&gt; AmbiguousFieldOcc p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XUnambiguous pass -&gt; LocatedN RdrName -&gt; AmbiguousFieldOcc pass
</span><a href="Language.Haskell.Syntax.Type.html#Unambiguous"><span class="hs-identifier hs-var">Unambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387890"><span class="hs-identifier hs-var">sel_id</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387893"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387888"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387890"><span class="hs-identifier hs-var">sel_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferRecSelId"><span class="hs-identifier hs-var">tcInferRecSelId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#Ambiguous"><span class="hs-identifier hs-type">Ambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">XAmbiguous (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387885"><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387885"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681387884"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387884"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387883"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387883"><span class="hs-identifier hs-var">mb_res_ty</span></a></span></span><span>
</span><span id="line-554"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387882"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387882"><span class="hs-identifier hs-var">sel_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
-&gt; [HsExprArg 'TcpRn] -&gt; Maybe TcSigmaType -&gt; TcM Name
</span><a href="GHC.Tc.Gen.Head.html#tcInferAmbiguousRecSelId"><span class="hs-identifier hs-var">tcInferAmbiguousRecSelId</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387885"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387884"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387883"><span class="hs-identifier hs-var">mb_res_ty</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387880"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387880"><span class="hs-identifier hs-var">sel_id</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; Name -&gt; TcM Id
</span><a href="GHC.Tc.Gen.Head.html#tc_rec_sel_id"><span class="hs-identifier hs-var">tc_rec_sel_id</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387885"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387882"><span class="hs-identifier hs-var">sel_name</span></a></span><span>
</span><span id="line-556"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387879"><span class="annot"><span class="annottext">expr :: HsExpr GhcTc
</span><a href="#local-6989586621681387879"><span class="hs-identifier hs-var hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. XRecFld p -&gt; AmbiguousFieldOcc p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XAmbiguous pass -&gt; LocatedN RdrName -&gt; AmbiguousFieldOcc pass
</span><a href="Language.Haskell.Syntax.Type.html#Ambiguous"><span class="hs-identifier hs-var">Ambiguous</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387880"><span class="hs-identifier hs-var">sel_id</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387885"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387879"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387880"><span class="hs-identifier hs-var">sel_id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-560"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tc_rec_sel_id"><span class="hs-identifier hs-type">tc_rec_sel_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- Like tc_infer_id, but returns an Id not a HsExpr,</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- so we can wrap it back up into a HsRecFld</span><span>
</span><span id="line-563"></span><span id="tc_rec_sel_id"><span class="annot"><span class="annottext">tc_rec_sel_id :: LocatedN RdrName -&gt; Name -&gt; TcM Id
</span><a href="GHC.Tc.Gen.Head.html#tc_rec_sel_id"><span class="hs-identifier hs-var hs-var">tc_rec_sel_id</span></a></span></span><span> </span><span id="local-6989586621681387877"><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387877"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621681387876"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387876"><span class="hs-identifier hs-var">sel_name</span></a></span></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387875"><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387875"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TcTyThing
</span><a href="GHC.Tc.Utils.Env.html#tcLookup"><span class="hs-identifier hs-var">tcLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387876"><span class="hs-identifier hs-var">sel_name</span></a></span><span>
</span><span id="line-565"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387875"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-566"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATcId"><span class="hs-identifier hs-type">ATcId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tct_id :: TcTyThing -&gt; Id
</span><a href="GHC.Tc.Types.html#tct_id"><span class="hs-identifier hs-var">tct_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387871"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387871"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-567"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var">check_naughty</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387869"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387871"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-568"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var">check_local_id</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387871"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-569"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387871"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier hs-type">AnId</span></a></span><span> </span><span id="local-6989586621681387865"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387865"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var">check_naughty</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387869"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387865"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-573"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387865"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-574"></span><span>                    </span><span class="hs-comment">-- A global cannot possibly be ill-staged</span><span>
</span><span id="line-575"></span><span>                    </span><span class="hs-comment">-- nor does it need the 'lifting' treatment</span><span>
</span><span id="line-576"></span><span>                    </span><span class="hs-comment">-- hence no checkTh stuff here</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>             </span><span class="annot"><span class="annottext">TcTyThing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-579"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387875"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;used where a value identifier was expected&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621681387869"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621681387869"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387877"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-584"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferAmbiguousRecSelId"><span class="hs-identifier hs-type">tcInferAmbiguousRecSelId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-585"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcRhoType"><span class="hs-identifier hs-type">TcRhoType</span></a></span><span>
</span><span id="line-586"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- Disgusting special case for ambiguous record selectors</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- Given a RdrName that refers to multiple record fields, and the type</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- of its argument, try to determine the name of the selector that is</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- meant.</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- See Note [Disambiguating record fields]</span><span>
</span><span id="line-592"></span><span id="tcInferAmbiguousRecSelId"><span class="annot"><span class="annottext">tcInferAmbiguousRecSelId :: LocatedN RdrName
-&gt; [HsExprArg 'TcpRn] -&gt; Maybe TcSigmaType -&gt; TcM Name
</span><a href="GHC.Tc.Gen.Head.html#tcInferAmbiguousRecSelId"><span class="hs-identifier hs-var hs-var">tcInferAmbiguousRecSelId</span></a></span></span><span> </span><span id="local-6989586621681387861"><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387861"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621681387860"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387860"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387859"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387859"><span class="hs-identifier hs-var">mb_res_ty</span></a></span></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681387858"><span class="annot"><span class="annottext">HsExprArg 'TcpRn
</span><a href="#local-6989586621681387858"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isVisibleArg"><span class="hs-identifier hs-var">isVisibleArg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387860"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-comment">-- A value arg is first</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#EValArg"><span class="hs-identifier hs-type">EValArg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eva_arg :: forall (p :: TcPass). HsExprArg p -&gt; EValArg p
</span><a href="GHC.Tc.Gen.Head.html#eva_arg"><span class="hs-identifier hs-var">eva_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Head.html#ValArg"><span class="hs-identifier hs-type">ValArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387854"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387854"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExprArg 'TcpRn
</span><a href="#local-6989586621681387858"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387853"><span class="annot"><span class="annottext">LHsSigWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681387853"><span class="hs-identifier hs-var">sig_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387854"><span class="hs-identifier hs-var">arg</span></a></span><span>  </span><span class="hs-comment">-- A type sig on the arg disambiguates</span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387852"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387852"><span class="hs-identifier hs-var">sig_tc_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; LHsSigWcType (GhcPass 'Renamed) -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Gen.HsType.html#tcHsSigWcType"><span class="hs-identifier hs-var">tcHsSigWcType</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (GhcPass 'Renamed)
</span><a href="#local-6989586621681387853"><span class="hs-identifier hs-var">sig_ty</span></a></span><span>
</span><span id="line-597"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; TcSigmaType -&gt; TcM Name
</span><a href="GHC.Tc.Gen.Head.html#finish_ambiguous_selector"><span class="hs-identifier hs-var">finish_ambiguous_selector</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387861"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387852"><span class="hs-identifier hs-var">sig_tc_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387848"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387848"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387859"><span class="hs-identifier hs-var">mb_res_ty</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387847"><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387847"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TcSigmaType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Maybe (Scaled TcSigmaType, TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTy_maybe"><span class="hs-identifier hs-var">tcSplitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387848"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName -&gt; TcSigmaType -&gt; TcM Name
</span><a href="GHC.Tc.Gen.Head.html#finish_ambiguous_selector"><span class="hs-identifier hs-var">finish_ambiguous_selector</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387861"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387847"><span class="hs-identifier hs-var">arg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. LocatedN RdrName -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#ambiguousSelector"><span class="hs-identifier hs-var">ambiguousSelector</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387861"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#finish_ambiguous_selector"><span class="hs-identifier hs-type">finish_ambiguous_selector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-607"></span><span id="finish_ambiguous_selector"><span class="annot"><span class="annottext">finish_ambiguous_selector :: LocatedN RdrName -&gt; TcSigmaType -&gt; TcM Name
</span><a href="GHC.Tc.Gen.Head.html#finish_ambiguous_selector"><span class="hs-identifier hs-var hs-var">finish_ambiguous_selector</span></a></span></span><span> </span><span id="local-6989586621681387843"><span class="annot"><span class="annottext">lr :: LocatedN RdrName
</span><a href="#local-6989586621681387843"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387842"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387842"><span class="hs-identifier hs-var">rdr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681387841"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387841"><span class="hs-identifier hs-var">parent_type</span></a></span></span><span>
</span><span id="line-608"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387840"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387840"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM FamInstEnvs
</span><a href="GHC.Tc.Instance.Family.html#tcGetFamInstEnvs"><span class="hs-identifier hs-var">tcGetFamInstEnvs</span></a></span><span>
</span><span id="line-609"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; TcSigmaType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-var">tyConOf</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387840"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387841"><span class="hs-identifier hs-var">parent_type</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-610"></span><span>          </span><span class="annot"><span class="annottext">Maybe TyCon
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. LocatedN RdrName -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#ambiguousSelector"><span class="hs-identifier hs-var">ambiguousSelector</span></a></span><span> </span><span class="annot"><span class="annottext">LocatedN RdrName
</span><a href="#local-6989586621681387843"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-611"></span><span>          </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387839"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387839"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387838"><span class="annot"><span class="annottext">[(RecSelParent, GlobalRdrElt)]
</span><a href="#local-6989586621681387838"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RdrName -&gt; RnM [(RecSelParent, GlobalRdrElt)]
</span><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier hs-var">lookupParents</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387842"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-614"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387837"><span class="annot"><span class="annottext">parent :: RecSelParent
</span><a href="#local-6989586621681387837"><span class="hs-identifier hs-var hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; RecSelParent
</span><a href="GHC.Types.Id.Info.html#RecSelData"><span class="hs-identifier hs-var">RecSelData</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387839"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-615"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="../../base-4.16.3.0/src/GHC-List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387837"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">[(RecSelParent, GlobalRdrElt)]
</span><a href="#local-6989586621681387838"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-616"></span><span>           </span><span class="annot"><span class="annottext">Maybe GlobalRdrElt
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecSelParent -&gt; RdrName -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier hs-var">fieldNotInType</span></a></span><span> </span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387837"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387842"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span>
</span><span id="line-617"></span><span>           </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387834"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387834"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-comment">-- See Note [Unused name reporting and HasField] in GHC.Tc.Instance.Class</span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GlobalRdrElt -&gt; TcM ()
</span><a href="GHC.Rename.Env.html#addUsedGRE"><span class="hs-identifier hs-var">addUsedGRE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387834"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-621"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#keepAlive"><span class="hs-identifier hs-var">keepAlive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387834"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>         </span><span class="hs-comment">-- See Note [Deprecating ambiguous fields]</span><span>
</span><span id="line-623"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; Bool -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#warnIfFlag"><span class="hs-identifier hs-var">warnIfFlag</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnAmbiguousFields"><span class="hs-identifier hs-var">Opt_WarnAmbiguousFields</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-624"></span><span>          </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The field&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387842"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>                   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;belonging to type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387841"><span class="hs-identifier hs-var">parent_type</span></a></span><span>
</span><span id="line-626"></span><span>                   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is ambiguous.&quot;</span></span><span>
</span><span id="line-627"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This will not be supported by -XDuplicateRecordFields in future releases of GHC.&quot;</span></span><span>
</span><span id="line-628"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387834"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-629"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;You can use explicit case analysis to resolve the ambiguity.&quot;</span></span><span>
</span><span id="line-630"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;You can use a qualified import or explicit case analysis to resolve the ambiguity.&quot;</span></span><span>
</span><span id="line-631"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387834"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-comment">-- This field name really is ambiguous, so add a suitable &quot;ambiguous</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- occurrence&quot; error, then give up.</span><span>
</span><span id="line-636"></span><span id="local-6989586621681388522"><span class="annot"><a href="GHC.Tc.Gen.Head.html#ambiguousSelector"><span class="hs-identifier hs-type">ambiguousSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388522"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-637"></span><span id="ambiguousSelector"><span class="annot"><span class="annottext">ambiguousSelector :: forall a. LocatedN RdrName -&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#ambiguousSelector"><span class="hs-identifier hs-var hs-var">ambiguousSelector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387826"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387826"><span class="hs-identifier hs-var">rdr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#addAmbiguousNameErr"><span class="hs-identifier hs-var">addAmbiguousNameErr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387826"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-639"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall env a. IOEnv env a
</span><a href="GHC.Data.IOEnv.html#failM"><span class="hs-identifier hs-var">failM</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- | This name really is ambiguous, so add a suitable &quot;ambiguous</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- occurrence&quot; error, then continue</span><span>
</span><span id="line-643"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#addAmbiguousNameErr"><span class="hs-identifier hs-type">addAmbiguousNameErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span id="addAmbiguousNameErr"><span class="annot"><span class="annottext">addAmbiguousNameErr :: RdrName -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#addAmbiguousNameErr"><span class="hs-identifier hs-var hs-var">addAmbiguousNameErr</span></a></span></span><span> </span><span id="local-6989586621681387824"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387824"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387823"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387823"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-646"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387821"><span class="annot"><span class="annottext">gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681387821"><span class="hs-identifier hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; GlobalRdrEnv -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_RdrName"><span class="hs-identifier hs-var">lookupGRE_RdrName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387824"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387823"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-647"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387821"><span class="hs-identifier hs-var">gres</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-648"></span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addAmbiguousNameErr: not found&quot;</span></span><span>
</span><span id="line-649"></span><span>         </span><span id="local-6989586621681387818"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387818"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681387817"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387817"><span class="hs-identifier hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [ErrCtxt] -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#setErrCtxt"><span class="hs-identifier hs-var">setErrCtxt</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; NonEmpty GlobalRdrElt -&gt; TcM ()
</span><a href="GHC.Rename.Utils.html#addNameClashErrRn"><span class="hs-identifier hs-var">addNameClashErrRn</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387824"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387818"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%3A%7C"><span class="hs-operator hs-var">NE.:|</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387817"><span class="hs-identifier hs-var">gres</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-comment">-- A type signature on the argument of an ambiguous record selector or</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- the record expression in an update must be &quot;obvious&quot;, i.e. the</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- outermost constructor ignoring parentheses.</span><span>
</span><span id="line-654"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-type">obviousSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span id="obviousSig"><span class="annot"><span class="annottext">obviousSig :: HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var hs-var">obviousSig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-type">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">XExprWithTySig (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387815"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387815"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387815"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-656"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387814"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387814"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387814"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPragE"><span class="hs-identifier hs-type">HsPragE</span></a></span><span> </span><span class="annot"><span class="annottext">XPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsPragE (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681387813"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387813"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
-&gt; Maybe (LHsSigWcType (GhcPass 'Renamed))
</span><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387813"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#obviousSig"><span class="hs-identifier hs-var">obviousSig</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- Extract the outermost TyCon of a type, if there is one; for</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- data families this is the representation tycon (because that's</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- where the fields live).</span><span>
</span><span id="line-663"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-type">tyConOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-664"></span><span id="tyConOf"><span class="annot"><span class="annottext">tyConOf :: FamInstEnvs -&gt; TcSigmaType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-var hs-var">tyConOf</span></a></span></span><span> </span><span id="local-6989586621681387812"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387812"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span id="local-6989586621681387811"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387811"><span class="hs-identifier hs-var">ty0</span></a></span></span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387809"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387808"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387808"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387807"><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387807"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a, b, c) -&gt; a
</span><a href="GHC.Utils.Misc.html#fstOf3"><span class="hs-identifier hs-var">fstOf3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamInstEnvs
-&gt; TyCon -&gt; [TcSigmaType] -&gt; (TyCon, [TcSigmaType], Coercion)
</span><a href="GHC.Tc.Instance.Family.html#tcLookupDataFamInst"><span class="hs-identifier hs-var">tcLookupDataFamInst</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387812"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387808"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387807"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TyCon, [TcSigmaType])
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387809"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387809"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Id], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitSigmaTy"><span class="hs-identifier hs-var">tcSplitSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387811"><span class="hs-identifier hs-var">ty0</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-comment">-- Variant of tyConOf that works for ExpTypes</span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier hs-type">tyConOfET</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-673"></span><span id="tyConOfET"><span class="annot"><span class="annottext">tyConOfET :: FamInstEnvs -&gt; ExpRhoType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOfET"><span class="hs-identifier hs-var hs-var">tyConOfET</span></a></span></span><span> </span><span id="local-6989586621681387804"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387804"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span></span><span> </span><span id="local-6989586621681387803"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387803"><span class="hs-identifier hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; TcSigmaType -&gt; Maybe TyCon
</span><a href="GHC.Tc.Gen.Head.html#tyConOf"><span class="hs-identifier hs-var">tyConOf</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621681387804"><span class="hs-identifier hs-var">fam_inst_envs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType -&gt; Maybe TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#checkingExpType_maybe"><span class="hs-identifier hs-var">checkingExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387803"><span class="hs-identifier hs-var">ty0</span></a></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- For an ambiguous record field, find all the candidate record</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- selectors (as GlobalRdrElts) and their parents.</span><span>
</span><span id="line-678"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier hs-type">lookupParents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-679"></span><span id="lookupParents"><span class="annot"><span class="annottext">lookupParents :: Bool -&gt; RdrName -&gt; RnM [(RecSelParent, GlobalRdrElt)]
</span><a href="GHC.Tc.Gen.Head.html#lookupParents"><span class="hs-identifier hs-var hs-var">lookupParents</span></a></span></span><span> </span><span id="local-6989586621681387800"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681387800"><span class="hs-identifier hs-var">is_selector</span></a></span></span><span> </span><span id="local-6989586621681387799"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387799"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-680"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387798"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387798"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-comment">-- Filter by isRecFldGRE because otherwise a non-selector variable with</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-comment">-- an overlapping name can get through when NoFieldSelectors is enabled.</span><span>
</span><span id="line-683"></span><span>        </span><span class="hs-comment">-- See Note [NoFieldSelectors] in GHC.Rename.Env.</span><span>
</span><span id="line-684"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387797"><span class="annot"><span class="annottext">all_gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681387797"><span class="hs-identifier hs-var hs-var">all_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; GlobalRdrEnv -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_RdrName%27"><span class="hs-identifier hs-var">lookupGRE_RdrName'</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387799"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387798"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-685"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387795"><span class="annot"><span class="annottext">gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681387795"><span class="hs-identifier hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681387800"><span class="hs-identifier hs-var">is_selector</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isFieldSelectorGRE"><span class="hs-identifier hs-var">isFieldSelectorGRE</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387797"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-686"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387797"><span class="hs-identifier hs-var">all_gres</span></a></span><span>
</span><span id="line-687"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.3.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; RnM (RecSelParent, GlobalRdrElt)
</span><a href="#local-6989586621681387791"><span class="hs-identifier hs-var">lookupParent</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681387795"><span class="hs-identifier hs-var">gres</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-689"></span><span>    </span><span class="annot"><a href="#local-6989586621681387791"><span class="hs-identifier hs-type">lookupParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621681387791"><span class="annot"><span class="annottext">lookupParent :: GlobalRdrElt -&gt; RnM (RecSelParent, GlobalRdrElt)
</span><a href="#local-6989586621681387791"><span class="hs-identifier hs-var hs-var">lookupParent</span></a></span></span><span> </span><span id="local-6989586621681387790"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387790"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387789"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387789"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Id
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387790"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>                          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe RecSelParent
</span><a href="GHC.Types.Id.html#recordSelectorTyCon_maybe"><span class="hs-identifier hs-var">recordSelectorTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387789"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-692"></span><span>                              </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387786"><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387786"><span class="hs-identifier hs-var">rstc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387786"><span class="hs-identifier hs-var">rstc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387790"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>                              </span><span class="annot"><span class="annottext">Maybe RecSelParent
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-var">notSelector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387790"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier hs-type">fieldNotInType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Id.Info.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-697"></span><span id="fieldNotInType"><span class="annot"><span class="annottext">fieldNotInType :: RecSelParent -&gt; RdrName -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#fieldNotInType"><span class="hs-identifier hs-var hs-var">fieldNotInType</span></a></span></span><span> </span><span id="local-6989586621681387785"><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387785"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681387784"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387784"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; RdrName -&gt; SDoc
</span><a href="GHC.Rename.Utils.html#unknownSubordinateErr"><span class="hs-identifier hs-var">unknownSubordinateErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;field of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RecSelParent
</span><a href="#local-6989586621681387785"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681387784"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-type">notSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-701"></span><span id="notSelector"><span class="annot"><span class="annottext">notSelector :: Name -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#notSelector"><span class="hs-identifier hs-var hs-var">notSelector</span></a></span></span><span> </span><span id="local-6989586621681387783"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387783"><span class="hs-identifier hs-var">field</span></a></span></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387783"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a record selector&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#naughtyRecordSel"><span class="hs-identifier hs-type">naughtyRecordSel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-705"></span><span id="naughtyRecordSel"><span class="annot"><span class="annottext">naughtyRecordSel :: OccName -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#naughtyRecordSel"><span class="hs-identifier hs-var hs-var">naughtyRecordSel</span></a></span></span><span> </span><span id="local-6989586621681387780"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387780"><span class="hs-identifier hs-var">lbl</span></a></span></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot use record selector&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387780"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;as a function due to escaped type variables&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Probable fix: use pattern-matching syntax instead&quot;</span></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                Expressions with a type signature
                        expr :: type
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-type">tcExprWithSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#NoGhcTc"><span class="hs-identifier hs-type">NoGhcTc</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span id="tcExprWithSig"><span class="annot"><span class="annottext">tcExprWithSig :: LHsExpr (GhcPass 'Renamed)
-&gt; LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
-&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprWithSig"><span class="hs-identifier hs-var hs-var">tcExprWithSig</span></a></span></span><span> </span><span id="local-6989586621681387778"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387778"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681387777"><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387777"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387776"><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681387776"><span class="hs-identifier hs-var">sig_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r. TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Monad.html#checkNoErrs"><span class="hs-identifier hs-var">checkNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>  </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><span id="line-722"></span><span>                     </span><span class="annot"><span class="annottext">SrcSpan
-&gt; LHsSigWcType (GhcPass 'Renamed) -&gt; Maybe Name -&gt; TcM TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier hs-var">tcUserTypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681387774"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387777"><span class="hs-identifier hs-var">hs_ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-723"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387773"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387773"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387772"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387772"><span class="hs-identifier hs-var">poly_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
-&gt; TcIdSigInfo -&gt; TcM (LHsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var">tcExprSig</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387778"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681387776"><span class="hs-identifier hs-var">sig_info</span></a></span><span>
</span><span id="line-724"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p.
XExprWithTySig p
-&gt; LHsExpr p -&gt; LHsSigWcType (NoGhcTc p) -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#ExprWithTySig"><span class="hs-identifier hs-var">ExprWithTySig</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387773"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387777"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387772"><span class="hs-identifier hs-var">poly_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-725"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-726"></span><span>    </span><span id="local-6989586621681387774"><span class="annot"><span class="annottext">loc :: SrcSpan
</span><a href="#local-6989586621681387774"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a e. GenLocated (SrcSpanAnn' a) e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. LHsSigWcType pass -&gt; LHsSigType pass
</span><a href="GHC.Hs.Type.html#dropWildCards"><span class="hs-identifier hs-var">dropWildCards</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType (NoGhcTc (GhcPass 'Renamed))
</span><a href="#local-6989586621681387777"><span class="hs-identifier hs-var">hs_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-type">tcExprSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span id="tcExprSig"><span class="annot"><span class="annottext">tcExprSig :: LHsExpr (GhcPass 'Renamed)
-&gt; TcIdSigInfo -&gt; TcM (LHsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var hs-var">tcExprSig</span></a></span></span><span> </span><span id="local-6989586621681387767"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387767"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcIdSigInfo -&gt; Id
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387764"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387764"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387762"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681387762"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681387762"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>   </span><span class="hs-comment">-- Sets the location for the implication constraint</span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387761"><span class="annot"><span class="annottext">poly_ty :: TcSigmaType
</span><a href="#local-6989586621681387761"><span class="hs-identifier hs-var hs-var">poly_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387764"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-732"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387760"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387760"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387759"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387759"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall result.
UserTypeCtxt
-&gt; TcSigmaType
-&gt; (TcSigmaType -&gt; TcM result)
-&gt; TcM (HsWrapper, result)
</span><a href="GHC.Tc.Utils.Unify.html#tcSkolemiseScoped"><span class="hs-identifier hs-var">tcSkolemiseScoped</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387761"><span class="hs-identifier hs-var">poly_ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681387757"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387757"><span class="hs-identifier hs-var">rho_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-733"></span><span>                          </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed) -&gt; TcSigmaType -&gt; TcM (LHsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcCheckMonoExprNC"><span class="hs-identifier hs-var">tcCheckMonoExprNC</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387767"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387757"><span class="hs-identifier hs-var">rho_ty</span></a></span><span>
</span><span id="line-734"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387760"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387759"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387761"><span class="hs-identifier hs-var">poly_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcExprSig"><span class="hs-identifier hs-var">tcExprSig</span></a></span><span> </span><span id="local-6989586621681387755"><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387755"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621681387754"><span class="annot"><span class="annottext">sig :: TcIdSigInfo
</span><a href="#local-6989586621681387754"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#PartialSig"><span class="hs-identifier hs-type">PartialSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psig_name :: TcIdSigInfo -&gt; Name
</span><a href="GHC.Tc.Types.html#psig_name"><span class="hs-identifier hs-var">psig_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387751"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387751"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387750"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681387750"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681387750"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>   </span><span class="hs-comment">-- Sets the location for the implication constraint</span><span>
</span><span id="line-738"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387749"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681387749"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387748"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621681387748"><span class="hs-identifier hs-var">wanted</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387747"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387747"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387746"><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. TcM a -&gt; TcM (TcLevel, WantedConstraints, a)
</span><a href="GHC.Tc.Utils.Monad.html#pushLevelAndCaptureConstraints"><span class="hs-identifier hs-var">pushLevelAndCaptureConstraints</span></a></span><span>  </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-740"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387744"><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387744"><span class="hs-identifier hs-var">sig_inst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo -&gt; TcM TcIdSigInst
</span><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier hs-var">tcInstSig</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681387754"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-741"></span><span>                   </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387743"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387743"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r. [(Name, Id)] -&gt; TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Env.html#tcExtendNameTyVarEnv"><span class="hs-identifier hs-var">tcExtendNameTyVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; [(a, b)] -&gt; [(a, c)]
</span><a href="GHC.Utils.Misc.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall tv argf. VarBndr tv argf -&gt; tv
</span><a href="GHC.Types.Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [(Name, InvisTVBinder)]
</span><a href="GHC.Tc.Types.html#sig_inst_skols"><span class="hs-identifier hs-var">sig_inst_skols</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387744"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-742"></span><span>                              </span><span class="annot"><span class="annottext">forall r. [(Name, Id)] -&gt; TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Env.html#tcExtendNameTyVarEnv"><span class="hs-identifier hs-var">tcExtendNameTyVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [(Name, Id)]
</span><a href="GHC.Tc.Types.html#sig_inst_wcs"><span class="hs-identifier hs-var">sig_inst_wcs</span></a></span><span>   </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387744"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-743"></span><span>                              </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed) -&gt; TcSigmaType -&gt; TcM (LHsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Expr.html#tcCheckPolyExprNC"><span class="hs-identifier hs-var">tcCheckPolyExprNC</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387755"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387744"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>                   </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387743"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387744"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-745"></span><span>       </span><span class="hs-comment">-- See Note [Partial expression signatures]</span><span>
</span><span id="line-746"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387736"><span class="annot"><span class="annottext">tau :: TcSigmaType
</span><a href="#local-6989586621681387736"><span class="hs-identifier hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcIdSigInst -&gt; TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span><span>
</span><span id="line-747"></span><span>             </span><span id="local-6989586621681387735"><span class="annot"><span class="annottext">infer_mode :: InferMode
</span><a href="#local-6989586621681387735"><span class="hs-identifier hs-var hs-var">infer_mode</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; [TcSigmaType]
</span><a href="GHC.Tc.Types.html#sig_inst_theta"><span class="hs-identifier hs-var">sig_inst_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcIdSigInst -&gt; Maybe TcSigmaType
</span><a href="GHC.Tc.Types.html#sig_inst_wcx"><span class="hs-identifier hs-var">sig_inst_wcx</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="GHC.Tc.Solver.html#ApplyMR"><span class="hs-identifier hs-var">ApplyMR</span></a></span><span>
</span><span id="line-750"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-751"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="GHC.Tc.Solver.html#NoRestrictions"><span class="hs-identifier hs-var">NoRestrictions</span></a></span><span>
</span><span id="line-752"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387729"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387729"><span class="hs-identifier hs-var">qtvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387728"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387728"><span class="hs-identifier hs-var">givens</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387727"><span class="annot"><span class="annottext">TcEvBinds
</span><a href="#local-6989586621681387727"><span class="hs-identifier hs-var">ev_binds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcLevel
-&gt; InferMode
-&gt; [TcIdSigInst]
-&gt; [(Name, TcSigmaType)]
-&gt; WantedConstraints
-&gt; TcM ([Id], [Id], TcEvBinds, Bool)
</span><a href="GHC.Tc.Solver.html#simplifyInfer"><span class="hs-identifier hs-var">simplifyInfer</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681387749"><span class="hs-identifier hs-var">tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">InferMode
</span><a href="#local-6989586621681387735"><span class="hs-identifier hs-var">infer_mode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387751"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387736"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621681387748"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387726"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387726"><span class="hs-identifier hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387736"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-756"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387724"><span class="annot"><span class="annottext">inferred_theta :: [TcSigmaType]
</span><a href="#local-6989586621681387724"><span class="hs-identifier hs-var hs-var">inferred_theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387728"><span class="hs-identifier hs-var">givens</span></a></span><span>
</span><span id="line-757"></span><span>             </span><span id="local-6989586621681387722"><span class="annot"><span class="annottext">tau_tvs :: TyCoVarSet
</span><a href="#local-6989586621681387722"><span class="hs-identifier hs-var hs-var">tau_tvs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TyCoVarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387726"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-758"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387720"><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387720"><span class="hs-identifier hs-var">binders</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387719"><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387719"><span class="hs-identifier hs-var">my_theta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
-&gt; TyCoVarSet
-&gt; [Id]
-&gt; Maybe TcIdSigInst
-&gt; TcM ([InvisTVBinder], [TcSigmaType])
</span><a href="GHC.Tc.Gen.Bind.html#chooseInferredQuantifiers"><span class="hs-identifier hs-var">chooseInferredQuantifiers</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387724"><span class="hs-identifier hs-var">inferred_theta</span></a></span><span>
</span><span id="line-759"></span><span>                                   </span><span class="annot"><span class="annottext">TyCoVarSet
</span><a href="#local-6989586621681387722"><span class="hs-identifier hs-var">tau_tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387729"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681387746"><span class="hs-identifier hs-var">sig_inst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387718"><span class="annot"><span class="annottext">inferred_sigma :: TcSigmaType
</span><a href="#local-6989586621681387718"><span class="hs-identifier hs-var hs-var">inferred_sigma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#mkInfSigmaTy"><span class="hs-identifier hs-var">mkInfSigmaTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387729"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387724"><span class="hs-identifier hs-var">inferred_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387726"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-761"></span><span>             </span><span id="local-6989586621681387716"><span class="annot"><span class="annottext">my_sigma :: TcSigmaType
</span><a href="#local-6989586621681387716"><span class="hs-identifier hs-var hs-var">my_sigma</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387720"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span>  </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387719"><span class="hs-identifier hs-var">my_theta</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387726"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387713"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387713"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387718"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcSigmaType -&gt; Bool
</span><a href="GHC.Core.Type.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387716"><span class="hs-identifier hs-var">my_sigma</span></a></span><span> </span><span class="hs-comment">-- NB: eqType ignores vis.</span><span>
</span><span id="line-763"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a></span><span>  </span><span class="hs-comment">-- Fast path; also avoids complaint when we infer</span><span>
</span><span id="line-764"></span><span>                                          </span><span class="hs-comment">-- an ambiguous type and have AllowAmbiguousType</span><span>
</span><span id="line-765"></span><span>                                          </span><span class="hs-comment">-- e..g infer  x :: forall a. F a -&gt; Int</span><span>
</span><span id="line-766"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CtOrigin
-&gt; UserTypeCtxt -&gt; TcSigmaType -&gt; TcSigmaType -&gt; TcM HsWrapper
</span><a href="GHC.Tc.Utils.Unify.html#tcSubTypeSigma"><span class="hs-identifier hs-var">tcSubTypeSigma</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#ExprSigOrigin"><span class="hs-identifier hs-var">ExprSigOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387718"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387716"><span class="hs-identifier hs-var">my_sigma</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcExpSig&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387729"><span class="hs-identifier hs-var">qtvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387728"><span class="hs-identifier hs-var">givens</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387718"><span class="hs-identifier hs-var">inferred_sigma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387716"><span class="hs-identifier hs-var">my_sigma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387707"><span class="annot"><span class="annottext">poly_wrap :: HsWrapper
</span><a href="#local-6989586621681387707"><span class="hs-identifier hs-var hs-var">poly_wrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387713"><span class="hs-identifier hs-var">wrap</span></a></span><span>
</span><span id="line-770"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387729"><span class="hs-identifier hs-var">qtvs</span></a></span><span>
</span><span id="line-771"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpLams"><span class="hs-identifier hs-var">mkWpLams</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387728"><span class="hs-identifier hs-var">givens</span></a></span><span>
</span><span id="line-772"></span><span>                         </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TcEvBinds -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a></span><span>  </span><span class="annot"><span class="annottext">TcEvBinds
</span><a href="#local-6989586621681387727"><span class="hs-identifier hs-var">ev_binds</span></a></span><span>
</span><span id="line-773"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387707"><span class="hs-identifier hs-var">poly_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387747"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387716"><span class="hs-identifier hs-var">my_sigma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span class="hs-comment">{- Note [Partial expression signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Partial type signatures on expressions are easy to get wrong.  But
here is a guiding principile
    e :: ty
should behave like
    let x :: ty
        x = e
    in x

So for partial signatures we apply the MR if no context is given.  So
   e :: IO _          apply the MR
   e :: _ =&gt; IO _     do not apply the MR
just like in GHC.Tc.Gen.Bind.decideGeneralisationPlan

This makes a difference (#11670):
   peek :: Ptr a -&gt; IO CLong
   peek ptr = peekElemOff undefined 0 :: _
from (peekElemOff undefined 0) we get
          type: IO w
   constraints: Storable w

We must NOT try to generalise over 'w' because the signature specifies
no constraints so we'll complain about not being able to solve
Storable w.  Instead, don't generalise; then _ gets instantiated to
CLong, as it should.
-}</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 Overloaded literals
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-type">tcInferOverLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span id="tcInferOverLit"><span class="annot"><span class="annottext">tcInferOverLit :: HsOverLit (GhcPass 'Renamed) -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-var hs-var">tcInferOverLit</span></a></span></span><span> </span><span id="local-6989586621681387702"><span class="annot"><span class="annottext">lit :: HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387702"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_val :: forall p. HsOverLit p -&gt; OverLitVal
</span><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387699"><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621681387699"><span class="hs-identifier hs-var">val</span></a></span></span><span>
</span><span id="line-813"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_witness :: forall p. HsOverLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Lit.html#ol_witness"><span class="hs-identifier hs-var">ol_witness</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-type">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">XVar (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681387697"><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621681387697"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681387696"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387696"><span class="hs-identifier hs-var">from_name</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_ext :: forall p. HsOverLit p -&gt; XOverLit p
</span><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387694"><span class="annot"><span class="annottext">XOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387694"><span class="hs-identifier hs-var">rebindable</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Desugar &quot;3&quot; to (fromInteger (3 :: Integer))</span><span>
</span><span id="line-816"></span><span>    </span><span class="hs-comment">--   where fromInteger is gotten by looking up from_name, and</span><span>
</span><span id="line-817"></span><span>    </span><span class="hs-comment">--   the (3 :: Integer) is returned by mkOverLit</span><span>
</span><span id="line-818"></span><span>    </span><span class="hs-comment">-- Ditto the string literal &quot;foo&quot; to (fromString (&quot;foo&quot; :: String))</span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387693"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387693"><span class="hs-identifier hs-var">from_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Id
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387696"><span class="hs-identifier hs-var">from_name</span></a></span><span>
</span><span id="line-820"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387692"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387692"><span class="hs-identifier hs-var">wrap1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387691"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387691"><span class="hs-identifier hs-var">from_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; TcSigmaType -&gt; TcM (HsWrapper, TcSigmaType)
</span><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier hs-var">topInstantiate</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621681387689"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387693"><span class="hs-identifier hs-var">from_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387688"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387688"><span class="hs-identifier hs-var">wrap2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387687"><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387687"><span class="hs-identifier hs-var">sarg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387686"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387686"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SDoc
-&gt; Maybe SDoc
-&gt; (ThLevel, [Scaled TcSigmaType])
-&gt; TcSigmaType
-&gt; TcM (HsWrapper, Scaled TcSigmaType, TcSigmaType)
</span><a href="GHC.Tc.Utils.Unify.html#matchActualFunTySigma"><span class="hs-identifier hs-var">matchActualFunTySigma</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681387684"><span class="hs-identifier hs-var">herald</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SDoc
</span><a href="#local-6989586621681387683"><span class="hs-identifier hs-var">mb_doc</span></a></span><span>
</span><span id="line-823"></span><span>                                                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387691"><span class="hs-identifier hs-var">from_ty</span></a></span><span>
</span><span id="line-824"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387682"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621681387682"><span class="hs-identifier hs-var">hs_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OverLitVal -&gt; TcM (HsLit GhcTc)
</span><a href="GHC.Tc.Utils.Instantiate.html#mkOverLit"><span class="hs-identifier hs-var">mkOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621681387699"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-825"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387680"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681387680"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe SDoc -&gt; TcSigmaType -&gt; TcSigmaType -&gt; TcM Coercion
</span><a href="GHC.Tc.Utils.Unify.html#unifyType"><span class="hs-identifier hs-var">unifyType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SDoc
</span><a href="#local-6989586621681387683"><span class="hs-identifier hs-var">mb_doc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass). HsLit (GhcPass p) -&gt; TcSigmaType
</span><a href="GHC.Tc.Utils.Zonk.html#hsLitType"><span class="hs-identifier hs-var">hsLitType</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621681387682"><span class="hs-identifier hs-var">hs_lit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387687"><span class="hs-identifier hs-var">sarg_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387678"><span class="annot"><span class="annottext">lit_expr :: GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387678"><span class="hs-identifier hs-var hs-var">lit_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621681387697"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrapCo"><span class="hs-identifier hs-var">mkHsWrapCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681387680"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-828"></span><span>                        </span><span class="annot"><span class="annottext">forall p. XLitE p -&gt; HsLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621681387682"><span class="hs-identifier hs-var">hs_lit</span></a></span><span>
</span><span id="line-829"></span><span>             </span><span id="local-6989586621681387674"><span class="annot"><span class="annottext">from_expr :: HsExpr GhcTc
</span><a href="#local-6989586621681387674"><span class="hs-identifier hs-var hs-var">from_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387688"><span class="hs-identifier hs-var">wrap2</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387692"><span class="hs-identifier hs-var">wrap1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-830"></span><span>                         </span><span class="annot"><span class="annottext">forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621681387697"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387693"><span class="hs-identifier hs-var">from_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>             </span><span id="local-6989586621681387673"><span class="annot"><span class="annottext">lit' :: HsOverLit GhcTc
</span><a href="#local-6989586621681387673"><span class="hs-identifier hs-var hs-var">lit'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387702"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_witness :: HsExpr GhcTc
</span><a href="Language.Haskell.Syntax.Lit.html#ol_witness"><span class="hs-identifier hs-var">ol_witness</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. XApp p -&gt; LHsExpr p -&gt; LHsExpr p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcAnn NameAnn
</span><a href="#local-6989586621681387697"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387674"><span class="hs-identifier hs-var">from_expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcTc)
</span><a href="#local-6989586621681387678"><span class="hs-identifier hs-var">lit_expr</span></a></span><span>
</span><span id="line-832"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_ext :: XOverLit GhcTc
</span><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TcSigmaType -&gt; OverLitTc
</span><a href="GHC.Hs.Lit.html#OverLitTc"><span class="hs-identifier hs-var">OverLitTc</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387694"><span class="hs-identifier hs-var">rebindable</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387686"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-833"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XOverLitE p -&gt; HsOverLit p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621681387673"><span class="hs-identifier hs-var">lit'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387686"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-834"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-835"></span><span>    </span><span id="local-6989586621681387689"><span class="annot"><span class="annottext">orig :: CtOrigin
</span><a href="#local-6989586621681387689"><span class="hs-identifier hs-var hs-var">orig</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed) -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#LiteralOrigin"><span class="hs-identifier hs-var">LiteralOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387702"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span id="local-6989586621681387683"><span class="annot"><span class="annottext">mb_doc :: Maybe SDoc
</span><a href="#local-6989586621681387683"><span class="hs-identifier hs-var hs-var">mb_doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387696"><span class="hs-identifier hs-var">from_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>    </span><span id="local-6989586621681387684"><span class="annot"><span class="annottext">herald :: SDoc
</span><a href="#local-6989586621681387684"><span class="hs-identifier hs-var hs-var">herald</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The function&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387696"><span class="hs-identifier hs-var">from_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is applied to&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferOverLit"><span class="hs-identifier hs-var">tcInferOverLit</span></a></span><span> </span><span id="local-6989586621681387669"><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387669"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcInferOverLit&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit (GhcPass 'Renamed)
</span><a href="#local-6989586621681387669"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                 tcInferId, tcCheckId
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier hs-type">tcCheckId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span id="tcCheckId"><span class="annot"><span class="annottext">tcCheckId :: Name -&gt; ExpRhoType -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Gen.Head.html#tcCheckId"><span class="hs-identifier hs-var hs-var">tcCheckId</span></a></span></span><span> </span><span id="local-6989586621681387667"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387667"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681387666"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387666"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387665"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387665"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387664"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387664"><span class="hs-identifier hs-var">actual_res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var">tcInferId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387667"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-853"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcCheckId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387667"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387664"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387666"><span class="hs-identifier hs-var">res_ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a.
HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM a
-&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-var">addFunResCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387663"><span class="hs-identifier hs-var">rn_fun</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387664"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387666"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-855"></span><span>         </span><span class="annot"><span class="annottext">CtOrigin
-&gt; HsExpr (GhcPass 'Renamed)
-&gt; HsExpr GhcTc
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Utils.Unify.html#tcWrapResultO"><span class="hs-identifier hs-var">tcWrapResultO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387667"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387663"><span class="hs-identifier hs-var">rn_fun</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387665"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387664"><span class="hs-identifier hs-var">actual_res_ty</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387666"><span class="hs-identifier hs-var">res_ty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-857"></span><span>    </span><span id="local-6989586621681387663"><span class="annot"><span class="annottext">rn_fun :: HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387663"><span class="hs-identifier hs-var hs-var">rn_fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387667"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="hs-comment">------------------------</span><span>
</span><span id="line-860"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-type">tcInferId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- Look up an occurrence of an Id</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- Do not instantiate its type</span><span>
</span><span id="line-863"></span><span id="tcInferId"><span class="annot"><span class="annottext">tcInferId :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tcInferId"><span class="hs-identifier hs-var hs-var">tcInferId</span></a></span></span><span> </span><span id="local-6989586621681387659"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span></span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#assertIdKey"><span class="hs-identifier hs-var">assertIdKey</span></a></span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387656"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681387656"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-866"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_IgnoreAsserts"><span class="hs-identifier hs-var">Opt_IgnoreAsserts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681387656"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-867"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var">tc_infer_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-868"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-var">tc_infer_assert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387650"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387650"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387649"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387649"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var">tc_infer_id</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-872"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcInferId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387659"><span class="hs-identifier hs-var">id_name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387649"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387650"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387649"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-type">tc_infer_assert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- Deal with an occurrence of 'assert'</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- See Note [Adding the implicit parameter to 'assert']</span><span>
</span><span id="line-878"></span><span id="tc_infer_assert"><span class="annot"><span class="annottext">tc_infer_assert :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_assert"><span class="hs-identifier hs-var hs-var">tc_infer_assert</span></a></span></span><span> </span><span id="local-6989586621681387648"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387648"><span class="hs-identifier hs-var">assert_name</span></a></span></span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387647"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387647"><span class="hs-identifier hs-var">assert_error_id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Id
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#assertErrorName"><span class="hs-identifier hs-var">assertErrorName</span></a></span><span>
</span><span id="line-880"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387645"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387645"><span class="hs-identifier hs-var">wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387644"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387644"><span class="hs-identifier hs-var">id_rho</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; TcSigmaType -&gt; TcM (HsWrapper, TcSigmaType)
</span><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier hs-var">topInstantiate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387648"><span class="hs-identifier hs-var">assert_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387647"><span class="hs-identifier hs-var">assert_error_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387645"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387647"><span class="hs-identifier hs-var">assert_error_id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387644"><span class="hs-identifier hs-var">id_rho</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-883"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-type">tc_infer_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span id="tc_infer_id"><span class="annot"><span class="annottext">tc_infer_id :: Name -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.Gen.Head.html#tc_infer_id"><span class="hs-identifier hs-var hs-var">tc_infer_id</span></a></span></span><span> </span><span id="local-6989586621681387643"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387643"><span class="hs-identifier hs-var">id_name</span></a></span></span><span>
</span><span id="line-887"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387642"><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387642"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TcTyThing
</span><a href="GHC.Tc.Utils.Env.html#tcLookup"><span class="hs-identifier hs-var">tcLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387643"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-888"></span><span>      </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387641"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387641"><span class="hs-identifier hs-var">global_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn GlobalRdrEnv
</span><a href="GHC.Tc.Utils.Monad.html#getGlobalRdrEnv"><span class="hs-identifier hs-var">getGlobalRdrEnv</span></a></span><span>
</span><span id="line-889"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387642"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-890"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATcId"><span class="hs-identifier hs-type">ATcId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tct_id :: TcTyThing -&gt; Id
</span><a href="GHC.Tc.Types.html#tct_id"><span class="hs-identifier hs-var">tct_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681387640"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387640"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-891"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var">check_local_id</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387640"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-892"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall {p} {an} {m :: * -&gt; *}.
(XVar p ~ NoExtField, XRec p (IdP p) ~ GenLocated (SrcAnn an) Id,
 Monad m) =&gt;
Id -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621681387639"><span class="hs-identifier hs-var">return_id</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387640"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AnId"><span class="hs-identifier hs-type">AnId</span></a></span><span> </span><span id="local-6989586621681387638"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387638"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {p} {an} {m :: * -&gt; *}.
(XVar p ~ NoExtField, XRec p (IdP p) ~ GenLocated (SrcAnn an) Id,
 Monad m) =&gt;
Id -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621681387639"><span class="hs-identifier hs-var">return_id</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387638"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-896"></span><span>               </span><span class="hs-comment">-- A global cannot possibly be ill-staged</span><span>
</span><span id="line-897"></span><span>               </span><span class="hs-comment">-- nor does it need the 'lifting' treatment</span><span>
</span><span id="line-898"></span><span>               </span><span class="hs-comment">-- Hence no checkTh stuff here</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#AConLike"><span class="hs-identifier hs-type">AConLike</span></a></span><span> </span><span id="local-6989586621681387636"><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621681387636"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConLike
</span><a href="#local-6989586621681387636"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-901"></span><span>                 </span><span class="annot"><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-type">RealDataCon</span></a></span><span> </span><span id="local-6989586621681387634"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387634"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621681387633"><span class="hs-identifier hs-var">return_data_con</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387634"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-902"></span><span>                 </span><span class="annot"><a href="GHC.Core.ConLike.html#PatSynCon"><span class="hs-identifier hs-type">PatSynCon</span></a></span><span> </span><span id="local-6989586621681387631"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621681387631"><span class="hs-identifier hs-var">ps</span></a></span></span><span>
</span><span id="line-903"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387630"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387630"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387629"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387629"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; Maybe (HsExpr GhcTc, TcSigmaType)
</span><a href="GHC.Tc.TyCl.PatSyn.html#patSynBuilderOcc"><span class="hs-identifier hs-var">patSynBuilderOcc</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621681387631"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-904"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387630"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387629"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-906"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-var">nonBidirectionalErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387643"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#AGlobal"><span class="hs-identifier hs-type">AGlobal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.TyThing.html#ATyCon"><span class="hs-identifier hs-type">ATyCon</span></a></span><span> </span><span id="local-6989586621681387627"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387627"><span class="hs-identifier hs-var">ty_con</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a}. GlobalRdrEnv -&gt; TyCon -&gt; TcM a
</span><a href="#local-6989586621681387626"><span class="hs-identifier hs-var">fail_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387641"><span class="hs-identifier hs-var">global_env</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387627"><span class="hs-identifier hs-var">ty_con</span></a></span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATyVar"><span class="hs-identifier hs-type">ATyVar</span></a></span><span> </span><span id="local-6989586621681387624"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387624"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-912"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-913"></span><span>                     </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal term-level use of the type variable&quot;</span></span><span>
</span><span id="line-914"></span><span>                       </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387624"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>                       </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bound at&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#getSrcLoc"><span class="hs-identifier hs-var">getSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387624"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span>             </span><span class="annot"><a href="GHC.Tc.Types.html#ATcTyCon"><span class="hs-identifier hs-type">ATcTyCon</span></a></span><span> </span><span id="local-6989586621681387620"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387620"><span class="hs-identifier hs-var">ty_con</span></a></span></span><span>
</span><span id="line-918"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a}. GlobalRdrEnv -&gt; TyCon -&gt; TcM a
</span><a href="#local-6989586621681387626"><span class="hs-identifier hs-var">fail_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387641"><span class="hs-identifier hs-var">global_env</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387620"><span class="hs-identifier hs-var">ty_con</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span>             </span><span class="annot"><span class="annottext">TcTyThing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-921"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcTyThing
</span><a href="#local-6989586621681387642"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;used where a value identifier was expected&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-923"></span><span>    </span><span id="local-6989586621681387626"><span class="annot"><span class="annottext">fail_tycon :: GlobalRdrEnv -&gt; TyCon -&gt; TcM a
</span><a href="#local-6989586621681387626"><span class="hs-identifier hs-var hs-var">fail_tycon</span></a></span></span><span> </span><span id="local-6989586621681387619"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387619"><span class="hs-identifier hs-var">global_env</span></a></span></span><span> </span><span id="local-6989586621681387618"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387618"><span class="hs-identifier hs-var">ty_con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-924"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387617"><span class="annot"><span class="annottext">pprov :: SDoc
</span><a href="#local-6989586621681387617"><span class="hs-identifier hs-var hs-var">pprov</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; Name -&gt; Maybe GlobalRdrElt
</span><a href="GHC.Types.Name.Reader.html#lookupGRE_Name"><span class="hs-identifier hs-var">lookupGRE_Name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681387619"><span class="hs-identifier hs-var">global_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387618"><span class="hs-identifier hs-var">ty_con</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-925"></span><span>            </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387614"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387614"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; SDoc
</span><a href="GHC.Types.Name.Reader.html#pprNameProvenance"><span class="hs-identifier hs-var">pprNameProvenance</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681387614"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>            </span><span class="annot"><span class="annottext">Maybe GlobalRdrElt
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-927"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; SDoc
</span><a href="#local-6989586621681387611"><span class="hs-identifier hs-var">term_level_tycons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387618"><span class="hs-identifier hs-var">ty_con</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681387617"><span class="hs-identifier hs-var">pprov</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621681387611"><span class="annot"><span class="annottext">term_level_tycons :: TyCon -&gt; SDoc
</span><a href="#local-6989586621681387611"><span class="hs-identifier hs-var hs-var">term_level_tycons</span></a></span></span><span> </span><span id="local-6989586621681387609"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387609"><span class="hs-identifier hs-var">ty_con</span></a></span></span><span>
</span><span id="line-930"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal term-level use of the type constructor&quot;</span></span><span>
</span><span id="line-931"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387609"><span class="hs-identifier hs-var">ty_con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span>    </span><span id="local-6989586621681387639"><span class="annot"><span class="annottext">return_id :: Id -&gt; m (HsExpr p, TcSigmaType)
</span><a href="#local-6989586621681387639"><span class="hs-identifier hs-var hs-var">return_id</span></a></span></span><span> </span><span id="local-6989586621681387602"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387602"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387602"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387602"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621681387633"><span class="annot"><span class="annottext">return_data_con :: DataCon -&gt; TcM (HsExpr GhcTc, TcSigmaType)
</span><a href="#local-6989586621681387633"><span class="hs-identifier hs-var hs-var">return_data_con</span></a></span></span><span> </span><span id="local-6989586621681387601"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span></span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387600"><span class="annot"><span class="annottext">tvs :: [InvisTVBinder]
</span><a href="#local-6989586621681387600"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [InvisTVBinder]
</span><a href="GHC.Core.DataCon.html#dataConUserTyVarBinders"><span class="hs-identifier hs-var">dataConUserTyVarBinders</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-937"></span><span>                 </span><span id="local-6989586621681387598"><span class="annot"><span class="annottext">theta :: [TcSigmaType]
</span><a href="#local-6989586621681387598"><span class="hs-identifier hs-var hs-var">theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConOtherTheta"><span class="hs-identifier hs-var">dataConOtherTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-938"></span><span>                 </span><span id="local-6989586621681387596"><span class="annot"><span class="annottext">args :: [Scaled TcSigmaType]
</span><a href="#local-6989586621681387596"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [Scaled TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConOrigArgTys"><span class="hs-identifier hs-var">dataConOrigArgTys</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-939"></span><span>                 </span><span id="local-6989586621681387594"><span class="annot"><span class="annottext">res :: TcSigmaType
</span><a href="#local-6989586621681387594"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; TcSigmaType
</span><a href="GHC.Core.DataCon.html#dataConOrigResTy"><span class="hs-identifier hs-var">dataConOrigResTy</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>           </span><span class="hs-comment">-- See Note [Linear fields generalization]</span><span>
</span><span id="line-942"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387592"><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387592"><span class="hs-identifier hs-var">mul_vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ThLevel -&gt; TcSigmaType -&gt; TcM [TcSigmaType]
</span><a href="GHC.Tc.Utils.TcMType.html#newFlexiTyVarTys"><span class="hs-identifier hs-var">newFlexiTyVarTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387596"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Builtin.Types.html#multiplicityTy"><span class="hs-identifier hs-var">multiplicityTy</span></a></span><span>
</span><span id="line-943"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387589"><span class="annot"><span class="annottext">scaleArgs :: [Scaled TcSigmaType] -&gt; [Scaled TcSigmaType]
</span><a href="#local-6989586621681387589"><span class="hs-identifier hs-var hs-var">scaleArgs</span></a></span></span><span> </span><span id="local-6989586621681387588"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387588"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. String -&gt; (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="GHC.Utils.Misc.html#zipWithEqual"><span class="hs-identifier hs-var">zipWithEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_data_con&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. TcSigmaType -&gt; Scaled a -&gt; Scaled a
</span><a href="#local-6989586621681387586"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387592"><span class="hs-identifier hs-var">mul_vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387588"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-944"></span><span>                 </span><span id="local-6989586621681387586"><span class="annot"><span class="annottext">combine :: TcSigmaType -&gt; Scaled a -&gt; Scaled a
</span><a href="#local-6989586621681387586"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621681387585"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387585"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Core.Type.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span id="local-6989586621681387582"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681387582"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. TcSigmaType -&gt; a -&gt; Scaled a
</span><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-var">Scaled</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387585"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681387582"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-945"></span><span>                 </span><span class="annot"><a href="#local-6989586621681387586"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><span class="hs-identifier">_</span></span><span>   </span><span id="local-6989586621681387581"><span class="annot"><span class="annottext">Scaled a
</span><a href="#local-6989586621681387581"><span class="hs-identifier hs-var">scaled_ty</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scaled a
</span><a href="#local-6989586621681387581"><span class="hs-identifier hs-var">scaled_ty</span></a></span><span>
</span><span id="line-946"></span><span>                   </span><span class="hs-comment">-- The combine function implements the fact that, as</span><span>
</span><span id="line-947"></span><span>                   </span><span class="hs-comment">-- described in Note [Linear fields generalization], if a</span><span>
</span><span id="line-948"></span><span>                   </span><span class="hs-comment">-- field is not linear (last line) it isn't made polymorphic.</span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span>                 </span><span id="local-6989586621681387578"><span class="annot"><span class="annottext">etaWrapper :: t (Scaled TcSigmaType) -&gt; HsWrapper
</span><a href="#local-6989586621681387578"><span class="hs-identifier hs-var hs-var">etaWrapper</span></a></span></span><span> </span><span id="local-6989586621681387577"><span class="annot"><span class="annottext">t (Scaled TcSigmaType)
</span><a href="#local-6989586621681387577"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681387575"><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387575"><span class="hs-identifier hs-var">scaled_ty</span></a></span></span><span> </span><span id="local-6989586621681387574"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387574"><span class="hs-identifier hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; Scaled TcSigmaType -&gt; SDoc -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#WpFun"><span class="hs-identifier hs-var">WpFun</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387574"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled TcSigmaType
</span><a href="#local-6989586621681387575"><span class="hs-identifier hs-var">scaled_ty</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#WpHole"><span class="hs-identifier hs-var">WpHole</span></a></span><span> </span><span class="annot"><span class="annottext">t (Scaled TcSigmaType)
</span><a href="#local-6989586621681387577"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span>           </span><span class="hs-comment">-- See Note [Instantiating stupid theta]</span><span>
</span><span id="line-953"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387571"><span class="annot"><span class="annottext">shouldInstantiate :: Bool
</span><a href="#local-6989586621681387571"><span class="hs-identifier hs-var hs-var">shouldInstantiate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType]
</span><a href="GHC.Core.DataCon.html#dataConStupidTheta"><span class="hs-identifier hs-var">dataConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-954"></span><span>                                      </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Core.Type.html#isKindLevPoly"><span class="hs-identifier hs-var">isKindLevPoly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; TcSigmaType
</span><a href="GHC.Core.TyCon.html#tyConResKind"><span class="hs-identifier hs-var">tyConResKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; TyCon
</span><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681387571"><span class="hs-identifier hs-var">shouldInstantiate</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-956"></span><span>               </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387565"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681387565"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387564"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387564"><span class="hs-identifier hs-var">tvs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; TcM (TCvSubst, [Id])
</span><a href="GHC.Tc.Utils.TcMType.html#newMetaTyVars"><span class="hs-identifier hs-var">newMetaTyVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387600"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>                           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387561"><span class="annot"><span class="annottext">tys' :: [TcSigmaType]
</span><a href="#local-6989586621681387561"><span class="hs-identifier hs-var hs-var">tys'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; [TcSigmaType]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681387564"><span class="hs-identifier hs-var">tvs'</span></a></span><span>
</span><span id="line-958"></span><span>                                 </span><span id="local-6989586621681387559"><span class="annot"><span class="annottext">theta' :: [TcSigmaType]
</span><a href="#local-6989586621681387559"><span class="hs-identifier hs-var hs-var">theta'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; [TcSigmaType] -&gt; [TcSigmaType]
</span><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681387565"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387598"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-959"></span><span>                                 </span><span id="local-6989586621681387557"><span class="annot"><span class="annottext">args' :: [Scaled TcSigmaType]
</span><a href="#local-6989586621681387557"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt;
TCvSubst -&gt; [Scaled TcSigmaType] -&gt; [Scaled TcSigmaType]
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier hs-var">substScaledTys</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681387565"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387596"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-960"></span><span>                                 </span><span id="local-6989586621681387555"><span class="annot"><span class="annottext">res' :: TcSigmaType
</span><a href="#local-6989586621681387555"><span class="hs-identifier hs-var hs-var">res'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681387565"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387594"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-961"></span><span>                           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387553"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387553"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; [TcSigmaType] -&gt; [TcSigmaType] -&gt; TcM HsWrapper
</span><a href="GHC.Tc.Utils.Instantiate.html#instCall"><span class="hs-identifier hs-var">instCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387643"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387561"><span class="hs-identifier hs-var">tys'</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387559"><span class="hs-identifier hs-var">theta'</span></a></span><span>
</span><span id="line-962"></span><span>                           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387551"><span class="annot"><span class="annottext">scaled_arg_tys :: [Scaled TcSigmaType]
</span><a href="#local-6989586621681387551"><span class="hs-identifier hs-var hs-var">scaled_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; [Scaled TcSigmaType]
</span><a href="#local-6989586621681387589"><span class="hs-identifier hs-var">scaleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387557"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-963"></span><span>                                 </span><span id="local-6989586621681387550"><span class="annot"><span class="annottext">eta_wrap :: HsWrapper
</span><a href="#local-6989586621681387550"><span class="hs-identifier hs-var hs-var">eta_wrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *}.
Foldable t =&gt;
t (Scaled TcSigmaType) -&gt; HsWrapper
</span><a href="#local-6989586621681387578"><span class="hs-identifier hs-var">etaWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387551"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span>
</span><span id="line-964"></span><span>                           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [TcSigmaType] -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Pat.html#addDataConStupidTheta"><span class="hs-identifier hs-var">addDataConStupidTheta</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387561"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-965"></span><span>                           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387550"><span class="hs-identifier hs-var">eta_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387553"><span class="hs-identifier hs-var">wrap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>                                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XConLikeOut p -&gt; ConLike -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsConLikeOut"><span class="hs-identifier hs-var">HsConLikeOut</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; ConLike
</span><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTys"><span class="hs-identifier hs-var">mkVisFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387551"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387555"><span class="hs-identifier hs-var">res'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-969"></span><span>               </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387546"><span class="annot"><span class="annottext">scaled_arg_tys :: [Scaled TcSigmaType]
</span><a href="#local-6989586621681387546"><span class="hs-identifier hs-var hs-var">scaled_arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; [Scaled TcSigmaType]
</span><a href="#local-6989586621681387589"><span class="hs-identifier hs-var">scaleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387596"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-970"></span><span>                            </span><span id="local-6989586621681387545"><span class="annot"><span class="annottext">wrap1 :: HsWrapper
</span><a href="#local-6989586621681387545"><span class="hs-identifier hs-var hs-var">wrap1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpTyApps"><span class="hs-identifier hs-var">mkWpTyApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id] -&gt; [TcSigmaType]
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387600"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>                            </span><span id="local-6989586621681387543"><span class="annot"><span class="annottext">eta_wrap :: HsWrapper
</span><a href="#local-6989586621681387543"><span class="hs-identifier hs-var hs-var">eta_wrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *}.
Foldable t =&gt;
t (Scaled TcSigmaType) -&gt; HsWrapper
</span><a href="#local-6989586621681387578"><span class="hs-identifier hs-var">etaWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387598"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387546"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>                            </span><span id="local-6989586621681387541"><span class="annot"><span class="annottext">wrap2 :: HsWrapper
</span><a href="#local-6989586621681387541"><span class="hs-identifier hs-var hs-var">wrap2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Id] -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#mkWpTyLams"><span class="hs-identifier hs-var">mkWpTyLams</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387600"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-973"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsExpr GhcTc -&gt; HsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387541"><span class="hs-identifier hs-var">wrap2</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387543"><span class="hs-identifier hs-var">eta_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681387545"><span class="hs-identifier hs-var">wrap1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>                                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XConLikeOut p -&gt; ConLike -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsConLikeOut"><span class="hs-identifier hs-var">HsConLikeOut</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; ConLike
</span><a href="GHC.Core.ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681387601"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[InvisTVBinder]
</span><a href="#local-6989586621681387600"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisFunTysMany"><span class="hs-identifier hs-var">mkInvisFunTysMany</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><a href="#local-6989586621681387598"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType] -&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.TyCo.Rep.html#mkVisFunTys"><span class="hs-identifier hs-var">mkVisFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387546"><span class="hs-identifier hs-var">scaled_arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387594"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-type">check_local_id</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-979"></span><span id="check_local_id"><span class="annot"><span class="annottext">check_local_id :: Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_local_id"><span class="hs-identifier hs-var hs-var">check_local_id</span></a></span></span><span> </span><span id="local-6989586621681387539"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387539"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-var">checkThLocalId</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387539"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-981"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">UsageEnv -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#tcEmitBindingUsage"><span class="hs-identifier hs-var">tcEmitBindingUsage</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall n. NamedThing n =&gt; n -&gt; TcSigmaType -&gt; UsageEnv
</span><a href="GHC.Core.UsageEnv.html#unitUE"><span class="hs-identifier hs-var">unitUE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387539"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Core.Type.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-type">check_naughty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span id="check_naughty"><span class="annot"><span class="annottext">check_naughty :: OccName -&gt; Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#check_naughty"><span class="hs-identifier hs-var hs-var">check_naughty</span></a></span></span><span> </span><span id="local-6989586621681387535"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387535"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621681387534"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387534"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isNaughtyRecordSelector"><span class="hs-identifier hs-var">isNaughtyRecordSelector</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387534"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#naughtyRecordSel"><span class="hs-identifier hs-var">naughtyRecordSel</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681387535"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span id="local-6989586621681387532"><span class="annot"><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-type">nonBidirectionalErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681387532"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681387532"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span><span>
</span><span id="line-989"></span><span id="nonBidirectionalErr"><span class="annot"><span class="annottext">nonBidirectionalErr :: forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#nonBidirectionalErr"><span class="hs-identifier hs-var hs-var">nonBidirectionalErr</span></a></span></span><span> </span><span id="local-6989586621681387529"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681387529"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non-bidirectional pattern synonym&quot;</span></span><span>
</span><span id="line-990"></span><span>                           </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681387529"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;used in an expression&quot;</span></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-comment">{-
Note [Linear fields generalization]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As per Note [Polymorphisation of linear fields], linear field of data
constructors get a polymorphic type when the data constructor is used as a term.

    Just :: forall {p} a. a #p-&gt; Maybe a

This rule is known only to the typechecker: Just keeps its linear type in Core.

In order to desugar this generalised typing rule, we simply eta-expand:

    \a (x # p :: a) -&gt; Just @a x

has the appropriate type. We insert these eta-expansion with WpFun wrappers.

A small hitch: if the constructor is levity-polymorphic (unboxed tuples, sums,
certain newtypes with -XUnliftedNewtypes) then this strategy produces

    \r1 r2 a b (x # p :: a) (y # q :: b) -&gt; (# a, b #)

Which has type

    forall r1 r2 a b. a #p-&gt; b #q-&gt; (# a, b #)

Which violates the levity-polymorphism restriction see Note [Levity polymorphism
checking] in DsMonad.

So we really must instantiate r1 and r2 rather than quantify over them.  For
simplicity, we just instantiate the entire type, as described in Note
[Instantiating stupid theta]. It breaks visible type application with unboxed
tuples, sums and levity-polymorphic newtypes, but this doesn't appear to be used
anywhere.

A better plan: let's force all representation variable to be *inferred*, so that
they are not subject to visible type applications. Then we can instantiate
inferred argument eagerly.

Note [Adding the implicit parameter to 'assert']
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The typechecker transforms (assert e1 e2) to (assertError e1 e2).
This isn't really the Right Thing because there's no way to &quot;undo&quot;
if you want to see the original source code in the typechecker
output.  We'll have fix this in due course, when we care more about
being able to reconstruct the exact original program.


Note [Instantiating stupid theta]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Normally, when we infer the type of an Id, we don't instantiate,
because we wish to allow for visible type application later on.
But if a datacon has a stupid theta, we're a bit stuck. We need
to emit the stupid theta constraints with instantiated types. It's
difficult to defer this to the lazy instantiation, because a stupid
theta has no spot to put it in a type. So we just instantiate eagerly
in this case. Thus, users cannot use visible type application with
a data constructor sporting a stupid theta. I won't feel so bad for
the users that complain.
-}</span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                 Template Haskell checks
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-type">checkThLocalId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- The renamer has already done checkWellStaged,</span><span>
</span><span id="line-1062"></span><span class="hs-comment">--   in RnSplice.checkThLocalName, so don't repeat that here.</span><span>
</span><span id="line-1063"></span><span class="hs-comment">-- Here we just add constraints for cross-stage lifting</span><span>
</span><span id="line-1064"></span><span id="checkThLocalId"><span class="annot"><span class="annottext">checkThLocalId :: Id -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkThLocalId"><span class="hs-identifier hs-var hs-var">checkThLocalId</span></a></span></span><span> </span><span id="local-6989586621681387528"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387528"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1065"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387527"><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><a href="#local-6989586621681387527"><span class="hs-identifier hs-var">mb_local_use</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcRn (Maybe (TopLevelFlag, ThLevel, ThStage))
</span><a href="GHC.Tc.Utils.Monad.html#getStageAndBindLevel"><span class="hs-identifier hs-var">getStageAndBindLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387528"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><a href="#local-6989586621681387527"><span class="hs-identifier hs-var">mb_local_use</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1067"></span><span>             </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387525"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621681387525"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387524"><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387524"><span class="hs-identifier hs-var">bind_lvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387523"><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681387523"><span class="hs-identifier hs-var">use_stage</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ThStage -&gt; ThLevel
</span><a href="GHC.Tc.Types.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681387523"><span class="hs-identifier hs-var">use_stage</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387524"><span class="hs-identifier hs-var">bind_lvl</span></a></span><span>
</span><span id="line-1069"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Id -&gt; ThStage -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var">checkCrossStageLifting</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621681387525"><span class="hs-identifier hs-var">top_lvl</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387528"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681387523"><span class="hs-identifier hs-var">use_stage</span></a></span><span>
</span><span id="line-1070"></span><span>             </span><span class="annot"><span class="annottext">Maybe (TopLevelFlag, ThLevel, ThStage)
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Not a locally-bound thing, or</span><span>
</span><span id="line-1071"></span><span>                               </span><span class="hs-comment">-- no cross-stage link</span><span>
</span><span id="line-1072"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-1075"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-type">checkCrossStageLifting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier hs-type">TopLevelFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ThStage"><span class="hs-identifier hs-type">ThStage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span class="hs-comment">-- If we are inside typed brackets, and (use_lvl &gt; bind_lvl)</span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- we must check whether there's a cross-stage lift to do</span><span>
</span><span id="line-1078"></span><span class="hs-comment">-- Examples   \x -&gt; [|| x ||]</span><span>
</span><span id="line-1079"></span><span class="hs-comment">--            [|| map ||]</span><span>
</span><span id="line-1080"></span><span class="hs-comment">--</span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- This is similar to checkCrossStageLifting in GHC.Rename.Splice, but</span><span>
</span><span id="line-1082"></span><span class="hs-comment">-- this code is applied to *typed* brackets.</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span id="checkCrossStageLifting"><span class="annot"><span class="annottext">checkCrossStageLifting :: TopLevelFlag -&gt; Id -&gt; ThStage -&gt; TcM ()
</span><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var hs-var">checkCrossStageLifting</span></a></span></span><span> </span><span id="local-6989586621681387519"><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621681387519"><span class="hs-identifier hs-var">top_lvl</span></a></span></span><span> </span><span id="local-6989586621681387518"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#Brack"><span class="hs-identifier hs-type">Brack</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcPending"><span class="hs-identifier hs-type">TcPending</span></a></span><span> </span><span id="local-6989586621681387515"><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621681387515"><span class="hs-identifier hs-var">ps_var</span></a></span></span><span> </span><span id="local-6989586621681387514"><span class="annot"><span class="annottext">TcRef WantedConstraints
</span><a href="#local-6989586621681387514"><span class="hs-identifier hs-var">lie_var</span></a></span></span><span> </span><span id="local-6989586621681387513"><span class="annot"><span class="annottext">QuoteWrapper
</span><a href="#local-6989586621681387513"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TopLevelFlag -&gt; Bool
</span><a href="GHC.Types.Basic.html#isTopLevel"><span class="hs-identifier hs-var">isTopLevel</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="#local-6989586621681387519"><span class="hs-identifier hs-var">top_lvl</span></a></span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387509"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#keepAlive"><span class="hs-identifier hs-var">keepAlive</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387509"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>    </span><span class="hs-comment">-- See Note [Keeping things alive for Template Haskell] in GHC.Rename.Splice</span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1090"></span><span>  </span><span class="hs-glyph">=</span><span>     </span><span class="hs-comment">-- Nested identifiers, such as 'x' in</span><span>
</span><span id="line-1091"></span><span>        </span><span class="hs-comment">-- E.g. \x -&gt; [|| h x ||]</span><span>
</span><span id="line-1092"></span><span>        </span><span class="hs-comment">-- We must behave as if the reference to x was</span><span>
</span><span id="line-1093"></span><span>        </span><span class="hs-comment">--      h $(lift x)</span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-comment">-- We use 'x' itself as the splice proxy, used by</span><span>
</span><span id="line-1095"></span><span>        </span><span class="hs-comment">-- the desugarer to stitch it all back together.</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-comment">-- If 'x' occurs many times we may get many identical</span><span>
</span><span id="line-1097"></span><span>        </span><span class="hs-comment">-- bindings of the same splice proxy, but that doesn't</span><span>
</span><span id="line-1098"></span><span>        </span><span class="hs-comment">-- matter, although it's a mite untidy.</span><span>
</span><span id="line-1099"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387508"><span class="annot"><span class="annottext">id_ty :: TcSigmaType
</span><a href="#local-6989586621681387508"><span class="hs-identifier hs-var hs-var">id_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; TcSigmaType
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1100"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#checkTc"><span class="hs-identifier hs-var">checkTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Core.Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387508"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#polySpliceErr"><span class="hs-identifier hs-var">polySpliceErr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>               </span><span class="hs-comment">-- If x is polymorphic, its occurrence sites might</span><span>
</span><span id="line-1102"></span><span>               </span><span class="hs-comment">-- have different instantiations, so we can't use plain</span><span>
</span><span id="line-1103"></span><span>               </span><span class="hs-comment">-- 'x' as the splice proxy name.  I don't know how to</span><span>
</span><span id="line-1104"></span><span>               </span><span class="hs-comment">-- solve this, and it's probably unimportant, so I'm</span><span>
</span><span id="line-1105"></span><span>               </span><span class="hs-comment">-- just going to flag an error for now</span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387504"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387504"><span class="hs-identifier hs-var">lift</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387508"><span class="hs-identifier hs-var">id_ty</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-1108"></span><span>                     </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387502"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387502"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM Id
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.TH.html#liftStringName"><span class="hs-identifier hs-var">GHC.Builtin.Names.TH.liftStringName</span></a></span><span>
</span><span id="line-1109"></span><span>                                     </span><span class="hs-comment">-- See Note [Lifting strings]</span><span>
</span><span id="line-1110"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. XVar p -&gt; LIdP p -&gt; HsExpr p
</span><a href="Language.Haskell.Syntax.Expr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387502"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1111"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-1112"></span><span>                     </span><span class="annot"><span class="annottext">forall a. TcRef WantedConstraints -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#setConstraintVar"><span class="hs-identifier hs-var">setConstraintVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef WantedConstraints
</span><a href="#local-6989586621681387514"><span class="hs-identifier hs-var">lie_var</span></a></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1113"></span><span>                          </span><span class="hs-comment">-- Put the 'lift' constraint into the right LIE</span><span>
</span><span id="line-1114"></span><span>                     </span><span class="annot"><span class="annottext">CtOrigin -&gt; Name -&gt; [TcSigmaType] -&gt; TcM (HsExpr GhcTc)
</span><a href="GHC.Tc.Utils.Instantiate.html#newMethodFromName"><span class="hs-identifier hs-var">newMethodFromName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#OccurrenceOf"><span class="hs-identifier hs-var">OccurrenceOf</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387509"><span class="hs-identifier hs-var">id_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>                                       </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.TH.html#liftName"><span class="hs-identifier hs-var">GHC.Builtin.Names.TH.liftName</span></a></span><span>
</span><span id="line-1116"></span><span>                                       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; TcSigmaType -&gt; TcSigmaType
</span><a href="GHC.Core.Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387508"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387508"><span class="hs-identifier hs-var">id_ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1117"></span><span>
</span><span id="line-1118"></span><span>                   </span><span class="hs-comment">-- Warning for implicit lift (#17804)</span><span>
</span><span id="line-1119"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnImplicitLift"><span class="hs-identifier hs-var">Opt_WarnImplicitLift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1120"></span><span>            </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; TcM ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnTc"><span class="hs-identifier hs-var">addWarnTc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnImplicitLift"><span class="hs-identifier hs-var">Opt_WarnImplicitLift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-1122"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is implicitly lifted in the TH quotation&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>
</span><span id="line-1124"></span><span>                   </span><span class="hs-comment">-- Update the pending splices</span><span>
</span><span id="line-1125"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387494"><span class="annot"><span class="annottext">[PendingTcSplice]
</span><a href="#local-6989586621681387494"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a env. IORef a -&gt; IOEnv env a
</span><a href="GHC.Data.IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621681387515"><span class="hs-identifier hs-var">ps_var</span></a></span><span>
</span><span id="line-1126"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681387492"><span class="annot"><span class="annottext">pending_splice :: PendingTcSplice
</span><a href="#local-6989586621681387492"><span class="hs-identifier hs-var hs-var">pending_splice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; LHsExpr GhcTc -&gt; PendingTcSplice
</span><a href="GHC.Hs.Expr.html#PendingTcSplice"><span class="hs-identifier hs-var">PendingTcSplice</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681387509"><span class="hs-identifier hs-var">id_name</span></a></span><span>
</span><span id="line-1127"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (id :: Pass).
IsPass id =&gt;
LHsExpr (GhcPass id)
-&gt; LHsExpr (GhcPass id) -&gt; LHsExpr (GhcPass id)
</span><a href="GHC.Hs.Utils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper -&gt; LHsExpr GhcTc -&gt; LHsExpr GhcTc
</span><a href="GHC.Hs.Utils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuoteWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#applyQuoteWrapper"><span class="hs-identifier hs-var">applyQuoteWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">QuoteWrapper
</span><a href="#local-6989586621681387513"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621681387504"><span class="hs-identifier hs-var">lift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass) a.
IsSrcSpanAnn p a =&gt;
IdP (GhcPass p) -&gt; LHsExpr (GhcPass p)
</span><a href="GHC.Hs.Utils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1129"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a env. IORef a -&gt; a -&gt; IOEnv env ()
</span><a href="GHC.Data.IOEnv.html#writeMutVar"><span class="hs-identifier hs-var">writeMutVar</span></a></span><span> </span><span class="annot"><span class="annottext">TcRef [PendingTcSplice]
</span><a href="#local-6989586621681387515"><span class="hs-identifier hs-var">ps_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PendingTcSplice
</span><a href="#local-6989586621681387492"><span class="hs-identifier hs-var">pending_splice</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PendingTcSplice]
</span><a href="#local-6989586621681387494"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1133"></span><span>    </span><span id="local-6989586621681387509"><span class="annot"><span class="annottext">id_name :: Name
</span><a href="#local-6989586621681387509"><span class="hs-identifier hs-var hs-var">id_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387518"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#checkCrossStageLifting"><span class="hs-identifier hs-var">checkCrossStageLifting</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelFlag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1136"></span><span>
</span><span id="line-1137"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#polySpliceErr"><span class="hs-identifier hs-type">polySpliceErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1138"></span><span id="polySpliceErr"><span class="annot"><span class="annottext">polySpliceErr :: Id -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#polySpliceErr"><span class="hs-identifier hs-var hs-var">polySpliceErr</span></a></span></span><span> </span><span id="local-6989586621681387486"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387486"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1139"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't splice the polymorphic local variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681387486"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="hs-comment">{-
Note [Lifting strings]
~~~~~~~~~~~~~~~~~~~~~~
If we see $(... [| s |] ...) where s::String, we don't want to
generate a mass of Cons (CharL 'x') (Cons (CharL 'y') ...)) etc.
So this conditional short-circuits the lifting mechanism to generate
(liftString &quot;xy&quot;) in that case.  I didn't want to use overlapping instances
for the Lift class in TH.Syntax, because that can lead to overlapping-instance
errors in a polymorphic situation.

If this check fails (which isn't impossible) we get another chance; see
Note [Converting strings] in Convert.hs

Local record selectors
~~~~~~~~~~~~~~~~~~~~~~
Record selectors for TyCons in this module are ordinary local bindings,
which show up as ATcIds rather than AGlobals.  So we need to check for
naughtiness in both branches.  c.f. TcTyClsBindings.mkAuxBinds.
-}</span><span>
</span><span id="line-1160"></span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
         Error reporting for function result mis-matches
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-1167"></span><span>
</span><span id="line-1168"></span><span id="local-6989586621681388458"><span class="annot"><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-type">addFunResCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#HsExprArg"><span class="hs-identifier hs-type">HsExprArg</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="GHC.Tc.Gen.Head.html#TcpRn"><span class="hs-identifier hs-type">TcpRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1169"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#ExpRhoType"><span class="hs-identifier hs-type">ExpRhoType</span></a></span><span>
</span><span id="line-1170"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388458"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388458"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1171"></span><span class="hs-comment">-- When we have a mis-match in the return type of a function</span><span>
</span><span id="line-1172"></span><span class="hs-comment">-- try to give a helpful message about too many/few arguments</span><span>
</span><span id="line-1173"></span><span class="hs-comment">-- But not in generated code, where we don't want</span><span>
</span><span id="line-1174"></span><span class="hs-comment">-- to mention internal (rebindable syntax) function names</span><span>
</span><span id="line-1175"></span><span id="addFunResCtxt"><span class="annot"><span class="annottext">addFunResCtxt :: forall a.
HsExpr (GhcPass 'Renamed)
-&gt; [HsExprArg 'TcpRn]
-&gt; TcSigmaType
-&gt; ExpRhoType
-&gt; TcM a
-&gt; TcM a
</span><a href="GHC.Tc.Gen.Head.html#addFunResCtxt"><span class="hs-identifier hs-var hs-var">addFunResCtxt</span></a></span></span><span> </span><span id="local-6989586621681387469"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387469"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681387468"><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387468"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621681387467"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387467"><span class="hs-identifier hs-var">fun_res_ty</span></a></span></span><span> </span><span id="local-6989586621681387466"><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387466"><span class="hs-identifier hs-var">env_ty</span></a></span></span><span> </span><span id="local-6989586621681387465"><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621681387465"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (TidyEnv -&gt; TcM (TidyEnv, SDoc)) -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addLandmarkErrCtxtM"><span class="hs-identifier hs-var">addLandmarkErrCtxtM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681387463"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681387463"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681387463"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) SDoc
</span><a href="#local-6989586621681387462"><span class="hs-identifier hs-var">mk_msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621681387465"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1177"></span><span>      </span><span class="hs-comment">-- NB: use a landmark error context, so that an empty context</span><span>
</span><span id="line-1178"></span><span>      </span><span class="hs-comment">-- doesn't suppress some more useful context</span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1180"></span><span>    </span><span id="local-6989586621681387462"><span class="annot"><span class="annottext">mk_msg :: IOEnv (Env TcGblEnv TcLclEnv) SDoc
</span><a href="#local-6989586621681387462"><span class="hs-identifier hs-var hs-var">mk_msg</span></a></span></span><span>
</span><span id="line-1181"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387461"><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387461"><span class="hs-identifier hs-var">mb_env_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExpRhoType -&gt; TcM (Maybe TcSigmaType)
</span><a href="GHC.Tc.Utils.TcMType.html#readExpType_maybe"><span class="hs-identifier hs-var">readExpType_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ExpRhoType
</span><a href="#local-6989586621681387466"><span class="hs-identifier hs-var">env_ty</span></a></span><span>
</span><span id="line-1182"></span><span>                     </span><span class="hs-comment">-- by the time the message is rendered, the ExpType</span><span>
</span><span id="line-1183"></span><span>                     </span><span class="hs-comment">-- will be filled in (except if we're debugging)</span><span>
</span><span id="line-1184"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387459"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387459"><span class="hs-identifier hs-var">fun_res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387467"><span class="hs-identifier hs-var">fun_res_ty</span></a></span><span>
</span><span id="line-1185"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681387458"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387458"><span class="hs-identifier hs-var">env'</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="#local-6989586621681387461"><span class="hs-identifier hs-var">mb_env_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1186"></span><span>                           </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681387457"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387457"><span class="hs-identifier hs-var">env_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387457"><span class="hs-identifier hs-var">env_ty</span></a></span><span>
</span><span id="line-1187"></span><span>                           </span><span class="annot"><span class="annottext">Maybe TcSigmaType
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1188"></span><span>                             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681387456"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681387456"><span class="hs-identifier hs-var">dumping</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. DumpFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#doptM"><span class="hs-identifier hs-var">doptM</span></a></span><span> </span><span class="annot"><span class="annottext">DumpFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_tc_trace"><span class="hs-identifier hs-var">Opt_D_dump_tc_trace</span></a></span><span>
</span><span id="line-1189"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">MASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">dumping</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1190"></span><span>                                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; TcM TcSigmaType
</span><a href="GHC.Tc.Utils.TcMType.html#newFlexiTyVarTy"><span class="hs-identifier hs-var">newFlexiTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="GHC.Builtin.Types.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1191"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [Splitting nested sigma types in mismatched</span><span>
</span><span id="line-1192"></span><span>                 </span><span class="hs-comment">--           function types]</span><span>
</span><span id="line-1193"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387448"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387448"><span class="hs-identifier hs-var">fun_tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Id], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387459"><span class="hs-identifier hs-var">fun_res'</span></a></span><span>
</span><span id="line-1194"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Id]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387446"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387446"><span class="hs-identifier hs-var">env_tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Id], [TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitNestedSigmaTys"><span class="hs-identifier hs-var">tcSplitNestedSigmaTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387458"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-1195"></span><span>                     </span><span class="hs-comment">-- env_ty is an ExpRhoTy, but with simple subsumption it</span><span>
</span><span id="line-1196"></span><span>                     </span><span class="hs-comment">-- is not deeply skolemised, so still use tcSplitNestedSigmaTys</span><span>
</span><span id="line-1197"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621681387445"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387445"><span class="hs-identifier hs-var">args_fun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387444"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387444"><span class="hs-identifier hs-var">res_fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Scaled TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387448"><span class="hs-identifier hs-var">fun_tau</span></a></span><span>
</span><span id="line-1198"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621681387442"><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387442"><span class="hs-identifier hs-var">args_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681387441"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387441"><span class="hs-identifier hs-var">res_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; ([Scaled TcSigmaType], TcSigmaType)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387446"><span class="hs-identifier hs-var">env_tau</span></a></span><span>
</span><span id="line-1199"></span><span>                 </span><span id="local-6989586621681387440"><span class="annot"><span class="annottext">n_fun :: ThLevel
</span><a href="#local-6989586621681387440"><span class="hs-identifier hs-var hs-var">n_fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387445"><span class="hs-identifier hs-var">args_fun</span></a></span><span>
</span><span id="line-1200"></span><span>                 </span><span id="local-6989586621681387439"><span class="annot"><span class="annottext">n_env :: ThLevel
</span><a href="#local-6989586621681387439"><span class="hs-identifier hs-var hs-var">n_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ThLevel
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled TcSigmaType]
</span><a href="#local-6989586621681387442"><span class="hs-identifier hs-var">args_env</span></a></span><span>
</span><span id="line-1201"></span><span>                 </span><span id="local-6989586621681387438"><span class="annot"><span class="annottext">info :: SDoc
</span><a href="#local-6989586621681387438"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Check for too few args</span><span>
</span><span id="line-1202"></span><span>                         </span><span class="hs-comment">--  fun_tau = a -&gt; b, res_tau = Int</span><span>
</span><span id="line-1203"></span><span>                         </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387440"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387439"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1204"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="#local-6989586621681387437"><span class="hs-identifier hs-var">not_fun</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387441"><span class="hs-identifier hs-var">res_env</span></a></span><span>
</span><span id="line-1205"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Probable cause:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387469"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1206"></span><span>                         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is applied to too few arguments&quot;</span></span><span>
</span><span id="line-1207"></span><span>
</span><span id="line-1208"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Check for too many args</span><span>
</span><span id="line-1209"></span><span>                         </span><span class="hs-comment">-- fun_tau = a -&gt; Int,   res_tau = a -&gt; b -&gt; c -&gt; d</span><span>
</span><span id="line-1210"></span><span>                         </span><span class="hs-comment">-- The final guard suppresses the message when there</span><span>
</span><span id="line-1211"></span><span>                         </span><span class="hs-comment">-- aren't enough args to drop; eg. the call is (f e1)</span><span>
</span><span id="line-1212"></span><span>                         </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387440"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387439"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1213"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigmaType -&gt; Bool
</span><a href="#local-6989586621681387437"><span class="hs-identifier hs-var">not_fun</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387444"><span class="hs-identifier hs-var">res_fun</span></a></span><span>
</span><span id="line-1214"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387440"><span class="hs-identifier hs-var">n_fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ThLevel
</span><a href="GHC.Utils.Misc.html#count"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">forall (id :: TcPass). HsExprArg id -&gt; Bool
</span><a href="GHC.Tc.Gen.Head.html#isValArg"><span class="hs-identifier hs-var">isValArg</span></a></span><span> </span><span class="annot"><span class="annottext">[HsExprArg 'TcpRn]
</span><a href="#local-6989586621681387468"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><a href="#local-6989586621681387439"><span class="hs-identifier hs-var">n_env</span></a></span><span>
</span><span id="line-1215"></span><span>                          </span><span class="hs-comment">-- Never suggest that a naked variable is</span><span>
</span><span id="line-1216"></span><span>                                           </span><span class="hs-comment">-- applied to too many args!</span><span>
</span><span id="line-1217"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Possible cause:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387469"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1218"></span><span>                         </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is applied to too many arguments&quot;</span></span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1221"></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-1222"></span><span>
</span><span id="line-1223"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681387438"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1224"></span><span>
</span><span id="line-1225"></span><span>    </span><span id="local-6989586621681387437"><span class="annot"><span class="annottext">not_fun :: TcSigmaType -&gt; Bool
</span><a href="#local-6989586621681387437"><span class="hs-identifier hs-var hs-var">not_fun</span></a></span></span><span> </span><span id="local-6989586621681387432"><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387432"><span class="hs-identifier hs-var">ty</span></a></span></span><span>   </span><span class="hs-comment">-- ty is definitely not an arrow type,</span><span>
</span><span id="line-1226"></span><span>                 </span><span class="hs-comment">-- and cannot conceivably become one</span><span>
</span><span id="line-1227"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TcSigmaType -&gt; Maybe (TyCon, [TcSigmaType])
</span><a href="GHC.Core.Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigmaType
</span><a href="#local-6989586621681387432"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1228"></span><span>          </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681387431"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387431"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TcSigmaType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681387431"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1229"></span><span>          </span><span class="annot"><span class="annottext">Maybe (TyCon, [TcSigmaType])
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1230"></span><span>
</span><span id="line-1231"></span><span class="hs-comment">{-
Note [Splitting nested sigma types in mismatched function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When one applies a function to too few arguments, GHC tries to determine this
fact if possible so that it may give a helpful error message. It accomplishes
this by checking if the type of the applied function has more argument types
than supplied arguments.

Previously, GHC computed the number of argument types through tcSplitSigmaTy.
This is incorrect in the face of nested foralls, however!
This caused Ticket #13311, for instance:

  f :: forall a. (Monoid a) =&gt; Int -&gt; forall b. (Monoid b) =&gt; Maybe a -&gt; Maybe b

If one uses `f` like so:

  do { f; putChar 'a' }

Then tcSplitSigmaTy will decompose the type of `f` into:

  Tyvars: [a]
  Context: (Monoid a)
  Argument types: []
  Return type: Int -&gt; forall b. Monoid b =&gt; Maybe a -&gt; Maybe b

That is, it will conclude that there are *no* argument types, and since `f`
was given no arguments, it won't print a helpful error message. On the other
hand, tcSplitNestedSigmaTys correctly decomposes `f`'s type down to:

  Tyvars: [a, b]
  Context: (Monoid a, Monoid b)
  Argument types: [Int, Maybe a]
  Return type: Maybe b

So now GHC recognizes that `f` has one more argument type than it was actually
provided.

Notice that tcSplitNestedSigmaTys looks through function arrows too, regardless
of simple/deep subsumption.  Here we are concerned only whether there is a
mis-match in the number of value arguments.
-}</span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
             Misc utility functions
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span id="local-6989586621681388537"><span class="annot"><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-type">addExprCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681388537"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1281"></span><span id="addExprCtxt"><span class="annot"><span class="annottext">addExprCtxt :: forall a. HsExpr (GhcPass 'Renamed) -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Gen.Head.html#addExprCtxt"><span class="hs-identifier hs-var hs-var">addExprCtxt</span></a></span></span><span> </span><span id="local-6989586621681387429"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387429"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621681387428"><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621681387428"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-1282"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387429"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1283"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsUnboundVar"><span class="hs-identifier hs-type">HsUnboundVar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621681387428"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1284"></span><span>      </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed) -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-var">exprCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387429"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRn a
</span><a href="#local-6989586621681387428"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-1285"></span><span>   </span><span class="hs-comment">-- The HsUnboundVar special case addresses situations like</span><span>
</span><span id="line-1286"></span><span>   </span><span class="hs-comment">--    f x = _</span><span>
</span><span id="line-1287"></span><span>   </span><span class="hs-comment">-- when we don't want to say &quot;In the expression: _&quot;,</span><span>
</span><span id="line-1288"></span><span>   </span><span class="hs-comment">-- because it is mentioned in the error message itself</span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span class="annot"><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-type">exprCtxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1291"></span><span id="exprCtxt"><span class="annot"><span class="annottext">exprCtxt :: HsExpr (GhcPass 'Renamed) -&gt; SDoc
</span><a href="GHC.Tc.Gen.Head.html#exprCtxt"><span class="hs-identifier hs-var hs-var">exprCtxt</span></a></span></span><span> </span><span id="local-6989586621681387424"><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387424"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; ThLevel -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the expression:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ThLevel
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass). HsExpr (GhcPass p) -&gt; HsExpr (GhcPass p)
</span><a href="GHC.Hs.Expr.html#stripParensHsExpr"><span class="hs-identifier hs-var">stripParensHsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr (GhcPass 'Renamed)
</span><a href="#local-6989586621681387424"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span></pre></body></html>
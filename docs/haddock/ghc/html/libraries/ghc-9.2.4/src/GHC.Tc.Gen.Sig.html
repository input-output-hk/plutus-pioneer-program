<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006-2012
(c) The GRASP Project, Glasgow University, 1992-2002

-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Tc.Gen.Sig</span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.html#TcSigInfo"><span class="hs-identifier">TcSigInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier">TcIdSigInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInst"><span class="hs-identifier">TcIdSigInst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.html#TcPatSynInfo"><span class="hs-identifier">TcPatSynInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.html#TcSigFun"><span class="hs-identifier">TcSigFun</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>       </span><span class="annot"><a href="GHC.Tc.Types.html#isPartialSig"><span class="hs-identifier">isPartialSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#hasCompleteSig"><span class="hs-identifier">hasCompleteSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcIdSigName"><span class="hs-identifier">tcIdSigName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSigInfoName"><span class="hs-identifier">tcSigInfoName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#completeSigPolyId_maybe"><span class="hs-identifier">completeSigPolyId_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#isCompleteHsSig"><span class="hs-identifier">isCompleteHsSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySigs"><span class="hs-identifier">tcTySigs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier">tcUserTypeSig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#completeSigFromId"><span class="hs-identifier">completeSigFromId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier">tcInstSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier">TcPragEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#emptyPragEnv"><span class="hs-identifier">emptyPragEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#lookupPragEnv"><span class="hs-identifier">lookupPragEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#extendPragEnv"><span class="hs-identifier">extendPragEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#mkPragEnv"><span class="hs-identifier">mkPragEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecPrags"><span class="hs-identifier">tcSpecPrags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecWrapper"><span class="hs-identifier">tcSpecWrapper</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcImpPrags"><span class="hs-identifier">tcImpPrags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>       </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePrags"><span class="hs-identifier">addInlinePrags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier">addInlinePragArity</span></a></span><span>
</span><span id="line-25"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.HsType.html"><span class="hs-identifier">GHC.Tc.Gen.HsType</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html"><span class="hs-identifier">GHC.Tc.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html"><span class="hs-identifier">GHC.Tc.Solver</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#pushLevelAndSolveEqualitiesX"><span class="hs-identifier">pushLevelAndSolveEqualitiesX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Solver.html#reportUnsolvedEqualities"><span class="hs-identifier">reportUnsolvedEqualities</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Zonk.html"><span class="hs-identifier">GHC.Tc.Utils.Zonk</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html"><span class="hs-identifier">GHC.Tc.Types.Origin</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html"><span class="hs-identifier">GHC.Tc.Utils.TcMType</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Validity.html"><span class="hs-identifier">GHC.Tc.Validity</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Validity.html#checkValidType"><span class="hs-identifier">checkValidType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Unify.html"><span class="hs-identifier">GHC.Tc.Utils.Unify</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Unify.html#tcTopSkolemise"><span class="hs-identifier">tcTopSkolemise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Unify.html#unifyType"><span class="hs-identifier">unifyType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html"><span class="hs-identifier">GHC.Tc.Utils.Instantiate</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier">topInstantiate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Instantiate.html#tcInstTypeBndrs"><span class="hs-identifier">tcInstTypeBndrs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier">tcLookupId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html"><span class="hs-identifier">GHC.Tc.Types.Evidence</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier">HsWrapper</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator">(&lt;.&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.html#hasSomeUnfolding"><span class="hs-identifier">hasSomeUnfolding</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#mkTyVarBinders"><span class="hs-identifier">mkTyVarBinders</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Multiplicity.html"><span class="hs-identifier">GHC.Core.Multiplicity</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Backend.html"><span class="hs-identifier">GHC.Driver.Backend</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Specificity"><span class="hs-identifier">Specificity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier">tyVarKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier">binderVars</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier">Id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idName"><span class="hs-identifier">idName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier">idType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#setInlinePragma"><span class="hs-identifier">setInlinePragma</span></a></span><span>
</span><span id="line-53"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#mkLocalId"><span class="hs-identifier">mkLocalId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Id.html#realIdUnfolding"><span class="hs-identifier">realIdUnfolding</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#mkUnboundName"><span class="hs-identifier">mkUnboundName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier">getModule</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Utils</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#singleton"><span class="hs-identifier">singleton</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#orElse"><span class="hs-identifier">orElse</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Maybe.html#"><span class="hs-identifier">Data.Maybe</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">{- -------------------------------------------------------------
          Note [Overview of type signatures]
----------------------------------------------------------------
Type signatures, including partial signatures, are jolly tricky,
especially on value bindings.  Here's an overview.

    f :: forall a. [a] -&gt; [a]
    g :: forall b. _ -&gt; b

    f = ...g...
    g = ...f...

* HsSyn: a signature in a binding starts off as a TypeSig, in
  type HsBinds.Sig

* When starting a mutually recursive group, like f/g above, we
  call tcTySig on each signature in the group.

* tcTySig: Sig -&gt; TcIdSigInfo
  - For a /complete/ signature, like 'f' above, tcTySig kind-checks
    the HsType, producing a Type, and wraps it in a CompleteSig, and
    extend the type environment with this polymorphic 'f'.

  - For a /partial/signature, like 'g' above, tcTySig does nothing
    Instead it just wraps the pieces in a PartialSig, to be handled
    later.

* tcInstSig: TcIdSigInfo -&gt; TcIdSigInst
  In tcMonoBinds, when looking at an individual binding, we use
  tcInstSig to instantiate the signature forall's in the signature,
  and attribute that instantiated (monomorphic) type to the
  binder.  You can see this in GHC.Tc.Gen.Bind.tcLhsId.

  The instantiation does the obvious thing for complete signatures,
  but for /partial/ signatures it starts from the HsSyn, so it
  has to kind-check it etc: tcHsPartialSigType.  It's convenient
  to do this at the same time as instantiation, because we can
  make the wildcards into unification variables right away, raather
  than somehow quantifying over them.  And the &quot;TcLevel&quot; of those
  unification variables is correct because we are in tcMonoBinds.


Note [Binding scoped type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The type variables *brought into lexical scope* by a type signature
may be a subset of the *quantified type variables* of the signatures,
for two reasons:

* With kind polymorphism a signature like
    f :: forall f a. f a -&gt; f a
  may actually give rise to
    f :: forall k. forall (f::k -&gt; *) (a:k). f a -&gt; f a
  So the sig_tvs will be [k,f,a], but only f,a are scoped.
  NB: the scoped ones are not necessarily the *initial* ones!

* Even aside from kind polymorphism, there may be more instantiated
  type variables than lexically-scoped ones.  For example:
        type T a = forall b. b -&gt; (a,b)
        f :: forall c. T c
  Here, the signature for f will have one scoped type variable, c,
  but two instantiated type variables, c' and b'.

However, all of this only applies to the renamer.  The typechecker
just puts all of them into the type environment; any lexical-scope
errors were dealt with by the renamer.

-}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
             Utility functions for TcSigInfo
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcIdSigName"><span class="hs-identifier hs-type">tcIdSigName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-144"></span><span id="tcIdSigName"><span class="annot"><span class="annottext">tcIdSigName :: TcIdSigInfo -&gt; Name
</span><a href="GHC.Tc.Gen.Sig.html#tcIdSigName"><span class="hs-identifier hs-var hs-var">tcIdSigName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcIdSigInfo -&gt; TcId
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385269"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385269"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385269"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-145"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcIdSigName"><span class="hs-identifier hs-var">tcIdSigName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#PartialSig"><span class="hs-identifier hs-type">PartialSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psig_name :: TcIdSigInfo -&gt; Name
</span><a href="GHC.Tc.Types.html#psig_name"><span class="hs-identifier hs-var">psig_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385266"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385266"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385266"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSigInfoName"><span class="hs-identifier hs-type">tcSigInfoName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-148"></span><span id="tcSigInfoName"><span class="annot"><span class="annottext">tcSigInfoName :: TcSigInfo -&gt; Name
</span><a href="GHC.Tc.Gen.Sig.html#tcSigInfoName"><span class="hs-identifier hs-var hs-var">tcSigInfoName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSig"><span class="hs-identifier hs-type">TcIdSig</span></a></span><span>     </span><span id="local-6989586621681385264"><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385264"><span class="hs-identifier hs-var">idsi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo -&gt; Name
</span><a href="GHC.Tc.Gen.Sig.html#tcIdSigName"><span class="hs-identifier hs-var">tcIdSigName</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385264"><span class="hs-identifier hs-var">idsi</span></a></span><span>
</span><span id="line-149"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSigInfoName"><span class="hs-identifier hs-var">tcSigInfoName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcPatSynSig"><span class="hs-identifier hs-type">TcPatSynSig</span></a></span><span> </span><span id="local-6989586621681385262"><span class="annot"><span class="annottext">TcPatSynInfo
</span><a href="#local-6989586621681385262"><span class="hs-identifier hs-var">tpsi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcPatSynInfo -&gt; Name
</span><a href="GHC.Tc.Types.html#patsig_name"><span class="hs-identifier hs-var">patsig_name</span></a></span><span> </span><span class="annot"><span class="annottext">TcPatSynInfo
</span><a href="#local-6989586621681385262"><span class="hs-identifier hs-var">tpsi</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#completeSigPolyId_maybe"><span class="hs-identifier hs-type">completeSigPolyId_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span>
</span><span id="line-152"></span><span id="completeSigPolyId_maybe"><span class="annot"><span class="annottext">completeSigPolyId_maybe :: TcSigInfo -&gt; Maybe TcId
</span><a href="GHC.Tc.Gen.Sig.html#completeSigPolyId_maybe"><span class="hs-identifier hs-var hs-var">completeSigPolyId_maybe</span></a></span></span><span> </span><span id="local-6989586621681385260"><span class="annot"><span class="annottext">TcSigInfo
</span><a href="#local-6989586621681385260"><span class="hs-identifier hs-var">sig</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSig"><span class="hs-identifier hs-type">TcIdSig</span></a></span><span> </span><span id="local-6989586621681385259"><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385259"><span class="hs-identifier hs-var">sig_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcSigInfo
</span><a href="#local-6989586621681385260"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcIdSigInfo -&gt; TcId
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385258"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385258"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385259"><span class="hs-identifier hs-var">sig_info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385258"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
               Typechecking user signatures
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySigs"><span class="hs-identifier hs-type">tcTySigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcSigFun"><span class="hs-identifier hs-type">TcSigFun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="tcTySigs"><span class="annot"><span class="annottext">tcTySigs :: [LSig GhcRn] -&gt; TcM ([TcId], TcSigFun)
</span><a href="GHC.Tc.Gen.Sig.html#tcTySigs"><span class="hs-identifier hs-var hs-var">tcTySigs</span></a></span></span><span> </span><span id="local-6989586621681385257"><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681385257"><span class="hs-identifier hs-var">hs_sigs</span></a></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall r. TcM r -&gt; TcM r
</span><a href="GHC.Tc.Utils.Monad.html#checkNoErrs"><span class="hs-identifier hs-var">checkNoErrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Fail if any of the signatures is duff</span><span>
</span><span id="line-168"></span><span>         </span><span class="hs-comment">-- Hence mapAndReportM</span><span>
</span><span id="line-169"></span><span>         </span><span class="hs-comment">-- See Note [Fail eagerly on bad signatures]</span><span>
</span><span id="line-170"></span><span>         </span><span id="local-6989586621681385255"><span class="annot"><span class="annottext">[[TcSigInfo]]
</span><a href="#local-6989586621681385255"><span class="hs-identifier hs-var">ty_sigs_s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndReportM"><span class="hs-identifier hs-var">mapAndReportM</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn -&gt; TcM [TcSigInfo]
</span><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-var">tcTySig</span></a></span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681385257"><span class="hs-identifier hs-var">hs_sigs</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681385252"><span class="annot"><span class="annottext">ty_sigs :: [TcSigInfo]
</span><a href="#local-6989586621681385252"><span class="hs-identifier hs-var hs-var">ty_sigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[TcSigInfo]]
</span><a href="#local-6989586621681385255"><span class="hs-identifier hs-var">ty_sigs_s</span></a></span><span>
</span><span id="line-173"></span><span>             </span><span id="local-6989586621681385250"><span class="annot"><span class="annottext">poly_ids :: [TcId]
</span><a href="#local-6989586621681385250"><span class="hs-identifier hs-var hs-var">poly_ids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/Data-Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigInfo -&gt; Maybe TcId
</span><a href="GHC.Tc.Gen.Sig.html#completeSigPolyId_maybe"><span class="hs-identifier hs-var">completeSigPolyId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSigInfo]
</span><a href="#local-6989586621681385252"><span class="hs-identifier hs-var">ty_sigs</span></a></span><span>
</span><span id="line-174"></span><span>                        </span><span class="hs-comment">-- The returned [TcId] are the ones for which we have</span><span>
</span><span id="line-175"></span><span>                        </span><span class="hs-comment">-- a complete type signature.</span><span>
</span><span id="line-176"></span><span>                        </span><span class="hs-comment">-- See Note [Complete and partial type signatures]</span><span>
</span><span id="line-177"></span><span>             </span><span id="local-6989586621681385249"><span class="annot"><span class="annottext">env :: NameEnv TcSigInfo
</span><a href="#local-6989586621681385249"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(Name, a)] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcSigInfo -&gt; Name
</span><a href="GHC.Tc.Gen.Sig.html#tcSigInfoName"><span class="hs-identifier hs-var">tcSigInfoName</span></a></span><span> </span><span class="annot"><span class="annottext">TcSigInfo
</span><a href="#local-6989586621681385247"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcSigInfo
</span><a href="#local-6989586621681385247"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681385247"><span class="annot"><span class="annottext">TcSigInfo
</span><a href="#local-6989586621681385247"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TcSigInfo]
</span><a href="#local-6989586621681385252"><span class="hs-identifier hs-var">ty_sigs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385250"><span class="hs-identifier hs-var">poly_ids</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv TcSigInfo
</span><a href="#local-6989586621681385249"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-type">tcTySig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Types.html#TcSigInfo"><span class="hs-identifier hs-type">TcSigInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span id="tcTySig"><span class="annot"><span class="annottext">tcTySig :: LSig GhcRn -&gt; TcM [TcSigInfo]
</span><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-var hs-var">tcTySig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#IdSig"><span class="hs-identifier hs-type">IdSig</span></a></span><span> </span><span class="annot"><span class="annottext">XIdSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385243"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385243"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681385242"><span class="annot"><span class="annottext">ctxt :: UserTypeCtxt
</span><a href="#local-6989586621681385242"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385243"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-184"></span><span>                    </span><span class="hs-comment">-- False: do not report redundant constraints</span><span>
</span><span id="line-185"></span><span>                    </span><span class="hs-comment">-- The user has no control over the signature!</span><span>
</span><span id="line-186"></span><span>             </span><span id="local-6989586621681385240"><span class="annot"><span class="annottext">sig :: TcIdSigInfo
</span><a href="#local-6989586621681385240"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; TcId -&gt; TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#completeSigFromId"><span class="hs-identifier hs-var">completeSigFromId</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385242"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385243"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-187"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TcIdSigInfo -&gt; TcSigInfo
</span><a href="GHC.Tc.Types.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385240"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-var">tcTySig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681385239"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681385239"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#TypeSig"><span class="hs-identifier hs-type">TypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">XTypeSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385237"><span class="annot"><span class="annottext">[LIdP GhcRn]
</span><a href="#local-6989586621681385237"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621681385236"><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385236"><span class="hs-identifier hs-var">sig_ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann a. SrcSpanAnn' ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681385239"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681385234"><span class="annot"><span class="annottext">[TcIdSigInfo]
</span><a href="#local-6989586621681385234"><span class="hs-identifier hs-var">sigs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../../base-4.16.3.0/src/Data-Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SrcSpan
-&gt; LHsSigWcType GhcRn
-&gt; Maybe Name
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier hs-var">tcUserTypeSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681385239"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385236"><span class="hs-identifier hs-var">sig_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385231"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385231"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385231"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LIdP GhcRn]
</span><a href="#local-6989586621681385237"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo -&gt; TcSigInfo
</span><a href="GHC.Tc.Types.html#TcIdSig"><span class="hs-identifier hs-var">TcIdSig</span></a></span><span> </span><span class="annot"><span class="annottext">[TcIdSigInfo]
</span><a href="#local-6989586621681385234"><span class="hs-identifier hs-var">sigs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-var">tcTySig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681385230"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681385230"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#PatSynSig"><span class="hs-identifier hs-type">PatSynSig</span></a></span><span> </span><span class="annot"><span class="annottext">XPatSynSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385228"><span class="annot"><span class="annottext">[LIdP GhcRn]
</span><a href="#local-6989586621681385228"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621681385227"><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621681385227"><span class="hs-identifier hs-var">sig_ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann a. SrcSpanAnn' ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681385230"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681385226"><span class="annot"><span class="annottext">[TcPatSynInfo]
</span><a href="#local-6989586621681385226"><span class="hs-identifier hs-var">tpsigs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../../base-4.16.3.0/src/Data-Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; LHsSigType GhcRn -&gt; IOEnv (Env TcGblEnv TcLclEnv) TcPatSynInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcPatSynSig"><span class="hs-identifier hs-var">tcPatSynSig</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385224"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621681385227"><span class="hs-identifier hs-var">sig_ty</span></a></span><span>
</span><span id="line-198"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385224"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385224"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LIdP GhcRn]
</span><a href="#local-6989586621681385228"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TcPatSynInfo -&gt; TcSigInfo
</span><a href="GHC.Tc.Types.html#TcPatSynSig"><span class="hs-identifier hs-var">TcPatSynSig</span></a></span><span> </span><span class="annot"><span class="annottext">[TcPatSynInfo]
</span><a href="#local-6989586621681385226"><span class="hs-identifier hs-var">tpsigs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcTySig"><span class="hs-identifier hs-var">tcTySig</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier hs-type">tcUserTypeSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-205"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- A function or expression type signature</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- Returns a fully quantified type signature; even the wildcards</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- are quantified with ordinary skolems that should be instantiated</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- The SrcSpan is what to declare as the binding site of the</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- any skolems in the signature. For function signatures we</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- use the whole `f :: ty' signature; for expression signatures</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- just the type part.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- Just n  =&gt; Function type signature       name :: type</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Nothing =&gt; Expression type signature   &lt;expr&gt; :: type</span><span>
</span><span id="line-217"></span><span id="tcUserTypeSig"><span class="annot"><span class="annottext">tcUserTypeSig :: SrcSpan
-&gt; LHsSigWcType GhcRn
-&gt; Maybe Name
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcUserTypeSig"><span class="hs-identifier hs-var hs-var">tcUserTypeSig</span></a></span></span><span> </span><span id="local-6989586621681385223"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681385223"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681385222"><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385222"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span></span><span> </span><span id="local-6989586621681385221"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681385221"><span class="hs-identifier hs-var">mb_name</span></a></span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#isCompleteHsSig"><span class="hs-identifier hs-var">isCompleteHsSig</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385222"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681385220"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385220"><span class="hs-identifier hs-var">sigma_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; LHsSigWcType GhcRn -&gt; TcM Kind
</span><a href="GHC.Tc.Gen.HsType.html#tcHsSigWcType"><span class="hs-identifier hs-var">tcHsSigWcType</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385218"><span class="hs-identifier hs-var">ctxt_F</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385222"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span><span>
</span><span id="line-220"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcuser&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385220"><span class="hs-identifier hs-var">sigma_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-222"></span><span>         </span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcId
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Kind -&gt; Kind -&gt; TcId
</span><a href="GHC.Types.Id.html#mkLocalId"><span class="hs-identifier hs-var">mkLocalId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385215"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="GHC.Core.Type.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385220"><span class="hs-identifier hs-var">sigma_ty</span></a></span><span>
</span><span id="line-223"></span><span>                                   </span><span class="hs-comment">-- We use `Many' as the multiplicity here,</span><span>
</span><span id="line-224"></span><span>                                   </span><span class="hs-comment">-- as if this identifier corresponds to</span><span>
</span><span id="line-225"></span><span>                                   </span><span class="hs-comment">-- anything, it is a top-level</span><span>
</span><span id="line-226"></span><span>                                   </span><span class="hs-comment">-- definition. Which are all unrestricted in</span><span>
</span><span id="line-227"></span><span>                                   </span><span class="hs-comment">-- the current implementation.</span><span>
</span><span id="line-228"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_ctxt :: UserTypeCtxt
</span><a href="GHC.Tc.Types.html#sig_ctxt"><span class="hs-identifier hs-var">sig_ctxt</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385212"><span class="hs-identifier hs-var">ctxt_T</span></a></span><span>
</span><span id="line-229"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681385223"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-230"></span><span>                       </span><span class="hs-comment">-- Location of the &lt;type&gt; in   f :: &lt;type&gt;</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- Partial sig with wildcards</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#PartialSig"><span class="hs-identifier hs-type">PartialSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psig_name :: Name
</span><a href="GHC.Tc.Types.html#psig_name"><span class="hs-identifier hs-var">psig_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385215"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">psig_hs_ty :: LHsSigWcType GhcRn
</span><a href="GHC.Tc.Types.html#psig_hs_ty"><span class="hs-identifier hs-var">psig_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681385222"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span><span>
</span><span id="line-235"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_ctxt :: UserTypeCtxt
</span><a href="GHC.Tc.Types.html#sig_ctxt"><span class="hs-identifier hs-var">sig_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385218"><span class="hs-identifier hs-var">ctxt_F</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681385223"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621681385215"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681385215"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681385221"><span class="hs-identifier hs-var">mb_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-238"></span><span>               </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681385209"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385209"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385209"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-239"></span><span>               </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Name
</span><a href="GHC.Builtin.Names.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#mkVarOcc"><span class="hs-identifier hs-var">mkVarOcc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;expression&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621681385218"><span class="annot"><span class="annottext">ctxt_F :: UserTypeCtxt
</span><a href="#local-6989586621681385218"><span class="hs-identifier hs-var hs-var">ctxt_F</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681385221"><span class="hs-identifier hs-var">mb_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>               </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681385207"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385207"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385207"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-242"></span><span>               </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621681385212"><span class="annot"><span class="annottext">ctxt_T :: UserTypeCtxt
</span><a href="#local-6989586621681385212"><span class="hs-identifier hs-var hs-var">ctxt_T</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681385221"><span class="hs-identifier hs-var">mb_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>               </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681385205"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385205"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385205"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-245"></span><span>               </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#ExprSigCtxt"><span class="hs-identifier hs-var">ExprSigCtxt</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#completeSigFromId"><span class="hs-identifier hs-type">completeSigFromId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- Used for instance methods and record selectors</span><span>
</span><span id="line-251"></span><span id="completeSigFromId"><span class="annot"><span class="annottext">completeSigFromId :: UserTypeCtxt -&gt; TcId -&gt; TcIdSigInfo
</span><a href="GHC.Tc.Gen.Sig.html#completeSigFromId"><span class="hs-identifier hs-var hs-var">completeSigFromId</span></a></span></span><span> </span><span id="local-6989586621681385204"><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385204"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681385203"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385203"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcId
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385203"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_ctxt :: UserTypeCtxt
</span><a href="GHC.Tc.Types.html#sig_ctxt"><span class="hs-identifier hs-var">sig_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385204"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-254"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385203"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#isCompleteHsSig"><span class="hs-identifier hs-type">isCompleteHsSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- ^ If there are no wildcards, return a LHsSigWcType</span><span>
</span><span id="line-258"></span><span id="isCompleteHsSig"><span class="annot"><span class="annottext">isCompleteHsSig :: LHsSigWcType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#isCompleteHsSig"><span class="hs-identifier hs-var hs-var">isCompleteHsSig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsWC"><span class="hs-identifier hs-type">HsWC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hswc_ext :: forall pass thing. HsWildCardBndrs pass thing -&gt; XHsWC pass thing
</span><a href="Language.Haskell.Syntax.Type.html#hswc_ext"><span class="hs-identifier hs-var">hswc_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385199"><span class="annot"><span class="annottext">XHsWC GhcRn (LHsSigType GhcRn)
</span><a href="#local-6989586621681385199"><span class="hs-identifier hs-var">wcs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hswc_body :: forall pass thing. HsWildCardBndrs pass thing -&gt; thing
</span><a href="Language.Haskell.Syntax.Type.html#hswc_body"><span class="hs-identifier hs-var">hswc_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385197"><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621681385197"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWC GhcRn (LHsSigType GhcRn)
</span><a href="#local-6989586621681385199"><span class="hs-identifier hs-var">wcs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_sig_ty"><span class="hs-identifier hs-var">no_anon_wc_sig_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621681385197"><span class="hs-identifier hs-var">hs_sig_ty</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_sig_ty"><span class="hs-identifier hs-type">no_anon_wc_sig_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-262"></span><span id="no_anon_wc_sig_ty"><span class="annot"><span class="annottext">no_anon_wc_sig_ty :: LHsSigType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_sig_ty"><span class="hs-identifier hs-var hs-var">no_anon_wc_sig_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSig"><span class="hs-identifier hs-type">HsSig</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sig_bndrs :: forall pass. HsSigType pass -&gt; HsOuterSigTyVarBndrs pass
</span><a href="Language.Haskell.Syntax.Type.html#sig_bndrs"><span class="hs-identifier hs-var">sig_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385191"><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcRn
</span><a href="#local-6989586621681385191"><span class="hs-identifier hs-var">outer_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_body :: forall pass. HsSigType pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Type.html#sig_body"><span class="hs-identifier hs-var">sig_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385189"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385189"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">forall flag. LHsTyVarBndr flag GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tvb"><span class="hs-identifier hs-var">no_anon_wc_tvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall flag (p :: Pass).
HsOuterTyVarBndrs flag (GhcPass p)
-&gt; [LHsTyVarBndr flag (NoGhcTc (GhcPass p))]
</span><a href="GHC.Hs.Type.html#hsOuterExplicitBndrs"><span class="hs-identifier hs-var">hsOuterExplicitBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcRn
</span><a href="#local-6989586621681385191"><span class="hs-identifier hs-var">outer_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_ty"><span class="hs-identifier hs-var">no_anon_wc_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385189"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_ty"><span class="hs-identifier hs-type">no_anon_wc_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-267"></span><span id="no_anon_wc_ty"><span class="annot"><span class="annottext">no_anon_wc_ty :: LHsType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_ty"><span class="hs-identifier hs-var hs-var">no_anon_wc_ty</span></a></span></span><span> </span><span id="local-6989586621681385184"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385184"><span class="hs-identifier hs-var">lty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385184"><span class="hs-identifier hs-var">lty</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621681385183"><span class="annot"><span class="annottext">go :: GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385181"><span class="annot"><span class="annottext">HsType GhcRn
</span><a href="#local-6989586621681385181"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsType GhcRn
</span><a href="#local-6989586621681385181"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsWildCardTy"><span class="hs-identifier hs-type">HsWildCardTy</span></a></span><span> </span><span class="annot"><span class="annottext">XWildCardTy GhcRn
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsAppTy"><span class="hs-identifier hs-type">HsAppTy</span></a></span><span> </span><span class="annot"><span class="annottext">XAppTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385178"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385178"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621681385177"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385177"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385178"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385177"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsAppKindTy"><span class="hs-identifier hs-type">HsAppKindTy</span></a></span><span> </span><span class="annot"><span class="annottext">XAppKindTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385175"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385175"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681385174"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385174"><span class="hs-identifier hs-var">ki</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385175"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385174"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsFunTy"><span class="hs-identifier hs-type">HsFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">XFunTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385172"><span class="annot"><span class="annottext">HsArrow GhcRn
</span><a href="#local-6989586621681385172"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681385171"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385171"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621681385170"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385170"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385171"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385170"><span class="hs-identifier hs-var">ty2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsArrow GhcRn -&gt; LHsType GhcRn
</span><a href="GHC.Hs.Type.html#arrowToHsType"><span class="hs-identifier hs-var">arrowToHsType</span></a></span><span> </span><span class="annot"><span class="annottext">HsArrow GhcRn
</span><a href="#local-6989586621681385172"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsListTy"><span class="hs-identifier hs-type">HsListTy</span></a></span><span> </span><span class="annot"><span class="annottext">XListTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385167"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385167"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385167"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsTupleTy"><span class="hs-identifier hs-type">HsTupleTy</span></a></span><span> </span><span class="annot"><span class="annottext">XTupleTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsTupleSort
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385165"><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385165"><span class="hs-identifier hs-var">tys</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385165"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSumTy"><span class="hs-identifier hs-type">HsSumTy</span></a></span><span> </span><span class="annot"><span class="annottext">XSumTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385162"><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385162"><span class="hs-identifier hs-var">tys</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385162"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsOpTy"><span class="hs-identifier hs-type">HsOpTy</span></a></span><span> </span><span class="annot"><span class="annottext">XOpTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385160"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385160"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385159"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385159"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385160"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385159"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsParTy"><span class="hs-identifier hs-type">HsParTy</span></a></span><span> </span><span class="annot"><span class="annottext">XParTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385157"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385157"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385157"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsIParamTy"><span class="hs-identifier hs-type">HsIParamTy</span></a></span><span> </span><span class="annot"><span class="annottext">XIParamTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">XRec GhcRn HsIPName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385155"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385155"><span class="hs-identifier hs-var">ty</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385155"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsKindSig"><span class="hs-identifier hs-type">HsKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">XKindSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385153"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385153"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681385152"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385152"><span class="hs-identifier hs-var">kind</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385153"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385152"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsDocTy"><span class="hs-identifier hs-type">HsDocTy</span></a></span><span> </span><span class="annot"><span class="annottext">XDocTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385150"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385150"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsDocString
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385150"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsBangTy"><span class="hs-identifier hs-type">HsBangTy</span></a></span><span> </span><span class="annot"><span class="annottext">XBangTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsSrcBang
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385148"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385148"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385148"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsRecTy"><span class="hs-identifier hs-type">HsRecTy</span></a></span><span> </span><span class="annot"><span class="annottext">XRecTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385146"><span class="annot"><span class="annottext">[LConDeclField GhcRn]
</span><a href="#local-6989586621681385146"><span class="hs-identifier hs-var">flds</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ConDeclField pass -&gt; LBangType pass
</span><a href="Language.Haskell.Syntax.Type.html#cd_fld_type"><span class="hs-identifier hs-var">cd_fld_type</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LConDeclField GhcRn]
</span><a href="#local-6989586621681385146"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsExplicitListTy"><span class="hs-identifier hs-type">HsExplicitListTy</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitListTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PromotionFlag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385141"><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385141"><span class="hs-identifier hs-var">tys</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385141"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsExplicitTupleTy"><span class="hs-identifier hs-type">HsExplicitTupleTy</span></a></span><span> </span><span class="annot"><span class="annottext">XExplicitTupleTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385139"><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385139"><span class="hs-identifier hs-var">tys</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsType GhcRn]
</span><a href="#local-6989586621681385139"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsForAllTy"><span class="hs-identifier hs-type">HsForAllTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hst_tele :: forall pass. HsType pass -&gt; HsForAllTelescope pass
</span><a href="Language.Haskell.Syntax.Type.html#hst_tele"><span class="hs-identifier hs-var">hst_tele</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385136"><span class="annot"><span class="annottext">HsForAllTelescope GhcRn
</span><a href="#local-6989586621681385136"><span class="hs-identifier hs-var">tele</span></a></span></span><span>
</span><span id="line-287"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hst_body :: forall pass. HsType pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Type.html#hst_body"><span class="hs-identifier hs-var">hst_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385134"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385134"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsForAllTelescope GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tele"><span class="hs-identifier hs-var">no_anon_wc_tele</span></a></span><span> </span><span class="annot"><span class="annottext">HsForAllTelescope GhcRn
</span><a href="#local-6989586621681385136"><span class="hs-identifier hs-var">tele</span></a></span><span>
</span><span id="line-288"></span><span>                                        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385134"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsQualTy"><span class="hs-identifier hs-type">HsQualTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hst_ctxt :: forall pass. HsType pass -&gt; Maybe (LHsContext pass)
</span><a href="Language.Haskell.Syntax.Type.html#hst_ctxt"><span class="hs-identifier hs-var">hst_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385130"><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385130"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-290"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hst_body :: forall pass. HsType pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Type.html#hst_body"><span class="hs-identifier hs-var">hst_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385129"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385129"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var">gos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass).
Maybe (LHsContext (GhcPass p)) -&gt; HsContext (GhcPass p)
</span><a href="GHC.Hs.Type.html#fromMaybeContext"><span class="hs-identifier hs-var">fromMaybeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385130"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385129"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSpliceTy"><span class="hs-identifier hs-type">HsSpliceTy</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliceTy GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsSpliced"><span class="hs-identifier hs-type">HsSpliced</span></a></span><span> </span><span class="annot"><span class="annottext">XSpliced GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ThModFinalizers
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsSplicedTy"><span class="hs-identifier hs-type">HsSplicedTy</span></a></span><span> </span><span id="local-6989586621681385124"><span class="annot"><span class="annottext">HsType GhcRn
</span><a href="#local-6989586621681385124"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#noSrcSpanA"><span class="hs-identifier hs-var">noSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">HsType GhcRn
</span><a href="#local-6989586621681385124"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSpliceTy"><span class="hs-identifier hs-type">HsSpliceTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsTyLit"><span class="hs-identifier hs-type">HsTyLit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsTyVar"><span class="hs-identifier hs-type">HsTyVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsStarTy"><span class="hs-identifier hs-type">HsStarTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#XHsType"><span class="hs-identifier hs-type">XHsType</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>       </span><span class="hs-comment">-- HsCoreTy, which does not have any wildcard</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621681385164"><span class="annot"><span class="annottext">gos :: [GenLocated SrcSpanAnnA (HsType GhcRn)] -&gt; Bool
</span><a href="#local-6989586621681385164"><span class="hs-identifier hs-var hs-var">gos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsType GhcRn) -&gt; Bool
</span><a href="#local-6989586621681385183"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tele"><span class="hs-identifier hs-type">no_anon_wc_tele</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsForAllTelescope"><span class="hs-identifier hs-type">HsForAllTelescope</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-301"></span><span id="no_anon_wc_tele"><span class="annot"><span class="annottext">no_anon_wc_tele :: HsForAllTelescope GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tele"><span class="hs-identifier hs-var hs-var">no_anon_wc_tele</span></a></span></span><span> </span><span id="local-6989586621681385118"><span class="annot"><span class="annottext">HsForAllTelescope GhcRn
</span><a href="#local-6989586621681385118"><span class="hs-identifier hs-var">tele</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsForAllTelescope GhcRn
</span><a href="#local-6989586621681385118"><span class="hs-identifier hs-var">tele</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsForAllVis"><span class="hs-identifier hs-type">HsForAllVis</span></a></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hsf_vis_bndrs :: forall pass. HsForAllTelescope pass -&gt; [LHsTyVarBndr () pass]
</span><a href="Language.Haskell.Syntax.Type.html#hsf_vis_bndrs"><span class="hs-identifier hs-var">hsf_vis_bndrs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385115"><span class="annot"><span class="annottext">[LHsTyVarBndr () GhcRn]
</span><a href="#local-6989586621681385115"><span class="hs-identifier hs-var">ltvs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">forall flag. LHsTyVarBndr flag GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tvb"><span class="hs-identifier hs-var">no_anon_wc_tvb</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTyVarBndr () GhcRn]
</span><a href="#local-6989586621681385115"><span class="hs-identifier hs-var">ltvs</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsForAllInvis"><span class="hs-identifier hs-type">HsForAllInvis</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hsf_invis_bndrs :: forall pass.
HsForAllTelescope pass -&gt; [LHsTyVarBndr Specificity pass]
</span><a href="Language.Haskell.Syntax.Type.html#hsf_invis_bndrs"><span class="hs-identifier hs-var">hsf_invis_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385112"><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcRn]
</span><a href="#local-6989586621681385112"><span class="hs-identifier hs-var">ltvs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">forall flag. LHsTyVarBndr flag GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tvb"><span class="hs-identifier hs-var">no_anon_wc_tvb</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcRn]
</span><a href="#local-6989586621681385112"><span class="hs-identifier hs-var">ltvs</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621681385650"><span class="annot"><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tvb"><span class="hs-identifier hs-type">no_anon_wc_tvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681385650"><span class="hs-identifier hs-type">flag</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-306"></span><span id="no_anon_wc_tvb"><span class="annot"><span class="annottext">no_anon_wc_tvb :: forall flag. LHsTyVarBndr flag GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_tvb"><span class="hs-identifier hs-var hs-var">no_anon_wc_tvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385111"><span class="annot"><span class="annottext">HsTyVarBndr flag GhcRn
</span><a href="#local-6989586621681385111"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsTyVarBndr flag GhcRn
</span><a href="#local-6989586621681385111"><span class="hs-identifier hs-var">tvb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#UserTyVar"><span class="hs-identifier hs-type">UserTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">XUserTyVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#KindedTyVar"><span class="hs-identifier hs-type">KindedTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">XKindedTyVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">flag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681385108"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385108"><span class="hs-identifier hs-var">ki</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn -&gt; Bool
</span><a href="GHC.Tc.Gen.Sig.html#no_anon_wc_ty"><span class="hs-identifier hs-var">no_anon_wc_ty</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385108"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">{- Note [Fail eagerly on bad signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If a type signature is wrong, fail immediately:

 * the type sigs may bind type variables, so proceeding without them
   can lead to a cascade of errors

 * the type signature might be ambiguous, in which case checking
   the code against the signature will give a very similar error
   to the ambiguity error.

ToDo: this means we fall over if any top-level type signature in the
module is wrong, because we typecheck all the signatures together
(see GHC.Tc.Gen.Bind.tcValBinds).  Moreover, because of top-level
captureTopConstraints, only insoluble constraints will be reported.
We typecheck all signatures at the same time because a signature
like   f,g :: blah   might have f and g from different SCCs.

So it's a bit awkward to get better error recovery, and no one
has complained!
-}</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
        Type checking a pattern synonym signature
*                                                                      *
************************************************************************

Note [Pattern synonym signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Pattern synonym signatures are surprisingly tricky (see #11224 for example).
In general they look like this:

   pattern P :: forall univ_tvs. req_theta
             =&gt; forall ex_tvs. prov_theta
             =&gt; arg1 -&gt; .. -&gt; argn -&gt; res_ty

For parsing and renaming we treat the signature as an ordinary LHsSigType.

Once we get to type checking, we decompose it into its parts, in tcPatSynSig.

* Note that 'forall univ_tvs' and 'req_theta =&gt;'
        and 'forall ex_tvs'   and 'prov_theta =&gt;'
  are all optional.  We gather the pieces at the top of tcPatSynSig

* Initially the implicitly-bound tyvars (added by the renamer) include both
  universal and existential vars.

* After we kind-check the pieces and convert to Types, we do kind generalisation.

Note [Report unsolved equalities in tcPatSynSig]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's important that we solve /all/ the equalities in a pattern
synonym signature, because we are going to zonk the signature to
a Type (not a TcType), in GHC.Tc.TyCl.PatSyn.tc_patsyn_finish, and that
fails if there are un-filled-in coercion variables mentioned
in the type (#15694).

So we solve all the equalities we can, and report any unsolved ones,
rather than leaving them in the ambient constraints to be solved
later.  Pattern synonyms are top-level, so there's no problem with
completely solving them.
-}</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcPatSynSig"><span class="hs-identifier hs-type">tcPatSynSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- See Note [Pattern synonym signatures]</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- See Note [Recipe for checking a signature] in GHC.Tc.Gen.HsType</span><span>
</span><span id="line-377"></span><span id="tcPatSynSig"><span class="annot"><span class="annottext">tcPatSynSig :: Name
-&gt; LHsSigType GhcRn -&gt; IOEnv (Env TcGblEnv TcLclEnv) TcPatSynInfo
</span><a href="GHC.Tc.Gen.Sig.html#tcPatSynSig"><span class="hs-identifier hs-var hs-var">tcPatSynSig</span></a></span></span><span> </span><span id="local-6989586621681385107"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385107"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681385106"><span class="annot"><span class="annottext">sig_ty :: LHsSigType GhcRn
</span><a href="#local-6989586621681385106"><span class="hs-identifier hs-var">sig_ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsSig"><span class="hs-identifier hs-type">HsSig</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">sig_bndrs :: forall pass. HsSigType pass -&gt; HsOuterSigTyVarBndrs pass
</span><a href="Language.Haskell.Syntax.Type.html#sig_bndrs"><span class="hs-identifier hs-var">sig_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385105"><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcRn
</span><a href="#local-6989586621681385105"><span class="hs-identifier hs-var">hs_outer_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_body :: forall pass. HsSigType pass -&gt; LHsType pass
</span><a href="Language.Haskell.Syntax.Type.html#sig_body"><span class="hs-identifier hs-var">sig_body</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385104"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385104"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385103"><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385103"><span class="hs-identifier hs-var">hs_req</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385102"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385102"><span class="hs-identifier hs-var">hs_ty1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (pass :: Pass).
LHsType (GhcPass pass)
-&gt; (Maybe (LHsContext (GhcPass pass)), LHsType (GhcPass pass))
</span><a href="GHC.Hs.Type.html#splitLHsQualTy"><span class="hs-identifier hs-var">splitLHsQualTy</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385104"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385100"><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcRn]
</span><a href="#local-6989586621681385100"><span class="hs-identifier hs-var">ex_hs_tvbndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385099"><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385099"><span class="hs-identifier hs-var">hs_prov</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385098"><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385098"><span class="hs-identifier hs-var">hs_body_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass).
LHsType (GhcPass p)
-&gt; ([LHsTyVarBndr Specificity (GhcPass p)],
    Maybe (LHsContext (GhcPass p)), LHsType (GhcPass p))
</span><a href="GHC.Hs.Type.html#splitLHsSigmaTyInvis"><span class="hs-identifier hs-var">splitLHsSigmaTyInvis</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385102"><span class="hs-identifier hs-var">hs_ty1</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcPatSynSig 1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcRn
</span><a href="#local-6989586621681385106"><span class="hs-identifier hs-var">sig_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681385096"><span class="annot"><span class="annottext">skol_info :: SkolemInfo
</span><a href="#local-6989586621681385096"><span class="hs-identifier hs-var hs-var">skol_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SkolemInfo
</span><a href="GHC.Tc.Types.Origin.html#DataConSkol"><span class="hs-identifier hs-var">DataConSkol</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385107"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-383"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385094"><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681385094"><span class="hs-identifier hs-var">tclvl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385093"><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621681385093"><span class="hs-identifier hs-var">wanted</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385092"><span class="annot"><span class="annottext">HsOuterTyVarBndrs Specificity GhcTc
</span><a href="#local-6989586621681385092"><span class="hs-identifier hs-var">outer_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385091"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385091"><span class="hs-identifier hs-var">ex_bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385090"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385090"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385089"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385089"><span class="hs-identifier hs-var">prov</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385088"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385088"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; TcM a -&gt; TcM (TcLevel, WantedConstraints, a)
</span><a href="GHC.Tc.Solver.html#pushLevelAndSolveEqualitiesX"><span class="hs-identifier hs-var">pushLevelAndSolveEqualitiesX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcPatSynSig&quot;</span></span><span>           </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-385"></span><span>                     </span><span class="hs-comment">-- See Note [solveEqualities in tcPatSynSig]</span><span>
</span><span id="line-386"></span><span>              </span><span class="annot"><span class="annottext">forall flag a.
OutputableBndrFlag flag 'Renamed =&gt;
SkolemInfo
-&gt; HsOuterTyVarBndrs flag GhcRn
-&gt; TcM a
-&gt; TcM (HsOuterTyVarBndrs flag GhcTc, a)
</span><a href="GHC.Tc.Gen.HsType.html#tcOuterTKBndrs"><span class="hs-identifier hs-var">tcOuterTKBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681385096"><span class="hs-identifier hs-var">skol_info</span></a></span><span> </span><span class="annot"><span class="annottext">HsOuterSigTyVarBndrs GhcRn
</span><a href="#local-6989586621681385105"><span class="hs-identifier hs-var">hs_outer_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-387"></span><span>              </span><span class="annot"><span class="annottext">forall flag a.
OutputableBndrFlag flag 'Renamed =&gt;
[LHsTyVarBndr flag GhcRn] -&gt; TcM a -&gt; TcM ([VarBndr TcId flag], a)
</span><a href="GHC.Tc.Gen.HsType.html#tcExplicitTKBndrs"><span class="hs-identifier hs-var">tcExplicitTKBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsTyVarBndr Specificity GhcRn]
</span><a href="#local-6989586621681385100"><span class="hs-identifier hs-var">ex_hs_tvbndrs</span></a></span><span>         </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-388"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681385085"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385085"><span class="hs-identifier hs-var">req</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn) -&gt; TcM [Kind]
</span><a href="GHC.Tc.Gen.HsType.html#tcHsContext"><span class="hs-identifier hs-var">tcHsContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385103"><span class="hs-identifier hs-var">hs_req</span></a></span><span>
</span><span id="line-389"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385083"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385083"><span class="hs-identifier hs-var">prov</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn) -&gt; TcM [Kind]
</span><a href="GHC.Tc.Gen.HsType.html#tcHsContext"><span class="hs-identifier hs-var">tcHsContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsContext GhcRn)
</span><a href="#local-6989586621681385099"><span class="hs-identifier hs-var">hs_prov</span></a></span><span>
</span><span id="line-390"></span><span>                 </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385082"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385082"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn -&gt; TcM Kind
</span><a href="GHC.Tc.Gen.HsType.html#tcHsOpenType"><span class="hs-identifier hs-var">tcHsOpenType</span></a></span><span> </span><span class="annot"><span class="annottext">LHsType GhcRn
</span><a href="#local-6989586621681385098"><span class="hs-identifier hs-var">hs_body_ty</span></a></span><span>
</span><span id="line-391"></span><span>                     </span><span class="hs-comment">-- A (literal) pattern can be unlifted;</span><span>
</span><span id="line-392"></span><span>                     </span><span class="hs-comment">-- e.g. pattern Zero &lt;- 0#   (#12094)</span><span>
</span><span id="line-393"></span><span>                 </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385085"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385083"><span class="hs-identifier hs-var">prov</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385082"><span class="hs-identifier hs-var">body_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681385080"><span class="hs-identifier hs-type">implicit_tvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>             </span><span class="annot"><a href="#local-6989586621681385078"><span class="hs-identifier hs-type">univ_bndrs</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcInvisTVBinder"><span class="hs-identifier hs-type">TcInvisTVBinder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621681385080"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385080"><span class="hs-identifier hs-var">implicit_tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385078"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385078"><span class="hs-identifier hs-var">univ_bndrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsOuterTyVarBndrs Specificity GhcTc
</span><a href="#local-6989586621681385092"><span class="hs-identifier hs-var">outer_bndrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>               </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsOuterImplicit"><span class="hs-identifier hs-type">HsOuterImplicit</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">hso_ximplicit :: forall flag pass.
HsOuterTyVarBndrs flag pass -&gt; XHsOuterImplicit pass
</span><a href="Language.Haskell.Syntax.Type.html#hso_ximplicit"><span class="hs-identifier hs-var">hso_ximplicit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385074"><span class="annot"><span class="annottext">XHsOuterImplicit GhcTc
</span><a href="#local-6989586621681385074"><span class="hs-identifier hs-var">implicit_tvs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsOuterImplicit GhcTc
</span><a href="#local-6989586621681385074"><span class="hs-identifier hs-var">implicit_tvs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>               </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#HsOuterExplicit"><span class="hs-identifier hs-type">HsOuterExplicit</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">hso_xexplicit :: forall flag pass.
HsOuterTyVarBndrs flag pass -&gt; XHsOuterExplicit pass flag
</span><a href="Language.Haskell.Syntax.Type.html#hso_xexplicit"><span class="hs-identifier hs-var">hso_xexplicit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385071"><span class="annot"><span class="annottext">XHsOuterExplicit GhcTc Specificity
</span><a href="#local-6989586621681385071"><span class="hs-identifier hs-var">univ_bndrs</span></a></span></span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XHsOuterExplicit GhcTc Specificity
</span><a href="#local-6989586621681385071"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385070"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385070"><span class="hs-identifier hs-var">implicit_tvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; TcM [TcId]
</span><a href="GHC.Tc.Gen.HsType.html#zonkAndScopedSort"><span class="hs-identifier hs-var">zonkAndScopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385080"><span class="hs-identifier hs-var">implicit_tvs</span></a></span><span>
</span><span id="line-402"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681385068"><span class="annot"><span class="annottext">implicit_bndrs :: [VarBndr TcId Specificity]
</span><a href="#local-6989586621681385068"><span class="hs-identifier hs-var hs-var">implicit_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall vis. vis -&gt; [TcId] -&gt; [VarBndr TcId vis]
</span><a href="GHC.Types.Var.html#mkTyVarBinders"><span class="hs-identifier hs-var">mkTyVarBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="GHC.Types.Var.html#SpecifiedSpec"><span class="hs-identifier hs-var">SpecifiedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385070"><span class="hs-identifier hs-var">implicit_tvs</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>       </span><span class="hs-comment">-- Kind generalisation</span><span>
</span><span id="line-405"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681385066"><span class="annot"><span class="annottext">ungen_patsyn_ty :: Kind
</span><a href="#local-6989586621681385066"><span class="hs-identifier hs-var hs-var">ungen_patsyn_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; Kind
-&gt; Kind
</span><a href="#local-6989586621681385065"><span class="hs-identifier hs-var">build_patsyn_type</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385068"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385078"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span>
</span><span id="line-406"></span><span>                                                 </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385090"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385091"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385089"><span class="hs-identifier hs-var">prov</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385088"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-407"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcPatSynSig&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385066"><span class="hs-identifier hs-var">ungen_patsyn_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385064"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385064"><span class="hs-identifier hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; TcM [TcId]
</span><a href="GHC.Tc.Gen.HsType.html#kindGeneralizeAll"><span class="hs-identifier hs-var">kindGeneralizeAll</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385066"><span class="hs-identifier hs-var">ungen_patsyn_ty</span></a></span><span>
</span><span id="line-409"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">SkolemInfo -&gt; [TcId] -&gt; TcLevel -&gt; WantedConstraints -&gt; TcRn ()
</span><a href="GHC.Tc.Solver.html#reportUnsolvedEqualities"><span class="hs-identifier hs-var">reportUnsolvedEqualities</span></a></span><span> </span><span class="annot"><span class="annottext">SkolemInfo
</span><a href="#local-6989586621681385096"><span class="hs-identifier hs-var">skol_info</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385064"><span class="hs-identifier hs-var">kvs</span></a></span><span> </span><span class="annot"><span class="annottext">TcLevel
</span><a href="#local-6989586621681385094"><span class="hs-identifier hs-var">tclvl</span></a></span><span> </span><span class="annot"><span class="annottext">WantedConstraints
</span><a href="#local-6989586621681385093"><span class="hs-identifier hs-var">wanted</span></a></span><span>
</span><span id="line-410"></span><span>               </span><span class="hs-comment">-- See Note [Report unsolved equalities in tcPatSynSig]</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>       </span><span class="hs-comment">-- These are /signatures/ so we zonk to squeeze out any kind</span><span>
</span><span id="line-413"></span><span>       </span><span class="hs-comment">-- unification variables.  Do this after kindGeneralizeAll which may</span><span>
</span><span id="line-414"></span><span>       </span><span class="hs-comment">-- default kind variables to *.</span><span>
</span><span id="line-415"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385062"><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385062"><span class="hs-identifier hs-var">ze</span></a></span></span><span>                   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkFlexi -&gt; TcM ZonkEnv
</span><a href="GHC.Tc.Utils.Zonk.html#mkEmptyZonkEnv"><span class="hs-identifier hs-var">mkEmptyZonkEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ZonkFlexi
</span><a href="GHC.Tc.Utils.Zonk.html#NoFlexi"><span class="hs-identifier hs-var">NoFlexi</span></a></span><span>
</span><span id="line-416"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385059"><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385059"><span class="hs-identifier hs-var">ze</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385058"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385058"><span class="hs-identifier hs-var">kv_bndrs</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall vis.
ZonkEnv -&gt; [VarBndr TcId vis] -&gt; TcM (ZonkEnv, [VarBndr TcId vis])
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTyVarBindersX"><span class="hs-identifier hs-var">zonkTyVarBindersX</span></a></span><span>   </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385062"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall vis. vis -&gt; [TcId] -&gt; [VarBndr TcId vis]
</span><a href="GHC.Types.Var.html#mkTyVarBinders"><span class="hs-identifier hs-var">mkTyVarBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Specificity
</span><a href="GHC.Types.Var.html#InferredSpec"><span class="hs-identifier hs-var">InferredSpec</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385064"><span class="hs-identifier hs-var">kvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385055"><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385055"><span class="hs-identifier hs-var">ze</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385054"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385054"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall vis.
ZonkEnv -&gt; [VarBndr TcId vis] -&gt; TcM (ZonkEnv, [VarBndr TcId vis])
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTyVarBindersX"><span class="hs-identifier hs-var">zonkTyVarBindersX</span></a></span><span>   </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385059"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385068"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span>
</span><span id="line-418"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385053"><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385053"><span class="hs-identifier hs-var">ze</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385052"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385052"><span class="hs-identifier hs-var">univ_bndrs</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall vis.
ZonkEnv -&gt; [VarBndr TcId vis] -&gt; TcM (ZonkEnv, [VarBndr TcId vis])
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTyVarBindersX"><span class="hs-identifier hs-var">zonkTyVarBindersX</span></a></span><span>   </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385055"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385078"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span>
</span><span id="line-419"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385051"><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385051"><span class="hs-identifier hs-var">ze</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385050"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385050"><span class="hs-identifier hs-var">ex_bndrs</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall vis.
ZonkEnv -&gt; [VarBndr TcId vis] -&gt; TcM (ZonkEnv, [VarBndr TcId vis])
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTyVarBindersX"><span class="hs-identifier hs-var">zonkTyVarBindersX</span></a></span><span>   </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385053"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385091"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span>
</span><span id="line-420"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385049"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385049"><span class="hs-identifier hs-var">req</span></a></span></span><span>                  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkEnv -&gt; [Kind] -&gt; TcM [Kind]
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTcTypesToTypesX"><span class="hs-identifier hs-var">zonkTcTypesToTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385051"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385090"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-421"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385047"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385047"><span class="hs-identifier hs-var">prov</span></a></span></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkEnv -&gt; [Kind] -&gt; TcM [Kind]
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTcTypesToTypesX"><span class="hs-identifier hs-var">zonkTcTypesToTypesX</span></a></span><span> </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385051"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385089"><span class="hs-identifier hs-var">prov</span></a></span><span>
</span><span id="line-422"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681385046"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385046"><span class="hs-identifier hs-var">body_ty</span></a></span></span><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ZonkEnv -&gt; Kind -&gt; TcM Kind
</span><a href="GHC.Tc.Utils.Zonk.html#zonkTcTypeToTypeX"><span class="hs-identifier hs-var">zonkTcTypeToTypeX</span></a></span><span>   </span><span class="annot"><span class="annottext">ZonkEnv
</span><a href="#local-6989586621681385051"><span class="hs-identifier hs-var">ze</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385088"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>       </span><span class="hs-comment">-- Now do validity checking</span><span>
</span><span id="line-425"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; Kind -&gt; TcRn ()
</span><a href="GHC.Tc.Validity.html#checkValidType"><span class="hs-identifier hs-var">checkValidType</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681385044"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-426"></span><span>         </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; Kind
-&gt; Kind
</span><a href="#local-6989586621681385065"><span class="hs-identifier hs-var">build_patsyn_type</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385054"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385052"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385049"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385050"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385047"><span class="hs-identifier hs-var">prov</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385046"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>       </span><span class="hs-comment">-- arguments become the types of binders. We thus cannot allow</span><span>
</span><span id="line-429"></span><span>       </span><span class="hs-comment">-- levity polymorphism here</span><span>
</span><span id="line-430"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385043"><span class="annot"><span class="annottext">[Scaled Kind]
</span><a href="#local-6989586621681385043"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; ([Scaled Kind], Kind)
</span><a href="GHC.Tc.Utils.TcType.html#tcSplitFunTys"><span class="hs-identifier hs-var">tcSplitFunTys</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385046"><span class="hs-identifier hs-var">body_ty</span></a></span><span>
</span><span id="line-431"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; Kind -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.TcMType.html#checkForLevPoly"><span class="hs-identifier hs-var">checkForLevPoly</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Kind]
</span><a href="#local-6989586621681385043"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcTySig }&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-434"></span><span>         </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kvs&quot;</span></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385058"><span class="hs-identifier hs-var">kv_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;implicit_tvs&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385054"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;univ_tvs&quot;</span></span><span>     </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385052"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;req&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385049"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-438"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ex_tvs&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TcId] -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tv argf. [VarBndr tv argf] -&gt; [tv]
</span><a href="GHC.Types.Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385050"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;prov&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385047"><span class="hs-identifier hs-var">prov</span></a></span><span>
</span><span id="line-440"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;body_ty&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385046"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-441"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TPSI"><span class="hs-identifier hs-type">TPSI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">patsig_name :: Name
</span><a href="GHC.Tc.Types.html#patsig_name"><span class="hs-identifier hs-var">patsig_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385107"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-442"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_implicit_bndrs :: [VarBndr TcId Specificity]
</span><a href="GHC.Tc.Types.html#patsig_implicit_bndrs"><span class="hs-identifier hs-var">patsig_implicit_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385058"><span class="hs-identifier hs-var">kv_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385054"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span>
</span><span id="line-443"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_univ_bndrs :: [VarBndr TcId Specificity]
</span><a href="GHC.Tc.Types.html#patsig_univ_bndrs"><span class="hs-identifier hs-var">patsig_univ_bndrs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385052"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span>
</span><span id="line-444"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_req :: [Kind]
</span><a href="GHC.Tc.Types.html#patsig_req"><span class="hs-identifier hs-var">patsig_req</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385049"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-445"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_ex_bndrs :: [VarBndr TcId Specificity]
</span><a href="GHC.Tc.Types.html#patsig_ex_bndrs"><span class="hs-identifier hs-var">patsig_ex_bndrs</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385050"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span>
</span><span id="line-446"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_prov :: [Kind]
</span><a href="GHC.Tc.Types.html#patsig_prov"><span class="hs-identifier hs-var">patsig_prov</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385047"><span class="hs-identifier hs-var">prov</span></a></span><span>
</span><span id="line-447"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">patsig_body_ty :: Kind
</span><a href="GHC.Tc.Types.html#patsig_body_ty"><span class="hs-identifier hs-var">patsig_body_ty</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385046"><span class="hs-identifier hs-var">body_ty</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621681385044"><span class="annot"><span class="annottext">ctxt :: UserTypeCtxt
</span><a href="#local-6989586621681385044"><span class="hs-identifier hs-var hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#PatSynCtxt"><span class="hs-identifier hs-var">PatSynCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681385107"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>    </span><span id="local-6989586621681385065"><span class="annot"><span class="annottext">build_patsyn_type :: [VarBndr TcId Specificity]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; [VarBndr TcId Specificity]
-&gt; [Kind]
-&gt; Kind
-&gt; Kind
</span><a href="#local-6989586621681385065"><span class="hs-identifier hs-var hs-var">build_patsyn_type</span></a></span></span><span> </span><span id="local-6989586621681385025"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385025"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span></span><span> </span><span id="local-6989586621681385024"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385024"><span class="hs-identifier hs-var">univ_bndrs</span></a></span></span><span> </span><span id="local-6989586621681385023"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385023"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621681385022"><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385022"><span class="hs-identifier hs-var">ex_bndrs</span></a></span></span><span> </span><span id="local-6989586621681385021"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385021"><span class="hs-identifier hs-var">prov</span></a></span></span><span> </span><span id="local-6989586621681385020"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385020"><span class="hs-identifier hs-var">body</span></a></span></span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385025"><span class="hs-identifier hs-var">implicit_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385024"><span class="hs-identifier hs-var">univ_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Kind
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385023"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity] -&gt; Kind -&gt; Kind
</span><a href="GHC.Core.TyCo.Rep.html#mkInvisForAllTys"><span class="hs-identifier hs-var">mkInvisForAllTys</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBndr TcId Specificity]
</span><a href="#local-6989586621681385022"><span class="hs-identifier hs-var">ex_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="annottext">[Kind] -&gt; Kind -&gt; Kind
</span><a href="GHC.Tc.Utils.TcType.html#mkPhiTy"><span class="hs-identifier hs-var">mkPhiTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385021"><span class="hs-identifier hs-var">prov</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-457"></span><span>        </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385020"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-type">ppr_tvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-460"></span><span id="ppr_tvs"><span class="annot"><span class="annottext">ppr_tvs :: [TcId] -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#ppr_tvs"><span class="hs-identifier hs-var hs-var">ppr_tvs</span></a></span></span><span> </span><span id="local-6989586621681385017"><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385017"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385015"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Kind
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385015"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681385015"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385015"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TcId]
</span><a href="#local-6989586621681385017"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
               Instantiating user signatures
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier hs-type">tcInstSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcIdSigInst"><span class="hs-identifier hs-type">TcIdSigInst</span></a></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- Instantiate a type signature; only used with plan InferGen</span><span>
</span><span id="line-473"></span><span id="tcInstSig"><span class="annot"><span class="annottext">tcInstSig :: TcIdSigInfo -&gt; TcM TcIdSigInst
</span><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier hs-var hs-var">tcInstSig</span></a></span></span><span> </span><span id="local-6989586621681385013"><span class="annot"><span class="annottext">sig :: TcIdSigInfo
</span><a href="#local-6989586621681385013"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#CompleteSig"><span class="hs-identifier hs-type">CompleteSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_bndr :: TcIdSigInfo -&gt; TcId
</span><a href="GHC.Tc.Types.html#sig_bndr"><span class="hs-identifier hs-var">sig_bndr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385012"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385012"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681385011"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681385011"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681385011"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>  </span><span class="hs-comment">-- Set the binding site of the tyvars</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681385009"><span class="annot"><span class="annottext">[(Name, VarBndr TcId Specificity)]
</span><a href="#local-6989586621681385009"><span class="hs-identifier hs-var">tv_prs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385008"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385008"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681385007"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385007"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; TcM ([(Name, VarBndr TcId Specificity)], [Kind], Kind)
</span><a href="GHC.Tc.Utils.Instantiate.html#tcInstTypeBndrs"><span class="hs-identifier hs-var">tcInstTypeBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681385012"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-476"></span><span>              </span><span class="hs-comment">-- See Note [Pattern bindings and complete signatures]</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TISI"><span class="hs-identifier hs-type">TISI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_inst_sig :: TcIdSigInfo
</span><a href="GHC.Tc.Types.html#sig_inst_sig"><span class="hs-identifier hs-var">sig_inst_sig</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681385013"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-479"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_skols :: [(Name, VarBndr TcId Specificity)]
</span><a href="GHC.Tc.Types.html#sig_inst_skols"><span class="hs-identifier hs-var">sig_inst_skols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, VarBndr TcId Specificity)]
</span><a href="#local-6989586621681385009"><span class="hs-identifier hs-var">tv_prs</span></a></span><span>
</span><span id="line-480"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_wcs :: [(Name, TcId)]
</span><a href="GHC.Tc.Types.html#sig_inst_wcs"><span class="hs-identifier hs-var">sig_inst_wcs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_wcx :: Maybe Kind
</span><a href="GHC.Tc.Types.html#sig_inst_wcx"><span class="hs-identifier hs-var">sig_inst_wcx</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-482"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_theta :: [Kind]
</span><a href="GHC.Tc.Types.html#sig_inst_theta"><span class="hs-identifier hs-var">sig_inst_theta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681385008"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-483"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_tau :: Kind
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681385007"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcInstSig"><span class="hs-identifier hs-var">tcInstSig</span></a></span><span> </span><span id="local-6989586621681384999"><span class="annot"><span class="annottext">hs_sig :: TcIdSigInfo
</span><a href="#local-6989586621681384999"><span class="hs-identifier hs-var">hs_sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#PartialSig"><span class="hs-identifier hs-type">PartialSig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">psig_hs_ty :: TcIdSigInfo -&gt; LHsSigWcType GhcRn
</span><a href="GHC.Tc.Types.html#psig_hs_ty"><span class="hs-identifier hs-var">psig_hs_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384998"><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681384998"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>
</span><span id="line-486"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_ctxt :: TcIdSigInfo -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.html#sig_ctxt"><span class="hs-identifier hs-var">sig_ctxt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384997"><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681384997"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-487"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_loc :: TcIdSigInfo -&gt; SrcSpan
</span><a href="GHC.Tc.Types.html#sig_loc"><span class="hs-identifier hs-var">sig_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384996"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681384996"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681384996"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>  </span><span class="hs-comment">-- Set the binding site of the tyvars</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Staring partial sig {&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681384999"><span class="hs-identifier hs-var">hs_sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384995"><span class="annot"><span class="annottext">[(Name, TcId)]
</span><a href="#local-6989586621681384995"><span class="hs-identifier hs-var">wcs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384994"><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621681384994"><span class="hs-identifier hs-var">wcx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384993"><span class="annot"><span class="annottext">[(Name, VarBndr TcId Specificity)]
</span><a href="#local-6989586621681384993"><span class="hs-identifier hs-var">tv_prs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384992"><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681384992"><span class="hs-identifier hs-var">theta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384991"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384991"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
-&gt; LHsSigWcType GhcRn
-&gt; TcM
     ([(Name, TcId)], Maybe Kind, [(Name, VarBndr TcId Specificity)],
      [Kind], Kind)
</span><a href="GHC.Tc.Gen.HsType.html#tcHsPartialSigType"><span class="hs-identifier hs-var">tcHsPartialSigType</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681384997"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcRn
</span><a href="#local-6989586621681384998"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-491"></span><span>         </span><span class="hs-comment">-- See Note [Checking partial type signatures] in GHC.Tc.Gen.HsType</span><span>
</span><span id="line-492"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681384989"><span class="annot"><span class="annottext">inst_sig :: TcIdSigInst
</span><a href="#local-6989586621681384989"><span class="hs-identifier hs-var hs-var">inst_sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TISI"><span class="hs-identifier hs-type">TISI</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sig_inst_sig :: TcIdSigInfo
</span><a href="GHC.Tc.Types.html#sig_inst_sig"><span class="hs-identifier hs-var">sig_inst_sig</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcIdSigInfo
</span><a href="#local-6989586621681384999"><span class="hs-identifier hs-var">hs_sig</span></a></span><span>
</span><span id="line-493"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_skols :: [(Name, VarBndr TcId Specificity)]
</span><a href="GHC.Tc.Types.html#sig_inst_skols"><span class="hs-identifier hs-var">sig_inst_skols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, VarBndr TcId Specificity)]
</span><a href="#local-6989586621681384993"><span class="hs-identifier hs-var">tv_prs</span></a></span><span>
</span><span id="line-494"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_wcs :: [(Name, TcId)]
</span><a href="GHC.Tc.Types.html#sig_inst_wcs"><span class="hs-identifier hs-var">sig_inst_wcs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, TcId)]
</span><a href="#local-6989586621681384995"><span class="hs-identifier hs-var">wcs</span></a></span><span>
</span><span id="line-495"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_wcx :: Maybe Kind
</span><a href="GHC.Tc.Types.html#sig_inst_wcx"><span class="hs-identifier hs-var">sig_inst_wcx</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621681384994"><span class="hs-identifier hs-var">wcx</span></a></span><span>
</span><span id="line-496"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_theta :: [Kind]
</span><a href="GHC.Tc.Types.html#sig_inst_theta"><span class="hs-identifier hs-var">sig_inst_theta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Kind]
</span><a href="#local-6989586621681384992"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-497"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sig_inst_tau :: Kind
</span><a href="GHC.Tc.Types.html#sig_inst_tau"><span class="hs-identifier hs-var">sig_inst_tau</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384991"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-498"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;End partial sig }&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681384989"><span class="hs-identifier hs-var">inst_sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">TcIdSigInst
</span><a href="#local-6989586621681384989"><span class="hs-identifier hs-var">inst_sig</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">{- Note [Pattern bindings and complete signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
      data T a = MkT a a
      f :: forall a. a-&gt;a
      g :: forall b. b-&gt;b
      MkT f g = MkT (\x-&gt;x) (\y-&gt;y)
Here we'll infer a type from the pattern of 'T a', but if we feed in
the signature types for f and g, we'll end up unifying 'a' and 'b'

So we instantiate f and g's signature with TyVarTv skolems
(newMetaTyVarTyVars) that can unify with each other.  If too much
unification takes place, we'll find out when we do the final
impedance-matching check in GHC.Tc.Gen.Bind.mkExport

See Note [TyVarTv] in GHC.Tc.Utils.TcMType

None of this applies to a function binding with a complete
signature, which doesn't use tcInstSig.  See GHC.Tc.Gen.Bind.tcPolyCheck.
-}</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                   Pragmas and PragEnv
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-keyword">type</span><span> </span><span id="TcPragEnv"><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-var">TcPragEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#emptyPragEnv"><span class="hs-identifier hs-type">emptyPragEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-type">TcPragEnv</span></a></span><span>
</span><span id="line-532"></span><span id="emptyPragEnv"><span class="annot"><span class="annottext">emptyPragEnv :: TcPragEnv
</span><a href="GHC.Tc.Gen.Sig.html#emptyPragEnv"><span class="hs-identifier hs-var hs-var">emptyPragEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#lookupPragEnv"><span class="hs-identifier hs-type">lookupPragEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-type">TcPragEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-535"></span><span id="lookupPragEnv"><span class="annot"><span class="annottext">lookupPragEnv :: TcPragEnv -&gt; Name -&gt; [LSig GhcRn]
</span><a href="GHC.Tc.Gen.Sig.html#lookupPragEnv"><span class="hs-identifier hs-var hs-var">lookupPragEnv</span></a></span></span><span> </span><span id="local-6989586621681384987"><span class="annot"><span class="annottext">TcPragEnv
</span><a href="#local-6989586621681384987"><span class="hs-identifier hs-var">prag_fn</span></a></span></span><span> </span><span id="local-6989586621681384986"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384986"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TcPragEnv
</span><a href="#local-6989586621681384987"><span class="hs-identifier hs-var">prag_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384986"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#extendPragEnv"><span class="hs-identifier hs-type">extendPragEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-type">TcPragEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-type">TcPragEnv</span></a></span><span>
</span><span id="line-538"></span><span id="extendPragEnv"><span class="annot"><span class="annottext">extendPragEnv :: TcPragEnv -&gt; (Name, LSig GhcRn) -&gt; TcPragEnv
</span><a href="GHC.Tc.Gen.Sig.html#extendPragEnv"><span class="hs-identifier hs-var hs-var">extendPragEnv</span></a></span></span><span> </span><span id="local-6989586621681384985"><span class="annot"><span class="annottext">TcPragEnv
</span><a href="#local-6989586621681384985"><span class="hs-identifier hs-var">prag_fn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384984"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384984"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384983"><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384983"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt; NameEnv b -&gt; Name -&gt; a -&gt; NameEnv b
</span><a href="GHC.Types.Name.Env.html#extendNameEnv_Acc"><span class="hs-identifier hs-var">extendNameEnv_Acc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><a href="GHC.Utils.Misc.html#singleton"><span class="hs-identifier hs-var">Utils.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">TcPragEnv
</span><a href="#local-6989586621681384985"><span class="hs-identifier hs-var">prag_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384984"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384983"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">---------------</span><span>
</span><span id="line-541"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#mkPragEnv"><span class="hs-identifier hs-type">mkPragEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#TcPragEnv"><span class="hs-identifier hs-type">TcPragEnv</span></a></span><span>
</span><span id="line-542"></span><span id="mkPragEnv"><span class="annot"><span class="annottext">mkPragEnv :: [LSig GhcRn] -&gt; LHsBinds GhcRn -&gt; TcPragEnv
</span><a href="GHC.Tc.Gen.Sig.html#mkPragEnv"><span class="hs-identifier hs-var hs-var">mkPragEnv</span></a></span></span><span> </span><span id="local-6989586621681384981"><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384981"><span class="hs-identifier hs-var">sigs</span></a></span></span><span> </span><span id="local-6989586621681384980"><span class="annot"><span class="annottext">LHsBinds GhcRn
</span><a href="#local-6989586621681384980"><span class="hs-identifier hs-var">binds</span></a></span></span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">TcPragEnv -&gt; (Name, LSig GhcRn) -&gt; TcPragEnv
</span><a href="GHC.Tc.Gen.Sig.html#extendPragEnv"><span class="hs-identifier hs-var">extendPragEnv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, GenLocated SrcSpanAnnA (Sig GhcRn))]
</span><a href="#local-6989586621681384978"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621681384978"><span class="annot"><span class="annottext">prs :: [(Name, GenLocated SrcSpanAnnA (Sig GhcRn))]
</span><a href="#local-6989586621681384978"><span class="hs-identifier hs-var hs-var">prs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/Data-Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn -&gt; Maybe (Name, LSig GhcRn)
</span><a href="#local-6989586621681384977"><span class="hs-identifier hs-var">get_sig</span></a></span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384981"><span class="hs-identifier hs-var">sigs</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="#local-6989586621681384977"><span class="hs-identifier hs-type">get_sig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621681384977"><span class="annot"><span class="annottext">get_sig :: LSig GhcRn -&gt; Maybe (Name, LSig GhcRn)
</span><a href="#local-6989586621681384977"><span class="hs-identifier hs-var hs-var">get_sig</span></a></span></span><span> </span><span id="local-6989586621681384976"><span class="annot"><span class="annottext">sig :: LSig GhcRn
</span><a href="#local-6989586621681384976"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#SpecSig"><span class="hs-identifier hs-type">SpecSig</span></a></span><span> </span><span class="annot"><span class="annottext">XSpecSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384974"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384974"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384974"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; GenLocated SrcSpanAnnA (Sig GhcRn)
-&gt; GenLocated SrcSpanAnnA (Sig GhcRn)
</span><a href="#local-6989586621681384973"><span class="hs-identifier hs-var">add_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384974"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384976"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="#local-6989586621681384977"><span class="hs-identifier hs-var">get_sig</span></a></span><span> </span><span id="local-6989586621681384972"><span class="annot"><span class="annottext">sig :: LSig GhcRn
</span><a href="#local-6989586621681384972"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#InlineSig"><span class="hs-identifier hs-type">InlineSig</span></a></span><span> </span><span class="annot"><span class="annottext">XInlineSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384970"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384970"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384970"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; GenLocated SrcSpanAnnA (Sig GhcRn)
-&gt; GenLocated SrcSpanAnnA (Sig GhcRn)
</span><a href="#local-6989586621681384973"><span class="hs-identifier hs-var">add_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384970"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384972"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="#local-6989586621681384977"><span class="hs-identifier hs-var">get_sig</span></a></span><span> </span><span id="local-6989586621681384969"><span class="annot"><span class="annottext">sig :: LSig GhcRn
</span><a href="#local-6989586621681384969"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#SCCFunSig"><span class="hs-identifier hs-type">SCCFunSig</span></a></span><span> </span><span class="annot"><span class="annottext">XSCCFunSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384967"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384967"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (XRec GhcRn StringLiteral)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384967"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384969"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="#local-6989586621681384977"><span class="hs-identifier hs-var">get_sig</span></a></span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621681384973"><span class="annot"><span class="annottext">add_arity :: Name -&gt; GenLocated SrcSpanAnnA (Sig GhcRn) -&gt; LSig GhcRn
</span><a href="#local-6989586621681384973"><span class="hs-identifier hs-var hs-var">add_arity</span></a></span></span><span> </span><span id="local-6989586621681384966"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384966"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681384965"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Sig GhcRn)
</span><a href="#local-6989586621681384965"><span class="hs-identifier hs-var">sig</span></a></span></span><span>  </span><span class="hs-comment">-- Adjust inl_sat field to match visible arity of function</span><span>
</span><span id="line-554"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Arity
</span><a href="#local-6989586621681384964"><span class="hs-identifier hs-var">ar_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384966"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-555"></span><span>          </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681384963"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384963"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Arity -&gt; LSig GhcRn -&gt; LSig GhcRn
</span><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier hs-var">addInlinePragArity</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384963"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Sig GhcRn)
</span><a href="#local-6989586621681384965"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-556"></span><span>          </span><span class="annot"><span class="annottext">Maybe Arity
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Sig GhcRn)
</span><a href="#local-6989586621681384965"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-comment">-- See Note [Pattern synonym inline arity]</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-comment">-- ar_env maps a local to the arity of its definition</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="#local-6989586621681384964"><span class="hs-identifier hs-type">ar_env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621681384964"><span class="annot"><span class="annottext">ar_env :: NameEnv Arity
</span><a href="#local-6989586621681384964"><span class="hs-identifier hs-var hs-var">ar_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBind GhcRn -&gt; NameEnv Arity -&gt; NameEnv Arity
</span><a href="GHC.Tc.Gen.Sig.html#lhsBindArity"><span class="hs-identifier hs-var">lhsBindArity</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBinds GhcRn
</span><a href="#local-6989586621681384980"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier hs-type">addInlinePragArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-563"></span><span id="addInlinePragArity"><span class="annot"><span class="annottext">addInlinePragArity :: Arity -&gt; LSig GhcRn -&gt; LSig GhcRn
</span><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier hs-var hs-var">addInlinePragArity</span></a></span></span><span> </span><span id="local-6989586621681384960"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384960"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384959"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384959"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#InlineSig"><span class="hs-identifier hs-type">InlineSig</span></a></span><span> </span><span id="local-6989586621681384958"><span class="annot"><span class="annottext">XInlineSig GhcRn
</span><a href="#local-6989586621681384958"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681384957"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384957"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621681384956"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384956"><span class="hs-identifier hs-var">inl</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384959"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XInlineSig pass -&gt; LIdP pass -&gt; InlinePragma -&gt; Sig pass
</span><a href="Language.Haskell.Syntax.Binds.html#InlineSig"><span class="hs-identifier hs-var">InlineSig</span></a></span><span> </span><span class="annot"><span class="annottext">XInlineSig GhcRn
</span><a href="#local-6989586621681384958"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384957"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arity -&gt; InlinePragma -&gt; InlinePragma
</span><a href="GHC.Tc.Gen.Sig.html#add_inl_arity"><span class="hs-identifier hs-var">add_inl_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384960"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384956"><span class="hs-identifier hs-var">inl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier hs-var">addInlinePragArity</span></a></span><span> </span><span id="local-6989586621681384954"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384954"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384953"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384953"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#SpecSig"><span class="hs-identifier hs-type">SpecSig</span></a></span><span> </span><span id="local-6989586621681384952"><span class="annot"><span class="annottext">XSpecSig GhcRn
</span><a href="#local-6989586621681384952"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681384951"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384951"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621681384950"><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><a href="#local-6989586621681384950"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681384949"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384949"><span class="hs-identifier hs-var">inl</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384953"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XSpecSig pass
-&gt; LIdP pass -&gt; [LHsSigType pass] -&gt; InlinePragma -&gt; Sig pass
</span><a href="Language.Haskell.Syntax.Binds.html#SpecSig"><span class="hs-identifier hs-var">SpecSig</span></a></span><span> </span><span class="annot"><span class="annottext">XSpecSig GhcRn
</span><a href="#local-6989586621681384952"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384951"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><a href="#local-6989586621681384950"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arity -&gt; InlinePragma -&gt; InlinePragma
</span><a href="GHC.Tc.Gen.Sig.html#add_inl_arity"><span class="hs-identifier hs-var">add_inl_arity</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384954"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384949"><span class="hs-identifier hs-var">inl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePragArity"><span class="hs-identifier hs-var">addInlinePragArity</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384948"><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384948"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSig GhcRn
</span><a href="#local-6989586621681384948"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#add_inl_arity"><span class="hs-identifier hs-type">add_inl_arity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#InlinePragma"><span class="hs-identifier hs-type">InlinePragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#InlinePragma"><span class="hs-identifier hs-type">InlinePragma</span></a></span><span>
</span><span id="line-568"></span><span id="add_inl_arity"><span class="annot"><span class="annottext">add_inl_arity :: Arity -&gt; InlinePragma -&gt; InlinePragma
</span><a href="GHC.Tc.Gen.Sig.html#add_inl_arity"><span class="hs-identifier hs-var hs-var">add_inl_arity</span></a></span></span><span> </span><span id="local-6989586621681384947"><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384947"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621681384946"><span class="annot"><span class="annottext">prag :: InlinePragma
</span><a href="#local-6989586621681384946"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Basic.html#InlinePragma"><span class="hs-identifier hs-type">InlinePragma</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">inl_inline :: InlinePragma -&gt; InlineSpec
</span><a href="GHC.Types.Basic.html#inl_inline"><span class="hs-identifier hs-var">inl_inline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384943"><span class="annot"><span class="annottext">InlineSpec
</span><a href="#local-6989586621681384943"><span class="hs-identifier hs-var">inl_spec</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InlineSpec
</span><a href="#local-6989586621681384943"><span class="hs-identifier hs-var">inl_spec</span></a></span><span>  </span><span class="hs-comment">-- Add arity only for real INLINE pragmas, not INLINABLE</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384946"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">inl_sat :: Maybe Arity
</span><a href="GHC.Types.Basic.html#inl_sat"><span class="hs-identifier hs-var">inl_sat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><a href="#local-6989586621681384947"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384946"><span class="hs-identifier hs-var">prag</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#lhsBindArity"><span class="hs-identifier hs-type">lhsBindArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LHsBind"><span class="hs-identifier hs-type">LHsBind</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span>
</span><span id="line-575"></span><span id="lhsBindArity"><span class="annot"><span class="annottext">lhsBindArity :: LHsBind GhcRn -&gt; NameEnv Arity -&gt; NameEnv Arity
</span><a href="GHC.Tc.Gen.Sig.html#lhsBindArity"><span class="hs-identifier hs-var hs-var">lhsBindArity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#FunBind"><span class="hs-identifier hs-type">FunBind</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="Language.Haskell.Syntax.Binds.html#fun_id"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384938"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384938"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fun_matches :: forall idL idR. HsBindLR idL idR -&gt; MatchGroup idR (LHsExpr idR)
</span><a href="Language.Haskell.Syntax.Binds.html#fun_matches"><span class="hs-identifier hs-var">fun_matches</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681384936"><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681384936"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681384935"><span class="annot"><span class="annottext">NameEnv Arity
</span><a href="#local-6989586621681384935"><span class="hs-identifier hs-var">env</span></a></span></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; a -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#extendNameEnv"><span class="hs-identifier hs-var">extendNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv Arity
</span><a href="#local-6989586621681384935"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384938"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (id :: Pass) body. MatchGroup (GhcPass id) body -&gt; Arity
</span><a href="GHC.Hs.Expr.html#matchGroupArity"><span class="hs-identifier hs-var">matchGroupArity</span></a></span><span> </span><span class="annot"><span class="annottext">MatchGroup GhcRn (LHsExpr GhcRn)
</span><a href="#local-6989586621681384936"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#lhsBindArity"><span class="hs-identifier hs-var">lhsBindArity</span></a></span><span> </span><span class="annot"><span class="annottext">LHsBind GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384932"><span class="annot"><span class="annottext">NameEnv Arity
</span><a href="#local-6989586621681384932"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameEnv Arity
</span><a href="#local-6989586621681384932"><span class="hs-identifier hs-var">env</span></a></span><span>        </span><span class="hs-comment">-- PatBind/VarBind</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="hs-comment">-----------------</span><span>
</span><span id="line-581"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#addInlinePrags"><span class="hs-identifier hs-type">addInlinePrags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span>
</span><span id="line-582"></span><span id="addInlinePrags"><span class="annot"><span class="annottext">addInlinePrags :: TcId -&gt; [LSig GhcRn] -&gt; TcM TcId
</span><a href="GHC.Tc.Gen.Sig.html#addInlinePrags"><span class="hs-identifier hs-var hs-var">addInlinePrags</span></a></span></span><span> </span><span id="local-6989586621681384931"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384931"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span> </span><span id="local-6989586621681384930"><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384930"><span class="hs-identifier hs-var">prags_for_me</span></a></span></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681384929"><span class="annot"><span class="annottext">inl :: GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384929"><span class="hs-identifier hs-var">inl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384928"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384928"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681384927"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384927"><span class="hs-identifier hs-var">inls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384926"><span class="hs-identifier hs-var">inl_prags</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addInlinePrag&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384931"><span class="hs-identifier hs-var">poly_id</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384928"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384927"><span class="hs-identifier hs-var">inls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
-&gt; [GenLocated SrcSpanAnnA InlinePragma] -&gt; TcRn ()
</span><a href="#local-6989586621681384924"><span class="hs-identifier hs-var">warn_multiple_inlines</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384929"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384927"><span class="hs-identifier hs-var">inls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384931"><span class="hs-identifier hs-var">poly_id</span></a></span><span> </span><span class="annot"><span class="annottext">TcId -&gt; InlinePragma -&gt; TcId
</span><a href="GHC.Types.Id.html#setInlinePragma"><span class="hs-operator hs-var">`setInlinePragma`</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384928"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384931"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621681384926"><span class="annot"><span class="annottext">inl_prags :: [GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384926"><span class="hs-identifier hs-var hs-var">inl_prags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384923"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384922"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384923"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384923"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#InlineSig"><span class="hs-identifier hs-type">InlineSig</span></a></span><span> </span><span class="annot"><span class="annottext">XInlineSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384922"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384922"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384930"><span class="hs-identifier hs-var">prags_for_me</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>    </span><span id="local-6989586621681384924"><span class="annot"><span class="annottext">warn_multiple_inlines :: GenLocated SrcSpanAnnA InlinePragma
-&gt; [GenLocated SrcSpanAnnA InlinePragma] -&gt; TcRn ()
</span><a href="#local-6989586621681384924"><span class="hs-identifier hs-var hs-var">warn_multiple_inlines</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="#local-6989586621681384924"><span class="hs-identifier hs-var">warn_multiple_inlines</span></a></span><span> </span><span id="local-6989586621681384921"><span class="annot"><span class="annottext">inl1 :: GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384921"><span class="hs-identifier hs-var">inl1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384920"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384920"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681384919"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384919"><span class="hs-identifier hs-var">prag1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384918"><span class="annot"><span class="annottext">inl2 :: GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384918"><span class="hs-identifier hs-var">inl2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384917"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384917"><span class="hs-identifier hs-var">prag2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681384916"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384916"><span class="hs-identifier hs-var">inls</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">InlinePragma -&gt; Activation
</span><a href="GHC.Types.Basic.html#inlinePragmaActivation"><span class="hs-identifier hs-var">inlinePragmaActivation</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384919"><span class="hs-identifier hs-var">prag1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">InlinePragma -&gt; Activation
</span><a href="GHC.Types.Basic.html#inlinePragmaActivation"><span class="hs-identifier hs-var">inlinePragmaActivation</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384917"><span class="hs-identifier hs-var">prag2</span></a></span><span>
</span><span id="line-596"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InlineSpec -&gt; Bool
</span><a href="GHC.Types.Basic.html#noUserInlineSpec"><span class="hs-identifier hs-var">noUserInlineSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InlinePragma -&gt; InlineSpec
</span><a href="GHC.Types.Basic.html#inlinePragmaSpec"><span class="hs-identifier hs-var">inlinePragmaSpec</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384919"><span class="hs-identifier hs-var">prag1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>       </span><span class="hs-glyph">=</span><span>    </span><span class="hs-comment">-- Tiresome: inl1 is put there by virtue of being in a hs-boot loop</span><span>
</span><span id="line-598"></span><span>            </span><span class="hs-comment">-- and inl2 is a user NOINLINE pragma; we don't want to complain</span><span>
</span><span id="line-599"></span><span>         </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
-&gt; [GenLocated SrcSpanAnnA InlinePragma] -&gt; TcRn ()
</span><a href="#local-6989586621681384924"><span class="hs-identifier hs-var">warn_multiple_inlines</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384918"><span class="hs-identifier hs-var">inl2</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384916"><span class="hs-identifier hs-var">inls</span></a></span><span>
</span><span id="line-600"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-601"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann a. SrcSpanAnn' ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384920"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-602"></span><span>         </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnTc"><span class="hs-identifier hs-var">addWarnTc</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.Flags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a></span><span>
</span><span id="line-603"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; Arity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiple INLINE pragmas for&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384931"><span class="hs-identifier hs-var">poly_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>                       </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ignoring all but the first&quot;</span></span><span>
</span><span id="line-605"></span><span>                                </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}.
(Outputable a, Outputable a) =&gt;
GenLocated a a -&gt; SDoc
</span><a href="#local-6989586621681384909"><span class="hs-identifier hs-var">pp_inl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384921"><span class="hs-identifier hs-var">inl1</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA InlinePragma
</span><a href="#local-6989586621681384918"><span class="hs-identifier hs-var">inl2</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA InlinePragma]
</span><a href="#local-6989586621681384916"><span class="hs-identifier hs-var">inls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621681384909"><span class="annot"><span class="annottext">pp_inl :: GenLocated a a -&gt; SDoc
</span><a href="#local-6989586621681384909"><span class="hs-identifier hs-var hs-var">pp_inl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384904"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384904"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681384903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384903"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384903"><span class="hs-identifier hs-var">prag</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384904"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-comment">{- Note [Pattern synonym inline arity]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
    {-# INLINE P #-}
    pattern P x = (x, True)

The INLINE pragma attaches to both the /matcher/ and the /builder/ for
the pattern synonym; see Note [Pragmas for pattern synonyms] in
GHC.Tc.TyCl.PatSyn.  But they have different inline arities (i.e. number
of binders to which we apply the function before inlining), and we don't
know what those arities are yet.  So for pattern synonyms we don't set
the inl_sat field yet; instead we do so (via addInlinePragArity) in
GHC.Tc.TyCl.PatSyn.tcPatSynMatcher and tcPatSynBuilderBind.

It's a bit messy that we set the arities in different ways.  Perhaps we
should add the arity later for all binders.  But it works fine like this.
-}</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
                   SPECIALISE pragmas
*                                                                      *
************************************************************************

Note [Handling SPECIALISE pragmas]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The basic idea is this:

   foo :: Num a =&gt; a -&gt; b -&gt; a
   {-# SPECIALISE foo :: Int -&gt; b -&gt; Int #-}

We check that
   (forall a b. Num a =&gt; a -&gt; b -&gt; a)
      is more polymorphic than
   forall b. Int -&gt; b -&gt; Int
(for which we could use tcSubType, but see below), generating a HsWrapper
to connect the two, something like
      wrap = /\b. &lt;hole&gt; Int b dNumInt
This wrapper is put in the TcSpecPrag, in the ABExport record of
the AbsBinds.


        f :: (Eq a, Ix b) =&gt; a -&gt; b -&gt; Bool
        {-# SPECIALISE f :: (Ix p, Ix q) =&gt; Int -&gt; (p,q) -&gt; Bool #-}
        f = &lt;poly_rhs&gt;

From this the typechecker generates

    AbsBinds [ab] [d1,d2] [([ab], f, f_mono, prags)] binds

    SpecPrag (wrap_fn :: forall a b. (Eq a, Ix b) =&gt; XXX
                      -&gt; forall p q. (Ix p, Ix q) =&gt; XXX[ Int/a, (p,q)/b ])

From these we generate:

    Rule:       forall p, q, (dp:Ix p), (dq:Ix q).
                    f Int (p,q) dInt ($dfInPair dp dq) = f_spec p q dp dq

    Spec bind:  f_spec = wrap_fn &lt;poly_rhs&gt;

Note that

  * The LHS of the rule may mention dictionary *expressions* (eg
    $dfIxPair dp dq), and that is essential because the dp, dq are
    needed on the RHS.

  * The RHS of f_spec, &lt;poly_rhs&gt; has a *copy* of 'binds', so that it
    can fully specialise it.

From the TcSpecPrag, in GHC.HsToCore.Binds we generate a binding for f_spec and a RULE:

   f_spec :: Int -&gt; b -&gt; Int
   f_spec = wrap&lt;f rhs&gt;

   RULE: forall b (d:Num b). f b d = f_spec b

The RULE is generated by taking apart the HsWrapper, which is a little
delicate, but works.

Some wrinkles

1. In tcSpecWrapper, rather than calling tcSubType, we directly call
   skolemise/instantiate.  That is mainly because of wrinkle (2).

   Historical note: in the past, tcSubType did co/contra stuff, which
   could generate too complex a LHS for the RULE, which was another
   reason for not using tcSubType.  But that reason has gone away
   with simple subsumption (#17775).

2. We need to take care with type families (#5821).  Consider
      type instance F Int = Bool
      f :: Num a =&gt; a -&gt; F a
      {-# SPECIALISE foo :: Int -&gt; Bool #-}

  We *could* try to generate an f_spec with precisely the declared type:
      f_spec :: Int -&gt; Bool
      f_spec = &lt;f rhs&gt; Int dNumInt |&gt; co

      RULE: forall d. f Int d = f_spec |&gt; sym co

  but the 'co' and 'sym co' are (a) playing no useful role, and (b) are
  hard to generate.  At all costs we must avoid this:
      RULE: forall d. f Int d |&gt; co = f_spec
  because the LHS will never match (indeed it's rejected in
  decomposeRuleLhs).

  So we simply do this:
    - Generate a constraint to check that the specialised type (after
      skolemisation) is equal to the instantiated function type.
    - But *discard* the evidence (coercion) for that constraint,
      so that we ultimately generate the simpler code
          f_spec :: Int -&gt; F Int
          f_spec = &lt;f rhs&gt; Int dNumInt

          RULE: forall d. f Int d = f_spec
      You can see this discarding happening in tcSpecPrag

3. Note that the HsWrapper can transform *any* function with the right
   type prefix
       forall ab. (Eq a, Ix b) =&gt; XXX
   regardless of XXX.  It's sort of polymorphic in XXX.  This is
   useful: we use the same wrapper to transform each of the class ops, as
   well as the dict.  That's what goes on in GHC.Tc.TyCl.Instance.mk_meth_spec_prags
-}</span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecPrags"><span class="hs-identifier hs-type">tcSpecPrags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-737"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- Add INLINE and SPECIALSE pragmas</span><span>
</span><span id="line-739"></span><span class="hs-comment">--    INLINE prags are added to the (polymorphic) Id directly</span><span>
</span><span id="line-740"></span><span class="hs-comment">--    SPECIALISE prags are passed to the desugarer via TcSpecPrags</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- Pre-condition: the poly_id is zonked</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- Reason: required by tcSubExp</span><span>
</span><span id="line-743"></span><span id="tcSpecPrags"><span class="annot"><span class="annottext">tcSpecPrags :: TcId -&gt; [LSig GhcRn] -&gt; TcM [LTcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecPrags"><span class="hs-identifier hs-var hs-var">tcSpecPrags</span></a></span></span><span> </span><span id="local-6989586621681384901"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384901"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span> </span><span id="local-6989586621681384900"><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384900"><span class="hs-identifier hs-var">prag_sigs</span></a></span></span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSpecPrags&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384901"><span class="hs-identifier hs-var">poly_id</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384899"><span class="hs-identifier hs-var">spec_sigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384898"><span class="hs-identifier hs-var">bad_sigs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TcRn ()
</span><a href="#local-6989586621681384897"><span class="hs-identifier hs-var">warn_discarded_sigs</span></a></span><span>
</span><span id="line-746"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681384896"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA [TcSpecPrag]]
</span><a href="#local-6989586621681384896"><span class="hs-identifier hs-var">pss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndRecoverM"><span class="hs-identifier hs-var">mapAndRecoverM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b ann.
(a -&gt; TcM b)
-&gt; GenLocated (SrcSpanAnn' ann) a
-&gt; TcRn (GenLocated (SrcSpanAnn' ann) b)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocMA"><span class="hs-identifier hs-var">wrapLocMA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Sig GhcRn -&gt; TcM [TcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecPrag"><span class="hs-identifier hs-var">tcSpecPrag</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384901"><span class="hs-identifier hs-var">poly_id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384899"><span class="hs-identifier hs-var">spec_sigs</span></a></span><span>
</span><span id="line-747"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384891"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384891"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681384890"><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384890"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384891"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384890"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA [TcSpecPrag]]
</span><a href="#local-6989586621681384896"><span class="hs-identifier hs-var">pss</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-749"></span><span>    </span><span id="local-6989586621681384899"><span class="annot"><span class="annottext">spec_sigs :: [GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384899"><span class="hs-identifier hs-var hs-var">spec_sigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. UnXRec p =&gt; LSig p -&gt; Bool
</span><a href="Language.Haskell.Syntax.Binds.html#isSpecLSig"><span class="hs-identifier hs-var">isSpecLSig</span></a></span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384900"><span class="hs-identifier hs-var">prag_sigs</span></a></span><span>
</span><span id="line-750"></span><span>    </span><span id="local-6989586621681384898"><span class="annot"><span class="annottext">bad_sigs :: [GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384898"><span class="hs-identifier hs-var hs-var">bad_sigs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. UnXRec p =&gt; LSig p -&gt; Bool
</span><a href="#local-6989586621681384888"><span class="hs-identifier hs-var">is_bad_sig</span></a></span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384900"><span class="hs-identifier hs-var">prag_sigs</span></a></span><span>
</span><span id="line-751"></span><span>    </span><span id="local-6989586621681384888"><span class="annot"><span class="annottext">is_bad_sig :: XRec p (Sig p) -&gt; Bool
</span><a href="#local-6989586621681384888"><span class="hs-identifier hs-var hs-var">is_bad_sig</span></a></span></span><span> </span><span id="local-6989586621681384883"><span class="annot"><span class="annottext">XRec p (Sig p)
</span><a href="#local-6989586621681384883"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall p. UnXRec p =&gt; LSig p -&gt; Bool
</span><a href="Language.Haskell.Syntax.Binds.html#isSpecLSig"><span class="hs-identifier hs-var">isSpecLSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRec p (Sig p)
</span><a href="#local-6989586621681384883"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall p. UnXRec p =&gt; LSig p -&gt; Bool
</span><a href="Language.Haskell.Syntax.Binds.html#isInlineLSig"><span class="hs-identifier hs-var">isInlineLSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRec p (Sig p)
</span><a href="#local-6989586621681384883"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall p. UnXRec p =&gt; LSig p -&gt; Bool
</span><a href="Language.Haskell.Syntax.Binds.html#isSCCFunSig"><span class="hs-identifier hs-var">isSCCFunSig</span></a></span><span> </span><span class="annot"><span class="annottext">XRec p (Sig p)
</span><a href="#local-6989586621681384883"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span>    </span><span id="local-6989586621681384897"><span class="annot"><span class="annottext">warn_discarded_sigs :: TcRn ()
</span><a href="#local-6989586621681384897"><span class="hs-identifier hs-var hs-var">warn_discarded_sigs</span></a></span></span><span>
</span><span id="line-754"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnTc"><span class="hs-identifier hs-var">addWarnTc</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.Flags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a></span><span>
</span><span id="line-755"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; Arity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Discarding unexpected pragmas for&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384901"><span class="hs-identifier hs-var">poly_id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>                      </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; l
</span><a href="GHC.Types.SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (Sig GhcRn)]
</span><a href="#local-6989586621681384898"><span class="hs-identifier hs-var">bad_sigs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-comment">--------------</span><span>
</span><span id="line-759"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecPrag"><span class="hs-identifier hs-type">tcSpecPrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcId"><span class="hs-identifier hs-type">TcId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#Sig"><span class="hs-identifier hs-type">Sig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#TcSpecPrag"><span class="hs-identifier hs-type">TcSpecPrag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-760"></span><span id="tcSpecPrag"><span class="annot"><span class="annottext">tcSpecPrag :: TcId -&gt; Sig GhcRn -&gt; TcM [TcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecPrag"><span class="hs-identifier hs-var hs-var">tcSpecPrag</span></a></span></span><span> </span><span id="local-6989586621681384877"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384877"><span class="hs-identifier hs-var">poly_id</span></a></span></span><span> </span><span id="local-6989586621681384876"><span class="annot"><span class="annottext">prag :: Sig GhcRn
</span><a href="#local-6989586621681384876"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#SpecSig"><span class="hs-identifier hs-type">SpecSig</span></a></span><span> </span><span class="annot"><span class="annottext">XSpecSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384875"><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384875"><span class="hs-identifier hs-var">fun_name</span></a></span></span><span> </span><span id="local-6989586621681384874"><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><a href="#local-6989586621681384874"><span class="hs-identifier hs-var">hs_tys</span></a></span></span><span> </span><span id="local-6989586621681384873"><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384873"><span class="hs-identifier hs-var">inl</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- See Note [Handling SPECIALISE pragmas]</span><span>
</span><span id="line-762"></span><span class="hs-comment">--</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- The Name fun_name in the SpecSig may not be the same as that of the poly_id</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- Example: SPECIALISE for a class method: the Name in the SpecSig is</span><span>
</span><span id="line-765"></span><span class="hs-comment">--          for the selector Id, but the poly_id is something like $cop</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- However we want to use fun_name in the error message, since that is</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- what the user wrote (#8537)</span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; TcM a -&gt; TcM a
</span><a href="GHC.Tc.Utils.Monad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="#local-6989586621681384871"><span class="hs-identifier hs-var">spec_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384876"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-769"></span><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#warnIf"><span class="hs-identifier hs-var">warnIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isOverloadedTy"><span class="hs-identifier hs-var">isOverloadedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384868"><span class="hs-identifier hs-var">poly_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">InlinePragma -&gt; Bool
</span><a href="GHC.Types.Basic.html#isInlinePragma"><span class="hs-identifier hs-var">isInlinePragma</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384873"><span class="hs-identifier hs-var">inl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SPECIALISE pragma for non-overloaded function&quot;</span></span><span>
</span><span id="line-771"></span><span>                  </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcRn
</span><a href="#local-6989586621681384875"><span class="hs-identifier hs-var">fun_name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>                  </span><span class="hs-comment">-- Note [SPECIALISE pragmas]</span><span>
</span><span id="line-773"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681384865"><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384865"><span class="hs-identifier hs-var">spec_prags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.3.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsSigType GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TcSpecPrag
</span><a href="#local-6989586621681384863"><span class="hs-identifier hs-var">tc_one</span></a></span><span> </span><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><a href="#local-6989586621681384874"><span class="hs-identifier hs-var">hs_tys</span></a></span><span>
</span><span id="line-774"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSpecPrag&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384877"><span class="hs-identifier hs-var">poly_id</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Arity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384865"><span class="hs-identifier hs-var">spec_prags</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384865"><span class="hs-identifier hs-var">spec_prags</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621681384861"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681384861"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384877"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621681384868"><span class="annot"><span class="annottext">poly_ty :: Kind
</span><a href="#local-6989586621681384868"><span class="hs-identifier hs-var hs-var">poly_ty</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Kind
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384877"><span class="hs-identifier hs-var">poly_id</span></a></span><span>
</span><span id="line-779"></span><span>    </span><span id="local-6989586621681384871"><span class="annot"><span class="annottext">spec_ctxt :: a -&gt; SDoc
</span><a href="#local-6989586621681384871"><span class="hs-identifier hs-var hs-var">spec_ctxt</span></a></span></span><span> </span><span id="local-6989586621681384858"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384858"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Arity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In the pragma:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681384858"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621681384863"><span class="annot"><span class="annottext">tc_one :: GenLocated SrcSpanAnnA (HsSigType GhcRn)
-&gt; IOEnv (Env TcGblEnv TcLclEnv) TcSpecPrag
</span><a href="#local-6989586621681384863"><span class="hs-identifier hs-var hs-var">tc_one</span></a></span></span><span> </span><span id="local-6989586621681384857"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsSigType GhcRn)
</span><a href="#local-6989586621681384857"><span class="hs-identifier hs-var">hs_ty</span></a></span></span><span>
</span><span id="line-782"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681384856"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384856"><span class="hs-identifier hs-var">spec_ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; LHsSigType GhcRn -&gt; TcM Kind
</span><a href="GHC.Tc.Gen.HsType.html#tcHsSigType"><span class="hs-identifier hs-var">tcHsSigType</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384861"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsSigType GhcRn)
</span><a href="#local-6989586621681384857"><span class="hs-identifier hs-var">hs_ty</span></a></span><span>
</span><span id="line-783"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681384854"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384854"><span class="hs-identifier hs-var">wrap</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; Kind -&gt; Kind -&gt; TcM HsWrapper
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecWrapper"><span class="hs-identifier hs-var">tcSpecWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool -&gt; UserTypeCtxt
</span><a href="GHC.Tc.Types.Origin.html#FunSigCtxt"><span class="hs-identifier hs-var">FunSigCtxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384861"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384868"><span class="hs-identifier hs-var">poly_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384856"><span class="hs-identifier hs-var">spec_ty</span></a></span><span>
</span><span id="line-784"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; HsWrapper -&gt; InlinePragma -&gt; TcSpecPrag
</span><a href="Language.Haskell.Syntax.Binds.html#SpecPrag"><span class="hs-identifier hs-var">SpecPrag</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384877"><span class="hs-identifier hs-var">poly_id</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384854"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><a href="#local-6989586621681384873"><span class="hs-identifier hs-var">inl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecPrag"><span class="hs-identifier hs-var">tcSpecPrag</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384852"><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384852"><span class="hs-identifier hs-var">prag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tcSpecPrag&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384852"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">--------------</span><span>
</span><span id="line-789"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcSpecWrapper"><span class="hs-identifier hs-type">tcSpecWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.Origin.html#UserTypeCtxt"><span class="hs-identifier hs-type">UserTypeCtxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.Evidence.html#HsWrapper"><span class="hs-identifier hs-type">HsWrapper</span></a></span><span>
</span><span id="line-790"></span><span class="hs-comment">-- A simpler variant of tcSubType, used for SPECIALISE pragmas</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- See Note [Handling SPECIALISE pragmas], wrinkle 1</span><span>
</span><span id="line-792"></span><span id="tcSpecWrapper"><span class="annot"><span class="annottext">tcSpecWrapper :: UserTypeCtxt -&gt; Kind -&gt; Kind -&gt; TcM HsWrapper
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecWrapper"><span class="hs-identifier hs-var hs-var">tcSpecWrapper</span></a></span></span><span> </span><span id="local-6989586621681384849"><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681384849"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621681384848"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384848"><span class="hs-identifier hs-var">poly_ty</span></a></span></span><span> </span><span id="local-6989586621681384847"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384847"><span class="hs-identifier hs-var">spec_ty</span></a></span></span><span>
</span><span id="line-793"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384846"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384846"><span class="hs-identifier hs-var">sk_wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384845"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384845"><span class="hs-identifier hs-var">inst_wrap</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>               </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall result.
UserTypeCtxt
-&gt; Kind -&gt; (Kind -&gt; TcM result) -&gt; TcM (HsWrapper, result)
</span><a href="GHC.Tc.Utils.Unify.html#tcTopSkolemise"><span class="hs-identifier hs-var">tcTopSkolemise</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681384849"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384847"><span class="hs-identifier hs-var">spec_ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681384844"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384844"><span class="hs-identifier hs-var">spec_tau</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-795"></span><span>                  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384843"><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384843"><span class="hs-identifier hs-var">inst_wrap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384842"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384842"><span class="hs-identifier hs-var">tau</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CtOrigin -&gt; Kind -&gt; TcM (HsWrapper, Kind)
</span><a href="GHC.Tc.Utils.Instantiate.html#topInstantiate"><span class="hs-identifier hs-var">topInstantiate</span></a></span><span> </span><span class="annot"><span class="annottext">CtOrigin
</span><a href="#local-6989586621681384841"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384848"><span class="hs-identifier hs-var">poly_ty</span></a></span><span>
</span><span id="line-796"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcCoercionN
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe SDoc -&gt; Kind -&gt; Kind -&gt; TcM TcCoercionN
</span><a href="GHC.Tc.Utils.Unify.html#unifyType"><span class="hs-identifier hs-var">unifyType</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384844"><span class="hs-identifier hs-var">spec_tau</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621681384842"><span class="hs-identifier hs-var">tau</span></a></span><span>
</span><span id="line-797"></span><span>                            </span><span class="hs-comment">-- Deliberately ignore the evidence</span><span>
</span><span id="line-798"></span><span>                            </span><span class="hs-comment">-- See Note [Handling SPECIALISE pragmas],</span><span>
</span><span id="line-799"></span><span>                            </span><span class="hs-comment">--   wrinkle (2)</span><span>
</span><span id="line-800"></span><span>                     </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384843"><span class="hs-identifier hs-var">inst_wrap</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-801"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384846"><span class="hs-identifier hs-var">sk_wrap</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper -&gt; HsWrapper -&gt; HsWrapper
</span><a href="GHC.Tc.Types.Evidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><a href="#local-6989586621681384845"><span class="hs-identifier hs-var">inst_wrap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621681384841"><span class="annot"><span class="annottext">orig :: CtOrigin
</span><a href="#local-6989586621681384841"><span class="hs-identifier hs-var hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt -&gt; CtOrigin
</span><a href="GHC.Tc.Types.Origin.html#SpecPragOrigin"><span class="hs-identifier hs-var">SpecPragOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">UserTypeCtxt
</span><a href="#local-6989586621681384849"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-comment">--------------</span><span>
</span><span id="line-806"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcImpPrags"><span class="hs-identifier hs-type">tcImpPrags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#LTcSpecPrag"><span class="hs-identifier hs-type">LTcSpecPrag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- SPECIALISE pragmas for imported things</span><span>
</span><span id="line-808"></span><span id="tcImpPrags"><span class="annot"><span class="annottext">tcImpPrags :: [LSig GhcRn] -&gt; TcM [LTcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcImpPrags"><span class="hs-identifier hs-var hs-var">tcImpPrags</span></a></span></span><span> </span><span id="local-6989586621681384839"><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384839"><span class="hs-identifier hs-var">prags</span></a></span></span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681384838"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681384838"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasModule m =&gt; m Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a></span><span>
</span><span id="line-810"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681384837"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681384837"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-811"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Bool
</span><a href="#local-6989586621681384835"><span class="hs-identifier hs-var">not_specialising</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681384837"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-812"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-813"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-814"></span><span>            </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681384834"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA [TcSpecPrag]]
</span><a href="#local-6989586621681384834"><span class="hs-identifier hs-var">pss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndRecoverM"><span class="hs-identifier hs-var">mapAndRecoverM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b ann.
(a -&gt; TcM b)
-&gt; GenLocated (SrcSpanAnn' ann) a
-&gt; TcRn (GenLocated (SrcSpanAnn' ann) b)
</span><a href="GHC.Tc.Utils.Monad.html#wrapLocMA"><span class="hs-identifier hs-var">wrapLocMA</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, Sig GhcRn) -&gt; TcM [TcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcImpSpec"><span class="hs-identifier hs-var">tcImpSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384832"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384831"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384830"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>                             </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384832"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384832"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681384830"><span class="annot"><span class="annottext">prag :: Sig GhcRn
</span><a href="#local-6989586621681384830"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#SpecSig"><span class="hs-identifier hs-type">SpecSig</span></a></span><span> </span><span class="annot"><span class="annottext">XSpecSig GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681384831"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384831"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LHsSigType GhcRn]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InlinePragma
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LSig GhcRn]
</span><a href="#local-6989586621681384839"><span class="hs-identifier hs-var">prags</span></a></span><span>
</span><span id="line-817"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Name -&gt; Bool
</span><a href="GHC.Types.Name.html#nameIsLocalOrFrom"><span class="hs-identifier hs-var">nameIsLocalOrFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681384838"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384831"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-818"></span><span>            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681384828"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384828"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681384827"><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384827"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681384828"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TcSpecPrag]
</span><a href="#local-6989586621681384827"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA [TcSpecPrag]]
</span><a href="#local-6989586621681384834"><span class="hs-identifier hs-var">pss</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-820"></span><span>    </span><span class="hs-comment">-- Ignore SPECIALISE pragmas for imported things</span><span>
</span><span id="line-821"></span><span>    </span><span class="hs-comment">-- when we aren't specialising, or when we aren't generating</span><span>
</span><span id="line-822"></span><span>    </span><span class="hs-comment">-- code.  The latter happens when Haddocking the base library;</span><span>
</span><span id="line-823"></span><span>    </span><span class="hs-comment">-- we don't want complaints about lack of INLINABLE pragmas</span><span>
</span><span id="line-824"></span><span>    </span><span id="local-6989586621681384835"><span class="annot"><span class="annottext">not_specialising :: DynFlags -&gt; Bool
</span><a href="#local-6989586621681384835"><span class="hs-identifier hs-var hs-var">not_specialising</span></a></span></span><span> </span><span id="local-6989586621681384826"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681384826"><span class="hs-identifier hs-var">dflags</span></a></span></span><span>
</span><span id="line-825"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_Specialise"><span class="hs-identifier hs-var">Opt_Specialise</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681384826"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-826"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Backend
</span><a href="GHC.Driver.Session.html#backend"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681384826"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-827"></span><span>                      </span><span class="annot"><span class="annottext">Backend
</span><a href="GHC.Driver.Backend.html#NoBackend"><span class="hs-identifier hs-var">NoBackend</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-828"></span><span>                      </span><span class="annot"><span class="annottext">Backend
</span><a href="GHC.Driver.Backend.html#Interpreter"><span class="hs-identifier hs-var">Interpreter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-829"></span><span>                      </span><span id="local-6989586621681384820"><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621681384820"><span class="hs-identifier hs-var">_other</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#tcImpSpec"><span class="hs-identifier hs-type">tcImpSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#Sig"><span class="hs-identifier hs-type">Sig</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcM"><span class="hs-identifier hs-type">TcM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#TcSpecPrag"><span class="hs-identifier hs-type">TcSpecPrag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span id="tcImpSpec"><span class="annot"><span class="annottext">tcImpSpec :: (Name, Sig GhcRn) -&gt; TcM [TcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcImpSpec"><span class="hs-identifier hs-var hs-var">tcImpSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681384819"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384819"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681384818"><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384818"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681384817"><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384817"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TcM TcId
</span><a href="GHC.Tc.Utils.Env.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384819"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-834"></span><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Unfolding -&gt; Bool
</span><a href="GHC.Core.html#hasSomeUnfolding"><span class="hs-identifier hs-var">hasSomeUnfolding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcId -&gt; Unfolding
</span><a href="GHC.Types.Id.html#realIdUnfolding"><span class="hs-identifier hs-var">realIdUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384817"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>           </span><span class="hs-comment">-- See Note [SPECIALISE pragmas for imported Ids]</span><span>
</span><span id="line-836"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TcId -&gt; Sig GhcRn -&gt; TcM [TcSpecPrag]
</span><a href="GHC.Tc.Gen.Sig.html#tcSpecPrag"><span class="hs-identifier hs-var">tcSpecPrag</span></a></span><span> </span><span class="annot"><span class="annottext">TcId
</span><a href="#local-6989586621681384817"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Sig GhcRn
</span><a href="#local-6989586621681384818"><span class="hs-identifier hs-var">prag</span></a></span><span>
</span><span id="line-837"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; TcRn ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnTc"><span class="hs-identifier hs-var">addWarnTc</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason
</span><a href="GHC.Driver.Flags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#impSpecErr"><span class="hs-identifier hs-var">impSpecErr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384819"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="annot"><a href="GHC.Tc.Gen.Sig.html#impSpecErr"><span class="hs-identifier hs-type">impSpecErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-841"></span><span id="impSpecErr"><span class="annot"><span class="annottext">impSpecErr :: Name -&gt; SDoc
</span><a href="GHC.Tc.Gen.Sig.html#impSpecErr"><span class="hs-identifier hs-var hs-var">impSpecErr</span></a></span></span><span> </span><span id="local-6989586621681384815"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384815"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-842"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Arity -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;You cannot SPECIALISE&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384815"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>       </span><span class="annot"><span class="annottext">Arity
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;because its definition is not visible in this module&quot;</span></span><span>
</span><span id="line-844"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hint: make sure&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681384814"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is compiled with -O&quot;</span></span><span>
</span><span id="line-845"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;      and that&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384815"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>                 </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;has an INLINABLE pragma&quot;</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-848"></span><span>    </span><span id="local-6989586621681384814"><span class="annot"><span class="annottext">mod :: Module
</span><a href="#local-6989586621681384814"><span class="hs-identifier hs-var hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Name -&gt; Module
</span><a href="GHC.Types.Name.html#nameModule"><span class="hs-identifier hs-var">nameModule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681384815"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-comment">{- Note [SPECIALISE pragmas for imported Ids]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
An imported Id may or may not have an unfolding.  If not, we obviously
can't specialise it here; indeed the desugar falls over (#18118).

We used to test whether it had a user-specified INLINABLE pragma but,
because of Note [Worker-wrapper for INLINABLE functions] in
GHC.Core.Opt.WorkWrap, even an INLINABLE function may end up with
a wrapper that has no pragma, just an unfolding (#19246).  So now
we just test whether the function has an unfolding.

There's a risk that a pragma-free function may have an unfolding now
(because it is fairly small), and then gets a bit bigger, and no
longer has an unfolding in the future.  But then you'll get a helpful
error message suggesting an INLINABLE pragma, which you can follow.
That seems enough for now.
-}</span><span>
</span><span id="line-867"></span></pre></body></html>
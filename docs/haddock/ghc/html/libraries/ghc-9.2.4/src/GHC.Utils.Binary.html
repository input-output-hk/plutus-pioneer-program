<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE UnboxedTuples #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -O2 -funbox-strict-fields #-}</span><span class="hs-cpp">
#if MIN_VERSION_base(4,16,0)
</span><span class="hs-cpp">#define HAS_TYPELITCHAR
</span><span class="hs-cpp">#endif
</span><span class="hs-comment">-- We always optimise this, otherwise performance of a non-optimised</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- compiler is severely affected</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- (c) The University of Glasgow 2002-2006</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Binary I/O library, with special tweaks for GHC</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Based on the nhc98 Binary library, which is copyright</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- (c) Malcolm Wallace and Colin Runciman, University of York, 1998.</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Under the terms of the license for that software, we must tell you</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- where you can obtain the original version of the Binary library, namely</span><span>
</span><span id="line-27"></span><span class="hs-comment">--     http://www.cs.york.ac.uk/fp/nhc98/</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Utils.Binary</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-comment">{-type-}</span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier">Bin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-comment">{-class-}</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier">Binary</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-comment">{-type-}</span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier">BinHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier">SymbolTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier">Dictionary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier">BinData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier">dataHandle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier">handleData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier">openBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span class="hs-comment">--   closeBin,</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier">seekBin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier">tellBin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier">castBin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier">withBinBuffer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier">writeBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier">readBinMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier">putAt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier">getAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>   </span><span class="annot"><span class="hs-comment">-- * For writing instances</span></span><span>
</span><span id="line-51"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier">putByte</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier">getByte</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Variable length encodings</span></span><span>
</span><span id="line-55"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier">putULEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier">getULEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier">putSLEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier">getSLEB128</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Fixed length encoding</span></span><span>
</span><span id="line-61"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier">FixedLengthEncoding</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>   </span><span class="annot"><span class="hs-comment">-- * Lazy Binary I/O</span></span><span>
</span><span id="line-64"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier">lazyGet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier">lazyPut</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>   </span><span class="annot"><span class="hs-comment">-- * User data</span></span><span>
</span><span id="line-68"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier">UserData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getUserData"><span class="hs-identifier">getUserData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#setUserData"><span class="hs-identifier">setUserData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier">newReadState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier">newWriteState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>   </span><span class="annot"><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier">putDictionary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier">getDictionary</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier">putFS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html"><span class="hs-identifier">GHC.Utils.Panic.Plain</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastMutInt.html"><span class="hs-identifier">GHC.Data.FastMutInt</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Fingerprint.html"><span class="hs-identifier">GHC.Utils.Fingerprint</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../deepseq-1.4.6.1/src/Control-DeepSeq.html#"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Foreign.html#"><span class="hs-identifier">Foreign</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#shiftL"><span class="hs-identifier">shiftL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#shiftR"><span class="hs-identifier">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array.html#"><span class="hs-identifier">Data.Array</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString.html#"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Unsafe.html#"><span class="hs-identifier">Data.ByteString.Unsafe</span></a></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-IORef.html#"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Char.html#"><span class="hs-identifier">Data.Char</span></a></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Base.html#ord"><span class="hs-identifier">ord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Char.html#chr"><span class="hs-identifier">chr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time.html#"><span class="hs-identifier">Data.Time</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Data-List.html#"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/Data-OldList.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#%3C%24%21%3E"><span class="hs-operator">(&lt;$!&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/Control-Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/System-IO.html#"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/System-IO-Unsafe.html#"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-IO-Unsafe.html#unsafeInterleaveIO"><span class="hs-identifier">unsafeInterleaveIO</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/System-IO-Error.html#"><span class="hs-identifier">System.IO.Error</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/System-IO-Error.html#mkIOError"><span class="hs-identifier">mkIOError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/System-IO-Error.html#eofErrorType"><span class="hs-identifier">eofErrorType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#"><span class="hs-identifier">GHC.Real</span></a></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Ratio"><span class="hs-identifier">Ratio</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_base(4,15,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier">unsafeWithForeignPtr</span></a></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-104"></span><span class="hs-keyword">type</span><span> </span><span id="BinArray"><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-var">BinArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-cpp">

#if !MIN_VERSION_base(4,15,0)
</span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ForeignPtr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-108"></span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">withForeignPtr</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-111"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- BinData</span><span>
</span><span id="line-113"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">data</span><span> </span><span id="BinData"><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinData"><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../deepseq-1.4.6.1/src/Control-DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621680974960"><span class="annot"><span class="annottext">rnf :: BinData -&gt; ()
</span><a href="../../deepseq-1.4.6.1/src/Control-DeepSeq.html#rnf"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621680974958"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974958"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../deepseq-1.4.6.1/src/Control-DeepSeq.html#rnf"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974958"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974955"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621680974950"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; BinData -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974948"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974948"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621680974947"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974947"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680974946"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974946"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974948"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974947"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974948"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974947"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974944"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974946"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974943"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Marshal-Utils.html#copyBytes"><span class="hs-identifier hs-var">copyBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974947"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621680974936"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO BinData
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974934"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974934"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621680974933"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974933"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974934"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621680974932"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974932"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#mallocForeignPtrBytes"><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974933"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974934"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974933"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974929"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974929"><span class="hs-identifier hs-var">orig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974932"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974928"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974928"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Marshal-Utils.html#copyBytes"><span class="hs-identifier hs-var">copyBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974928"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974929"><span class="hs-identifier hs-var">orig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974933"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; BinArray -&gt; BinData
</span><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974933"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974932"><span class="hs-identifier hs-var">dat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier hs-type">dataHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span>
</span><span id="line-136"></span><span id="dataHandle"><span class="annot"><span class="annottext">dataHandle :: BinData -&gt; IO BinHandle
</span><a href="GHC.Utils.Binary.html#dataHandle"><span class="hs-identifier hs-var hs-var">dataHandle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span> </span><span id="local-6989586621680974927"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974927"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621680974926"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974926"><span class="hs-identifier hs-var">bin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621680974925"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974925"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621680974923"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974923"><span class="hs-identifier hs-var">szr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974927"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621680974922"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974922"><span class="hs-identifier hs-var">binr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; IO (IORef a)
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#newIORef"><span class="hs-identifier hs-var">newIORef</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974926"><span class="hs-identifier hs-var">bin</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserData -&gt; FastMutInt -&gt; FastMutInt -&gt; IORef BinArray -&gt; BinHandle
</span><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-var">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="GHC.Utils.Binary.html#noUserData"><span class="hs-identifier hs-var">noUserData</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974925"><span class="hs-identifier hs-var">ixr</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974923"><span class="hs-identifier hs-var">szr</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974922"><span class="hs-identifier hs-var">binr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier hs-type">handleData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-type">BinData</span></a></span><span>
</span><span id="line-143"></span><span id="handleData"><span class="annot"><span class="annottext">handleData :: BinHandle -&gt; IO BinData
</span><a href="GHC.Utils.Binary.html#handleData"><span class="hs-identifier hs-var hs-var">handleData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974918"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974918"><span class="hs-identifier hs-var">ixr</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974917"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974917"><span class="hs-identifier hs-var">binr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BinArray -&gt; BinData
</span><a href="GHC.Utils.Binary.html#BinData"><span class="hs-identifier hs-var">BinData</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974918"><span class="hs-identifier hs-var">ixr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974917"><span class="hs-identifier hs-var">binr</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- BinHandle</span><span>
</span><span id="line-147"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="BinHandle"><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-var">BinHandle</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BinMem"><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-var">BinMem</span></a></span></span><span> </span><span class="hs-special">{</span><span>                     </span><span class="hs-comment">-- binary data stored in an unboxed array</span><span>
</span><span id="line-151"></span><span>     </span><span id="bh_usr"><span class="annot"><span class="annottext">BinHandle -&gt; UserData
</span><a href="GHC.Utils.Binary.html#bh_usr"><span class="hs-identifier hs-var hs-var">bh_usr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- sigh, need parameterized modules :-)</span><span>
</span><span id="line-152"></span><span>     </span><span id="_off_r"><span class="annot"><span class="annottext">BinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#_off_r"><span class="hs-identifier hs-var hs-var">_off_r</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- the current offset</span><span>
</span><span id="line-153"></span><span>     </span><span id="_sz_r"><span class="annot"><span class="annottext">BinHandle -&gt; FastMutInt
</span><a href="GHC.Utils.Binary.html#_sz_r"><span class="hs-identifier hs-var hs-var">_sz_r</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Data.FastMutInt.html#FastMutInt"><span class="hs-identifier hs-type">FastMutInt</span></a></span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- size of the array (cached)</span><span>
</span><span id="line-154"></span><span>     </span><span id="_arr_r"><span class="annot"><span class="annottext">BinHandle -&gt; IORef BinArray
</span><a href="GHC.Utils.Binary.html#_arr_r"><span class="hs-identifier hs-var hs-var">_arr_r</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinArray"><span class="hs-identifier hs-type">BinArray</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the array (bounds: (0,size-1))</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-comment">-- XXX: should really store a &quot;high water mark&quot; for dumping out</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-comment">-- the binary data to a file.</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="GHC.Utils.Binary.html#getUserData"><span class="hs-identifier hs-type">getUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span>
</span><span id="line-160"></span><span id="getUserData"><span class="annot"><span class="annottext">getUserData :: BinHandle -&gt; UserData
</span><a href="GHC.Utils.Binary.html#getUserData"><span class="hs-identifier hs-var hs-var">getUserData</span></a></span></span><span> </span><span id="local-6989586621680974909"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974909"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; UserData
</span><a href="GHC.Utils.Binary.html#bh_usr"><span class="hs-identifier hs-var">bh_usr</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974909"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="GHC.Utils.Binary.html#setUserData"><span class="hs-identifier hs-type">setUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span>
</span><span id="line-163"></span><span id="setUserData"><span class="annot"><span class="annottext">setUserData :: BinHandle -&gt; UserData -&gt; BinHandle
</span><a href="GHC.Utils.Binary.html#setUserData"><span class="hs-identifier hs-var hs-var">setUserData</span></a></span></span><span> </span><span id="local-6989586621680974908"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974908"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974907"><span class="annot"><span class="annottext">UserData
</span><a href="#local-6989586621680974907"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974908"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bh_usr :: UserData
</span><a href="GHC.Utils.Binary.html#bh_usr"><span class="hs-identifier hs-var">bh_usr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserData
</span><a href="#local-6989586621680974907"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Get access to the underlying buffer.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- It is quite important that no references to the 'ByteString' leak out of the</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- continuation lest terrible things happen.</span><span>
</span><span id="line-169"></span><span id="local-6989586621680975689"><span class="annot"><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier hs-type">withBinBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975689"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span id="withBinBuffer"><span class="annot"><span class="annottext">withBinBuffer :: forall a. BinHandle -&gt; (ByteString -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#withBinBuffer"><span class="hs-identifier hs-var hs-var">withBinBuffer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974903"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974903"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974902"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974902"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680974901"><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621680974901"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621680974900"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974900"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974902"><span class="hs-identifier hs-var">arr_r</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621680974899"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974899"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974903"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974900"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974897"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974897"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">CStringLen -&gt; IO ByteString
</span><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Unsafe.html#unsafePackCStringLen"><span class="hs-identifier hs-var">BS.unsafePackCStringLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Ptr b
</span><a href="../../base-4.16.3.0/src/GHC-Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974897"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974899"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO a
</span><a href="#local-6989586621680974901"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- Bin</span><span>
</span><span id="line-179"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">newtype</span><span> </span><span id="Bin"><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-var">Bin</span></a></span></span><span> </span><span id="local-6989586621680975678"><span class="annot"><a href="#local-6989586621680975678"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BinPtr"><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974888"><span id="local-6989586621680974892"><span class="annot"><span class="annottext">Bin a -&gt; Bin a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
/= :: Bin a -&gt; Bin a -&gt; Bool
$c/= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
== :: Bin a -&gt; Bin a -&gt; Bool
$c== :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974856"><span id="local-6989586621680974860"><span id="local-6989586621680974864"><span id="local-6989586621680974868"><span id="local-6989586621680974872"><span id="local-6989586621680974876"><span id="local-6989586621680974880"><span class="annot"><span class="annottext">Bin a -&gt; Bin a -&gt; Bool
Bin a -&gt; Bin a -&gt; Ordering
Bin a -&gt; Bin a -&gt; Bin a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (a :: k). Eq (Bin a)
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
forall k (a :: k). Bin a -&gt; Bin a -&gt; Ordering
forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
min :: Bin a -&gt; Bin a -&gt; Bin a
$cmin :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
max :: Bin a -&gt; Bin a -&gt; Bin a
$cmax :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bin a
&gt;= :: Bin a -&gt; Bin a -&gt; Bool
$c&gt;= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&gt; :: Bin a -&gt; Bin a -&gt; Bool
$c&gt; :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&lt;= :: Bin a -&gt; Bin a -&gt; Bool
$c&lt;= :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
&lt; :: Bin a -&gt; Bin a -&gt; Bool
$c&lt; :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Bool
compare :: Bin a -&gt; Bin a -&gt; Ordering
$ccompare :: forall k (a :: k). Bin a -&gt; Bin a -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974844"><span id="local-6989586621680974846"><span id="local-6989586621680974850"><span class="annot"><span class="annottext">Int -&gt; Bin a -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (a :: k). Int -&gt; Bin a -&gt; ShowS
forall k (a :: k). [Bin a] -&gt; ShowS
forall k (a :: k). Bin a -&gt; String
showList :: [Bin a] -&gt; ShowS
$cshowList :: forall k (a :: k). [Bin a] -&gt; ShowS
show :: Bin a -&gt; String
$cshow :: forall k (a :: k). Bin a -&gt; String
showsPrec :: Int -&gt; Bin a -&gt; ShowS
$cshowsPrec :: forall k (a :: k). Int -&gt; Bin a -&gt; ShowS
</span><a href="../../base-4.16.3.0/src/GHC-Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974836"><span id="local-6989586621680974841"><span class="annot"><span class="annottext">Bin a
forall a. a -&gt; a -&gt; Bounded a
forall k (a :: k). Bin a
maxBound :: Bin a
$cmaxBound :: forall k (a :: k). Bin a
minBound :: Bin a
$cminBound :: forall k (a :: k). Bin a
</span><a href="../../base-4.16.3.0/src/GHC-Enum.html#Bounded"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621680975666"><span id="local-6989586621680975667"><span class="annot"><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier hs-type">castBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975666"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-185"></span><span id="castBin"><span class="annot"><span class="annottext">castBin :: forall {k} {k} (a :: k) (b :: k). Bin a -&gt; Bin b
</span><a href="GHC.Utils.Binary.html#castBin"><span class="hs-identifier hs-var hs-var">castBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span id="local-6989586621680974831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974831"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974831"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- class Binary</span><span>
</span><span id="line-189"></span><span class="hs-comment">---------------------------------------------------------------</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Do not rely on instance sizes for general types,</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- we use variable length encoding for many of them.</span><span>
</span><span id="line-193"></span><span class="hs-keyword">class</span><span> </span><span id="Binary"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-var">Binary</span></a></span></span><span> </span><span id="local-6989586621680975713"><span class="annot"><a href="#local-6989586621680975713"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span id="put_"><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-type">put_</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975713"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span id="put"><span class="annot"><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-type">put</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975713"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975713"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span id="get"><span class="annot"><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-type">get</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975713"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- define one of put_, put.  Use of put_ is recommended because it</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- is more likely that tail-calls can kick in, and we rarely need the</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- position return value.</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621680974828"><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var hs-var">put_</span></a></span><span> </span><span id="local-6989586621680974824"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974824"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974823"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974823"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Bin a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974824"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974823"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621680974822"><span class="annot"><a href="GHC.Utils.Binary.html#put"><span class="hs-identifier hs-var hs-var">put</span></a></span><span> </span><span id="local-6989586621680974817"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974817"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974816"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974816"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974815"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974815"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-var">tellBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974817"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974817"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974816"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974815"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621680975661"><span class="annot"><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-type">putAt</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-205"></span><span id="putAt"><span class="annot"><span class="annottext">putAt :: forall a. Binary a =&gt; BinHandle -&gt; Bin a -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-var hs-var">putAt</span></a></span></span><span> </span><span id="local-6989586621680974809"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974809"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974808"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974808"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680974807"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974807"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-var">seekBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974809"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974808"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974809"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974807"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621680975657"><span class="annot"><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier hs-type">getAt</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975657"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975657"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975657"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-208"></span><span id="getAt"><span class="annot"><span class="annottext">getAt :: forall a. Binary a =&gt; BinHandle -&gt; Bin a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier hs-var hs-var">getAt</span></a></span></span><span> </span><span id="local-6989586621680974803"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974803"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974802"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974802"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-var">seekBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974803"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680974802"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974803"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier hs-type">openBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span>
</span><span id="line-211"></span><span id="openBinMem"><span class="annot"><span class="annottext">openBinMem :: Int -&gt; IO BinHandle
</span><a href="GHC.Utils.Binary.html#openBinMem"><span class="hs-identifier hs-var hs-var">openBinMem</span></a></span></span><span> </span><span id="local-6989586621680974801"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974801"><span class="hs-identifier hs-var">size</span></a></span></span><span>
</span><span id="line-212"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974801"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data.Binary.openBinMem: size must be &gt;= 0&quot;</span></span><span>
</span><span id="line-213"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>   </span><span id="local-6989586621680974798"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974798"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#mallocForeignPtrBytes"><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974801"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-215"></span><span>   </span><span id="local-6989586621680974797"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974797"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; IO (IORef a)
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#newIORef"><span class="hs-identifier hs-var">newIORef</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974798"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-216"></span><span>   </span><span id="local-6989586621680974796"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974796"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-217"></span><span>   </span><span id="local-6989586621680974795"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974795"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974801"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-218"></span><span>   </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserData -&gt; FastMutInt -&gt; FastMutInt -&gt; IORef BinArray -&gt; BinHandle
</span><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-var">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="GHC.Utils.Binary.html#noUserData"><span class="hs-identifier hs-var">noUserData</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974796"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974795"><span class="hs-identifier hs-var">sz_r</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974797"><span class="hs-identifier hs-var">arr_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621680975662"><span class="annot"><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-type">tellBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975662"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-221"></span><span id="tellBin"><span class="annot"><span class="annottext">tellBin :: forall {k} (a :: k). BinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-var hs-var">tellBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974792"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974792"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974791"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974791"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974791"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621680975658"><span class="annot"><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-type">seekBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975658"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-224"></span><span id="seekBin"><span class="annot"><span class="annottext">seekBin :: forall {k} (a :: k). BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-var hs-var">seekBin</span></a></span></span><span> </span><span id="local-6989586621680974787"><span class="annot"><span class="annottext">h :: BinHandle
</span><a href="#local-6989586621680974787"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974786"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974786"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621680974785"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974785"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974784"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974784"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621680974783"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974783"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974785"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974784"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974783"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-var">expandBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974787"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974784"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974786"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974784"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974786"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974784"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier hs-type">writeBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span id="writeBinMem"><span class="annot"><span class="annottext">writeBinMem :: BinHandle -&gt; String -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#writeBinMem"><span class="hs-identifier hs-var hs-var">writeBinMem</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974779"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974779"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974778"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974778"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680974777"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680974777"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621680974776"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974776"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><a href="../../base-4.16.3.0/src/GHC-IO-StdHandles.html#openBinaryFile"><span class="hs-identifier hs-var">openBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680974777"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.16.3.0/src/GHC-IO-IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621680974773"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974773"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974778"><span class="hs-identifier hs-var">arr_r</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621680974772"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974772"><span class="hs-identifier hs-var">ix</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974779"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974773"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974771"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974771"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/GHC-IO-Handle-Text.html#hPutBuf"><span class="hs-identifier hs-var">hPutBuf</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974776"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974771"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974772"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/GHC-IO-Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974776"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier hs-type">readBinMem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- Return a BinHandle with a totally undefined State</span><span>
</span><span id="line-240"></span><span id="readBinMem"><span class="annot"><span class="annottext">readBinMem :: String -&gt; IO BinHandle
</span><a href="GHC.Utils.Binary.html#readBinMem"><span class="hs-identifier hs-var hs-var">readBinMem</span></a></span></span><span> </span><span id="local-6989586621680974768"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680974768"><span class="hs-identifier hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621680974767"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974767"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><a href="../../base-4.16.3.0/src/GHC-IO-StdHandles.html#openBinaryFile"><span class="hs-identifier hs-var">openBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680974768"><span class="hs-identifier hs-var">filename</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.16.3.0/src/GHC-IO-IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621680974765"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680974765"><span class="hs-identifier hs-var">filesize'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Integer
</span><a href="../../base-4.16.3.0/src/GHC-IO-Handle.html#hFileSize"><span class="hs-identifier hs-var">hFileSize</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974767"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974763"><span class="annot"><span class="annottext">filesize :: Int
</span><a href="#local-6989586621680974763"><span class="hs-identifier hs-var hs-var">filesize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680974765"><span class="hs-identifier hs-var">filesize'</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621680974762"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974762"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#mallocForeignPtrBytes"><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974763"><span class="hs-identifier hs-var">filesize</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621680974761"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974761"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974762"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974760"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974760"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><a href="../../base-4.16.3.0/src/GHC-IO-Handle-Text.html#hGetBuf"><span class="hs-identifier hs-var">hGetBuf</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974767"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974760"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974763"><span class="hs-identifier hs-var">filesize</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974761"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974763"><span class="hs-identifier hs-var">filesize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-247"></span><span>       </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binary.readBinMem: only read &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.16.3.0/src/GHC-Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974761"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/GHC-IO-Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680974767"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621680974756"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974756"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; IO (IORef a)
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#newIORef"><span class="hs-identifier hs-var">newIORef</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974762"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621680974755"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974755"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621680974754"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974754"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974763"><span class="hs-identifier hs-var">filesize</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserData -&gt; FastMutInt -&gt; FastMutInt -&gt; IORef BinArray -&gt; BinHandle
</span><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-var">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a
</span><a href="GHC.Utils.Binary.html#noUserData"><span class="hs-identifier hs-var">noUserData</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974755"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974754"><span class="hs-identifier hs-var">sz_r</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974756"><span class="hs-identifier hs-var">arr_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- expand the size of the array to include a specified offset</span><span>
</span><span id="line-255"></span><span class="annot"><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-type">expandBin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span id="expandBin"><span class="annot"><span class="annottext">expandBin :: BinHandle -&gt; Int -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-var hs-var">expandBin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974753"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974753"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621680974752"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974752"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974751"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974751"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>   </span><span class="hs-glyph">!</span><span id="local-6989586621680974750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974750"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974753"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-258"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974749"><span class="annot"><span class="annottext">sz' :: Int
</span><a href="#local-6989586621680974749"><span class="hs-identifier hs-var hs-var">sz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621680974748"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974750"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-259"></span><span>   </span><span id="local-6989586621680974747"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974747"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974752"><span class="hs-identifier hs-var">arr_r</span></a></span><span>
</span><span id="line-260"></span><span>   </span><span id="local-6989586621680974746"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974746"><span class="hs-identifier hs-var">arr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#mallocForeignPtrBytes"><span class="hs-identifier hs-var">mallocForeignPtrBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974749"><span class="hs-identifier hs-var">sz'</span></a></span><span>
</span><span id="line-261"></span><span>   </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974747"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974745"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974745"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>     </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#withForeignPtr"><span class="hs-identifier hs-var">withForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974746"><span class="hs-identifier hs-var">arr'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974744"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974744"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>       </span><span class="annot"><span class="annottext">forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Marshal-Utils.html#copyBytes"><span class="hs-identifier hs-var">copyBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974744"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974745"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974750"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-264"></span><span>   </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974753"><span class="hs-identifier hs-var">sz_r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974749"><span class="hs-identifier hs-var">sz'</span></a></span><span>
</span><span id="line-265"></span><span>   </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#writeIORef"><span class="hs-identifier hs-var">writeIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974752"><span class="hs-identifier hs-var">arr_r</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974746"><span class="hs-identifier hs-var">arr'</span></a></span><span>
</span><span id="line-266"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="#local-6989586621680974748"><span class="hs-identifier hs-type">getSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621680974748"><span class="annot"><span class="annottext">getSize :: Int -&gt; Int
</span><a href="#local-6989586621680974748"><span class="hs-identifier hs-var hs-var">getSize</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974742"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974742"><span class="hs-identifier hs-var">sz</span></a></span></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974742"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974751"><span class="hs-identifier hs-var">off</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974742"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621680974748"><span class="hs-identifier hs-var">getSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974742"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Low-level reading/writing of bytes</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Takes a size and action writing up to @size@ bytes.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--   After the action has run advance the index to the buffer</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   by size bytes.</span><span>
</span><span id="line-280"></span><span class="annot"><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-type">putPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="putPrim"><span class="annot"><span class="annottext">putPrim :: BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var hs-var">putPrim</span></a></span></span><span> </span><span id="local-6989586621680974739"><span class="annot"><span class="annottext">h :: BinHandle
</span><a href="#local-6989586621680974739"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974738"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974738"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621680974737"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974737"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621680974736"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974736"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680974735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974735"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621680974734"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621680974734"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621680974733"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974733"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974738"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621680974732"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974732"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974737"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974733"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974735"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974732"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#expandBin"><span class="hs-identifier hs-var">expandBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974739"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974733"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974735"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621680974730"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974730"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974736"><span class="hs-identifier hs-var">arr_r</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974730"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974729"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974729"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621680974734"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974729"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../base-4.16.3.0/src/GHC-Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974733"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974738"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974733"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974735"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- -- | Similar to putPrim but advances the index by the actual number of</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- -- bytes written.</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- putPrimMax :: BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO ()</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- putPrimMax h@(BinMem _ ix_r sz_r arr_r) size f = do</span><span>
</span><span id="line-294"></span><span class="hs-comment">--   ix &lt;- readFastMutInt ix_r</span><span>
</span><span id="line-295"></span><span class="hs-comment">--   sz &lt;- readFastMutInt sz_r</span><span>
</span><span id="line-296"></span><span class="hs-comment">--   when (ix + size &gt; sz) $</span><span>
</span><span id="line-297"></span><span class="hs-comment">--     expandBin h (ix + size)</span><span>
</span><span id="line-298"></span><span class="hs-comment">--   arr &lt;- readIORef arr_r</span><span>
</span><span id="line-299"></span><span class="hs-comment">--   written &lt;- withForeignPtr arr $ \op -&gt; f (op `plusPtr` ix)</span><span>
</span><span id="line-300"></span><span class="hs-comment">--   writeFastMutInt ix_r (ix + written)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621680975704"><span class="annot"><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-type">getPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975704"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-303"></span><span id="getPrim"><span class="annot"><span class="annottext">getPrim :: forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var hs-var">getPrim</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinMem"><span class="hs-identifier hs-type">BinMem</span></a></span><span> </span><span class="annot"><span class="annottext">UserData
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680974716"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974716"><span class="hs-identifier hs-var">ix_r</span></a></span></span><span> </span><span id="local-6989586621680974715"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974715"><span class="hs-identifier hs-var">sz_r</span></a></span></span><span> </span><span id="local-6989586621680974714"><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974714"><span class="hs-identifier hs-var">arr_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680974713"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974713"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621680974712"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO a
</span><a href="#local-6989586621680974712"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621680974711"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974711"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974716"><span class="hs-identifier hs-var">ix_r</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621680974710"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974710"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastMutInt -&gt; IO Int
</span><a href="GHC.Data.FastMutInt.html#readFastMutInt"><span class="hs-identifier hs-var">readFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974715"><span class="hs-identifier hs-var">sz_r</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974711"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974713"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974710"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">forall a. IOError -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IO-Exception.html#ioError"><span class="hs-identifier hs-var">ioError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOErrorType -&gt; String -&gt; Maybe Handle -&gt; Maybe String -&gt; IOError
</span><a href="../../base-4.16.3.0/src/System-IO-Error.html#mkIOError"><span class="hs-identifier hs-var">mkIOError</span></a></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><a href="../../base-4.16.3.0/src/System-IO-Error.html#eofErrorType"><span class="hs-identifier hs-var">eofErrorType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data.Binary.getPrim&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621680974708"><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974708"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IORef a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IORef.html#readIORef"><span class="hs-identifier hs-var">readIORef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef BinArray
</span><a href="#local-6989586621680974714"><span class="hs-identifier hs-var">arr_r</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621680974707"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974707"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.16.3.0/src/GHC-ForeignPtr.html#unsafeWithForeignPtr"><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BinArray
</span><a href="#local-6989586621680974708"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680974706"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974706"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO a
</span><a href="#local-6989586621680974712"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974706"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../base-4.16.3.0/src/GHC-Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974711"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- This is safe WRT #17760 as we we guarantee that the above line doesn't</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">-- diverge</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">FastMutInt -&gt; Int -&gt; IO ()
</span><a href="GHC.Data.FastMutInt.html#writeFastMutInt"><span class="hs-identifier hs-var">writeFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680974716"><span class="hs-identifier hs-var">ix_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974711"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974713"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974707"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-type">putWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span id="putWord8"><span class="annot"><span class="annottext">putWord8 :: BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var hs-var">putWord8</span></a></span></span><span> </span><span id="local-6989586621680974704"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974704"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974703"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974703"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974704"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974702"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974702"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974702"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974703"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-type">getWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-319"></span><span id="getWord8"><span class="annot"><span class="annottext">getWord8 :: BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var hs-var">getWord8</span></a></span></span><span> </span><span id="local-6989586621680974699"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974699"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974699"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-type">putWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span id="putWord16"><span class="annot"><span class="annottext">putWord16 :: BinHandle -&gt; Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-var hs-var">putWord16</span></a></span></span><span> </span><span id="local-6989586621680974696"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974696"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680974695"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974695"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974696"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974694"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974694"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974694"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974695"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974694"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974695"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-type">getWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-328"></span><span id="getWord16"><span class="annot"><span class="annottext">getWord16 :: BinHandle -&gt; IO Word16
</span><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-var hs-var">getWord16</span></a></span></span><span> </span><span id="local-6989586621680974689"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974689"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974689"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974688"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974688"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621680974687"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974687"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974688"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621680974685"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974685"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974688"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974687"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974685"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-type">putWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span id="putWord32"><span class="annot"><span class="annottext">putWord32 :: BinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var hs-var">putWord32</span></a></span></span><span> </span><span id="local-6989586621680974680"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974680"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680974679"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974679"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974680"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974678"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974678"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974678"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974679"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974678"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974679"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974678"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974679"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974678"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974679"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-type">getWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-343"></span><span id="getWord32"><span class="annot"><span class="annottext">getWord32 :: BinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var hs-var">getWord32</span></a></span></span><span> </span><span id="local-6989586621680974676"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974676"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974676"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974675"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974675"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621680974674"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974674"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974675"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621680974673"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974673"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974675"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621680974672"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974672"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974675"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621680974671"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974671"><span class="hs-identifier hs-var">w3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974675"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974674"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974673"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974672"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974671"><span class="hs-identifier hs-var">w3</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="annot"><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-type">putWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span id="putWord64"><span class="annot"><span class="annottext">putWord64 :: BinHandle -&gt; Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-var hs-var">putWord64</span></a></span></span><span> </span><span id="local-6989586621680974669"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974669"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680974668"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974669"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974667"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974667"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-type">getWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-368"></span><span id="getWord64"><span class="annot"><span class="annottext">getWord64 :: BinHandle -&gt; IO Word64
</span><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-var hs-var">getWord64</span></a></span></span><span> </span><span id="local-6989586621680974665"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974665"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974665"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974664"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621680974663"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974663"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621680974662"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974662"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621680974661"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974661"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621680974660"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974660"><span class="hs-identifier hs-var">w3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621680974659"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974659"><span class="hs-identifier hs-var">w4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621680974658"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974658"><span class="hs-identifier hs-var">w5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621680974657"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974657"><span class="hs-identifier hs-var">w6</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621680974656"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974656"><span class="hs-identifier hs-var">w7</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><a href="../../base-4.16.3.0/src/Foreign-Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680974664"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974663"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-379"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974662"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-380"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974661"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974660"><span class="hs-identifier hs-var">w3</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974659"><span class="hs-identifier hs-var">w4</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974658"><span class="hs-identifier hs-var">w5</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974657"><span class="hs-identifier hs-var">w6</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974656"><span class="hs-identifier hs-var">w7</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-type">putByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span id="putByte"><span class="annot"><span class="annottext">putByte :: BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var hs-var">putByte</span></a></span></span><span> </span><span id="local-6989586621680974655"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974655"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974654"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974654"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974655"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974654"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-type">getByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-392"></span><span id="getByte"><span class="annot"><span class="annottext">getByte :: BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var hs-var">getByte</span></a></span></span><span> </span><span id="local-6989586621680974653"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974653"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974653"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- Encode numbers in LEB128 encoding.</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- Requires one byte of space per 7 bits of data.</span><span>
</span><span id="line-397"></span><span class="hs-comment">--</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- There are signed and unsigned variants.</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- Do NOT use the unsigned one for signed values, at worst it will</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- result in wrong results, at best it will lead to bad performance</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- when coercing negative values to an unsigned type.</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- We mark them as SPECIALIZE as it's extremely critical that they get specialized</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- to their specific types.</span><span>
</span><span id="line-405"></span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- TODO: Each use of putByte performs a bounds check,</span><span>
</span><span id="line-407"></span><span class="hs-comment">--       we should use putPrimMax here. However it's quite hard to return</span><span>
</span><span id="line-408"></span><span class="hs-comment">--       the number of bytes written into putPrimMax without allocating an</span><span>
</span><span id="line-409"></span><span class="hs-comment">--       Int for it, while the code below does not allocate at all.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--       So we eat the cost of the bounds check instead of increasing allocations</span><span>
</span><span id="line-411"></span><span class="hs-comment">--       for now.</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- Unsigned numbers</span><span>
</span><span id="line-414"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-415"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-416"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-417"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-pragma hs-type">Word16</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-418"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-419"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-pragma hs-type">Int64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-420"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-421"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-pragma hs-type">putULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int16"><span class="hs-pragma hs-type">Int16</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-422"></span><span class="annot"><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-type">putULEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680975629"><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#FiniteBits"><span class="hs-identifier hs-type">FiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span id="putULEB128"><span class="annot"><span class="annottext">putULEB128 :: forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var hs-var">putULEB128</span></a></span></span><span> </span><span id="local-6989586621680974632"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974632"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974631"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974631"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(DEBUG)
</span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">panic</span><span> </span><span class="hs-string">&quot;putULEB128: Signed number&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">id</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621680974630"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974631"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="#local-6989586621680974630"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621680974630"><span class="annot"><span class="annottext">go :: a -&gt; IO ()
</span><a href="#local-6989586621680974630"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680974629"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974629"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974629"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">127</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974632"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974629"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-comment">-- bit 7 (8th bit) indicates more to come.</span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974628"><span class="annot"><span class="annottext">byte :: Word8
</span><a href="#local-6989586621680974628"><span class="hs-identifier hs-var hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#setBit"><span class="hs-identifier hs-var">setBit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974629"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974632"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974628"><span class="hs-identifier hs-var">byte</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621680974630"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974629"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-440"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-441"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-442"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-pragma hs-type">Word16</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-443"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-444"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-pragma hs-type">Int64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-445"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-446"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-pragma hs-type">getULEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int16"><span class="hs-pragma hs-type">Int16</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-447"></span><span class="annot"><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-type">getULEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680975624"><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#FiniteBits"><span class="hs-identifier hs-type">FiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-448"></span><span id="getULEB128"><span class="annot"><span class="annottext">getULEB128 :: forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var hs-var">getULEB128</span></a></span></span><span> </span><span id="local-6989586621680974609"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974609"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO a
</span><a href="#local-6989586621680974608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="#local-6989586621680974608"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621680974608"><span class="annot"><span class="annottext">go :: Int -&gt; a -&gt; IO a
</span><a href="#local-6989586621680974608"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680974607"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974607"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621680974606"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974606"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621680974605"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974605"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974609"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974604"><span class="annot"><span class="annottext">hasMore :: Bool
</span><a href="#local-6989586621680974604"><span class="hs-identifier hs-var hs-var">hasMore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#testBit"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974605"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974602"><span class="annot"><span class="annottext">val :: a
</span><a href="#local-6989586621680974602"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974606"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974605"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#unsafeShiftL"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974607"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975624"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974604"><span class="hs-identifier hs-var">hasMore</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO a
</span><a href="#local-6989586621680974608"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974607"><span class="hs-identifier hs-var">shift</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974602"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-459"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-460"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974602"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- Signed numbers</span><span>
</span><span id="line-463"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-464"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-465"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-466"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-pragma hs-type">Word16</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-467"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-468"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-pragma hs-type">Int64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-469"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-470"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-pragma hs-type">putSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int16"><span class="hs-pragma hs-type">Int16</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-type">putSLEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680975622"><span class="annot"><a href="#local-6989586621680975622"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#Bits"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span id="putSLEB128"><span class="annot"><span class="annottext">putSLEB128 :: forall a. (Integral a, Bits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var hs-var">putSLEB128</span></a></span></span><span> </span><span id="local-6989586621680974580"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974580"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974579"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974579"><span class="hs-identifier hs-var">initial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621680974578"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974579"><span class="hs-identifier hs-var">initial</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="#local-6989586621680974578"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621680974578"><span class="annot"><span class="annottext">go :: a -&gt; IO ()
</span><a href="#local-6989586621680974578"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680974577"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974577"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-476"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974576"><span class="annot"><span class="annottext">byte :: Word8
</span><a href="#local-6989586621680974576"><span class="hs-identifier hs-var hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974577"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-477"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974575"><span class="annot"><span class="annottext">val' :: a
</span><a href="#local-6989586621680974575"><span class="hs-identifier hs-var hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974577"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974574"><span class="annot"><span class="annottext">signBit :: Bool
</span><a href="#local-6989586621680974574"><span class="hs-identifier hs-var hs-var">signBit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#testBit"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974576"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974573"><span class="annot"><span class="annottext">done :: Bool
</span><a href="#local-6989586621680974573"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>                </span><span class="hs-comment">-- Unsigned value, val' == 0 and last value can</span><span>
</span><span id="line-481"></span><span>                </span><span class="hs-comment">-- be discriminated from a negative number.</span><span>
</span><span id="line-482"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974575"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974574"><span class="hs-identifier hs-var">signBit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-483"></span><span>                </span><span class="hs-comment">-- Signed value,</span><span>
</span><span id="line-484"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974575"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974574"><span class="hs-identifier hs-var">signBit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974569"><span class="annot"><span class="annottext">byte' :: Word8
</span><a href="#local-6989586621680974569"><span class="hs-identifier hs-var hs-var">byte'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974573"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974576"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#setBit"><span class="hs-identifier hs-var">setBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974576"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-487"></span><span>        </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974580"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974569"><span class="hs-identifier hs-var">byte'</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974573"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO ()
</span><a href="#local-6989586621680974578"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974575"><span class="hs-identifier hs-var">val'</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Word</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-492"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-493"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-494"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-pragma hs-type">Word16</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-495"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-496"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-pragma hs-type">Int64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-497"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-498"></span><span class="hs-pragma">{-# SPECIALISE</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-pragma hs-type">getSLEB128</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-pragma hs-type">BinHandle</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int16"><span class="hs-pragma hs-type">Int16</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-499"></span><span class="annot"><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-type">getSLEB128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680975620"><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Bits.html#FiniteBits"><span class="hs-identifier hs-type">FiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-500"></span><span id="getSLEB128"><span class="annot"><span class="annottext">getSLEB128 :: forall a. (Show a, Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var hs-var">getSLEB128</span></a></span></span><span> </span><span id="local-6989586621680974541"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974541"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680974540"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974540"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974539"><span class="hs-identifier hs-var">shift</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974538"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974538"><span class="hs-identifier hs-var">signed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO (a, Int, Bool)
</span><a href="#local-6989586621680974537"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974538"><span class="hs-identifier hs-var">signed</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974539"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall b. FiniteBits b =&gt; b -&gt; Int
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#finiteBitSize"><span class="hs-identifier hs-var">finiteBitSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974540"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#complement"><span class="hs-identifier hs-var">complement</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#unsafeShiftL"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974539"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974540"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974540"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>        </span><span class="annot"><a href="#local-6989586621680974537"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>        </span><span id="local-6989586621680974537"><span class="annot"><span class="annottext">go :: Int -&gt; a -&gt; IO (a, Int, Bool)
</span><a href="#local-6989586621680974537"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680974533"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974533"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621680974532"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974532"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>            </span><span id="local-6989586621680974531"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974531"><span class="hs-identifier hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974541"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-509"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974530"><span class="annot"><span class="annottext">byteVal :: a
</span><a href="#local-6989586621680974530"><span class="hs-identifier hs-var hs-var">byteVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#clearBit"><span class="hs-identifier hs-var">clearBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974531"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975620"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-510"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974529"><span class="annot"><span class="annottext">val' :: a
</span><a href="#local-6989586621680974529"><span class="hs-identifier hs-var hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974532"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974530"><span class="hs-identifier hs-var">byteVal</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#unsafeShiftL"><span class="hs-operator hs-var">`unsafeShiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974533"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974528"><span class="annot"><span class="annottext">more :: Bool
</span><a href="#local-6989586621680974528"><span class="hs-identifier hs-var hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#testBit"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974531"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-512"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974527"><span class="annot"><span class="annottext">shift' :: Int
</span><a href="#local-6989586621680974527"><span class="hs-identifier hs-var hs-var">shift'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974533"><span class="hs-identifier hs-var">shift</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-513"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974528"><span class="hs-identifier hs-var">more</span></a></span><span>
</span><span id="line-514"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; IO (a, Int, Bool)
</span><a href="#local-6989586621680974537"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974527"><span class="hs-identifier hs-var">shift'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974529"><span class="hs-identifier hs-var">val'</span></a></span><span>
</span><span id="line-515"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-516"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974526"><span class="annot"><span class="annottext">signed :: Bool
</span><a href="#local-6989586621680974526"><span class="hs-identifier hs-var hs-var">signed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; Bool
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#testBit"><span class="hs-identifier hs-var">testBit</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974531"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-517"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974529"><span class="hs-identifier hs-var">val'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974527"><span class="hs-identifier hs-var">shift'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974526"><span class="hs-identifier hs-var">signed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- Fixed length encoding instances</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- Sometimes words are used to represent a certain bit pattern instead</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- of a number. Using FixedLengthEncoding we will write the pattern as</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- is to the interface file without the variable length encoding we usually</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- apply.</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | Encode the argument in it's full length. This is different from many default</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- binary instances which make no guarantee about the actual encoding and</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- might do things use variable length encoding.</span><span>
</span><span id="line-530"></span><span class="hs-keyword">newtype</span><span> </span><span id="FixedLengthEncoding"><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span></span><span> </span><span id="local-6989586621680975618"><span class="annot"><a href="#local-6989586621680975618"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FixedLengthEncoding"><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unFixedLength"><span class="annot"><span class="annottext">forall a. FixedLengthEncoding a -&gt; a
</span><a href="GHC.Utils.Binary.html#unFixedLength"><span class="hs-identifier hs-var hs-var">unFixedLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975618"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974521"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>  </span><span id="local-6989586621680974519"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; FixedLengthEncoding Word8 -&gt; IO ()
</span><a href="#local-6989586621680974519"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974518"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974518"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621680974517"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974517"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974518"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974517"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621680974515"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (FixedLengthEncoding Word8)
</span><a href="#local-6989586621680974515"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974514"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974514"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974514"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974511"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-537"></span><span>  </span><span id="local-6989586621680974509"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; FixedLengthEncoding Word16 -&gt; IO ()
</span><a href="#local-6989586621680974509"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974508"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974508"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621680974507"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974507"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word16 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974508"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680974507"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span id="local-6989586621680974505"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (FixedLengthEncoding Word16)
</span><a href="#local-6989586621680974505"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974504"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974504"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word16
</span><a href="GHC.Utils.Binary.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974504"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974501"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621680974499"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; FixedLengthEncoding Word32 -&gt; IO ()
</span><a href="#local-6989586621680974499"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974498"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974498"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621680974497"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974497"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var">putWord32</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974498"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974497"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span id="local-6989586621680974495"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (FixedLengthEncoding Word32)
</span><a href="#local-6989586621680974495"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974494"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974494"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var">getWord32</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974494"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974491"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621680974489"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; FixedLengthEncoding Word64 -&gt; IO ()
</span><a href="#local-6989586621680974489"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974488"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974488"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-type">FixedLengthEncoding</span></a></span><span> </span><span id="local-6989586621680974487"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974487"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word64 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord64"><span class="hs-identifier hs-var">putWord64</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974488"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680974487"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621680974485"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (FixedLengthEncoding Word64)
</span><a href="#local-6989586621680974485"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974484"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974484"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; FixedLengthEncoding a
</span><a href="GHC.Utils.Binary.html#FixedLengthEncoding"><span class="hs-identifier hs-var">FixedLengthEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word64
</span><a href="GHC.Utils.Binary.html#getWord64"><span class="hs-identifier hs-var">getWord64</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974484"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- Primitive Word writes</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974481"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621680974479"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="#local-6989586621680974479"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974478"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974478"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680974477"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974477"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974478"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974477"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span id="local-6989586621680974476"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Word8
</span><a href="#local-6989586621680974476"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974473"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621680974469"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Word16 -&gt; IO ()
</span><a href="#local-6989586621680974469"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621680974466"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Word16
</span><a href="#local-6989586621680974466"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974463"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621680974459"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Word32 -&gt; IO ()
</span><a href="#local-6989586621680974459"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621680974456"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Word32
</span><a href="#local-6989586621680974456"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974453"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-564"></span><span>  </span><span id="local-6989586621680974449"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Word64 -&gt; IO ()
</span><a href="#local-6989586621680974449"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putULEB128"><span class="hs-identifier hs-var">putULEB128</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621680974446"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Word64
</span><a href="#local-6989586621680974446"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getULEB128"><span class="hs-identifier hs-var">getULEB128</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- Primitive Int writes</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974443"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int8"><span class="hs-identifier hs-type">Int8</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621680974437"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Int8 -&gt; IO ()
</span><a href="#local-6989586621680974437"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974436"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974436"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680974435"><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621680974435"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974436"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int8
</span><a href="#local-6989586621680974435"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>  </span><span id="local-6989586621680974428"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Int8
</span><a href="#local-6989586621680974428"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974427"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974427"><span class="hs-identifier hs-var">h</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974426"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974426"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974427"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974426"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-glyph">::</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974423"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int16"><span class="hs-identifier hs-type">Int16</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621680974419"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Int16 -&gt; IO ()
</span><a href="#local-6989586621680974419"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Bits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span id="local-6989586621680974415"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Int16
</span><a href="#local-6989586621680974415"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Show a, Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974412"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-579"></span><span>  </span><span id="local-6989586621680974408"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Int32 -&gt; IO ()
</span><a href="#local-6989586621680974408"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Bits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621680974404"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Int32
</span><a href="#local-6989586621680974404"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Show a, Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974401"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-583"></span><span>  </span><span id="local-6989586621680974397"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Int64 -&gt; IO ()
</span><a href="#local-6989586621680974397"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974396"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974396"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680974395"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680974395"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Bits a) =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putSLEB128"><span class="hs-identifier hs-var">putSLEB128</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974396"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680974395"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621680974391"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Int64
</span><a href="#local-6989586621680974391"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974390"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974390"><span class="hs-identifier hs-var">h</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Show a, Integral a, FiniteBits a) =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getSLEB128"><span class="hs-identifier hs-var">getSLEB128</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974390"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- Instances for standard types</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974387"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621680974384"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; () -&gt; IO ()
</span><a href="#local-6989586621680974384"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>    </span><span id="local-6989586621680974382"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO ()
</span><a href="#local-6989586621680974382"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span class="annot"><span class="annottext">BinHandle
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974379"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-594"></span><span>    </span><span id="local-6989586621680974373"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Bool -&gt; IO ()
</span><a href="#local-6989586621680974373"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974372"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974372"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974371"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974371"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974372"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../base-4.16.3.0/src/GHC-Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680974371"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621680974364"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Bool
</span><a href="#local-6989586621680974364"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621680974363"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974363"><span class="hs-identifier hs-var">bh</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974362"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974362"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974363"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; Int -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Enum.html#toEnum"><span class="hs-identifier hs-var">toEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974362"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974358"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621680974353"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Char -&gt; IO ()
</span><a href="#local-6989586621680974353"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span>  </span><span id="local-6989586621680974352"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974352"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974351"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680974351"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974352"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680974351"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>    </span><span id="local-6989586621680974345"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Char
</span><a href="#local-6989586621680974345"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621680974344"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974344"><span class="hs-identifier hs-var">bh</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974343"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974343"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974344"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="../../base-4.16.3.0/src/GHC-Char.html#chr"><span class="hs-identifier hs-var">chr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680974343"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974340"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621680974334"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621680974334"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974333"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974333"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974332"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974332"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974333"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974332"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621680974326"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Int
</span><a href="#local-6989586621680974326"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621680974325"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974325"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>        </span><span id="local-6989586621680974324"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680974324"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974325"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680974324"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974321"><span id="local-6989586621680975615"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680975615"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621680974313"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; [a] -&gt; IO ()
</span><a href="#local-6989586621680974313"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974312"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974312"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974311"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680974311"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974310"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621680974310"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680974311"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-610"></span><span>        </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974312"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974310"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974312"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680974311"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621680974296"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO [a]
</span><a href="#local-6989586621680974296"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974295"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974295"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>        </span><span id="local-6989586621680974294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974294"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974295"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Int is variable length encoded so only</span><span>
</span><span id="line-614"></span><span>                                </span><span class="hs-comment">-- one byte for small lists.</span><span>
</span><span id="line-615"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974293"><span class="annot"><span class="annottext">loop :: Int -&gt; IO [a]
</span><a href="#local-6989586621680974293"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>            </span><span class="annot"><a href="#local-6989586621680974293"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621680974292"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974292"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974291"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974291"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974295"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621680974290"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680974290"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [a]
</span><a href="#local-6989586621680974293"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974292"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974291"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680974290"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; IO [a]
</span><a href="#local-6989586621680974293"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680974294"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974287"><span id="local-6989586621680975607"><span id="local-6989586621680975608"><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Ix.html#Ix"><span class="hs-identifier hs-type">Ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975607"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Arr.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975607"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-620"></span><span>    </span><span id="local-6989586621680974282"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Array a b -&gt; IO ()
</span><a href="#local-6989586621680974282"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974281"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974281"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680974280"><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621680974280"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-621"></span><span>        </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974281"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; (i, i)
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#bounds"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621680974280"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-622"></span><span>        </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974281"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#elems"><span class="hs-identifier hs-var">elems</span></a></span><span> </span><span class="annot"><span class="annottext">Array a b
</span><a href="#local-6989586621680974280"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621680974271"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Array a b)
</span><a href="#local-6989586621680974271"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974270"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974270"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621680974269"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621680974269"><span class="hs-identifier hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974270"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span id="local-6989586621680974268"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680974268"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974270"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-626"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#listArray"><span class="hs-identifier hs-var">listArray</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621680974269"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680974268"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974264"><span id="local-6989586621680975605"><span id="local-6989586621680975606"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975605"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975605"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621680974259"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b) -&gt; IO ()
</span><a href="#local-6989586621680974259"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974258"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974258"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974257"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974257"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974256"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974256"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974258"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974257"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974258"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974256"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621680974250"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b)
</span><a href="#local-6989586621680974250"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974249"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974249"><span class="hs-identifier hs-var">bh</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974248"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974248"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974249"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-631"></span><span>                       </span><span id="local-6989586621680974247"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974247"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974249"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-632"></span><span>                       </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974248"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974247"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974244"><span id="local-6989586621680975596"><span id="local-6989586621680975597"><span id="local-6989586621680975598"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975597"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975596"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975597"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975596"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621680974237"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b, c) -&gt; IO ()
</span><a href="#local-6989586621680974237"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974236"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974236"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974235"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974235"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974234"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974234"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974233"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974233"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974236"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974235"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974236"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974234"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974236"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974233"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621680974225"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b, c)
</span><a href="#local-6989586621680974225"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974224"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974224"><span class="hs-identifier hs-var">bh</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974223"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974223"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974224"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-637"></span><span>                         </span><span id="local-6989586621680974222"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974222"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974224"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-638"></span><span>                         </span><span id="local-6989586621680974221"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974221"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974224"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-639"></span><span>                         </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974223"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974222"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974221"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974218"><span id="local-6989586621680975592"><span id="local-6989586621680975593"><span id="local-6989586621680975594"><span id="local-6989586621680975595"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975595"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975594"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975593"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975592"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975595"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975594"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975593"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975592"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621680974209"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b, c, d) -&gt; IO ()
</span><a href="#local-6989586621680974209"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974208"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974208"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974207"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974206"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974206"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974205"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974205"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974204"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974204"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974208"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974207"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974208"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974206"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974208"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974205"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974208"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974204"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621680974194"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b, c, d)
</span><a href="#local-6989586621680974194"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974193"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974193"><span class="hs-identifier hs-var">bh</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974192"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974192"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974193"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-644"></span><span>                           </span><span id="local-6989586621680974191"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974191"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974193"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-645"></span><span>                           </span><span id="local-6989586621680974190"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974190"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974193"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-646"></span><span>                           </span><span id="local-6989586621680974189"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974189"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974193"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-647"></span><span>                           </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974192"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974191"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974190"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974189"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974186"><span id="local-6989586621680975587"><span id="local-6989586621680975588"><span id="local-6989586621680975589"><span id="local-6989586621680975590"><span id="local-6989586621680975591"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975590"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975589"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975588"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975587"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975590"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975589"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975588"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680975587"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621680974175"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b, c, d, e) -&gt; IO ()
</span><a href="#local-6989586621680974175"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974174"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974173"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974173"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974172"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974172"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974171"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974171"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974170"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974170"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974169"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974169"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974173"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974172"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974171"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974170"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974174"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974169"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-651"></span><span>    </span><span id="local-6989586621680974157"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b, c, d, e)
</span><a href="#local-6989586621680974157"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974156"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974155"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974155"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-652"></span><span>                              </span><span id="local-6989586621680974154"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974154"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-653"></span><span>                              </span><span id="local-6989586621680974153"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974153"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-654"></span><span>                              </span><span id="local-6989586621680974152"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974152"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-655"></span><span>                              </span><span id="local-6989586621680974151"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974151"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974156"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-656"></span><span>                              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974155"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974154"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974153"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974152"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974151"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974148"><span id="local-6989586621680975581"><span id="local-6989586621680975582"><span id="local-6989586621680975583"><span id="local-6989586621680975584"><span id="local-6989586621680975585"><span id="local-6989586621680975586"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975586"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975584"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975583"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975582"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975581"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975586"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975585"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975584"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975583"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680975582"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680975581"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>    </span><span id="local-6989586621680974135"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b, c, d, e, f) -&gt; IO ()
</span><a href="#local-6989586621680974135"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974134"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974133"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974132"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974132"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974131"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974131"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974130"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974130"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974129"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974129"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974128"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974128"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974133"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974132"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974131"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974130"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974129"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974134"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974128"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621680974114"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b, c, d, e, f)
</span><a href="#local-6989586621680974114"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974113"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974112"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974112"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-661"></span><span>                                 </span><span id="local-6989586621680974111"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974111"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-662"></span><span>                                 </span><span id="local-6989586621680974110"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974110"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-663"></span><span>                                 </span><span id="local-6989586621680974109"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974109"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-664"></span><span>                                 </span><span id="local-6989586621680974108"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974108"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-665"></span><span>                                 </span><span id="local-6989586621680974107"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974107"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974113"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-666"></span><span>                                 </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974112"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974111"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974110"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974109"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974108"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974107"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974104"><span id="local-6989586621680975574"><span id="local-6989586621680975575"><span id="local-6989586621680975576"><span id="local-6989586621680975577"><span id="local-6989586621680975578"><span id="local-6989586621680975579"><span id="local-6989586621680975580"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975578"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975577"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975576"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975575"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975574"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680975580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975578"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975577"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975576"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975575"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621680975574"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621680974089"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; (a, b, c, d, e, f, g) -&gt; IO ()
</span><a href="#local-6989586621680974089"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974088"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974087"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974087"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974086"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974086"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974085"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974085"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974084"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974084"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974083"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974083"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974082"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974082"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974081"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621680974081"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974087"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974086"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974085"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974084"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974083"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974082"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974088"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621680974081"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621680974065"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (a, b, c, d, e, f, g)
</span><a href="#local-6989586621680974065"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974064"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974063"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974063"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-671"></span><span>                                 </span><span id="local-6989586621680974062"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974062"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-672"></span><span>                                 </span><span id="local-6989586621680974061"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974061"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-673"></span><span>                                 </span><span id="local-6989586621680974060"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974060"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-674"></span><span>                                 </span><span id="local-6989586621680974059"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974059"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-675"></span><span>                                 </span><span id="local-6989586621680974058"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974058"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-676"></span><span>                                 </span><span id="local-6989586621680974057"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621680974057"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974064"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-677"></span><span>                                 </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974063"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974062"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621680974061"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621680974060"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680974059"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621680974058"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621680974057"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974054"><span id="local-6989586621680975573"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621680974048"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Maybe a -&gt; IO ()
</span><a href="#local-6989586621680974048"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974047"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974047"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974047"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621680974046"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974046"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680974045"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974045"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974046"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974046"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974045"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621680974036"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Maybe a)
</span><a href="#local-6989586621680974036"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974035"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974035"><span class="hs-identifier hs-var">bh</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974034"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974034"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974035"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-683"></span><span>                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974034"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-684"></span><span>                            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-685"></span><span>                            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974035"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974030"><span id="local-6989586621680975571"><span id="local-6989586621680975572"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975571"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975572"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975571"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621680974022"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Either a b -&gt; IO ()
</span><a href="#local-6989586621680974022"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680974021"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974021"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621680974020"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974020"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974021"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974021"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974020"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621680974019"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974019"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/Data-Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680974018"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974018"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974019"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974019"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974018"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621680974008"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Either a b)
</span><a href="#local-6989586621680974008"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680974007"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974007"><span class="hs-identifier hs-var">bh</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974006"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974006"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974007"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-691"></span><span>                           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680974006"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-692"></span><span>                             </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974005"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974007"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../base-4.16.3.0/src/Data-Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680974005"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>                             </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680974004"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974004"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680974007"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../base-4.16.3.0/src/Data-Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680974004"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680974001"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621680973996"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; UTCTime -&gt; IO ()
</span><a href="#local-6989586621680973996"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973995"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973995"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973994"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680973994"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973995"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680973994"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>                   </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973995"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; DiffTime
</span><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#utctDayTime"><span class="hs-identifier hs-var">utctDayTime</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680973994"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621680973986"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO UTCTime
</span><a href="#local-6989586621680973986"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973985"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973985"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973984"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621680973984"><span class="hs-identifier hs-var">day</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973985"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-699"></span><span>                </span><span id="local-6989586621680973983"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621680973983"><span class="hs-identifier hs-var">dayTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973985"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-700"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#UTCTime"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">utctDay :: Day
</span><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#utctDay"><span class="hs-identifier hs-var">utctDay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621680973984"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utctDayTime :: DiffTime
</span><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-UTCTime.html#utctDayTime"><span class="hs-identifier hs-var">utctDayTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621680973983"><span class="hs-identifier hs-var">dayTime</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973979"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time-Calendar-Days.html#Day"><span class="hs-identifier hs-type">Day</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621680973976"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Day -&gt; IO ()
</span><a href="#local-6989586621680973976"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973975"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973975"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973974"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621680973974"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973975"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><a href="../../time-1.11.1.1/src/Data-Time-Calendar-Days.html#toModifiedJulianDay"><span class="hs-identifier hs-var">toModifiedJulianDay</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621680973974"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621680973969"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Day
</span><a href="#local-6989586621680973969"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973968"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973968"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973967"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973967"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973968"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-705"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time-Calendar-Days.html#ModifiedJulianDay"><span class="hs-identifier hs-type">ModifiedJulianDay</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">toModifiedJulianDay :: Integer
</span><a href="../../time-1.11.1.1/src/Data-Time-Calendar-Days.html#toModifiedJulianDay"><span class="hs-identifier hs-var">toModifiedJulianDay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973967"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973963"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../time-1.11.1.1/src/Data-Time-Clock-Internal-DiffTime.html#DiffTime"><span class="hs-identifier hs-type">DiffTime</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621680973957"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; DiffTime -&gt; IO ()
</span><a href="#local-6989586621680973957"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973956"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973956"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973955"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621680973955"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973956"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Real a =&gt; a -&gt; Rational
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#toRational"><span class="hs-identifier hs-var">toRational</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621680973955"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>    </span><span id="local-6989586621680973948"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO DiffTime
</span><a href="#local-6989586621680973948"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973947"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973947"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973946"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621680973946"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973947"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-710"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromRational"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621680973946"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span class="hs-comment">{-
Finally - a reasonable portable Integer instance.

We used to encode values in the Int32 range as such,
falling back to a string of all things. In either case
we stored a tag byte to discriminate between the two cases.

This made some sense as it's highly portable but also not very
efficient.

However GHC stores a surprisingly large number off large Integer
values. In the examples looked at between 25% and 50% of Integers
serialized were outside of the Int32 range.

Consider a valie like `2724268014499746065`, some sort of hash
actually generated by GHC.
In the old scheme this was encoded as a list of 19 chars. This
gave a size of 77 Bytes, one for the length of the list and 76
since we encode chars as Word32 as well.

We can easily do better. The new plan is:

* Start with a tag byte
  * 0 =&gt; Int64 (LEB128 encoded)
  * 1 =&gt; Negative large interger
  * 2 =&gt; Positive large integer
* Followed by the value:
  * Int64 is encoded as usual
  * Large integers are encoded as a list of bytes (Word8).
    We use Data.Bits which defines a bit order independent of the representation.
    Values are stored LSB first.

This means our example value `2724268014499746065` is now only 10 bytes large.
* One byte tag
* One byte for the length of the [Word8] list.
* 8 bytes for the actual date.

The new scheme also does not depend in any way on
architecture specific details.

We still use this scheme even with LEB128 available,
as it has less overhead for truly large numbers. (&gt; maxBound :: Int64)

The instance is used for in Binary Integer and Binary Rational in GHC.Types.Literal
-}</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973943"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-759"></span><span>    </span><span id="local-6989586621680973925"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Integer -&gt; IO ()
</span><a href="#local-6989586621680973925"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973924"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973923"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-760"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973922"><span class="hs-identifier hs-var">lo64</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973921"><span class="hs-identifier hs-var">hi64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-761"></span><span>          </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-762"></span><span>          </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-765"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-766"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord8"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span>
</span><span id="line-767"></span><span>          </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973924"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; [Word8]
</span><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-var">unroll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680973923"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-769"></span><span>        </span><span id="local-6989586621680973922"><span class="annot"><span class="annottext">lo64 :: Integer
</span><a href="#local-6989586621680973922"><span class="hs-identifier hs-var hs-var">lo64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Enum.html#minBound"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>        </span><span id="local-6989586621680973921"><span class="annot"><span class="annottext">hi64 :: Integer
</span><a href="#local-6989586621680973921"><span class="hs-identifier hs-var hs-var">hi64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>    </span><span id="local-6989586621680973893"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Integer
</span><a href="#local-6989586621680973893"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973892"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973892"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-772"></span><span>      </span><span id="local-6989586621680973891"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973891"><span class="hs-identifier hs-var">int_kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getWord8"><span class="hs-identifier hs-var">getWord8</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973892"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973891"><span class="hs-identifier hs-var">int_kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-774"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#%3C%24%21%3E"><span class="hs-operator hs-var">&lt;$!&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973892"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>        </span><span class="hs-comment">-- Large integer</span><span>
</span><span id="line-776"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#negate"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#%3C%24%21%3E"><span class="hs-operator hs-var">&lt;$!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><a href="#local-6989586621680973890"><span class="hs-identifier hs-var">getInt</span></a></span><span>
</span><span id="line-777"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><a href="#local-6989586621680973890"><span class="hs-identifier hs-var">getInt</span></a></span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binary Integer - Invalid byte&quot;</span></span><span>
</span><span id="line-779"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-780"></span><span>          </span><span class="annot"><a href="#local-6989586621680973890"><span class="hs-identifier hs-type">getInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-781"></span><span>          </span><span id="local-6989586621680973890"><span class="annot"><span class="annottext">getInt :: IO Integer
</span><a href="#local-6989586621680973890"><span class="hs-identifier hs-var hs-var">getInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Integer
</span><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-var">roll</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../base-4.16.3.0/src/Control-Monad.html#%3C%24%21%3E"><span class="hs-operator hs-var">&lt;$!&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973892"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="annot"><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-type">unroll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-784"></span><span id="unroll"><span class="annot"><span class="annottext">unroll :: Integer -&gt; [Word8]
</span><a href="GHC.Utils.Binary.html#unroll"><span class="hs-identifier hs-var hs-var">unroll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><a href="../../base-4.16.3.0/src/Data-OldList.html#unfoldr"><span class="hs-identifier hs-var">unfoldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b} {a}. (Integral b, Num a, Bits b) =&gt; b -&gt; Maybe (a, b)
</span><a href="#local-6989586621680973887"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-785"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-786"></span><span>    </span><span id="local-6989586621680973887"><span class="annot"><span class="annottext">step :: b -&gt; Maybe (a, b)
</span><a href="#local-6989586621680973887"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-787"></span><span>    </span><span class="annot"><a href="#local-6989586621680973887"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span id="local-6989586621680973875"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680973875"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.3.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680973875"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680973875"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span class="annot"><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-type">roll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-790"></span><span id="roll"><span class="annot"><span class="annottext">roll :: [Word8] -&gt; Integer
</span><a href="GHC.Utils.Binary.html#roll"><span class="hs-identifier hs-var hs-var">roll</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Bits a, Integral a, Num a) =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621680973873"><span class="hs-identifier hs-var">unstep</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-792"></span><span>    </span><span id="local-6989586621680973873"><span class="annot"><span class="annottext">unstep :: a -&gt; a -&gt; a
</span><a href="#local-6989586621680973873"><span class="hs-identifier hs-var hs-var">unstep</span></a></span></span><span> </span><span id="local-6989586621680973863"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973863"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680973862"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973862"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973863"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973862"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span>    </span><span class="hs-comment">{-
    -- This code is currently commented out.
    -- See https://gitlab.haskell.org/ghc/ghc/issues/3379#note_104346 for
    -- discussion.

    put_ bh (S# i#) = do putByte bh 0; put_ bh (I# i#)
    put_ bh (J# s# a#) = do
        putByte bh 1
        put_ bh (I# s#)
        let sz# = sizeofByteArray# a#  -- in *bytes*
        put_ bh (I# sz#)  -- in *bytes*
        putByteArray bh a# sz#

    get bh = do
        b &lt;- getByte bh
        case b of
          0 -&gt; do (I# i#) &lt;- get bh
                  return (S# i#)
          _ -&gt; do (I# s#) &lt;- get bh
                  sz &lt;- get bh
                  (BA a#) &lt;- getByteArray bh sz
                  return (J# s# a#)

putByteArray :: BinHandle -&gt; ByteArray# -&gt; Int# -&gt; IO ()
putByteArray bh a s# = loop 0#
  where loop n#
           | n# ==# s# = return ()
           | otherwise = do
                putByte bh (indexByteArray a n#)
                loop (n# +# 1#)

getByteArray :: BinHandle -&gt; Int -&gt; IO ByteArray
getByteArray bh (I# sz) = do
  (MBA arr) &lt;- newByteArray sz
  let loop n
           | n ==# sz = return ()
           | otherwise = do
                w &lt;- getByte bh
                writeByteArray arr n w
                loop (n +# 1#)
  loop 0#
  freezeByteArray arr
    -}</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">{-
data ByteArray = BA ByteArray#
data MBA = MBA (MutableByteArray# RealWorld)

newByteArray :: Int# -&gt; IO MBA
newByteArray sz = IO $ \s -&gt;
  case newByteArray# sz s of { (# s, arr #) -&gt;
  (# s, MBA arr #) }

freezeByteArray :: MutableByteArray# RealWorld -&gt; IO ByteArray
freezeByteArray arr = IO $ \s -&gt;
  case unsafeFreezeByteArray# arr s of { (# s, arr #) -&gt;
  (# s, BA arr #) }

writeByteArray :: MutableByteArray# RealWorld -&gt; Int# -&gt; Word8 -&gt; IO ()
writeByteArray arr i (W8# w) = IO $ \s -&gt;
  case writeWord8Array# arr i w s of { s -&gt;
  (# s, () #) }

indexByteArray :: ByteArray# -&gt; Int# -&gt; Word8
indexByteArray a# n# = W8# (indexWord8Array# a# n#)

-}</span><span>
</span><span id="line-862"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973859"><span id="local-6989586621680975568"><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#Ratio"><span class="hs-identifier hs-type">Ratio</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-863"></span><span>    </span><span id="local-6989586621680973854"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Ratio a -&gt; IO ()
</span><a href="#local-6989586621680973854"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973853"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973853"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680973852"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973852"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Real.html#%3A%25"><span class="hs-operator hs-type">:%</span></a></span><span> </span><span id="local-6989586621680973851"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973851"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973853"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973852"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973853"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973851"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-864"></span><span>    </span><span id="local-6989586621680973845"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Ratio a)
</span><a href="#local-6989586621680973845"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973844"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973844"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973843"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973843"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973844"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621680973842"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973842"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973844"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973843"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; Ratio a
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#%3A%25"><span class="hs-operator hs-var">:%</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973842"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-comment">-- Instance uses fixed-width encoding to allow inserting</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- Bin placeholders in the stream.</span><span>
</span><span id="line-868"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973839"><span id="local-6989586621680975548"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#Bin"><span class="hs-identifier hs-type">Bin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975548"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-869"></span><span>  </span><span id="local-6989586621680973835"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="#local-6989586621680973835"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973834"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973834"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-type">BinPtr</span></a></span><span> </span><span id="local-6989586621680973833"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973833"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word32 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putWord32"><span class="hs-identifier hs-var">putWord32</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973834"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973833"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>  </span><span id="local-6989586621680973828"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Bin a)
</span><a href="#local-6989586621680973828"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973827"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973827"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973826"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680973826"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word32
</span><a href="GHC.Utils.Binary.html#getWord32"><span class="hs-identifier hs-var">getWord32</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973827"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (a :: k). Int -&gt; Bin a
</span><a href="GHC.Utils.Binary.html#BinPtr"><span class="hs-identifier hs-var">BinPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621680973826"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- Lazy reading/writing</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span id="local-6989586621680973825"><span class="annot"><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier hs-type">lazyPut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680973825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680973825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-877"></span><span id="lazyPut"><span class="annot"><span class="annottext">lazyPut :: forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#lazyPut"><span class="hs-identifier hs-var hs-var">lazyPut</span></a></span></span><span> </span><span id="local-6989586621680973815"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973814"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973814"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-878"></span><span>    </span><span class="hs-comment">-- output the obj with a ptr to skip over it:</span><span>
</span><span id="line-879"></span><span>    </span><span id="local-6989586621680973813"><span class="annot"><span class="annottext">Bin (Bin Any)
</span><a href="#local-6989586621680973813"><span class="hs-identifier hs-var">pre_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-var">tellBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-880"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin (Bin Any)
</span><a href="#local-6989586621680973813"><span class="hs-identifier hs-var">pre_a</span></a></span><span>       </span><span class="hs-comment">-- save a slot for the ptr</span><span>
</span><span id="line-881"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973814"><span class="hs-identifier hs-var">a</span></a></span><span>           </span><span class="hs-comment">-- dump the object</span><span>
</span><span id="line-882"></span><span>    </span><span id="local-6989586621680973812"><span class="annot"><span class="annottext">Bin Any
</span><a href="#local-6989586621680973812"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-var">tellBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span>     </span><span class="hs-comment">-- q = ptr to after object</span><span>
</span><span id="line-883"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; Bin a -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putAt"><span class="hs-identifier hs-var">putAt</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin (Bin Any)
</span><a href="#local-6989586621680973813"><span class="hs-identifier hs-var">pre_a</span></a></span><span> </span><span class="annot"><span class="annottext">Bin Any
</span><a href="#local-6989586621680973812"><span class="hs-identifier hs-var">q</span></a></span><span>    </span><span class="hs-comment">-- fill in slot before a with ptr to q</span><span>
</span><span id="line-884"></span><span>    </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-var">seekBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973815"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin Any
</span><a href="#local-6989586621680973812"><span class="hs-identifier hs-var">q</span></a></span><span>        </span><span class="hs-comment">-- finally carry on writing at q</span><span>
</span><span id="line-885"></span><span>
</span><span id="line-886"></span><span id="local-6989586621680973811"><span class="annot"><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier hs-type">lazyGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680973811"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621680973811"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-887"></span><span id="lazyGet"><span class="annot"><span class="annottext">lazyGet :: forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#lazyGet"><span class="hs-identifier hs-var hs-var">lazyGet</span></a></span></span><span> </span><span id="local-6989586621680973801"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973801"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-888"></span><span>    </span><span id="local-6989586621680973800"><span class="annot"><span class="annottext">Bin Any
</span><a href="#local-6989586621680973800"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973801"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-comment">-- a BinPtr</span><span>
</span><span id="line-889"></span><span>    </span><span id="local-6989586621680973799"><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680973799"><span class="hs-identifier hs-var">p_a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; IO (Bin a)
</span><a href="GHC.Utils.Binary.html#tellBin"><span class="hs-identifier hs-var">tellBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973801"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-890"></span><span>    </span><span id="local-6989586621680973798"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973798"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="../../base-4.16.3.0/src/GHC-IO-Unsafe.html#unsafeInterleaveIO"><span class="hs-identifier hs-var">unsafeInterleaveIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-891"></span><span>        </span><span class="hs-comment">-- NB: Use a fresh off_r variable in the child thread, for thread</span><span>
</span><span id="line-892"></span><span>        </span><span class="hs-comment">-- safety.</span><span>
</span><span id="line-893"></span><span>        </span><span id="local-6989586621680973797"><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680973797"><span class="hs-identifier hs-var">off_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO FastMutInt
</span><a href="GHC.Data.FastMutInt.html#newFastMutInt"><span class="hs-identifier hs-var">newFastMutInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-894"></span><span>        </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; Bin a -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getAt"><span class="hs-identifier hs-var">getAt</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973801"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_off_r :: FastMutInt
</span><a href="GHC.Utils.Binary.html#_off_r"><span class="hs-identifier hs-var">_off_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastMutInt
</span><a href="#local-6989586621680973797"><span class="hs-identifier hs-var">off_r</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Bin a
</span><a href="#local-6989586621680973799"><span class="hs-identifier hs-var">p_a</span></a></span><span>
</span><span id="line-895"></span><span>    </span><span class="annot"><span class="annottext">forall {k} (a :: k). BinHandle -&gt; Bin a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#seekBin"><span class="hs-identifier hs-var">seekBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973801"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Bin Any
</span><a href="#local-6989586621680973800"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-comment">-- skip over the object for now</span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973798"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- UserData</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span class="hs-comment">-- | Information we keep around during interface file</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- serialization/deserialization. Namely we keep the functions for serializing</span><span>
</span><span id="line-904"></span><span class="hs-comment">-- and deserializing 'Name's and 'FastString's. We do this because we actually</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- use serialization in two distinct settings,</span><span>
</span><span id="line-906"></span><span class="hs-comment">--</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- * When serializing interface files themselves</span><span>
</span><span id="line-908"></span><span class="hs-comment">--</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- * When computing the fingerprint of an IfaceDecl (which we computing by</span><span>
</span><span id="line-910"></span><span class="hs-comment">--   hashing its Binary serialization)</span><span>
</span><span id="line-911"></span><span class="hs-comment">--</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- These two settings have different needs while serializing Names:</span><span>
</span><span id="line-913"></span><span class="hs-comment">--</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- * Names in interface files are serialized via a symbol table (see Note</span><span>
</span><span id="line-915"></span><span class="hs-comment">--   [Symbol table representation of names] in &quot;GHC.Iface.Binary&quot;).</span><span>
</span><span id="line-916"></span><span class="hs-comment">--</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- * During fingerprinting a binding Name is serialized as the OccName and a</span><span>
</span><span id="line-918"></span><span class="hs-comment">--   non-binding Name is serialized as the fingerprint of the thing they</span><span>
</span><span id="line-919"></span><span class="hs-comment">--   represent. See Note [Fingerprinting IfaceDecls] for further discussion.</span><span>
</span><span id="line-920"></span><span class="hs-comment">--</span><span>
</span><span id="line-921"></span><span class="hs-keyword">data</span><span> </span><span id="UserData"><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-var">UserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-922"></span><span>   </span><span id="UserData"><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-var">UserData</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-923"></span><span>        </span><span class="hs-comment">-- for *deserialising* only:</span><span>
</span><span id="line-924"></span><span>        </span><span id="ud_get_name"><span class="annot"><span class="annottext">UserData -&gt; BinHandle -&gt; IO Name
</span><a href="GHC.Utils.Binary.html#ud_get_name"><span class="hs-identifier hs-var hs-var">ud_get_name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-925"></span><span>        </span><span id="ud_get_fs"><span class="annot"><span class="annottext">UserData -&gt; BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#ud_get_fs"><span class="hs-identifier hs-var hs-var">ud_get_fs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-comment">-- for *serialising* only:</span><span>
</span><span id="line-928"></span><span>        </span><span id="ud_put_nonbinding_name"><span class="annot"><span class="annottext">UserData -&gt; BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_nonbinding_name"><span class="hs-identifier hs-var hs-var">ud_put_nonbinding_name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-929"></span><span>        </span><span class="hs-comment">-- ^ serialize a non-binding 'Name' (e.g. a reference to another</span><span>
</span><span id="line-930"></span><span>        </span><span class="hs-comment">-- binding).</span><span>
</span><span id="line-931"></span><span>        </span><span id="ud_put_binding_name"><span class="annot"><span class="annottext">UserData -&gt; BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_binding_name"><span class="hs-identifier hs-var hs-var">ud_put_binding_name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-932"></span><span>        </span><span class="hs-comment">-- ^ serialize a binding 'Name' (e.g. the name of an IfaceDecl)</span><span>
</span><span id="line-933"></span><span>        </span><span id="ud_put_fs"><span class="annot"><span class="annottext">UserData -&gt; BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_fs"><span class="hs-identifier hs-var hs-var">ud_put_fs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span class="annot"><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier hs-type">newReadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ how to deserialize 'Name's</span><span>
</span><span id="line-937"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-938"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span>
</span><span id="line-939"></span><span id="newReadState"><span class="annot"><span class="annottext">newReadState :: (BinHandle -&gt; IO Name) -&gt; (BinHandle -&gt; IO FastString) -&gt; UserData
</span><a href="GHC.Utils.Binary.html#newReadState"><span class="hs-identifier hs-var hs-var">newReadState</span></a></span></span><span> </span><span id="local-6989586621680973790"><span class="annot"><span class="annottext">BinHandle -&gt; IO Name
</span><a href="#local-6989586621680973790"><span class="hs-identifier hs-var">get_name</span></a></span></span><span> </span><span id="local-6989586621680973789"><span class="annot"><span class="annottext">BinHandle -&gt; IO FastString
</span><a href="#local-6989586621680973789"><span class="hs-identifier hs-var">get_fs</span></a></span></span><span>
</span><span id="line-940"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_get_name :: BinHandle -&gt; IO Name
</span><a href="GHC.Utils.Binary.html#ud_get_name"><span class="hs-identifier hs-var">ud_get_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Name
</span><a href="#local-6989586621680973790"><span class="hs-identifier hs-var">get_name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-941"></span><span>               </span><span class="annot"><span class="annottext">ud_get_fs :: BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#ud_get_fs"><span class="hs-identifier hs-var">ud_get_fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO FastString
</span><a href="#local-6989586621680973789"><span class="hs-identifier hs-var">get_fs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-942"></span><span>               </span><span class="annot"><span class="annottext">ud_put_nonbinding_name :: BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_nonbinding_name"><span class="hs-identifier hs-var">ud_put_nonbinding_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;put_nonbinding_name&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-943"></span><span>               </span><span class="annot"><span class="annottext">ud_put_binding_name :: BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_binding_name"><span class="hs-identifier hs-var">ud_put_binding_name</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;put_binding_name&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-944"></span><span>               </span><span class="annot"><span class="annottext">ud_put_fs :: BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_fs"><span class="hs-identifier hs-var">ud_put_fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;put_fs&quot;</span></span><span>
</span><span id="line-945"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="annot"><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier hs-type">newWriteState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>                 </span><span class="hs-comment">-- ^ how to serialize non-binding 'Name's</span><span>
</span><span id="line-949"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>                 </span><span class="hs-comment">-- ^ how to serialize binding 'Name's</span><span>
</span><span id="line-951"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span>
</span><span id="line-953"></span><span id="newWriteState"><span class="annot"><span class="annottext">newWriteState :: (BinHandle -&gt; Name -&gt; IO ())
-&gt; (BinHandle -&gt; Name -&gt; IO ())
-&gt; (BinHandle -&gt; FastString -&gt; IO ())
-&gt; UserData
</span><a href="GHC.Utils.Binary.html#newWriteState"><span class="hs-identifier hs-var hs-var">newWriteState</span></a></span></span><span> </span><span id="local-6989586621680973787"><span class="annot"><span class="annottext">BinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621680973787"><span class="hs-identifier hs-var">put_nonbinding_name</span></a></span></span><span> </span><span id="local-6989586621680973786"><span class="annot"><span class="annottext">BinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621680973786"><span class="hs-identifier hs-var">put_binding_name</span></a></span></span><span> </span><span id="local-6989586621680973785"><span class="annot"><span class="annottext">BinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621680973785"><span class="hs-identifier hs-var">put_fs</span></a></span></span><span>
</span><span id="line-954"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_get_name :: BinHandle -&gt; IO Name
</span><a href="GHC.Utils.Binary.html#ud_get_name"><span class="hs-identifier hs-var">ud_get_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_name&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-955"></span><span>               </span><span class="annot"><span class="annottext">ud_get_fs :: BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#ud_get_fs"><span class="hs-identifier hs-var">ud_get_fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_fs&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-956"></span><span>               </span><span class="annot"><span class="annottext">ud_put_nonbinding_name :: BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_nonbinding_name"><span class="hs-identifier hs-var">ud_put_nonbinding_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621680973787"><span class="hs-identifier hs-var">put_nonbinding_name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-957"></span><span>               </span><span class="annot"><span class="annottext">ud_put_binding_name :: BinHandle -&gt; Name -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_binding_name"><span class="hs-identifier hs-var">ud_put_binding_name</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Name -&gt; IO ()
</span><a href="#local-6989586621680973786"><span class="hs-identifier hs-var">put_binding_name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-958"></span><span>               </span><span class="annot"><span class="annottext">ud_put_fs :: BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_fs"><span class="hs-identifier hs-var">ud_put_fs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621680973785"><span class="hs-identifier hs-var">put_fs</span></a></span><span>
</span><span id="line-959"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span id="local-6989586621680975697"><span class="annot"><a href="GHC.Utils.Binary.html#noUserData"><span class="hs-identifier hs-type">noUserData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680975697"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-962"></span><span id="noUserData"><span class="annot"><span class="annottext">noUserData :: forall a. a
</span><a href="GHC.Utils.Binary.html#noUserData"><span class="hs-identifier hs-var hs-var">noUserData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var">undef</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;UserData&quot;</span></span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span id="local-6989586621680973784"><span class="annot"><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-type">undef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680973784"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-965"></span><span id="undef"><span class="annot"><span class="annottext">undef :: forall a. String -&gt; a
</span><a href="GHC.Utils.Binary.html#undef"><span class="hs-identifier hs-var hs-var">undef</span></a></span></span><span> </span><span id="local-6989586621680973783"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680973783"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Binary.UserData: no &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680973783"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- The Dictionary</span><span>
</span><span id="line-969"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-970"></span><span>
</span><span id="line-971"></span><span class="hs-keyword">type</span><span> </span><span id="Dictionary"><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier hs-var">Dictionary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Arr.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-comment">-- The dictionary</span><span>
</span><span id="line-972"></span><span>                                       </span><span class="hs-comment">-- Should be 0-indexed</span><span>
</span><span id="line-973"></span><span>
</span><span id="line-974"></span><span class="annot"><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier hs-type">putDictionary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html#UniqFM"><span class="hs-identifier hs-type">UniqFM</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span id="putDictionary"><span class="annot"><span class="annottext">putDictionary :: BinHandle -&gt; Int -&gt; UniqFM FastString (Int, FastString) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putDictionary"><span class="hs-identifier hs-var hs-var">putDictionary</span></a></span></span><span> </span><span id="local-6989586621680973782"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973782"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973781"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973781"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680973780"><span class="annot"><span class="annottext">UniqFM FastString (Int, FastString)
</span><a href="#local-6989586621680973780"><span class="hs-identifier hs-var">dict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-976"></span><span>  </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973782"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973781"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-977"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.3.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-var">putFS</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973782"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Array i e -&gt; [e]
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#elems"><span class="hs-identifier hs-var">elems</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [(i, e)] -&gt; Array i e
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#array"><span class="hs-identifier hs-var">array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973781"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key elt. UniqFM key elt -&gt; [elt]
</span><a href="GHC.Types.Unique.FM.html#nonDetEltsUFM"><span class="hs-identifier hs-var">nonDetEltsUFM</span></a></span><span> </span><span class="annot"><span class="annottext">UniqFM FastString (Int, FastString)
</span><a href="#local-6989586621680973780"><span class="hs-identifier hs-var">dict</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>    </span><span class="hs-comment">-- It's OK to use nonDetEltsUFM here because the elements have indices</span><span>
</span><span id="line-979"></span><span>    </span><span class="hs-comment">-- that array uses to create order</span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span class="annot"><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier hs-type">getDictionary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Dictionary"><span class="hs-identifier hs-type">Dictionary</span></a></span><span>
</span><span id="line-982"></span><span id="getDictionary"><span class="annot"><span class="annottext">getDictionary :: BinHandle -&gt; IO Dictionary
</span><a href="GHC.Utils.Binary.html#getDictionary"><span class="hs-identifier hs-var hs-var">getDictionary</span></a></span></span><span> </span><span id="local-6989586621680973777"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973777"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-983"></span><span>  </span><span id="local-6989586621680973776"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973776"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973777"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-984"></span><span>  </span><span id="local-6989586621680973775"><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621680973775"><span class="hs-identifier hs-var">elems</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../../base-4.16.3.0/src/Data-Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#take"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973776"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><a href="../../base-4.16.3.0/src/GHC-List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-var">getFS</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973777"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><a href="../../base-4.16.3.0/src/GHC-Arr.html#listArray"><span class="hs-identifier hs-var">listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973776"><span class="hs-identifier hs-var">sz</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.3.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FastString]
</span><a href="#local-6989586621680973775"><span class="hs-identifier hs-var">elems</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- The Symbol Table</span><span>
</span><span id="line-989"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-990"></span><span>
</span><span id="line-991"></span><span class="hs-comment">-- On disk, the symbol table is an array of IfExtName, when</span><span>
</span><span id="line-992"></span><span class="hs-comment">-- reading it in we turn it into a SymbolTable.</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="hs-keyword">type</span><span> </span><span id="SymbolTable"><span class="annot"><a href="GHC.Utils.Binary.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Arr.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-997"></span><span class="hs-comment">-- Reading and writing FastStrings</span><span>
</span><span id="line-998"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-999"></span><span>
</span><span id="line-1000"></span><span class="annot"><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-type">putFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span id="putFS"><span class="annot"><span class="annottext">putFS :: BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putFS"><span class="hs-identifier hs-var hs-var">putFS</span></a></span></span><span> </span><span id="local-6989586621680973770"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973770"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973769"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973769"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var">putBS</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973770"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; ByteString
</span><a href="GHC.Data.FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973769"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span class="annot"><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-type">getFS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-1004"></span><span id="getFS"><span class="annot"><span class="annottext">getFS :: BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#getFS"><span class="hs-identifier hs-var hs-var">getFS</span></a></span></span><span> </span><span id="local-6989586621680973766"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973766"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1005"></span><span>  </span><span id="local-6989586621680973765"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973765"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973766"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1006"></span><span>  </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973766"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973765"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680973764"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973764"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastStringBytes"><span class="hs-identifier hs-var">mkFastStringBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973764"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973765"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>
</span><span id="line-1008"></span><span class="annot"><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-type">putBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span id="putBS"><span class="annot"><span class="annottext">putBS :: BinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var hs-var">putBS</span></a></span></span><span> </span><span id="local-6989586621680973762"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973762"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973761"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680973761"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1010"></span><span>  </span><span class="annot"><span class="annottext">forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Unsafe.html#unsafeUseAsCStringLen"><span class="hs-identifier hs-var">BS.unsafeUseAsCStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680973761"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680973759"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621680973759"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680973758"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973758"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1011"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973762"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973758"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1012"></span><span>    </span><span class="annot"><span class="annottext">BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putPrim"><span class="hs-identifier hs-var">putPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973762"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973758"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680973757"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973757"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
</span><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#memcpy"><span class="hs-identifier hs-var">BS.memcpy</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973757"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ptr a -&gt; Ptr b
</span><a href="../../base-4.16.3.0/src/GHC-Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621680973759"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973758"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span class="annot"><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-type">getBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#BinHandle"><span class="hs-identifier hs-type">BinHandle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1015"></span><span id="getBS"><span class="annot"><span class="annottext">getBS :: BinHandle -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-var hs-var">getBS</span></a></span></span><span> </span><span id="local-6989586621680973754"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973754"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1016"></span><span>  </span><span id="local-6989586621680973753"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973753"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973754"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1017"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#create"><span class="hs-identifier hs-var">BS.create</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680973751"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973751"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1018"></span><span>    </span><span class="annot"><span class="annottext">forall a. BinHandle -&gt; Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
</span><a href="GHC.Utils.Binary.html#getPrim"><span class="hs-identifier hs-var">getPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973754"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680973750"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973750"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
</span><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#memcpy"><span class="hs-identifier hs-var">BS.memcpy</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973751"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621680973750"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973753"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>
</span><span id="line-1020"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973747"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../bytestring-0.11.3.1/src/Data-ByteString-Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1021"></span><span>  </span><span id="local-6989586621680973745"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; ByteString -&gt; IO ()
</span><a href="#local-6989586621680973745"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973744"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973744"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973743"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680973743"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; ByteString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putBS"><span class="hs-identifier hs-var">putBS</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973744"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680973743"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1022"></span><span>  </span><span id="local-6989586621680973742"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO ByteString
</span><a href="#local-6989586621680973742"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973741"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973741"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO ByteString
</span><a href="GHC.Utils.Binary.html#getBS"><span class="hs-identifier hs-var">getBS</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973741"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973738"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1025"></span><span>  </span><span id="local-6989586621680973736"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621680973736"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973735"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973735"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973734"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973734"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1026"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; UserData
</span><a href="GHC.Utils.Binary.html#getUserData"><span class="hs-identifier hs-var">getUserData</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973735"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1027"></span><span>        </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_put_fs :: UserData -&gt; BinHandle -&gt; FastString -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#ud_put_fs"><span class="hs-identifier hs-var">ud_put_fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680973733"><span class="annot"><span class="annottext">BinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621680973733"><span class="hs-identifier hs-var">put_fs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; FastString -&gt; IO ()
</span><a href="#local-6989586621680973733"><span class="hs-identifier hs-var">put_fs</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973735"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973734"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span>  </span><span id="local-6989586621680973732"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO FastString
</span><a href="#local-6989586621680973732"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973731"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973731"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1030"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; UserData
</span><a href="GHC.Utils.Binary.html#getUserData"><span class="hs-identifier hs-var">getUserData</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973731"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1031"></span><span>        </span><span class="annot"><a href="GHC.Utils.Binary.html#UserData"><span class="hs-identifier hs-type">UserData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ud_get_fs :: UserData -&gt; BinHandle -&gt; IO FastString
</span><a href="GHC.Utils.Binary.html#ud_get_fs"><span class="hs-identifier hs-var">ud_get_fs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680973730"><span class="annot"><span class="annottext">BinHandle -&gt; IO FastString
</span><a href="#local-6989586621680973730"><span class="hs-identifier hs-var">get_fs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO FastString
</span><a href="#local-6989586621680973730"><span class="hs-identifier hs-var">get_fs</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973731"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span id="local-6989586621680973720"><span id="local-6989586621680973724"><span id="local-6989586621680973728"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#NonDetFastString"><span class="hs-identifier hs-type">NonDetFastString</span></a></span></span></span></span><span>
</span><span id="line-1034"></span><span id="local-6989586621680973707"><span id="local-6989586621680973711"><span id="local-6989586621680973715"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#LexicalFastString"><span class="hs-identifier hs-type">LexicalFastString</span></a></span></span></span></span><span>
</span><span id="line-1035"></span><span>
</span><span id="line-1036"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973701"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Fingerprint-Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1037"></span><span>  </span><span id="local-6989586621680973696"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Fingerprint -&gt; IO ()
</span><a href="#local-6989586621680973696"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973695"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973695"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.3.0/src/GHC-Fingerprint-Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span> </span><span id="local-6989586621680973694"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973694"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621680973693"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973693"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973695"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973694"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973695"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973693"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-1038"></span><span>  </span><span id="local-6989586621680973687"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO Fingerprint
</span><a href="#local-6989586621680973687"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>  </span><span id="local-6989586621680973686"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973686"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973685"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973685"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973686"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621680973684"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973684"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973686"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Fingerprint
</span><a href="../../base-4.16.3.0/src/GHC-Fingerprint-Type.html#Fingerprint"><span class="hs-identifier hs-var">Fingerprint</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973685"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680973684"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- instance Binary FunctionOrData where</span><span>
</span><span id="line-1041"></span><span class="hs-comment">--     put_ bh IsFunction = putByte bh 0</span><span>
</span><span id="line-1042"></span><span class="hs-comment">--     put_ bh IsData     = putByte bh 1</span><span>
</span><span id="line-1043"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1044"></span><span class="hs-comment">--         h &lt;- getByte bh</span><span>
</span><span id="line-1045"></span><span class="hs-comment">--         case h of</span><span>
</span><span id="line-1046"></span><span class="hs-comment">--           0 -&gt; return IsFunction</span><span>
</span><span id="line-1047"></span><span class="hs-comment">--           1 -&gt; return IsData</span><span>
</span><span id="line-1048"></span><span class="hs-comment">--           _ -&gt; panic &quot;Binary FunctionOrData&quot;</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- instance Binary TupleSort where</span><span>
</span><span id="line-1051"></span><span class="hs-comment">--     put_ bh BoxedTuple      = putByte bh 0</span><span>
</span><span id="line-1052"></span><span class="hs-comment">--     put_ bh UnboxedTuple    = putByte bh 1</span><span>
</span><span id="line-1053"></span><span class="hs-comment">--     put_ bh ConstraintTuple = putByte bh 2</span><span>
</span><span id="line-1054"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1055"></span><span class="hs-comment">--       h &lt;- getByte bh</span><span>
</span><span id="line-1056"></span><span class="hs-comment">--       case h of</span><span>
</span><span id="line-1057"></span><span class="hs-comment">--         0 -&gt; do return BoxedTuple</span><span>
</span><span id="line-1058"></span><span class="hs-comment">--         1 -&gt; do return UnboxedTuple</span><span>
</span><span id="line-1059"></span><span class="hs-comment">--         _ -&gt; do return ConstraintTuple</span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- instance Binary Activation where</span><span>
</span><span id="line-1062"></span><span class="hs-comment">--     put_ bh NeverActive = do</span><span>
</span><span id="line-1063"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1064"></span><span class="hs-comment">--     put_ bh FinalActive = do</span><span>
</span><span id="line-1065"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1066"></span><span class="hs-comment">--     put_ bh AlwaysActive = do</span><span>
</span><span id="line-1067"></span><span class="hs-comment">--             putByte bh 2</span><span>
</span><span id="line-1068"></span><span class="hs-comment">--     put_ bh (ActiveBefore src aa) = do</span><span>
</span><span id="line-1069"></span><span class="hs-comment">--             putByte bh 3</span><span>
</span><span id="line-1070"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1071"></span><span class="hs-comment">--             put_ bh aa</span><span>
</span><span id="line-1072"></span><span class="hs-comment">--     put_ bh (ActiveAfter src ab) = do</span><span>
</span><span id="line-1073"></span><span class="hs-comment">--             putByte bh 4</span><span>
</span><span id="line-1074"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1075"></span><span class="hs-comment">--             put_ bh ab</span><span>
</span><span id="line-1076"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1077"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1078"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1079"></span><span class="hs-comment">--               0 -&gt; do return NeverActive</span><span>
</span><span id="line-1080"></span><span class="hs-comment">--               1 -&gt; do return FinalActive</span><span>
</span><span id="line-1081"></span><span class="hs-comment">--               2 -&gt; do return AlwaysActive</span><span>
</span><span id="line-1082"></span><span class="hs-comment">--               3 -&gt; do src &lt;- get bh</span><span>
</span><span id="line-1083"></span><span class="hs-comment">--                       aa &lt;- get bh</span><span>
</span><span id="line-1084"></span><span class="hs-comment">--                       return (ActiveBefore src aa)</span><span>
</span><span id="line-1085"></span><span class="hs-comment">--               _ -&gt; do src &lt;- get bh</span><span>
</span><span id="line-1086"></span><span class="hs-comment">--                       ab &lt;- get bh</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--                       return (ActiveAfter src ab)</span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span class="hs-comment">-- instance Binary InlinePragma where</span><span>
</span><span id="line-1090"></span><span class="hs-comment">--     put_ bh (InlinePragma s a b c d) = do</span><span>
</span><span id="line-1091"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1092"></span><span class="hs-comment">--             put_ bh a</span><span>
</span><span id="line-1093"></span><span class="hs-comment">--             put_ bh b</span><span>
</span><span id="line-1094"></span><span class="hs-comment">--             put_ bh c</span><span>
</span><span id="line-1095"></span><span class="hs-comment">--             put_ bh d</span><span>
</span><span id="line-1096"></span><span>
</span><span id="line-1097"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1098"></span><span class="hs-comment">--            s &lt;- get bh</span><span>
</span><span id="line-1099"></span><span class="hs-comment">--            a &lt;- get bh</span><span>
</span><span id="line-1100"></span><span class="hs-comment">--            b &lt;- get bh</span><span>
</span><span id="line-1101"></span><span class="hs-comment">--            c &lt;- get bh</span><span>
</span><span id="line-1102"></span><span class="hs-comment">--            d &lt;- get bh</span><span>
</span><span id="line-1103"></span><span class="hs-comment">--            return (InlinePragma s a b c d)</span><span>
</span><span id="line-1104"></span><span>
</span><span id="line-1105"></span><span class="hs-comment">-- instance Binary RuleMatchInfo where</span><span>
</span><span id="line-1106"></span><span class="hs-comment">--     put_ bh FunLike = putByte bh 0</span><span>
</span><span id="line-1107"></span><span class="hs-comment">--     put_ bh ConLike = putByte bh 1</span><span>
</span><span id="line-1108"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1109"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1110"></span><span class="hs-comment">--             if h == 1 then return ConLike</span><span>
</span><span id="line-1111"></span><span class="hs-comment">--                       else return FunLike</span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span class="hs-comment">-- instance Binary InlineSpec where</span><span>
</span><span id="line-1114"></span><span class="hs-comment">--     put_ bh NoUserInlinePrag = putByte bh 0</span><span>
</span><span id="line-1115"></span><span class="hs-comment">--     put_ bh Inline           = putByte bh 1</span><span>
</span><span id="line-1116"></span><span class="hs-comment">--     put_ bh Inlinable        = putByte bh 2</span><span>
</span><span id="line-1117"></span><span class="hs-comment">--     put_ bh NoInline         = putByte bh 3</span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span class="hs-comment">--     get bh = do h &lt;- getByte bh</span><span>
</span><span id="line-1120"></span><span class="hs-comment">--                 case h of</span><span>
</span><span id="line-1121"></span><span class="hs-comment">--                   0 -&gt; return NoUserInlinePrag</span><span>
</span><span id="line-1122"></span><span class="hs-comment">--                   1 -&gt; return Inline</span><span>
</span><span id="line-1123"></span><span class="hs-comment">--                   2 -&gt; return Inlinable</span><span>
</span><span id="line-1124"></span><span class="hs-comment">--                   _ -&gt; return NoInline</span><span>
</span><span id="line-1125"></span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- instance Binary RecFlag where</span><span>
</span><span id="line-1127"></span><span class="hs-comment">--     put_ bh Recursive = do</span><span>
</span><span id="line-1128"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1129"></span><span class="hs-comment">--     put_ bh NonRecursive = do</span><span>
</span><span id="line-1130"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1131"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1132"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1133"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1134"></span><span class="hs-comment">--               0 -&gt; do return Recursive</span><span>
</span><span id="line-1135"></span><span class="hs-comment">--               _ -&gt; do return NonRecursive</span><span>
</span><span id="line-1136"></span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- instance Binary OverlapMode where</span><span>
</span><span id="line-1138"></span><span class="hs-comment">--     put_ bh (NoOverlap    s) = putByte bh 0 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1139"></span><span class="hs-comment">--     put_ bh (Overlaps     s) = putByte bh 1 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1140"></span><span class="hs-comment">--     put_ bh (Incoherent   s) = putByte bh 2 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1141"></span><span class="hs-comment">--     put_ bh (Overlapping  s) = putByte bh 3 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1142"></span><span class="hs-comment">--     put_ bh (Overlappable s) = putByte bh 4 &gt;&gt; put_ bh s</span><span>
</span><span id="line-1143"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1144"></span><span class="hs-comment">--         h &lt;- getByte bh</span><span>
</span><span id="line-1145"></span><span class="hs-comment">--         case h of</span><span>
</span><span id="line-1146"></span><span class="hs-comment">--             0 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ NoOverlap s</span><span>
</span><span id="line-1147"></span><span class="hs-comment">--             1 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlaps s</span><span>
</span><span id="line-1148"></span><span class="hs-comment">--             2 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Incoherent s</span><span>
</span><span id="line-1149"></span><span class="hs-comment">--             3 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlapping s</span><span>
</span><span id="line-1150"></span><span class="hs-comment">--             4 -&gt; (get bh) &gt;&gt;= \s -&gt; return $ Overlappable s</span><span>
</span><span id="line-1151"></span><span class="hs-comment">--             _ -&gt; panic (&quot;get OverlapMode&quot; ++ show h)</span><span>
</span><span id="line-1152"></span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- instance Binary OverlapFlag where</span><span>
</span><span id="line-1155"></span><span class="hs-comment">--     put_ bh flag = do put_ bh (overlapMode flag)</span><span>
</span><span id="line-1156"></span><span class="hs-comment">--                       put_ bh (isSafeOverlap flag)</span><span>
</span><span id="line-1157"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1158"></span><span class="hs-comment">--         h &lt;- get bh</span><span>
</span><span id="line-1159"></span><span class="hs-comment">--         b &lt;- get bh</span><span>
</span><span id="line-1160"></span><span class="hs-comment">--         return OverlapFlag { overlapMode = h, isSafeOverlap = b }</span><span>
</span><span id="line-1161"></span><span>
</span><span id="line-1162"></span><span class="hs-comment">-- instance Binary FixityDirection where</span><span>
</span><span id="line-1163"></span><span class="hs-comment">--     put_ bh InfixL = do</span><span>
</span><span id="line-1164"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1165"></span><span class="hs-comment">--     put_ bh InfixR = do</span><span>
</span><span id="line-1166"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1167"></span><span class="hs-comment">--     put_ bh InfixN = do</span><span>
</span><span id="line-1168"></span><span class="hs-comment">--             putByte bh 2</span><span>
</span><span id="line-1169"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1170"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1171"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1172"></span><span class="hs-comment">--               0 -&gt; do return InfixL</span><span>
</span><span id="line-1173"></span><span class="hs-comment">--               1 -&gt; do return InfixR</span><span>
</span><span id="line-1174"></span><span class="hs-comment">--               _ -&gt; do return InfixN</span><span>
</span><span id="line-1175"></span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- instance Binary Fixity where</span><span>
</span><span id="line-1177"></span><span class="hs-comment">--     put_ bh (Fixity src aa ab) = do</span><span>
</span><span id="line-1178"></span><span class="hs-comment">--             put_ bh src</span><span>
</span><span id="line-1179"></span><span class="hs-comment">--             put_ bh aa</span><span>
</span><span id="line-1180"></span><span class="hs-comment">--             put_ bh ab</span><span>
</span><span id="line-1181"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1182"></span><span class="hs-comment">--           src &lt;- get bh</span><span>
</span><span id="line-1183"></span><span class="hs-comment">--           aa &lt;- get bh</span><span>
</span><span id="line-1184"></span><span class="hs-comment">--           ab &lt;- get bh</span><span>
</span><span id="line-1185"></span><span class="hs-comment">--           return (Fixity src aa ab)</span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- instance Binary WarningTxt where</span><span>
</span><span id="line-1188"></span><span class="hs-comment">--     put_ bh (WarningTxt s w) = do</span><span>
</span><span id="line-1189"></span><span class="hs-comment">--             putByte bh 0</span><span>
</span><span id="line-1190"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1191"></span><span class="hs-comment">--             put_ bh w</span><span>
</span><span id="line-1192"></span><span class="hs-comment">--     put_ bh (DeprecatedTxt s d) = do</span><span>
</span><span id="line-1193"></span><span class="hs-comment">--             putByte bh 1</span><span>
</span><span id="line-1194"></span><span class="hs-comment">--             put_ bh s</span><span>
</span><span id="line-1195"></span><span class="hs-comment">--             put_ bh d</span><span>
</span><span id="line-1196"></span><span>
</span><span id="line-1197"></span><span class="hs-comment">--     get bh = do</span><span>
</span><span id="line-1198"></span><span class="hs-comment">--             h &lt;- getByte bh</span><span>
</span><span id="line-1199"></span><span class="hs-comment">--             case h of</span><span>
</span><span id="line-1200"></span><span class="hs-comment">--               0 -&gt; do s &lt;- get bh</span><span>
</span><span id="line-1201"></span><span class="hs-comment">--                       w &lt;- get bh</span><span>
</span><span id="line-1202"></span><span class="hs-comment">--                       return (WarningTxt s w)</span><span>
</span><span id="line-1203"></span><span class="hs-comment">--               _ -&gt; do s &lt;- get bh</span><span>
</span><span id="line-1204"></span><span class="hs-comment">--                       d &lt;- get bh</span><span>
</span><span id="line-1205"></span><span class="hs-comment">--                       return (DeprecatedTxt s d)</span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span class="hs-comment">-- instance Binary StringLiteral where</span><span>
</span><span id="line-1208"></span><span class="hs-comment">--   put_ bh (StringLiteral st fs _) = do</span><span>
</span><span id="line-1209"></span><span class="hs-comment">--             put_ bh st</span><span>
</span><span id="line-1210"></span><span class="hs-comment">--             put_ bh fs</span><span>
</span><span id="line-1211"></span><span class="hs-comment">--   get bh = do</span><span>
</span><span id="line-1212"></span><span class="hs-comment">--             st &lt;- get bh</span><span>
</span><span id="line-1213"></span><span class="hs-comment">--             fs &lt;- get bh</span><span>
</span><span id="line-1214"></span><span class="hs-comment">--             return (StringLiteral st fs Nothing)</span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973681"><span id="local-6989586621680975527"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680975527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1217"></span><span>    </span><span id="local-6989586621680973676"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; Located a -&gt; IO ()
</span><a href="#local-6989586621680973676"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973675"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973675"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680973673"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621680973673"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680973672"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973672"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1218"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973675"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621680973673"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1219"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973675"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973672"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span>    </span><span id="local-6989586621680973666"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO (Located a)
</span><a href="#local-6989586621680973666"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973665"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973665"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1222"></span><span>            </span><span id="local-6989586621680973664"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621680973664"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973665"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1223"></span><span>            </span><span id="local-6989586621680973663"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973663"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973665"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1224"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621680973664"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680973663"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>
</span><span id="line-1226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973660"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1227"></span><span>  </span><span id="local-6989586621680973649"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; RealSrcSpan -&gt; IO ()
</span><a href="#local-6989586621680973649"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973648"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973647"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1228"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; FastString
</span><a href="GHC.Types.SrcLoc.html#srcSpanFile"><span class="hs-identifier hs-var">srcSpanFile</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartLine"><span class="hs-identifier hs-var">srcSpanStartLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanStartCol"><span class="hs-identifier hs-var">srcSpanStartCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanEndLine"><span class="hs-identifier hs-var">srcSpanEndLine</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>            </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973648"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Int
</span><a href="GHC.Types.SrcLoc.html#srcSpanEndCol"><span class="hs-identifier hs-var">srcSpanEndCol</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973647"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span>  </span><span id="local-6989586621680973630"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO RealSrcSpan
</span><a href="#local-6989586621680973630"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973629"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1235"></span><span>            </span><span id="local-6989586621680973628"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973628"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1236"></span><span>            </span><span id="local-6989586621680973627"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973627"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1237"></span><span>            </span><span id="local-6989586621680973626"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973626"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1238"></span><span>            </span><span id="local-6989586621680973625"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973625"><span class="hs-identifier hs-var">el</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1239"></span><span>            </span><span id="local-6989586621680973624"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973624"><span class="hs-identifier hs-var">ec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973629"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1240"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; RealSrcLoc -&gt; RealSrcSpan
</span><a href="GHC.Types.SrcLoc.html#mkRealSrcSpan"><span class="hs-identifier hs-var">mkRealSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Int -&gt; Int -&gt; RealSrcLoc
</span><a href="GHC.Types.SrcLoc.html#mkRealSrcLoc"><span class="hs-identifier hs-var">mkRealSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973628"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973627"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973626"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Int -&gt; Int -&gt; RealSrcLoc
</span><a href="GHC.Types.SrcLoc.html#mkRealSrcLoc"><span class="hs-identifier hs-var">mkRealSrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973628"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973625"><span class="hs-identifier hs-var">el</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973624"><span class="hs-identifier hs-var">ec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973619"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#BufPos"><span class="hs-identifier hs-type">BufPos</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1244"></span><span>  </span><span id="local-6989586621680973616"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; BufPos -&gt; IO ()
</span><a href="#local-6989586621680973616"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973615"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973615"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#BufPos"><span class="hs-identifier hs-type">BufPos</span></a></span><span> </span><span id="local-6989586621680973613"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973613"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973615"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680973613"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1245"></span><span>  </span><span id="local-6989586621680973610"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO BufPos
</span><a href="#local-6989586621680973610"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973609"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973609"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; BufPos
</span><a href="GHC.Types.SrcLoc.html#BufPos"><span class="hs-identifier hs-var">BufPos</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973609"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1246"></span><span>
</span><span id="line-1247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973606"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#BufSpan"><span class="hs-identifier hs-type">BufSpan</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1248"></span><span>  </span><span id="local-6989586621680973601"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; BufSpan -&gt; IO ()
</span><a href="#local-6989586621680973601"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973600"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973600"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#BufSpan"><span class="hs-identifier hs-type">BufSpan</span></a></span><span> </span><span id="local-6989586621680973598"><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973598"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621680973597"><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973597"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1249"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973600"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973598"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-1250"></span><span>    </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973600"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973597"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-1251"></span><span>  </span><span id="local-6989586621680973591"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO BufSpan
</span><a href="#local-6989586621680973591"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973590"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973590"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1252"></span><span>    </span><span id="local-6989586621680973589"><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973589"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973590"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1253"></span><span>    </span><span id="local-6989586621680973588"><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973588"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973590"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1254"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BufPos -&gt; BufPos -&gt; BufSpan
</span><a href="GHC.Types.SrcLoc.html#BufSpan"><span class="hs-identifier hs-var">BufSpan</span></a></span><span> </span><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973589"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">BufPos
</span><a href="#local-6989586621680973588"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>
</span><span id="line-1256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973585"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulSpanReason"><span class="hs-identifier hs-type">UnhelpfulSpanReason</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1257"></span><span>  </span><span id="local-6989586621680973576"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; UnhelpfulSpanReason -&gt; IO ()
</span><a href="#local-6989586621680973576"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973575"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621680973574"><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973574"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973574"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1258"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulNoLocationInfo"><span class="hs-identifier hs-var">UnhelpfulNoLocationInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1259"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulWiredIn"><span class="hs-identifier hs-var">UnhelpfulWiredIn</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1260"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulInteractive"><span class="hs-identifier hs-var">UnhelpfulInteractive</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1261"></span><span>    </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulGenerated"><span class="hs-identifier hs-var">UnhelpfulGenerated</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1262"></span><span>    </span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulOther"><span class="hs-identifier hs-type">UnhelpfulOther</span></a></span><span> </span><span id="local-6989586621680973568"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973568"><span class="hs-identifier hs-var">fs</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973575"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680973568"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span>  </span><span id="local-6989586621680973552"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO UnhelpfulSpanReason
</span><a href="#local-6989586621680973552"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973551"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973551"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1265"></span><span>    </span><span id="local-6989586621680973550"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973550"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973551"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1266"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973550"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1267"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulNoLocationInfo"><span class="hs-identifier hs-var">UnhelpfulNoLocationInfo</span></a></span><span>
</span><span id="line-1268"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulWiredIn"><span class="hs-identifier hs-var">UnhelpfulWiredIn</span></a></span><span>
</span><span id="line-1269"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulInteractive"><span class="hs-identifier hs-var">UnhelpfulInteractive</span></a></span><span>
</span><span id="line-1270"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulGenerated"><span class="hs-identifier hs-var">UnhelpfulGenerated</span></a></span><span>
</span><span id="line-1271"></span><span>      </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; UnhelpfulSpanReason
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulOther"><span class="hs-identifier hs-var">UnhelpfulOther</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.3.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973551"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1272"></span><span>
</span><span id="line-1273"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680973547"><span class="annot"><a href="GHC.Utils.Binary.html#Binary"><span class="hs-identifier hs-type">Binary</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1274"></span><span>  </span><span id="local-6989586621680973536"><span class="annot"><span class="annottext">put_ :: BinHandle -&gt; SrcSpan -&gt; IO ()
</span><a href="#local-6989586621680973536"><span class="hs-identifier hs-var hs-var hs-var hs-var">put_</span></a></span></span><span> </span><span id="local-6989586621680973535"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973535"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-type">RealSrcSpan</span></a></span><span> </span><span id="local-6989586621680973533"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973533"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621680973532"><span class="annot"><span class="annottext">Maybe BufSpan
</span><a href="#local-6989586621680973532"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1275"></span><span>          </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973535"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1276"></span><span>          </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973535"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973533"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1277"></span><span>          </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973535"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BufSpan
</span><a href="#local-6989586621680973532"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-1278"></span><span>
</span><span id="line-1279"></span><span>  </span><span class="annot"><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span id="local-6989586621680973531"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973531"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulSpan"><span class="hs-identifier hs-type">UnhelpfulSpan</span></a></span><span> </span><span id="local-6989586621680973529"><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973529"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1280"></span><span>          </span><span class="annot"><span class="annottext">BinHandle -&gt; Word8 -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#putByte"><span class="hs-identifier hs-var">putByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973531"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1281"></span><span>          </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; a -&gt; IO ()
</span><a href="GHC.Utils.Binary.html#put_"><span class="hs-identifier hs-var">put_</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973531"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973529"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1282"></span><span>
</span><span id="line-1283"></span><span>  </span><span id="local-6989586621680973516"><span class="annot"><span class="annottext">get :: BinHandle -&gt; IO SrcSpan
</span><a href="#local-6989586621680973516"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span id="local-6989586621680973515"><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973515"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1284"></span><span>          </span><span id="local-6989586621680973514"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973514"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinHandle -&gt; IO Word8
</span><a href="GHC.Utils.Binary.html#getByte"><span class="hs-identifier hs-var">getByte</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973515"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1285"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680973514"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1286"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973513"><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973513"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973515"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1287"></span><span>                    </span><span id="local-6989586621680973512"><span class="annot"><span class="annottext">Maybe BufSpan
</span><a href="#local-6989586621680973512"><span class="hs-identifier hs-var">sb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973515"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1288"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; Maybe BufSpan -&gt; SrcSpan
</span><a href="GHC.Types.SrcLoc.html#RealSrcSpan"><span class="hs-identifier hs-var">RealSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcSpan
</span><a href="#local-6989586621680973513"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BufSpan
</span><a href="#local-6989586621680973512"><span class="hs-identifier hs-var">sb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680973511"><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973511"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; BinHandle -&gt; IO a
</span><a href="GHC.Utils.Binary.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">BinHandle
</span><a href="#local-6989586621680973515"><span class="hs-identifier hs-var">bh</span></a></span><span>
</span><span id="line-1290"></span><span>                    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.3.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnhelpfulSpanReason -&gt; SrcSpan
</span><a href="GHC.Types.SrcLoc.html#UnhelpfulSpan"><span class="hs-identifier hs-var">UnhelpfulSpan</span></a></span><span> </span><span class="annot"><span class="annottext">UnhelpfulSpanReason
</span><a href="#local-6989586621680973511"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span></pre></body></html>
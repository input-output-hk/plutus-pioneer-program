<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/GHC/Num/Backend/GMP.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE NoImplicitPrelude #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE BangPatterns #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE GHCForeignImportPrim #-}</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE MagicHash #-}</span>
<a name="line-7"></a><span class='hs-comment'>{-# LANGUAGE UnboxedTuples #-}</span>
<a name="line-8"></a><span class='hs-comment'>{-# LANGUAGE UnliftedFFITypes #-}</span>
<a name="line-9"></a><span class='hs-comment'>{-# LANGUAGE NegativeLiterals #-}</span>
<a name="line-10"></a><span class='hs-comment'>{-# LANGUAGE BlockArguments #-}</span>
<a name="line-11"></a><span class='hs-comment'>{-# LANGUAGE LambdaCase #-}</span>
<a name="line-12"></a>
<a name="line-13"></a><span class='hs-comment'>{-# OPTIONS_GHC -Wno-name-shadowing #-}</span>
<a name="line-14"></a>
<a name="line-15"></a><span class='hs-comment'>-- | Backend based on the GNU GMP library.</span>
<a name="line-16"></a><span class='hs-comment'>--</span>
<a name="line-17"></a><span class='hs-comment'>-- This has been adapted from the legacy `integer-gmp` package written by</span>
<a name="line-18"></a><span class='hs-comment'>-- Herbert Valerio Riedel.</span>
<a name="line-19"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Num.Backend.GMP</span> <span class='hs-keyword'>where</span>
<a name="line-20"></a>
<a name="line-21"></a><span class='hs-cpp'>#include "MachDeps.h"</span>
<a name="line-22"></a><span class='hs-cpp'>#include "WordSize.h"</span>
<a name="line-23"></a>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Num.WordArray</span>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Num.Primitives</span>
<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Prim</span>
<a name="line-27"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types</span>
<a name="line-28"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Magic</span> <span class='hs-layout'>(</span><span class='hs-varid'>runRW</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Num.Integer</span>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Num.BigNat</span>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Num.Natural</span>
<a name="line-32"></a>
<a name="line-33"></a><span class='hs-keyword'>default</span> <span class='hs-conid'>()</span>
<a name="line-34"></a>
<a name="line-35"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-36"></a><span class='hs-comment'>-- type definitions</span>
<a name="line-37"></a>
<a name="line-38"></a><span class='hs-comment'>-- NB: all code assumes GMP_LIMB_BITS == WORD_SIZE_IN_BITS</span>
<a name="line-39"></a><span class='hs-comment'>-- The C99 code in cbits/gmp_wrappers.c will fail to compile if this doesn't hold</span>
<a name="line-40"></a>
<a name="line-41"></a><a name="GmpLimb"></a><span class='hs-comment'>-- | Type representing a GMP Limb</span>
<a name="line-42"></a><a name="GmpLimb"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>GmpLimb</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Word</span> <span class='hs-comment'>-- actually, 'CULong'</span>
<a name="line-43"></a><a name="GmpLimb"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-44"></a>
<a name="line-45"></a><a name="GmpSize"></a><span class='hs-comment'>-- | Count of 'GmpLimb's, must be positive (unless specified otherwise).</span>
<a name="line-46"></a><a name="GmpSize"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>GmpSize</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>  <span class='hs-comment'>-- actually, a 'CLong'</span>
<a name="line-47"></a><a name="GmpSize"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-48"></a>
<a name="line-49"></a><a name="narrowGmpSize"></a><span class='hs-definition'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-50"></a><span class='hs-cpp'>#if SIZEOF_LONG == SIZEOF_HSWORD</span>
<a name="line-51"></a><span class='hs-definition'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-52"></a><span class='hs-cpp'>#elif (SIZEOF_LONG == 4) &amp;&amp; (SIZEOF_HSWORD == 8)</span>
<a name="line-53"></a><span class='hs-comment'>-- On IL32P64 (i.e. Win64), we have to be careful with CLong not being</span>
<a name="line-54"></a><span class='hs-comment'>-- 64bit.  This is mostly an issue on values returned from C functions</span>
<a name="line-55"></a><span class='hs-comment'>-- due to sign-extension.</span>
<a name="line-56"></a><span class='hs-definition'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>narrow32Int</span><span class='hs-cpp'>#</span>
<a name="line-57"></a><span class='hs-cpp'>#endif</span>
<a name="line-58"></a>
<a name="line-59"></a><a name="narrowCInt"></a><span class='hs-definition'>narrowCInt</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-60"></a><span class='hs-definition'>narrowCInt</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>narrow32Int</span><span class='hs-cpp'>#</span>
<a name="line-61"></a>
<a name="line-62"></a><a name="bignat_compare"></a><span class='hs-definition'>bignat_compare</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-63"></a><span class='hs-definition'>bignat_compare</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>narrowCInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_cmp</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-64"></a>
<a name="line-65"></a><a name="bignat_add"></a><span class='hs-definition'>bignat_add</span>
<a name="line-66"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-67"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-68"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-69"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-70"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-71"></a><span class='hs-comment'>{-# INLINE bignat_add #-}</span>
<a name="line-72"></a><span class='hs-definition'>bignat_add</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span>
<a name="line-73"></a>   <span class='hs-comment'>-- weird GMP requirement: the biggest comes first</span>
<a name="line-74"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span> <span class='hs-varop'>&gt;#</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span>
<a name="line-75"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_add</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wb</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span><span class='hs-layout'>)</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-76"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaWriteMostSignificant</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>c</span> <span class='hs-varid'>s'</span>
<a name="line-77"></a>
<a name="line-78"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-conid'>True</span>
<a name="line-79"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_add</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>wb</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-80"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaWriteMostSignificant</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>c</span> <span class='hs-varid'>s'</span>
<a name="line-81"></a>
<a name="line-82"></a><a name="bignat_add_word"></a><span class='hs-definition'>bignat_add_word</span>
<a name="line-83"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-84"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-85"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-86"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-87"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-88"></a><span class='hs-comment'>{-# INLINE bignat_add_word #-}</span>
<a name="line-89"></a><span class='hs-definition'>bignat_add_word</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-90"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_add_1</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-91"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaWriteMostSignificant</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>c</span> <span class='hs-varid'>s'</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="bignat_sub"></a><span class='hs-definition'>bignat_sub</span>
<a name="line-94"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-95"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-96"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-97"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-98"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bool</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-99"></a><span class='hs-comment'>{-# INLINE bignat_sub #-}</span>
<a name="line-100"></a><span class='hs-definition'>bignat_sub</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-101"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_sub</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>wb</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-102"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>1</span><span class='hs-cpp'>##</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- underflow</span>
<a name="line-103"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span>   <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- no underflow</span>
<a name="line-104"></a>
<a name="line-105"></a><a name="bignat_sub_word"></a><span class='hs-definition'>bignat_sub_word</span>
<a name="line-106"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-107"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-108"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-109"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-110"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bool</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-111"></a><span class='hs-comment'>{-# INLINE bignat_sub_word #-}</span>
<a name="line-112"></a><span class='hs-definition'>bignat_sub_word</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-113"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_sub_1</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-114"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>1</span><span class='hs-cpp'>##</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- underflow</span>
<a name="line-115"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span>   <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- no underflow</span>
<a name="line-116"></a>
<a name="line-117"></a><a name="bignat_mul"></a><span class='hs-definition'>bignat_mul</span>
<a name="line-118"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-119"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-120"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-121"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-122"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-123"></a><span class='hs-comment'>{-# INLINE bignat_mul #-}</span>
<a name="line-124"></a><span class='hs-definition'>bignat_mul</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-125"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_mul</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>wb</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-126"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-sel'>_msl</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s'</span> <span class='hs-comment'>-- we don't care about the most-significant</span>
<a name="line-127"></a>                           <span class='hs-comment'>-- limb. The caller shrink the mwa if</span>
<a name="line-128"></a>                           <span class='hs-comment'>-- necessary anyway.</span>
<a name="line-129"></a>
<a name="line-130"></a><a name="bignat_mul_word"></a><span class='hs-definition'>bignat_mul_word</span>
<a name="line-131"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span> <span class='hs-comment'>-- ^ Result</span>
<a name="line-132"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-133"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-134"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-135"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-136"></a><span class='hs-comment'>{-# INLINE bignat_mul_word #-}</span>
<a name="line-137"></a><span class='hs-definition'>bignat_mul_word</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-138"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_mul_1</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-139"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaWriteMostSignificant</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>c</span> <span class='hs-varid'>s'</span>
<a name="line-140"></a>
<a name="line-141"></a><a name="bignat_popcount"></a><span class='hs-definition'>bignat_popcount</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-142"></a><span class='hs-comment'>{-# INLINE bignat_popcount #-}</span>
<a name="line-143"></a><span class='hs-definition'>bignat_popcount</span> <span class='hs-varid'>wa</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c_mpn_popcount</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span>
<a name="line-144"></a>
<a name="line-145"></a>
<a name="line-146"></a><a name="bignat_shiftl"></a><span class='hs-definition'>bignat_shiftl</span>
<a name="line-147"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-148"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-149"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-150"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-151"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-152"></a><span class='hs-comment'>{-# INLINE bignat_shiftl #-}</span>
<a name="line-153"></a><span class='hs-definition'>bignat_shiftl</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>n</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-154"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_lshift</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-155"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-sel'>_msl</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s'</span> <span class='hs-comment'>-- we don't care about the most-significant</span>
<a name="line-156"></a>                           <span class='hs-comment'>-- limb. The caller shrink the mwa if</span>
<a name="line-157"></a>                           <span class='hs-comment'>-- necessary anyway.</span>
<a name="line-158"></a>
<a name="line-159"></a><a name="bignat_shiftr"></a><span class='hs-definition'>bignat_shiftr</span>
<a name="line-160"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-161"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-162"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-163"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-164"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-165"></a><span class='hs-comment'>{-# INLINE bignat_shiftr #-}</span>
<a name="line-166"></a><span class='hs-definition'>bignat_shiftr</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>n</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-167"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_rshift</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-168"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-sel'>_msl</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s'</span> <span class='hs-comment'>-- we don't care about the most-significant</span>
<a name="line-169"></a>                           <span class='hs-comment'>-- limb. The caller shrink the mwa if</span>
<a name="line-170"></a>                           <span class='hs-comment'>-- necessary anyway.</span>
<a name="line-171"></a>
<a name="line-172"></a><a name="bignat_or"></a><span class='hs-definition'>bignat_or</span>
<a name="line-173"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-174"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-175"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-176"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-177"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-178"></a><span class='hs-comment'>{-# INLINE bignat_or #-}</span>
<a name="line-179"></a><span class='hs-definition'>bignat_or</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s1</span>
<a name="line-180"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>szA</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span> <span class='hs-varid'>s1</span>
<a name="line-181"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-conid'>True</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>s1</span>
<a name="line-182"></a>   <span class='hs-keyword'>where</span>
<a name="line-183"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-184"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-185"></a>      <span class='hs-comment'>-- nx &gt;= ny</span>
<a name="line-186"></a>      <span class='hs-varid'>go</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>nx</span> <span class='hs-varid'>wy</span> <span class='hs-varid'>ny</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_ior_n</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>wy</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-187"></a>         <span class='hs-varid'>s'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaArrayCopy</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>ny</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>ny</span> <span class='hs-layout'>(</span><span class='hs-varid'>nx</span> <span class='hs-varop'>-#</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span> <span class='hs-varid'>s'</span>
<a name="line-188"></a>
<a name="line-189"></a><a name="bignat_xor"></a><span class='hs-definition'>bignat_xor</span>
<a name="line-190"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-191"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-192"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-193"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-194"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-195"></a><span class='hs-comment'>{-# INLINE bignat_xor #-}</span>
<a name="line-196"></a><span class='hs-definition'>bignat_xor</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s1</span>
<a name="line-197"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>szA</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span> <span class='hs-varid'>s1</span>
<a name="line-198"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-conid'>True</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>s1</span>
<a name="line-199"></a>   <span class='hs-keyword'>where</span>
<a name="line-200"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-201"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-202"></a>      <span class='hs-comment'>-- nx &gt;= ny</span>
<a name="line-203"></a>      <span class='hs-varid'>go</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>nx</span> <span class='hs-varid'>wy</span> <span class='hs-varid'>ny</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_xor_n</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>wy</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-204"></a>         <span class='hs-varid'>s'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaArrayCopy</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>ny</span> <span class='hs-varid'>wx</span> <span class='hs-varid'>ny</span> <span class='hs-layout'>(</span><span class='hs-varid'>nx</span> <span class='hs-varop'>-#</span> <span class='hs-varid'>ny</span><span class='hs-layout'>)</span> <span class='hs-varid'>s'</span>
<a name="line-205"></a>
<a name="line-206"></a><a name="bignat_and"></a><span class='hs-definition'>bignat_and</span>
<a name="line-207"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span> <span class='hs-comment'>-- ^ Result</span>
<a name="line-208"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-209"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-210"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-211"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-212"></a><span class='hs-comment'>{-# INLINE bignat_and #-}</span>
<a name="line-213"></a><span class='hs-definition'>bignat_and</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_and_n</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>sz</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-214"></a>   <span class='hs-keyword'>where</span>
<a name="line-215"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-216"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-217"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>sz</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minI</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>szB</span>
<a name="line-218"></a>
<a name="line-219"></a><a name="bignat_and_not"></a><span class='hs-definition'>bignat_and_not</span>
<a name="line-220"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span> <span class='hs-comment'>-- ^ Result</span>
<a name="line-221"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-222"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-223"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-224"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-225"></a><span class='hs-comment'>{-# INLINE bignat_and_not #-}</span>
<a name="line-226"></a><span class='hs-definition'>bignat_and_not</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-227"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_andn_n</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-228"></a>      <span class='hs-varid'>s'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaArrayCopy</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>szB</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szB</span> <span class='hs-layout'>(</span><span class='hs-varid'>szA</span> <span class='hs-varop'>-#</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-varid'>s'</span>
<a name="line-229"></a>   <span class='hs-keyword'>where</span>
<a name="line-230"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-231"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-232"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>n</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minI</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>szB</span>
<a name="line-233"></a>
<a name="line-234"></a><a name="bignat_quotrem"></a><span class='hs-definition'>bignat_quotrem</span>
<a name="line-235"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-236"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-237"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-238"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-239"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-240"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-241"></a><span class='hs-definition'>bignat_quotrem</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>mwr</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-242"></a>   <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_tdiv_qr</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>mwr</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-243"></a>   <span class='hs-keyword'>where</span>
<a name="line-244"></a>      <span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-245"></a>      <span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-246"></a>
<a name="line-247"></a><a name="bignat_quot"></a><span class='hs-definition'>bignat_quot</span>
<a name="line-248"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-249"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-250"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-251"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-252"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-253"></a><span class='hs-definition'>bignat_quot</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-254"></a>   <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_tdiv_q</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-255"></a>   <span class='hs-keyword'>where</span>
<a name="line-256"></a>      <span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-257"></a>      <span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-258"></a>
<a name="line-259"></a><a name="bignat_rem"></a><span class='hs-definition'>bignat_rem</span>
<a name="line-260"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-261"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-262"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-263"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-264"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-265"></a><span class='hs-definition'>bignat_rem</span> <span class='hs-varid'>mwr</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-266"></a>   <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_tdiv_r</span> <span class='hs-varid'>mwr</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>szB</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-267"></a>   <span class='hs-keyword'>where</span>
<a name="line-268"></a>      <span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-269"></a>      <span class='hs-varid'>szB</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span>
<a name="line-270"></a>
<a name="line-271"></a><a name="bignat_quotrem_word"></a><span class='hs-definition'>bignat_quotrem_word</span>
<a name="line-272"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span> <span class='hs-comment'>-- ^ Quotient</span>
<a name="line-273"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-274"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-275"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-276"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-277"></a><span class='hs-definition'>bignat_quotrem_word</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-278"></a>   <span class='hs-varid'>ioWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_divrem_1</span> <span class='hs-varid'>mwq</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>szA</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-279"></a>   <span class='hs-keyword'>where</span>
<a name="line-280"></a>      <span class='hs-varid'>szA</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span>
<a name="line-281"></a>
<a name="line-282"></a><a name="bignat_quot_word"></a><span class='hs-definition'>bignat_quot_word</span>
<a name="line-283"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span> <span class='hs-comment'>-- ^ Quotient</span>
<a name="line-284"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-285"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-286"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-287"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-288"></a><span class='hs-definition'>bignat_quot_word</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-289"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>bignat_quotrem_word</span> <span class='hs-varid'>mwq</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-290"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s'</span>
<a name="line-291"></a>
<a name="line-292"></a><a name="bignat_rem_word"></a><span class='hs-definition'>bignat_rem_word</span>
<a name="line-293"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-294"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-295"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-296"></a><span class='hs-definition'>bignat_rem_word</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span>
<a name="line-297"></a>   <span class='hs-varid'>c_mpn_mod_1</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-298"></a>
<a name="line-299"></a>
<a name="line-300"></a><a name="bignat_gcd"></a><span class='hs-definition'>bignat_gcd</span>
<a name="line-301"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-302"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-303"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-304"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-305"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-306"></a><span class='hs-definition'>bignat_gcd</span> <span class='hs-varid'>mwr</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>wb</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-307"></a>   <span class='hs-comment'>-- wa &gt; wb</span>
<a name="line-308"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_gcd</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mwr</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>wb</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wb</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-309"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>sz</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mwr</span> <span class='hs-layout'>(</span><span class='hs-varid'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sz</span><span class='hs-layout'>)</span> <span class='hs-varid'>s'</span>
<a name="line-310"></a>
<a name="line-311"></a><a name="bignat_gcd_word"></a><span class='hs-definition'>bignat_gcd_word</span>
<a name="line-312"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-313"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-314"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-315"></a><span class='hs-definition'>bignat_gcd_word</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c_mpn_gcd_1</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-316"></a>
<a name="line-317"></a><a name="bignat_gcd_word_word"></a><span class='hs-definition'>bignat_gcd_word_word</span>
<a name="line-318"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-319"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-320"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-321"></a><span class='hs-definition'>bignat_gcd_word_word</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer_gmp_gcd_word</span>
<a name="line-322"></a>
<a name="line-323"></a>
<a name="line-324"></a><a name="bignat_encode_double"></a><span class='hs-definition'>bignat_encode_double</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-325"></a><span class='hs-definition'>bignat_encode_double</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c_mpn_get_d</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-326"></a>
<a name="line-327"></a><a name="bignat_shiftr_neg"></a><span class='hs-definition'>bignat_shiftr_neg</span>
<a name="line-328"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-329"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-330"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-331"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-332"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-333"></a><span class='hs-definition'>bignat_shiftr_neg</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-varid'>n</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-334"></a>   <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>c_mpn_rshift_2c</span> <span class='hs-varid'>mwa</span> <span class='hs-varid'>wa</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>wa</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-335"></a>
<a name="line-336"></a><a name="bignat_powmod_word"></a><span class='hs-definition'>bignat_powmod_word</span>
<a name="line-337"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-338"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-339"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-340"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-341"></a><span class='hs-definition'>bignat_powmod_word</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span>
<a name="line-342"></a>   <span class='hs-varid'>integer_gmp_powm1</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span>
<a name="line-343"></a>
<a name="line-344"></a><a name="bignat_powmod_words"></a><span class='hs-definition'>bignat_powmod_words</span>
<a name="line-345"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-346"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-347"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-348"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-349"></a><span class='hs-definition'>bignat_powmod_words</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer_gmp_powm_word</span>
<a name="line-350"></a>
<a name="line-351"></a><a name="bignat_powmod"></a><span class='hs-definition'>bignat_powmod</span>
<a name="line-352"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-353"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-354"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-355"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-356"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-357"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-358"></a><span class='hs-definition'>bignat_powmod</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sbignat_powmod</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-varid'>s</span>
<a name="line-359"></a>
<a name="line-360"></a><a name="integer_powmod"></a><span class='hs-definition'>integer_powmod</span>
<a name="line-361"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span>
<a name="line-362"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Natural</span>
<a name="line-363"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Natural</span>
<a name="line-364"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Natural</span>
<a name="line-365"></a><span class='hs-definition'>integer_powmod</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>naturalFromBigNat</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>withNewWordArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szm</span> <span class='hs-varid'>io</span><span class='hs-layout'>)</span>
<a name="line-366"></a>   <span class='hs-keyword'>where</span>
<a name="line-367"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>be</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>naturalToBigNat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span>
<a name="line-368"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>bm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>naturalToBigNat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span>
<a name="line-369"></a>      <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span><span class='hs-layout'>,</span> <span class='hs-varid'>bb</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span>
<a name="line-370"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szb</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>bb</span>
<a name="line-371"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>bm</span>
<a name="line-372"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>ssb</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>sb</span> <span class='hs-keyword'>of</span> <span class='hs-comment'>-- signed size of b</span>
<a name="line-373"></a>               <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>szb</span>
<a name="line-374"></a>               <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szb</span>
<a name="line-375"></a>
<a name="line-376"></a>      <span class='hs-varid'>io</span> <span class='hs-varid'>r</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sbignat_powmod</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ssb</span> <span class='hs-varid'>bb</span> <span class='hs-varid'>be</span> <span class='hs-varid'>bm</span> <span class='hs-varid'>s</span>
<a name="line-377"></a>
<a name="line-378"></a>
<a name="line-379"></a><a name="sbignat_powmod"></a><span class='hs-definition'>sbignat_powmod</span>
<a name="line-380"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableWordArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-381"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-382"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-383"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-384"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>WordArray</span><span class='hs-cpp'>#</span>
<a name="line-385"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-386"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-387"></a><span class='hs-definition'>sbignat_powmod</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b_signed_size</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-388"></a>   <span class='hs-keyword'>case</span> <span class='hs-varid'>ioInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer_gmp_powm</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b</span> <span class='hs-varid'>b_signed_size</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>wordArraySize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-389"></a>      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s'</span><span class='hs-layout'>,</span> <span class='hs-varid'>n</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>s'</span>
<a name="line-390"></a>
<a name="line-391"></a><a name="integer_gcde"></a><span class='hs-definition'>integer_gcde</span>
<a name="line-392"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span>
<a name="line-393"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-394"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-395"></a><span class='hs-definition'>integer_gcde</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>runRW</span><span class='hs-cpp'>#</span> <span class='hs-varid'>io</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-396"></a>   <span class='hs-keyword'>where</span>
<a name="line-397"></a>      <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span><span class='hs-layout'>,</span> <span class='hs-varid'>ba</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span>
<a name="line-398"></a>      <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span><span class='hs-layout'>,</span> <span class='hs-varid'>bb</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span>
<a name="line-399"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>sza</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ba</span>
<a name="line-400"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>szb</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>bb</span>
<a name="line-401"></a>      <span class='hs-comment'>-- signed sizes of a and b</span>
<a name="line-402"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>ssa</span>          <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>sa</span> <span class='hs-keyword'>of</span>
<a name="line-403"></a>                           <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>sza</span>
<a name="line-404"></a>                           <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sza</span>
<a name="line-405"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>ssb</span>          <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>sb</span> <span class='hs-keyword'>of</span>
<a name="line-406"></a>                        <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>szb</span>
<a name="line-407"></a>                        <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szb</span>
<a name="line-408"></a>
<a name="line-409"></a>      <span class='hs-comment'>-- gcd(a,b) &lt; min(a,b)</span>
<a name="line-410"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>g_init_sz</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minI</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sza</span> <span class='hs-varid'>szb</span>
<a name="line-411"></a>
<a name="line-412"></a>      <span class='hs-comment'>-- According to https://gmplib.org/manual/Number-Theoretic-Functions.html#index-mpz_005fgcdext</span>
<a name="line-413"></a>      <span class='hs-comment'>-- a*x + b*y = g</span>
<a name="line-414"></a>      <span class='hs-comment'>-- abs(x) &lt; abs(b) / (2 g) &lt; abs(b)</span>
<a name="line-415"></a>      <span class='hs-comment'>-- abs(y) &lt; abs(a) / (2 g) &lt; abs(a)</span>
<a name="line-416"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>x_init_sz</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>szb</span>
<a name="line-417"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>y_init_sz</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sza</span>
<a name="line-418"></a>
<a name="line-419"></a>      <span class='hs-varid'>io</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span>
<a name="line-420"></a>         <span class='hs-comment'>-- allocate output arrays</span>
<a name="line-421"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>newWordArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>g_init_sz</span> <span class='hs-varid'>s</span>     <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>mbg</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-422"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>newWordArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x_init_sz</span> <span class='hs-varid'>s</span>     <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>mbx</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-423"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>newWordArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y_init_sz</span> <span class='hs-varid'>s</span>     <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>mby</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-424"></a>         <span class='hs-comment'>-- allocate space to return sizes (3x4 = 12)</span>
<a name="line-425"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>newPinnedByteArray</span><span class='hs-cpp'>#</span> <span class='hs-num'>12</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span>     <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>mszs</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-426"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>unsafeFreezeByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mszs</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>szs</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-427"></a>         <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>ssx_ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>byteArrayContents</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szs</span> <span class='hs-keyword'>in</span>
<a name="line-428"></a>         <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>ssy_ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ssx_ptr</span> <span class='hs-varop'>`</span><span class='hs-varid'>plusAddr</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-num'>4</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>in</span>
<a name="line-429"></a>         <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>sg_ptr</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ssy_ptr</span> <span class='hs-varop'>`</span><span class='hs-varid'>plusAddr</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-num'>4</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>in</span>
<a name="line-430"></a>         <span class='hs-comment'>-- call GMP</span>
<a name="line-431"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>ioVoid</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer_gmp_gcdext</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mbx</span> <span class='hs-varid'>ssx_ptr</span> <span class='hs-varid'>mby</span> <span class='hs-varid'>ssy_ptr</span> <span class='hs-varid'>mbg</span> <span class='hs-varid'>sg_ptr</span> <span class='hs-varid'>ba</span> <span class='hs-varid'>ssa</span> <span class='hs-varid'>bb</span> <span class='hs-varid'>ssb</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-432"></a>         <span class='hs-comment'>-- read sizes</span>
<a name="line-433"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>readInt32OffAddr</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssx_ptr</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>ssx</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-434"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>readInt32OffAddr</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssy_ptr</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>ssy</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-435"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>readInt32OffAddr</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg_ptr</span>  <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>sg</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-436"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>touch</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szs</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-437"></a>         <span class='hs-comment'>-- shrink x, y and g to their actual sizes and freeze them</span>
<a name="line-438"></a>         <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>sx</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absI</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int32ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssx</span><span class='hs-layout'>)</span> <span class='hs-keyword'>in</span>
<a name="line-439"></a>         <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>sy</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absI</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int32ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssy</span><span class='hs-layout'>)</span> <span class='hs-keyword'>in</span>
<a name="line-440"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mbx</span> <span class='hs-varid'>sx</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-441"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mby</span> <span class='hs-varid'>sy</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-442"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mbg</span> <span class='hs-layout'>(</span><span class='hs-varid'>int32ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sg</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-443"></a>
<a name="line-444"></a>         <span class='hs-comment'>-- return x, y and g as Integer</span>
<a name="line-445"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>unsafeFreezeByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mbx</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>bx</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-446"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>unsafeFreezeByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mby</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>by</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-447"></a>         <span class='hs-keyword'>case</span> <span class='hs-varid'>unsafeFreezeByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mbg</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>bg</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-448"></a>
<a name="line-449"></a>         <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>integerFromBigNat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>bg</span>
<a name="line-450"></a>               <span class='hs-layout'>,</span>  <span class='hs-varid'>integerFromBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int32ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssx</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>bx</span>
<a name="line-451"></a>               <span class='hs-layout'>,</span>  <span class='hs-varid'>integerFromBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int32ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ssy</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>by</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-452"></a>         <span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span>
<a name="line-453"></a>
<a name="line-454"></a>
<a name="line-455"></a>
<a name="line-456"></a><a name="integer_recip_mod"></a><span class='hs-definition'>integer_recip_mod</span>
<a name="line-457"></a>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span>
<a name="line-458"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Natural</span>
<a name="line-459"></a>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Natural</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>()</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-460"></a><span class='hs-definition'>integer_recip_mod</span> <span class='hs-varid'>x</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span>
<a name="line-461"></a>   <span class='hs-keyword'>let</span>
<a name="line-462"></a>      <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-cpp'>#</span>  <span class='hs-varid'>sign_x</span><span class='hs-layout'>,</span> <span class='hs-varid'>bx</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToBigNatSign</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span>
<a name="line-463"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>bm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>naturalToBigNat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span>
<a name="line-464"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>br</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sbignat_recip_mod</span> <span class='hs-varid'>sign_x</span> <span class='hs-varid'>bx</span> <span class='hs-varid'>bm</span>
<a name="line-465"></a>   <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>bigNatIsZero</span><span class='hs-cpp'>#</span> <span class='hs-varid'>br</span><span class='hs-layout'>)</span>
<a name="line-466"></a>         <span class='hs-keyword'>then</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>()</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-467"></a>         <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>naturalFromBigNat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>br</span> <span class='hs-keyglyph'>|</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-468"></a>
<a name="line-469"></a>
<a name="line-470"></a><a name="sbignat_recip_mod"></a><span class='hs-comment'>-- | Return 0 for invalid inputs</span>
<a name="line-471"></a><span class='hs-definition'>sbignat_recip_mod</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BigNat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BigNat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>BigNat</span><span class='hs-cpp'>#</span>
<a name="line-472"></a><span class='hs-definition'>sbignat_recip_mod</span> <span class='hs-varid'>sign_x</span> <span class='hs-varid'>x</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>withNewWordArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szm</span> <span class='hs-varid'>io</span>
<a name="line-473"></a>  <span class='hs-keyword'>where</span>
<a name="line-474"></a>    <span class='hs-varid'>io</span> <span class='hs-varid'>r</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ioInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer_gmp_invert</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ssx</span> <span class='hs-varid'>m</span> <span class='hs-varid'>szm</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>of</span>
<a name="line-475"></a>               <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>rn</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mwaSetSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>narrowGmpSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>rn</span><span class='hs-layout'>)</span> <span class='hs-varid'>s</span>
<a name="line-476"></a>    <span class='hs-varop'>!</span><span class='hs-varid'>szx</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span>
<a name="line-477"></a>    <span class='hs-varop'>!</span><span class='hs-varid'>szm</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bigNatSize</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span>
<a name="line-478"></a>    <span class='hs-varop'>!</span><span class='hs-varid'>ssx</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>sign_x</span> <span class='hs-keyword'>of</span> <span class='hs-comment'>-- signed size of x</span>
<a name="line-479"></a>            <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>szx</span>
<a name="line-480"></a>            <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>szx</span>
<a name="line-481"></a>
<a name="line-482"></a><span class='hs-comment'>----------------------------------------------------------------------</span>
<a name="line-483"></a><span class='hs-comment'>-- FFI ccall imports</span>
<a name="line-484"></a>
<a name="line-485"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_gcd_word"</span>
<a name="line-486"></a>  <span class='hs-varid'>integer_gmp_gcd_word</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-487"></a>
<a name="line-488"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_gcd_1"</span>
<a name="line-489"></a>  <span class='hs-varid'>c_mpn_gcd_1</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-490"></a>
<a name="line-491"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_gcd"</span>
<a name="line-492"></a>  <span class='hs-varid'>c_mpn_gcd</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-493"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpSize</span>
<a name="line-494"></a>
<a name="line-495"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_gcdext"</span> <span class='hs-varid'>integer_gmp_gcdext</span><span class='hs-cpp'>#</span>
<a name="line-496"></a>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span>
<a name="line-497"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span>
<a name="line-498"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span>
<a name="line-499"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-500"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-501"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-502"></a>
<a name="line-503"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_invert"</span>
<a name="line-504"></a>  <span class='hs-varid'>integer_gmp_invert</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-505"></a>                         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-506"></a>                         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpSize</span>
<a name="line-507"></a>
<a name="line-508"></a><span class='hs-comment'>-- mp_limb_t mpn_add_1 (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t n,</span>
<a name="line-509"></a><span class='hs-comment'>--                      mp_limb_t s2limb)</span>
<a name="line-510"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_add_1"</span>
<a name="line-511"></a>  <span class='hs-varid'>c_mpn_add_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-512"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-513"></a>
<a name="line-514"></a><span class='hs-comment'>-- mp_limb_t mpn_sub_1 (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t n,</span>
<a name="line-515"></a><span class='hs-comment'>--                      mp_limb_t s2limb)</span>
<a name="line-516"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_sub_1"</span>
<a name="line-517"></a>  <span class='hs-varid'>c_mpn_sub_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-518"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-519"></a>
<a name="line-520"></a><span class='hs-comment'>-- mp_limb_t mpn_mul_1 (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t n,</span>
<a name="line-521"></a><span class='hs-comment'>--                      mp_limb_t s2limb)</span>
<a name="line-522"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_mul_1"</span>
<a name="line-523"></a>  <span class='hs-varid'>c_mpn_mul_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-524"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-525"></a>
<a name="line-526"></a><span class='hs-comment'>-- mp_limb_t mpn_add (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t s1n,</span>
<a name="line-527"></a><span class='hs-comment'>--                    const mp_limb_t *s2p, mp_size_t s2n)</span>
<a name="line-528"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_add"</span>
<a name="line-529"></a>  <span class='hs-varid'>c_mpn_add</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-530"></a>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-531"></a>
<a name="line-532"></a><span class='hs-comment'>-- mp_limb_t mpn_sub (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t s1n,</span>
<a name="line-533"></a><span class='hs-comment'>--                    const mp_limb_t *s2p, mp_size_t s2n)</span>
<a name="line-534"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_sub"</span>
<a name="line-535"></a>  <span class='hs-varid'>c_mpn_sub</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span>
<a name="line-536"></a>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-537"></a>
<a name="line-538"></a><span class='hs-comment'>-- mp_limb_t mpn_mul (mp_limb_t *rp, const mp_limb_t *s1p, mp_size_t s1n,</span>
<a name="line-539"></a><span class='hs-comment'>--                    const mp_limb_t *s2p, mp_size_t s2n)</span>
<a name="line-540"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_mul"</span>
<a name="line-541"></a>  <span class='hs-varid'>c_mpn_mul</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span>
<a name="line-542"></a>               <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-543"></a>
<a name="line-544"></a><span class='hs-comment'>-- int mpn_cmp (const mp_limb_t *s1p, const mp_limb_t *s2p, mp_size_t n)</span>
<a name="line-545"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_cmp"</span>
<a name="line-546"></a>  <span class='hs-varid'>c_mpn_cmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-547"></a>
<a name="line-548"></a><span class='hs-comment'>-- void mpn_tdiv_qr (mp_limb_t *qp, mp_limb_t *rp, mp_size_t qxn,</span>
<a name="line-549"></a><span class='hs-comment'>--                   const mp_limb_t *np, mp_size_t nn,</span>
<a name="line-550"></a><span class='hs-comment'>--                   const mp_limb_t *dp, mp_size_t dn)</span>
<a name="line-551"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_tdiv_qr"</span>
<a name="line-552"></a>  <span class='hs-varid'>c_mpn_tdiv_qr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-553"></a>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-554"></a>
<a name="line-555"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_tdiv_q"</span>
<a name="line-556"></a>  <span class='hs-varid'>c_mpn_tdiv_q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span>
<a name="line-557"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-558"></a>
<a name="line-559"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_tdiv_r"</span>
<a name="line-560"></a>  <span class='hs-varid'>c_mpn_tdiv_r</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span>
<a name="line-561"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-562"></a>
<a name="line-563"></a><span class='hs-comment'>-- mp_limb_t mpn_divrem_1 (mp_limb_t *r1p, mp_size_t qxn, mp_limb_t *s2p,</span>
<a name="line-564"></a><span class='hs-comment'>--                         mp_size_t s2n, mp_limb_t s3limb)</span>
<a name="line-565"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_divrem_1"</span>
<a name="line-566"></a>  <span class='hs-varid'>c_mpn_divrem_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-567"></a>                    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-568"></a>
<a name="line-569"></a><span class='hs-comment'>-- mp_limb_t mpn_mod_1 (const mp_limb_t *s1p, mp_size_t s1n, mp_limb_t s2limb)</span>
<a name="line-570"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_mod_1"</span>
<a name="line-571"></a>  <span class='hs-varid'>c_mpn_mod_1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-572"></a>
<a name="line-573"></a><span class='hs-comment'>-- mp_limb_t integer_gmp_mpn_rshift (mp_limb_t rp[], const mp_limb_t sp[],</span>
<a name="line-574"></a><span class='hs-comment'>--                                   mp_size_t sn, mp_bitcnt_t count)</span>
<a name="line-575"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_rshift"</span>
<a name="line-576"></a>  <span class='hs-varid'>c_mpn_rshift</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-577"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-578"></a>
<a name="line-579"></a><span class='hs-comment'>-- mp_limb_t integer_gmp_mpn_rshift (mp_limb_t rp[], const mp_limb_t sp[],</span>
<a name="line-580"></a><span class='hs-comment'>--                                   mp_size_t sn, mp_bitcnt_t count)</span>
<a name="line-581"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_rshift_2c"</span>
<a name="line-582"></a>  <span class='hs-varid'>c_mpn_rshift_2c</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-583"></a>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-584"></a>
<a name="line-585"></a><span class='hs-comment'>-- mp_limb_t integer_gmp_mpn_lshift (mp_limb_t rp[], const mp_limb_t sp[],</span>
<a name="line-586"></a><span class='hs-comment'>--                                   mp_size_t sn, mp_bitcnt_t count)</span>
<a name="line-587"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_lshift"</span>
<a name="line-588"></a>  <span class='hs-varid'>c_mpn_lshift</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-589"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpLimb</span>
<a name="line-590"></a>
<a name="line-591"></a><span class='hs-comment'>-- void mpn_and_n (mp_limb_t *rp, const mp_limb_t *s1p, const mp_limb_t *s2p,</span>
<a name="line-592"></a><span class='hs-comment'>--                 mp_size_t n)</span>
<a name="line-593"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_and_n"</span>
<a name="line-594"></a>  <span class='hs-varid'>c_mpn_and_n</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-595"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-596"></a>
<a name="line-597"></a><span class='hs-comment'>-- void mpn_andn_n (mp_limb_t *rp, const mp_limb_t *s1p, const mp_limb_t *s2p,</span>
<a name="line-598"></a><span class='hs-comment'>--                  mp_size_t n)</span>
<a name="line-599"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_andn_n"</span>
<a name="line-600"></a>  <span class='hs-varid'>c_mpn_andn_n</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-601"></a>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-602"></a>
<a name="line-603"></a><span class='hs-comment'>-- void mpn_ior_n (mp_limb_t *rp, const mp_limb_t *s1p, const mp_limb_t *s2p,</span>
<a name="line-604"></a><span class='hs-comment'>--                 mp_size_t n)</span>
<a name="line-605"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_ior_n"</span>
<a name="line-606"></a>  <span class='hs-varid'>c_mpn_ior_n</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-607"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-608"></a>
<a name="line-609"></a><span class='hs-comment'>-- void mpn_xor_n (mp_limb_t *rp, const mp_limb_t *s1p, const mp_limb_t *s2p,</span>
<a name="line-610"></a><span class='hs-comment'>--                 mp_size_t n)</span>
<a name="line-611"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_xor_n"</span>
<a name="line-612"></a>  <span class='hs-varid'>c_mpn_xor_n</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-613"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<a name="line-614"></a>
<a name="line-615"></a><span class='hs-comment'>-- mp_bitcnt_t mpn_popcount (const mp_limb_t *s1p, mp_size_t n)</span>
<a name="line-616"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"gmp.h __gmpn_popcount"</span>
<a name="line-617"></a>  <span class='hs-varid'>c_mpn_popcount</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-618"></a>
<a name="line-619"></a><span class='hs-comment'>-- double integer_gmp_mpn_get_d (const mp_limb_t sp[], const mp_size_t sn)</span>
<a name="line-620"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_mpn_get_d"</span>
<a name="line-621"></a>  <span class='hs-varid'>c_mpn_get_d</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-622"></a>
<a name="line-623"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_powm"</span>
<a name="line-624"></a>  <span class='hs-varid'>integer_gmp_powm</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-conid'>RealWorld</span>
<a name="line-625"></a>                       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-626"></a>                       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>GmpSize</span>
<a name="line-627"></a>
<a name="line-628"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_powm_word"</span>
<a name="line-629"></a>  <span class='hs-varid'>integer_gmp_powm_word</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
<a name="line-630"></a>
<a name="line-631"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_gmp_powm1"</span>
<a name="line-632"></a>  <span class='hs-varid'>integer_gmp_powm1</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpSize</span><span class='hs-cpp'>#</span>
<a name="line-633"></a>                        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GmpLimb</span><span class='hs-cpp'>#</span>
</pre></body>
</html>

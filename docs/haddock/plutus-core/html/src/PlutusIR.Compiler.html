<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusIR.Compiler</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.html#compileTerm"><span class="hs-identifier">compileTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.html#compileToReadable"><span class="hs-identifier">compileToReadable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.html#compileReadableToPlc"><span class="hs-identifier">compileReadableToPlc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier">Compiling</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="PlutusIR.Error.html#Error"><span class="hs-identifier">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="PlutusIR.Error.html#AsError"><span class="hs-identifier">AsError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="PlutusCore.Error.html#AsTypeError"><span class="hs-identifier">AsTypeError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="PlutusIR.Error.html#AsTypeErrorExt"><span class="hs-identifier">AsTypeErrorExt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier">Provenance</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#DatatypeComponent"><span class="hs-identifier">DatatypeComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#noProvenance"><span class="hs-identifier">noProvenance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#CompilationOpts"><span class="hs-identifier">CompilationOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coOptimize"><span class="hs-identifier">coOptimize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coPedantic"><span class="hs-identifier">coPedantic</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coVerbose"><span class="hs-identifier">coVerbose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coDebug"><span class="hs-identifier">coDebug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coMaxSimplifierIterations"><span class="hs-identifier">coMaxSimplifierIterations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coDoSimplifierUnwrapCancel"><span class="hs-identifier">coDoSimplifierUnwrapCancel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coDoSimplifierBeta"><span class="hs-identifier">coDoSimplifierBeta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coDoSimplifierInline"><span class="hs-identifier">coDoSimplifierInline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coInlineHints"><span class="hs-identifier">coInlineHints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#coProfile"><span class="hs-identifier">coProfile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#defaultCompilationOpts"><span class="hs-identifier">defaultCompilationOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#CompilationCtx"><span class="hs-identifier">CompilationCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier">ccOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#ccEnclosing"><span class="hs-identifier">ccEnclosing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#ccTypeCheckConfig"><span class="hs-identifier">ccTypeCheckConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#PirTCConfig"><span class="hs-identifier">PirTCConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#AllowEscape"><span class="hs-identifier">AllowEscape</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#toDefaultCompilationCtx"><span class="hs-identifier">toDefaultCompilationCtx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.html"><span class="hs-identifier">PlutusIR</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Let.html"><span class="hs-identifier">PlutusIR.Compiler.Let</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Let</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Lower.html"><span class="hs-identifier">PlutusIR.Compiler.Lower</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html"><span class="hs-identifier">PlutusIR.Compiler.Provenance</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html"><span class="hs-identifier">PlutusIR.Compiler.Types</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Error.html"><span class="hs-identifier">PlutusIR.Error</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Beta.html"><span class="hs-identifier">PlutusIR.Transform.Beta</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Beta</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.DeadCode.html"><span class="hs-identifier">PlutusIR.Transform.DeadCode</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DeadCode</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Inline.html"><span class="hs-identifier">PlutusIR.Transform.Inline</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Inline</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.LetFloat.html"><span class="hs-identifier">PlutusIR.Transform.LetFloat</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LetFloat</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.LetMerge.html"><span class="hs-identifier">PlutusIR.Transform.LetMerge</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LetMerge</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.NonStrict.html"><span class="hs-identifier">PlutusIR.Transform.NonStrict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonStrict</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.RecSplit.html"><span class="hs-identifier">PlutusIR.Transform.RecSplit</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RecSplit</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Rename.html"><span class="hs-identifier">PlutusIR.Transform.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.ThunkRecursions.html"><span class="hs-identifier">PlutusIR.Transform.ThunkRecursions</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ThunkRec</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Unwrap.html"><span class="hs-identifier">PlutusIR.Transform.Unwrap</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Unwrap</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.TypeCheck.Internal.html"><span class="hs-identifier">PlutusIR.TypeCheck.Internal</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.html"><span class="hs-identifier">PlutusCore</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.html"><span class="hs-identifier">PlutusCore.Builtin</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../extra/html/src"><span class="hs-identifier">Control.Monad.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../extra/html/src"><span class="hs-identifier">orM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../extra/html/src"><span class="hs-identifier">whenM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Debug.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">traceM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Simplifier passes</span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="Pass"><span class="annot"><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span></span><span> </span><span id="local-6989586621681120001"><span class="annot"><a href="#local-6989586621681120001"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681120000"><span class="annot"><a href="#local-6989586621681120000"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>  </span><span id="Pass"><span class="annot"><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_name"><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun. Pass uni fun -&gt; String
</span><a href="PlutusIR.Compiler.html#_name"><span class="hs-identifier hs-var hs-var">_name</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-70"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="_shouldRun"><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
Pass uni fun
-&gt; forall (m :: * -&gt; *) e a. Compiling m e uni fun a =&gt; m Bool
</span><a href="PlutusIR.Compiler.html#_shouldRun"><span class="hs-identifier hs-var hs-var">_shouldRun</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681119996"><span class="annot"><a href="#local-6989586621681119996"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681119995"><span class="annot"><a href="#local-6989586621681119995"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621681119994"><span class="annot"><a href="#local-6989586621681119994"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119995"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120001"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120000"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-71"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="_pass"><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
Pass uni fun
-&gt; forall (m :: * -&gt; *) e a.
   Compiling m e uni fun a =&gt;
   Term TyName Name uni fun (Provenance a)
   -&gt; m (Term TyName Name uni fun (Provenance a))
</span><a href="PlutusIR.Compiler.html#_pass"><span class="hs-identifier hs-var hs-var">_pass</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681119954"><span class="annot"><a href="#local-6989586621681119954"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681119953"><span class="annot"><a href="#local-6989586621681119953"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621681119952"><span class="annot"><a href="#local-6989586621681119952"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119954"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119953"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120001"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120000"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119952"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120001"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120000"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119954"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120001"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681120000"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621681119942"><span id="local-6989586621681119943"><span id="local-6989586621681119944"><span id="local-6989586621681119945"><span id="local-6989586621681119946"><span class="annot"><a href="PlutusIR.Compiler.html#onOption"><span class="hs-identifier hs-type">onOption</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119945"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119944"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119943"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#CompilationOpts"><span class="hs-identifier hs-type">CompilationOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119942"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-75"></span><span id="onOption"><span class="annot"><span class="annottext">onOption :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
Lens' (CompilationOpts a) Bool -&gt; m Bool
</span><a href="PlutusIR.Compiler.html#onOption"><span class="hs-identifier hs-var hs-var">onOption</span></a></span></span><span> </span><span id="local-6989586621681119495"><span class="annot"><span class="annottext">Lens' (CompilationOpts a) Bool
</span><a href="#local-6989586621681119495"><span class="hs-identifier hs-var">coOpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' (CompilationOpts a) Bool
</span><a href="#local-6989586621681119495"><span class="hs-identifier hs-var">coOpt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621681119918"><span id="local-6989586621681119919"><span id="local-6989586621681119920"><span id="local-6989586621681119921"><span id="local-6989586621681119922"><span class="annot"><a href="PlutusIR.Compiler.html#isVerbose"><span class="hs-identifier hs-type">isVerbose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119922"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119921"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119920"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119919"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119918"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119922"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-78"></span><span id="isVerbose"><span class="annot"><span class="annottext">isVerbose :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
m Bool
</span><a href="PlutusIR.Compiler.html#isVerbose"><span class="hs-identifier hs-var hs-var">isVerbose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coVerbose"><span class="hs-identifier hs-var">coVerbose</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621681119482"><span id="local-6989586621681119483"><span id="local-6989586621681119484"><span id="local-6989586621681119485"><span id="local-6989586621681119486"><span class="annot"><a href="PlutusIR.Compiler.html#isDebug"><span class="hs-identifier hs-type">isDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119485"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119484"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119483"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119482"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span></span></span><span>
</span><span id="line-81"></span><span id="isDebug"><span class="annot"><span class="annottext">isDebug :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
m Bool
</span><a href="PlutusIR.Compiler.html#isDebug"><span class="hs-identifier hs-var hs-var">isDebug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coDebug"><span class="hs-identifier hs-var">coDebug</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621681119899"><span id="local-6989586621681119900"><span id="local-6989586621681119901"><span id="local-6989586621681119902"><span id="local-6989586621681119903"><span class="annot"><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-type">logVerbose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119903"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119902"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119901"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119900"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119903"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-84"></span><span id="logVerbose"><span class="annot"><span class="annottext">logVerbose :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var hs-var">logVerbose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="../../../../extra/html/src"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; [m Bool] -&gt; m Bool
</span><a href="../../../../extra/html/src"><span class="hs-identifier hs-var">orM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
m Bool
</span><a href="PlutusIR.Compiler.html#isVerbose"><span class="hs-identifier hs-var">isVerbose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
m Bool
</span><a href="PlutusIR.Compiler.html#isDebug"><span class="hs-identifier hs-var">isDebug</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; String -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">traceM</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621681119421"><span id="local-6989586621681119422"><span id="local-6989586621681119423"><span id="local-6989586621681119424"><span id="local-6989586621681119425"><span class="annot"><a href="PlutusIR.Compiler.html#logDebug"><span class="hs-identifier hs-type">logDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119424"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119423"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119422"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119421"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-87"></span><span id="logDebug"><span class="annot"><span class="annottext">logDebug :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logDebug"><span class="hs-identifier hs-var hs-var">logDebug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="../../../../extra/html/src"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
m Bool
</span><a href="PlutusIR.Compiler.html#isDebug"><span class="hs-identifier hs-var">isDebug</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; String -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">traceM</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621681119879"><span id="local-6989586621681119880"><span id="local-6989586621681119881"><span id="local-6989586621681119882"><span id="local-6989586621681119883"><span id="local-6989586621681119884"><span class="annot"><a href="PlutusIR.Compiler.html#applyPass"><span class="hs-identifier hs-type">applyPass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119884"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119883"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119882"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119881"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119880"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119879"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119880"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119882"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119881"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119882"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119881"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119879"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119884"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119882"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119881"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119879"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-90"></span><span id="applyPass"><span class="annot"><span class="annottext">applyPass :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Pass uni fun
-&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#applyPass"><span class="hs-identifier hs-var hs-var">applyPass</span></a></span></span><span> </span><span id="local-6989586621681119276"><span class="annot"><span class="annottext">Pass uni fun
</span><a href="#local-6989586621681119276"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) b.
MonadReader (CompilationCtx uni fun a) m =&gt;
m Bool -&gt; (b -&gt; m b) -&gt; b -&gt; m b
</span><a href="PlutusIR.Compiler.Types.html#runIf"><span class="hs-identifier hs-var">runIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
Pass uni fun
-&gt; forall (m :: * -&gt; *) e a. Compiling m e uni fun a =&gt; m Bool
</span><a href="PlutusIR.Compiler.html#_shouldRun"><span class="hs-identifier hs-var">_shouldRun</span></a></span><span> </span><span class="annot"><span class="annottext">Pass uni fun
</span><a href="#local-6989586621681119276"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681119271"><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119271"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681119270"><span class="annot"><span class="annottext">passName :: String
</span><a href="#local-6989586621681119270"><span class="hs-identifier hs-var hs-var">passName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun. Pass uni fun -&gt; String
</span><a href="PlutusIR.Compiler.html#_name"><span class="hs-identifier hs-var">_name</span></a></span><span> </span><span class="annot"><span class="annottext">Pass uni fun
</span><a href="#local-6989586621681119276"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;      !!! &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681119270"><span class="hs-identifier hs-var">passName</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;        !!! Before &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681119270"><span class="hs-identifier hs-var">passName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119271"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621681119267"><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance a)
</span><a href="#local-6989586621681119267"><span class="hs-identifier hs-var">term'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
Pass uni fun
-&gt; forall (m :: * -&gt; *) e a.
   Compiling m e uni fun a =&gt;
   Term TyName Name uni fun (Provenance a)
   -&gt; m (Term TyName Name uni fun (Provenance a))
</span><a href="PlutusIR.Compiler.html#_pass"><span class="hs-identifier hs-var">_pass</span></a></span><span> </span><span class="annot"><span class="annottext">Pass uni fun
</span><a href="#local-6989586621681119276"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119271"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span>   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;        !!! After &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681119270"><span class="hs-identifier hs-var">passName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance a)
</span><a href="#local-6989586621681119267"><span class="hs-identifier hs-var">term'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance a)
</span><a href="#local-6989586621681119267"><span class="hs-identifier hs-var">term'</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span id="local-6989586621681119832"><span id="local-6989586621681119833"><span class="annot"><a href="PlutusIR.Compiler.html#availablePasses"><span class="hs-identifier hs-type">availablePasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119833"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119832"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-99"></span><span id="availablePasses"><span class="annot"><span class="annottext">availablePasses :: forall (uni :: * -&gt; *) fun. [Pass uni fun]
</span><a href="PlutusIR.Compiler.html#availablePasses"><span class="hs-identifier hs-var hs-var">availablePasses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
String
-&gt; (forall (m :: * -&gt; *) e a. Compiling m e uni fun a =&gt; m Bool)
-&gt; (forall (m :: * -&gt; *) e a.
    Compiling m e uni fun a =&gt;
    Term TyName Name uni fun (Provenance a)
    -&gt; m (Term TyName Name uni fun (Provenance a)))
-&gt; Pass uni fun
</span><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unwrap cancel&quot;</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
Lens' (CompilationOpts a) Bool -&gt; m Bool
</span><a href="PlutusIR.Compiler.html#onOption"><span class="hs-identifier hs-var">onOption</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coDoSimplifierUnwrapCancel"><span class="hs-identifier hs-var">coDoSimplifierUnwrapCancel</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.Unwrap.html#unwrapCancel"><span class="hs-identifier hs-var">Unwrap.unwrapCancel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
String
-&gt; (forall (m :: * -&gt; *) e a. Compiling m e uni fun a =&gt; m Bool)
-&gt; (forall (m :: * -&gt; *) e a.
    Compiling m e uni fun a =&gt;
    Term TyName Name uni fun (Provenance a)
    -&gt; m (Term TyName Name uni fun (Provenance a)))
-&gt; Pass uni fun
</span><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;beta&quot;</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
Lens' (CompilationOpts a) Bool -&gt; m Bool
</span><a href="PlutusIR.Compiler.html#onOption"><span class="hs-identifier hs-var">onOption</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coDoSimplifierBeta"><span class="hs-identifier hs-var">coDoSimplifierBeta</span></a></span><span class="hs-special">)</span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.Beta.html#beta"><span class="hs-identifier hs-var">Beta.beta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun.
String
-&gt; (forall (m :: * -&gt; *) e a. Compiling m e uni fun a =&gt; m Bool)
-&gt; (forall (m :: * -&gt; *) e a.
    Compiling m e uni fun a =&gt;
    Term TyName Name uni fun (Provenance a)
    -&gt; m (Term TyName Name uni fun (Provenance a)))
-&gt; Pass uni fun
</span><a href="PlutusIR.Compiler.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inline&quot;</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
Lens' (CompilationOpts a) Bool -&gt; m Bool
</span><a href="PlutusIR.Compiler.html#onOption"><span class="hs-identifier hs-var">onOption</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coDoSimplifierInline"><span class="hs-identifier hs-var">coDoSimplifierInline</span></a></span><span class="hs-special">)</span><span>             </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681119139"><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance a)
</span><a href="#local-6989586621681119139"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>                                                                                  </span><span id="local-6989586621681119138"><span class="annot"><span class="annottext">InlineHints Name (Provenance a)
</span><a href="#local-6989586621681119138"><span class="hs-identifier hs-var">hints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a1 a2.
Lens
  (CompilationOpts a1)
  (CompilationOpts a2)
  (InlineHints Name (Provenance a1))
  (InlineHints Name (Provenance a2))
</span><a href="PlutusIR.Compiler.Types.html#coInlineHints"><span class="hs-identifier hs-var">coInlineHints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                                                                                  </span><span id="local-6989586621681119137"><span class="annot"><span class="annottext">BuiltinVersion fun
</span><a href="#local-6989586621681119137"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (BuiltinVersion fun)
</span><a href="PlutusIR.Compiler.Types.html#ccBuiltinVer"><span class="hs-identifier hs-var">ccBuiltinVer</span></a></span><span>
</span><span id="line-105"></span><span>                                                                                  </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a (m :: * -&gt; *).
ExternalConstraints tyname name uni fun m =&gt;
InlineHints name a
-&gt; BuiltinVersion fun
-&gt; Term tyname name uni fun a
-&gt; m (Term tyname name uni fun a)
</span><a href="PlutusIR.Transform.Inline.html#inline"><span class="hs-identifier hs-var">Inline.inline</span></a></span><span> </span><span class="annot"><span class="annottext">InlineHints Name (Provenance a)
</span><a href="#local-6989586621681119138"><span class="hs-identifier hs-var">hints</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinVersion fun
</span><a href="#local-6989586621681119137"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance a)
</span><a href="#local-6989586621681119139"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-106"></span><span>                                                                              </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Actual simplifier</span><span>
</span><span id="line-110"></span><span class="annot"><a href="PlutusIR.Compiler.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681119784"><span class="annot"><a href="#local-6989586621681119784"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681119783"><span class="annot"><a href="#local-6989586621681119783"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621681119782"><span class="annot"><a href="#local-6989586621681119782"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681119781"><span class="annot"><a href="#local-6989586621681119781"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681119780"><span class="annot"><a href="#local-6989586621681119780"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681119779"><span class="annot"><a href="#local-6989586621681119779"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119783"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119782"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119781"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119779"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119782"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119781"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119779"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119782"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119781"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119779"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">(&gt;=&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Pass uni fun
-&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#applyPass"><span class="hs-identifier hs-var">applyPass</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun. [Pass uni fun]
</span><a href="PlutusIR.Compiler.html#availablePasses"><span class="hs-identifier hs-var">availablePasses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Perform some simplification of a 'Term'.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="PlutusIR.Compiler.html#simplifyTerm"><span class="hs-identifier hs-type">simplifyTerm</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681119099"><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681119098"><span class="annot"><a href="#local-6989586621681119098"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621681119097"><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681119096"><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681119095"><span class="annot"><a href="#local-6989586621681119095"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621681119094"><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119098"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119095"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119095"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span id="simplifyTerm"><span class="annot"><span class="annottext">simplifyTerm :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#simplifyTerm"><span class="hs-identifier hs-var hs-var">simplifyTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) b.
MonadReader (CompilationCtx uni fun a) m =&gt;
(b -&gt; m b) -&gt; b -&gt; m b
</span><a href="PlutusIR.Compiler.Types.html#runIfOpts"><span class="hs-identifier hs-var">runIfOpts</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119036"><span class="hs-identifier hs-var">simplify'</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- NOTE: we need at least one pass of dead code elimination</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="#local-6989586621681119036"><span class="hs-identifier hs-type">simplify'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621681119036"><span class="annot"><span class="annottext">simplify' :: Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119036"><span class="hs-identifier hs-var hs-var">simplify'</span></a></span></span><span> </span><span id="local-6989586621681119035"><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119035"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>            </span><span id="local-6989586621681119034"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119034"><span class="hs-identifier hs-var">maxIterations</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Int
</span><a href="PlutusIR.Compiler.Types.html#coMaxSimplifierIterations"><span class="hs-identifier hs-var">coMaxSimplifierIterations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119033"><span class="hs-identifier hs-var">simplifyNTimes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119034"><span class="hs-identifier hs-var">maxIterations</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119035"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-comment">-- Run the simplifier @n@ times</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="#local-6989586621681119033"><span class="hs-identifier hs-type">simplifyNTimes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621681119033"><span class="annot"><span class="annottext">simplifyNTimes :: Int -&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119033"><span class="hs-identifier hs-var hs-var">simplifyNTimes</span></a></span></span><span> </span><span id="local-6989586621681119032"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119032"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">(&gt;=&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119031"><span class="hs-identifier hs-var">simplifyStep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119032"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-comment">-- generate simplification step</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="#local-6989586621681119031"><span class="hs-identifier hs-type">simplifyStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119097"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119096"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119094"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621681119031"><span class="annot"><span class="annottext">simplifyStep :: Int -&gt; Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="#local-6989586621681119031"><span class="hs-identifier hs-var hs-var">simplifyStep</span></a></span></span><span> </span><span id="local-6989586621681119030"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119030"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681119029"><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119029"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    !!! simplifier pass &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681119030"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119029"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Perform floating/merging of lets in a 'Term' to their nearest lambda/Lambda/letStrictNonValue.</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- Note: It assumes globally unique names</span><span>
</span><span id="line-138"></span><span id="local-6989586621681119746"><span id="local-6989586621681119747"><span id="local-6989586621681119748"><span id="local-6989586621681119749"><span id="local-6989586621681119750"><span id="local-6989586621681119751"><span class="annot"><a href="PlutusIR.Compiler.html#floatTerm"><span class="hs-identifier hs-type">floatTerm</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119750"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119749"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119748"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119747"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119746"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119749"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119748"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119746"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119751"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119749"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119748"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119746"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-142"></span><span id="floatTerm"><span class="annot"><span class="annottext">floatTerm :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, Semigroup b) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#floatTerm"><span class="hs-identifier hs-var hs-var">floatTerm</span></a></span></span><span> </span><span id="local-6989586621681119003"><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119003"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621681119002"><span class="annot"><span class="annottext">BuiltinVersion fun
</span><a href="#local-6989586621681119002"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (BuiltinVersion fun)
</span><a href="PlutusIR.Compiler.Types.html#ccBuiltinVer"><span class="hs-identifier hs-var">ccBuiltinVer</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) b.
MonadReader (CompilationCtx uni fun a) m =&gt;
(b -&gt; m b) -&gt; b -&gt; m b
</span><a href="PlutusIR.Compiler.Types.html#runIfOpts"><span class="hs-identifier hs-var">runIfOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.LetMerge.html#letMerge"><span class="hs-identifier hs-var">LetMerge.letMerge</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a name tyname.
(Ord name, Ord tyname, HasUnique tyname TypeUnique,
 HasUnique name TermUnique) =&gt;
Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.RecSplit.html#recSplit"><span class="hs-identifier hs-var">RecSplit.recSplit</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun tyname name a.
(ToBuiltinMeaning uni fun, HasUnique tyname TypeUnique,
 HasUnique name TermUnique, Ord tyname, Ord name, Semigroup a) =&gt;
BuiltinVersion fun
-&gt; Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.LetFloat.html#floatTerm"><span class="hs-identifier hs-var">LetFloat.floatTerm</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinVersion fun
</span><a href="#local-6989586621681119002"><span class="hs-identifier hs-var">ver</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681119003"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Typecheck a PIR Term iff the context demands it.</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- Note: assumes globally unique names</span><span>
</span><span id="line-148"></span><span id="local-6989586621681119724"><span id="local-6989586621681119725"><span id="local-6989586621681119726"><span id="local-6989586621681119727"><span id="local-6989586621681119728"><span id="local-6989586621681119729"><span class="annot"><a href="PlutusIR.Compiler.html#typeCheckTerm"><span class="hs-identifier hs-type">typeCheckTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119729"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119728"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119727"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119726"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119724"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119727"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119726"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119724"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119729"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-149"></span><span id="typeCheckTerm"><span class="annot"><span class="annottext">typeCheckTerm :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m ()
</span><a href="PlutusIR.Compiler.html#typeCheckTerm"><span class="hs-identifier hs-var hs-var">typeCheckTerm</span></a></span></span><span> </span><span id="local-6989586621681118967"><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681118967"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621681118966"><span class="annot"><span class="annottext">Maybe (PirTCConfig uni fun)
</span><a href="#local-6989586621681118966"><span class="hs-identifier hs-var">mtcconfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
CompilationCtx uni fun a -&gt; Maybe (PirTCConfig uni fun)
</span><a href="PlutusIR.Compiler.Types.html#_ccTypeCheckConfig"><span class="hs-identifier hs-var">_ccTypeCheckConfig</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (PirTCConfig uni fun)
</span><a href="#local-6989586621681118966"><span class="hs-identifier hs-var">mtcconfig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681118963"><span class="annot"><span class="annottext">PirTCConfig uni fun
</span><a href="#local-6989586621681118963"><span class="hs-identifier hs-var">tcconfig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun (m :: * -&gt; *) a.
PirTCConfig uni fun -&gt; PirTCEnv uni fun m a -&gt; m a
</span><a href="PlutusIR.TypeCheck.Internal.html#runTypeCheckM"><span class="hs-identifier hs-var">runTypeCheckM</span></a></span><span> </span><span class="annot"><span class="annottext">PirTCConfig uni fun
</span><a href="#local-6989586621681118963"><span class="hs-identifier hs-var">tcconfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall err (m :: * -&gt; *) (uni :: * -&gt; *) fun ann.
MonadTypeCheckPir err uni fun ann m =&gt;
Term TyName Name uni fun ann
-&gt; PirTCEnv uni fun m (Normalized (Type TyName uni ()))
</span><a href="PlutusIR.TypeCheck.Internal.html#inferTypeM"><span class="hs-identifier hs-var">inferTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun b
</span><a href="#local-6989586621681118967"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">Maybe (PirTCConfig uni fun)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span id="local-6989586621681119843"><span id="local-6989586621681119844"><span id="local-6989586621681119845"><span id="local-6989586621681119846"><span id="local-6989586621681119847"><span class="annot"><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119846"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119845"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119844"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119843"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119845"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119844"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119843"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119847"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-156"></span><span id="check"><span class="annot"><span class="annottext">check :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621681118924"><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance b)
</span><a href="#local-6989586621681118924"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="../../../../extra/html/src"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (CompilationOpts a)
</span><a href="PlutusIR.Compiler.Types.html#ccOpts"><span class="hs-identifier hs-var">ccOpts</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (CompilationOpts a) Bool
</span><a href="PlutusIR.Compiler.Types.html#coPedantic"><span class="hs-identifier hs-var">coPedantic</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-158"></span><span>         </span><span class="hs-comment">-- the typechecker requires global uniqueness, so rename here</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m ()
</span><a href="PlutusIR.Compiler.html#typeCheckTerm"><span class="hs-identifier hs-var">typeCheckTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
</span><a href="PlutusCore.Rename.html#rename"><span class="hs-identifier hs-var">PLC.rename</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun (Provenance b)
</span><a href="#local-6989586621681118924"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621681119667"><span id="local-6989586621681119668"><span id="local-6989586621681119669"><span id="local-6989586621681119670"><span id="local-6989586621681119671"><span class="annot"><a href="PlutusIR.Compiler.html#withVer"><span class="hs-identifier hs-type">withVer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#CompilationCtx"><span class="hs-identifier hs-type">CompilationCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119671"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119670"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681119668"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Meaning.html#BuiltinVersion"><span class="hs-identifier hs-type">PLC.BuiltinVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119670"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119668"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119667"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119668"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119667"><span class="hs-identifier hs-type">t</span></a></span></span></span></span></span></span><span>
</span><span id="line-162"></span><span id="withVer"><span class="annot"><span class="annottext">withVer :: forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) t.
MonadReader (CompilationCtx uni fun a) m =&gt;
(BuiltinVersion fun -&gt; m t) -&gt; m t
</span><a href="PlutusIR.Compiler.html#withVer"><span class="hs-identifier hs-var hs-var">withVer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a.
Lens' (CompilationCtx uni fun a) (BuiltinVersion fun)
</span><a href="PlutusIR.Compiler.Types.html#ccBuiltinVer"><span class="hs-identifier hs-var">ccBuiltinVer</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | The 1st half of the PIR compiler pipeline up to floating/merging the lets.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- We stop momentarily here to give a chance to the tx-plugin</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- to dump a &quot;readable&quot; version of pir (i.e. floated).</span><span>
</span><span id="line-167"></span><span id="local-6989586621681119652"><span id="local-6989586621681119653"><span id="local-6989586621681119654"><span id="local-6989586621681119655"><span id="local-6989586621681119656"><span id="local-6989586621681119657"><span class="annot"><a href="PlutusIR.Compiler.html#compileToReadable"><span class="hs-identifier hs-type">compileToReadable</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119657"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119656"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119655"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119654"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119655"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119654"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119653"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119657"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119655"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119654"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119652"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-171"></span><span id="compileToReadable"><span class="annot"><span class="annottext">compileToReadable :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun a -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#compileToReadable"><span class="hs-identifier hs-var hs-var">compileToReadable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f (Provenance a)
</span><a href="PlutusIR.Compiler.Provenance.html#original"><span class="hs-identifier hs-var">original</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- We need globally unique names for typechecking, floating, and compiling non-strict bindings</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! rename&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
</span><a href="PlutusCore.Rename.html#rename"><span class="hs-identifier hs-var">PLC.rename</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m ()
</span><a href="PlutusIR.Compiler.html#typeCheckTerm"><span class="hs-identifier hs-var">typeCheckTerm</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! removeDeadBindings&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) t.
MonadReader (CompilationCtx uni fun a) m =&gt;
(BuiltinVersion fun -&gt; m t) -&gt; m t
</span><a href="PlutusIR.Compiler.html#withVer"><span class="hs-identifier hs-var">withVer</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall name (uni :: * -&gt; *) fun (m :: * -&gt; *) a.
(HasUnique name TermUnique, ToBuiltinMeaning uni fun,
 MonadQuote m) =&gt;
BuiltinVersion fun
-&gt; Term TyName name uni fun a -&gt; m (Term TyName name uni fun a)
</span><a href="PlutusIR.Transform.DeadCode.html#removeDeadBindings"><span class="hs-identifier hs-var">DeadCode.removeDeadBindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! simplifyTerm&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! floatTerm&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, Semigroup b) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#floatTerm"><span class="hs-identifier hs-var">floatTerm</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | The 2nd half of the PIR compiler pipeline.</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- Compiles a 'Term' into a PLC Term, by removing/translating step-by-step the PIR's language constructs to PLC.</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Note: the result *does* have globally unique names.</span><span>
</span><span id="line-188"></span><span id="local-6989586621681119622"><span id="local-6989586621681119623"><span id="local-6989586621681119624"><span id="local-6989586621681119625"><span id="local-6989586621681119626"><span id="local-6989586621681119627"><span class="annot"><a href="PlutusIR.Compiler.html#compileReadableToPlc"><span class="hs-identifier hs-type">compileReadableToPlc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119627"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119626"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119625"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119624"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681119622"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Provenance.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119625"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119624"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119622"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119627"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#PLCTerm"><span class="hs-identifier hs-type">PLCTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119625"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119624"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119623"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-189"></span><span id="compileReadableToPlc"><span class="annot"><span class="annottext">compileReadableToPlc :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (PLCTerm uni fun a)
</span><a href="PlutusIR.Compiler.html#compileReadableToPlc"><span class="hs-identifier hs-var hs-var">compileReadableToPlc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileNonStrictBindings&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
Bool
-&gt; Term TyName Name uni fun a -&gt; m (Term TyName Name uni fun a)
</span><a href="PlutusIR.Transform.NonStrict.html#compileNonStrictBindings"><span class="hs-identifier hs-var">NonStrict.compileNonStrictBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! thunkRecursions&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) t.
MonadReader (CompilationCtx uni fun a) m =&gt;
(BuiltinVersion fun -&gt; m t) -&gt; m t
</span><a href="PlutusIR.Compiler.html#withVer"><span class="hs-identifier hs-var">withVer</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun tyname name a.
ToBuiltinMeaning uni fun =&gt;
BuiltinVersion fun
-&gt; Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Transform.ThunkRecursions.html#thunkRecursions"><span class="hs-identifier hs-var">ThunkRec.thunkRecursions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- Thunking recursions breaks global uniqueness</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
</span><a href="PlutusCore.Rename.html#rename"><span class="hs-identifier hs-var">PLC.rename</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- Process only the non-strict bindings created by 'thunkRecursions' with unit delay/forces</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- See Note [Using unit versus force/delay]</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileNonStrictBindings&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (uni :: * -&gt; *) fun a.
MonadQuote m =&gt;
Bool
-&gt; Term TyName Name uni fun a -&gt; m (Term TyName Name uni fun a)
</span><a href="PlutusIR.Transform.NonStrict.html#compileNonStrictBindings"><span class="hs-identifier hs-var">NonStrict.compileNonStrictBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileLets DataTypes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
LetKind -&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
</span><a href="PlutusIR.Compiler.Let.html#compileLets"><span class="hs-identifier hs-var">Let.compileLets</span></a></span><span> </span><span class="annot"><span class="annottext">LetKind
</span><a href="PlutusIR.Compiler.Let.html#DataTypes"><span class="hs-identifier hs-var">Let.DataTypes</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileLets RecTerms&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
LetKind -&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
</span><a href="PlutusIR.Compiler.Let.html#compileLets"><span class="hs-identifier hs-var">Let.compileLets</span></a></span><span> </span><span class="annot"><span class="annottext">LetKind
</span><a href="PlutusIR.Compiler.Let.html#RecTerms"><span class="hs-identifier hs-var">Let.RecTerms</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- We introduce some non-recursive let bindings while eliminating recursive let-bindings, so we</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- can eliminate any of them which are unused here.</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! removeDeadBindings&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (uni :: * -&gt; *) fun a (m :: * -&gt; *) t.
MonadReader (CompilationCtx uni fun a) m =&gt;
(BuiltinVersion fun -&gt; m t) -&gt; m t
</span><a href="PlutusIR.Compiler.html#withVer"><span class="hs-identifier hs-var">withVer</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall name (uni :: * -&gt; *) fun (m :: * -&gt; *) a.
(HasUnique name TermUnique, ToBuiltinMeaning uni fun,
 MonadQuote m) =&gt;
BuiltinVersion fun
-&gt; Term TyName name uni fun a -&gt; m (Term TyName name uni fun a)
</span><a href="PlutusIR.Transform.DeadCode.html#removeDeadBindings"><span class="hs-identifier hs-var">DeadCode.removeDeadBindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! simplifyTerm&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#simplifyTerm"><span class="hs-identifier hs-var">simplifyTerm</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileLets Types&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
LetKind -&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
</span><a href="PlutusIR.Compiler.Let.html#compileLets"><span class="hs-identifier hs-var">Let.compileLets</span></a></span><span> </span><span class="annot"><span class="annottext">LetKind
</span><a href="PlutusIR.Compiler.Let.html#Types"><span class="hs-identifier hs-var">Let.Types</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! compileLets NonRecTerms&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
LetKind -&gt; PIRTerm uni fun a -&gt; m (PIRTerm uni fun a)
</span><a href="PlutusIR.Compiler.Let.html#compileLets"><span class="hs-identifier hs-var">Let.compileLets</span></a></span><span> </span><span class="annot"><span class="annottext">LetKind
</span><a href="PlutusIR.Compiler.Let.html#NonRecTerms"><span class="hs-identifier hs-var">Let.NonRecTerms</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun b.
Compiling m e uni fun b =&gt;
Term TyName Name uni fun (Provenance b) -&gt; m ()
</span><a href="PlutusIR.Compiler.html#check"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  !!! lowerTerm&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
PIRTerm uni fun a -&gt; m (PLCTerm uni fun a)
</span><a href="PlutusIR.Compiler.Lower.html#lowerTerm"><span class="hs-identifier hs-var">lowerTerm</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">--- | Compile a 'Term' into a PLC Term. Note: the result *does* have globally unique names.</span><span>
</span><span id="line-227"></span><span id="local-6989586621681119586"><span id="local-6989586621681119587"><span id="local-6989586621681119588"><span id="local-6989586621681119589"><span id="local-6989586621681119590"><span class="annot"><a href="PlutusIR.Compiler.html#compileTerm"><span class="hs-identifier hs-type">compileTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Types.html#Compiling"><span class="hs-identifier hs-type">Compiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119590"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119589"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119588"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119587"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119586"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119588"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119587"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119586"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681119590"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Types.html#PLCTerm"><span class="hs-identifier hs-type">PLCTerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119588"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119587"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681119586"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-229"></span><span id="compileTerm"><span class="annot"><span class="annottext">compileTerm :: forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
Term TyName Name uni fun a -&gt; m (PLCTerm uni fun a)
</span><a href="PlutusIR.Compiler.html#compileTerm"><span class="hs-identifier hs-var hs-var">compileTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!!! compileToReadable&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun a -&gt; m (Term TyName Name uni fun b)
</span><a href="PlutusIR.Compiler.html#compileToReadable"><span class="hs-identifier hs-var">compileToReadable</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a.
Compiling m e uni fun a =&gt;
String -&gt; m ()
</span><a href="PlutusIR.Compiler.html#logVerbose"><span class="hs-identifier hs-var">logVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!!! compileReadableToPlc&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e (uni :: * -&gt; *) fun a b.
(Compiling m e uni fun a, b ~ Provenance a) =&gt;
Term TyName Name uni fun b -&gt; m (PLCTerm uni fun a)
</span><a href="PlutusIR.Compiler.html#compileReadableToPlc"><span class="hs-identifier hs-var">compileReadableToPlc</span></a></span><span>
</span><span id="line-234"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances        #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies             #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances     #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-specialise #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-omit-interface-pragmas #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusTx.Builtins.Class</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html"><span class="hs-identifier">PlutusTx.Builtins.Internal</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">pack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">GHC.Magic</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Magic</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusTx.Base.html"><span class="hs-identifier">PlutusTx.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Base.html#const"><span class="hs-identifier">const</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusTx.Base.html#id"><span class="hs-identifier">id</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusTx.Base.html#%24"><span class="hs-operator">($)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusTx.Bool.html"><span class="hs-identifier">PlutusTx.Bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Bool</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusTx.Integer.html"><span class="hs-identifier">PlutusTx.Integer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Haskell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">String</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">{- Note [Fundeps versus type families in To/FromBuiltin]
We could use a type family here to get the builtin representation of a type. After all, it's
entirely determined by the Haskell type.

However, this is harder for the plugin to deal with. It's okay to have a type variable
for the representation type that needs to be instantiated later, but it's *not* okay to
have an irreducible type application on a type variable. So fundeps are much nicer here.
-}</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">{-|
A class witnessing the ability to convert from the builtin representation to the Haskell representation.
-}</span><span>
</span><span id="line-39"></span><span class="hs-keyword">class</span><span> </span><span id="FromBuiltin"><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698826"><span class="annot"><a href="#local-6989586621679698826"><span class="hs-identifier hs-type">arep</span></a></span></span><span> </span><span id="local-6989586621679698825"><span class="annot"><a href="#local-6989586621679698825"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679698826"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679698825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>    </span><span id="fromBuiltin"><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-identifier hs-type">fromBuiltin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679698826"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679698825"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">{-|
A class witnessing the ability to convert from the Haskell representation to the builtin representation.
-}</span><span>
</span><span id="line-45"></span><span class="hs-keyword">class</span><span> </span><span id="ToBuiltin"><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-var">ToBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698822"><span class="annot"><a href="#local-6989586621679698822"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679698821"><span class="annot"><a href="#local-6989586621679698821"><span class="hs-identifier hs-type">arep</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679698822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679698821"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span id="toBuiltin"><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-type">toBuiltin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679698822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679698821"><span class="hs-identifier hs-type">arep</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinInteger"><span class="hs-identifier hs-type">BuiltinInteger</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679698771"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinInteger -&gt; BuiltinInteger
</span><a href="#local-6989586621679698771"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="PlutusTx.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinInteger"><span class="hs-identifier hs-type">BuiltinInteger</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679698767"><span class="annot"><span class="annottext">toBuiltin :: BuiltinInteger -&gt; BuiltinInteger
</span><a href="#local-6989586621679698767"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="PlutusTx.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinBool"><span class="hs-identifier hs-type">BuiltinBool</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679698764"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinBool -&gt; Bool
</span><a href="#local-6989586621679698764"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698763"><span class="annot"><span class="annottext">BuiltinBool
</span><a href="#local-6989586621679698763"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BuiltinBool -&gt; a -&gt; a -&gt; a
</span><a href="PlutusTx.Builtins.Internal.html#ifThenElse"><span class="hs-identifier hs-var">ifThenElse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinBool
</span><a href="#local-6989586621679698763"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinBool"><span class="hs-identifier hs-type">BuiltinBool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679698759"><span class="annot"><span class="annottext">toBuiltin :: Bool -&gt; BuiltinBool
</span><a href="#local-6989586621679698759"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698758"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679698758"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679698758"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BuiltinBool
</span><a href="PlutusTx.Builtins.Internal.html#true"><span class="hs-identifier hs-var">true</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BuiltinBool
</span><a href="PlutusTx.Builtins.Internal.html#false"><span class="hs-identifier hs-var">false</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">{- Note [Strict conversions to/from unit]
Converting to/from unit *should* be straightforward: just ``const ()`.`
*But* GHC is very good at optimizing this, and we sometimes use unit
where side effects matter, e.g. as the result of `trace`. So GHC will
tend to turn `fromBuiltin (trace s)` into `()`, which is wrong.

So we want our conversions to/from unit to be strict in Haskell. This
means we need to case pointlessly on the argument, which means we need
case on unit (`chooseUnit`) as a builtin. But then it all works okay.
-}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinUnit"><span class="hs-identifier hs-type">BuiltinUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- See Note [Strict conversions to/from unit]</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679698753"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinUnit -&gt; ()
</span><a href="#local-6989586621679698753"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698752"><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="#local-6989586621679698752"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. BuiltinUnit -&gt; a -&gt; a
</span><a href="PlutusTx.Builtins.Internal.html#chooseUnit"><span class="hs-identifier hs-var">chooseUnit</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="#local-6989586621679698752"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinUnit"><span class="hs-identifier hs-type">BuiltinUnit</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- See Note [Strict conversions to/from unit]</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679698748"><span class="annot"><span class="annottext">toBuiltin :: () -&gt; BuiltinUnit
</span><a href="#local-6989586621679698748"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698747"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621679698747"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621679698747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="PlutusTx.Builtins.Internal.html#unitval"><span class="hs-identifier hs-var">unitval</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-type">BuiltinByteString</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679698743"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinByteString -&gt; ByteString
</span><a href="#local-6989586621679698743"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-type">BuiltinByteString</span></a></span><span> </span><span id="local-6989586621679698741"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679698741"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679698741"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-type">BuiltinByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679698738"><span class="annot"><span class="annottext">toBuiltin :: ByteString -&gt; BuiltinByteString
</span><a href="#local-6989586621679698738"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; BuiltinByteString
</span><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-var">BuiltinByteString</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">{- Note [noinline hack]
For some functions we have two conflicting desires:
- We want to have the unfolding available for the plugin.
- We don't want the function to *actually* get inlined before the plugin runs, since we rely
on being able to see the original function for some reason.

'INLINABLE' achieves the first, but may cause the function to be inlined too soon.

We can solve this at specific call sites by using the 'noinline' magic function from
GHC. This stops GHC from inlining it. As a bonus, it also won't be inlined if
that function is compiled later into the body of another function.

We do therefore need to handle 'noinline' in the plugin, as it itself does not have
an unfolding.

Another annoying quirk: even if you have 'noinline'd a function call, if the body is
a single variable, it will still inline! This is the case for the obvious definition
of 'stringToBuiltinString' (since the newtype constructor vanishes), so we have to add
some obfuscation to the body to prevent it inlining.
-}</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- We can't put this in `Builtins.hs`, since that force `O0` deliberately, which prevents</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- the unfoldings from going in. So we just stick it here. Fiddly.</span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-type">BuiltinString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- Try and make sure the dictionary selector goes away, it's simpler to match on</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- the application of 'stringToBuiltinString'</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-pragma hs-type">fromString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- See Note [noinline hack]</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679698734"><span class="annot"><span class="annottext">fromString :: String -&gt; BuiltinString
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">Magic.noinline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; BuiltinString
</span><a href="PlutusTx.Builtins.Class.html#stringToBuiltinString"><span class="hs-identifier hs-var">stringToBuiltinString</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#stringToBuiltinString"><span class="hs-pragma hs-type">stringToBuiltinString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-120"></span><span class="annot"><a href="PlutusTx.Builtins.Class.html#stringToBuiltinString"><span class="hs-identifier hs-type">stringToBuiltinString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Haskell.String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-type">BuiltinString</span></a></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- To explain why the obfuscatedId is here</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- See Note [noinline hack]</span><span>
</span><span id="line-123"></span><span id="stringToBuiltinString"><span class="annot"><span class="annottext">stringToBuiltinString :: String -&gt; BuiltinString
</span><a href="PlutusTx.Builtins.Class.html#stringToBuiltinString"><span class="hs-identifier hs-var hs-var">stringToBuiltinString</span></a></span></span><span> </span><span id="local-6989586621679698732"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679698732"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="PlutusTx.Builtins.Class.html#obfuscatedId"><span class="hs-identifier hs-var">obfuscatedId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; BuiltinString
</span><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-var">BuiltinString</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="PlutusTx.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679698732"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#obfuscatedId"><span class="hs-pragma hs-type">obfuscatedId</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-126"></span><span id="local-6989586621679698729"><span class="annot"><a href="PlutusTx.Builtins.Class.html#obfuscatedId"><span class="hs-identifier hs-type">obfuscatedId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679698729"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679698729"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-127"></span><span id="obfuscatedId"><span class="annot"><span class="annottext">obfuscatedId :: forall a. a -&gt; a
</span><a href="PlutusTx.Builtins.Class.html#obfuscatedId"><span class="hs-identifier hs-var hs-var">obfuscatedId</span></a></span></span><span> </span><span id="local-6989586621679698728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679698728"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679698728"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-type">BuiltinString</span></a></span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679698725"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinString -&gt; Text
</span><a href="#local-6989586621679698725"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-type">BuiltinString</span></a></span><span> </span><span id="local-6989586621679698724"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679698724"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679698724"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-type">BuiltinString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679698721"><span class="annot"><span class="annottext">toBuiltin :: Text -&gt; BuiltinString
</span><a href="#local-6989586621679698721"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; BuiltinString
</span><a href="PlutusTx.Builtins.Internal.html#BuiltinString"><span class="hs-identifier hs-var">BuiltinString</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">{- Same noinline hack as with `String` type. -}</span><span>
</span><span id="line-137"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">IsString</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-type">BuiltinByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- Try and make sure the dictionary selector goes away, it's simpler to match on</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- the application of 'stringToBuiltinByteString'</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-pragma hs-type">fromString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- See Note [noinline hack]</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679698718"><span class="annot"><span class="annottext">fromString :: String -&gt; BuiltinByteString
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">Magic.noinline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; BuiltinByteString
</span><a href="PlutusTx.Builtins.Class.html#stringToBuiltinByteString"><span class="hs-identifier hs-var">stringToBuiltinByteString</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#stringToBuiltinByteString"><span class="hs-pragma hs-type">stringToBuiltinByteString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-145"></span><span class="annot"><a href="PlutusTx.Builtins.Class.html#stringToBuiltinByteString"><span class="hs-identifier hs-type">stringToBuiltinByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Haskell.String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinByteString"><span class="hs-identifier hs-type">BuiltinByteString</span></a></span><span>
</span><span id="line-146"></span><span id="stringToBuiltinByteString"><span class="annot"><span class="annottext">stringToBuiltinByteString :: String -&gt; BuiltinByteString
</span><a href="PlutusTx.Builtins.Class.html#stringToBuiltinByteString"><span class="hs-identifier hs-var hs-var">stringToBuiltinByteString</span></a></span></span><span> </span><span id="local-6989586621679698716"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679698716"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinString -&gt; BuiltinByteString
</span><a href="PlutusTx.Builtins.Internal.html#encodeUtf8"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="PlutusTx.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; BuiltinString
</span><a href="PlutusTx.Builtins.Class.html#stringToBuiltinString"><span class="hs-identifier hs-var">stringToBuiltinString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679698716"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">{- Note [From/ToBuiltin instances for polymorphic builtin types]
For various technical reasons
(see Note [Representable built-in functions over polymorphic built-in types])
it's not always easy to provide polymorphic constructors for builtin types, but
we can usually provide destructors.

What this means in practice is that we can write a generic FromBuiltin instance
for pairs that makes use of polymorphic fst/snd builtins, but we can't write
a polymorphic ToBuiltin instance because we'd need a polymorphic version of (,).

Instead we write monomorphic instances corresponding to monomorphic constructor
builtins that we add for specific purposes.
-}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679698799"><span id="local-6989586621679698800"><span id="local-6989586621679698801"><span id="local-6989586621679698802"><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698802"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698800"><span class="hs-identifier hs-type">brep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinPair"><span class="hs-identifier hs-type">BuiltinPair</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698802"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698800"><span class="hs-identifier hs-type">brep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679698801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679698799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679698708"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinPair arep brep -&gt; (a, b)
</span><a href="#local-6989586621679698708"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span id="local-6989586621679698707"><span class="annot"><span class="annottext">BuiltinPair arep brep
</span><a href="#local-6989586621679698707"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall arep a. FromBuiltin arep a =&gt; arep -&gt; a
</span><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-identifier hs-var">fromBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="PlutusTx.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. BuiltinPair a b -&gt; a
</span><a href="PlutusTx.Builtins.Internal.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinPair arep brep
</span><a href="#local-6989586621679698707"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall arep a. FromBuiltin arep a =&gt; arep -&gt; a
</span><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-identifier hs-var">fromBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="PlutusTx.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. BuiltinPair a b -&gt; b
</span><a href="PlutusTx.Builtins.Internal.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinPair arep brep
</span><a href="#local-6989586621679698707"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinPair"><span class="hs-identifier hs-type">BuiltinPair</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679698702"><span class="annot"><span class="annottext">toBuiltin :: (BuiltinData, BuiltinData) -&gt; BuiltinPair BuiltinData BuiltinData
</span><a href="#local-6989586621679698702"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679698701"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698701"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679698700"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698700"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; BuiltinData -&gt; BuiltinPair BuiltinData BuiltinData
</span><a href="PlutusTx.Builtins.Internal.html#mkPairData"><span class="hs-identifier hs-var">mkPairData</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698701"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698700"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679698789"><span id="local-6989586621679698790"><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698790"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinList"><span class="hs-identifier hs-type">BuiltinList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698790"><span class="hs-identifier hs-type">arep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679698789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679698694"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinList arep -&gt; [a]
</span><a href="#local-6989586621679698694"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinList arep -&gt; [a]
</span><a href="#local-6989586621679698693"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-comment">-- The combination of both INLINABLE and a type signature seems to stop this getting lifted to the top</span><span>
</span><span id="line-174"></span><span>          </span><span class="hs-comment">-- level, which means it gets a proper unfolding, which means that specialization can work, which can</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-comment">-- actually help quite a bit here.</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="#local-6989586621679698693"><span class="hs-pragma hs-type">go</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><a href="#local-6989586621679698693"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinList"><span class="hs-identifier hs-type">BuiltinList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679698790"><span class="hs-identifier hs-type">arep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679698789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-comment">-- Note that we are using builtin chooseList here so this is *strict* application! So we need to do</span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-comment">-- the manual laziness ourselves.</span><span>
</span><span id="line-180"></span><span>          </span><span id="local-6989586621679698693"><span class="annot"><span class="annottext">go :: BuiltinList arep -&gt; [a]
</span><a href="#local-6989586621679698693"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679698692"><span class="annot"><span class="annottext">BuiltinList arep
</span><a href="#local-6989586621679698692"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. BuiltinList a -&gt; b -&gt; b -&gt; b
</span><a href="PlutusTx.Builtins.Internal.html#chooseList"><span class="hs-identifier hs-var">chooseList</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinList arep
</span><a href="#local-6989586621679698692"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="PlutusTx.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">BuiltinUnit
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall arep a. FromBuiltin arep a =&gt; arep -&gt; a
</span><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-identifier hs-var">fromBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BuiltinList a -&gt; a
</span><a href="PlutusTx.Builtins.Internal.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinList arep
</span><a href="#local-6989586621679698692"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">BuiltinList arep -&gt; [a]
</span><a href="#local-6989586621679698693"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BuiltinList a -&gt; BuiltinList a
</span><a href="PlutusTx.Builtins.Internal.html#tail"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinList arep
</span><a href="#local-6989586621679698692"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="PlutusTx.Builtins.Internal.html#unitval"><span class="hs-identifier hs-var">unitval</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinList"><span class="hs-identifier hs-type">BuiltinList</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679698685"><span class="annot"><span class="annottext">toBuiltin :: [BuiltinData] -&gt; BuiltinList BuiltinData
</span><a href="#local-6989586621679698685"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinUnit -&gt; BuiltinList BuiltinData
</span><a href="PlutusTx.Builtins.Internal.html#mkNilData"><span class="hs-identifier hs-var">mkNilData</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="PlutusTx.Builtins.Internal.html#unitval"><span class="hs-identifier hs-var">unitval</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-var">toBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679698683"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698683"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679698682"><span class="annot"><span class="annottext">[BuiltinData]
</span><a href="#local-6989586621679698682"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; BuiltinList a -&gt; BuiltinList a
</span><a href="PlutusTx.Builtins.Internal.html#mkCons"><span class="hs-identifier hs-var">mkCons</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679698683"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a arep. ToBuiltin a arep =&gt; a -&gt; arep
</span><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-var">toBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">[BuiltinData]
</span><a href="#local-6989586621679698682"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinList"><span class="hs-identifier hs-type">BuiltinList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinPair"><span class="hs-identifier hs-type">BuiltinPair</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679698676"><span class="annot"><span class="annottext">toBuiltin :: [(BuiltinData, BuiltinData)]
-&gt; BuiltinList (BuiltinPair BuiltinData BuiltinData)
</span><a href="#local-6989586621679698676"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinUnit -&gt; BuiltinList (BuiltinPair BuiltinData BuiltinData)
</span><a href="PlutusTx.Builtins.Internal.html#mkNilPairData"><span class="hs-identifier hs-var">mkNilPairData</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinUnit
</span><a href="PlutusTx.Builtins.Internal.html#unitval"><span class="hs-identifier hs-var">unitval</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-var">toBuiltin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679698674"><span class="annot"><span class="annottext">(BuiltinData, BuiltinData)
</span><a href="#local-6989586621679698674"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679698673"><span class="annot"><span class="annottext">[(BuiltinData, BuiltinData)]
</span><a href="#local-6989586621679698673"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; BuiltinList a -&gt; BuiltinList a
</span><a href="PlutusTx.Builtins.Internal.html#mkCons"><span class="hs-identifier hs-var">mkCons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a arep. ToBuiltin a arep =&gt; a -&gt; arep
</span><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-var">toBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinData, BuiltinData)
</span><a href="#local-6989586621679698674"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a arep. ToBuiltin a arep =&gt; a -&gt; arep
</span><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-identifier hs-var">toBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">[(BuiltinData, BuiltinData)]
</span><a href="#local-6989586621679698673"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#FromBuiltin"><span class="hs-identifier hs-type">FromBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#fromBuiltin"><span class="hs-pragma hs-type">fromBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679698670"><span class="annot"><span class="annottext">fromBuiltin :: BuiltinData -&gt; BuiltinData
</span><a href="#local-6989586621679698670"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="PlutusTx.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#ToBuiltin"><span class="hs-identifier hs-type">ToBuiltin</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Internal.html#BuiltinData"><span class="hs-identifier hs-type">BuiltinData</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="PlutusTx.Builtins.Class.html#toBuiltin"><span class="hs-pragma hs-type">toBuiltin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679698667"><span class="annot"><span class="annottext">toBuiltin :: BuiltinData -&gt; BuiltinData
</span><a href="#local-6989586621679698667"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBuiltin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="PlutusTx.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-198"></span></pre></body></html>
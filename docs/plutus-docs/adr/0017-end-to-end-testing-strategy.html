<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ADR 17: End-to-end testing strategy for Plutus, cardano-ledger-api and cardano-node-client &mdash; Plutus Tools SDK User Guide 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reference" href="../reference/index.html" />
    <link rel="prev" title="ADR 16: Self-contained cardano-node emulator component" href="0016-cardano-node-emulator.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #fcfcfc" >
            <a href="../index.html" class="icon icon-home"> Plutus Tools SDK User Guide
            <img src="../_static/cardano-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Explore Plutus</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../plutus/explanations/index.html">Explanations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html">Plutus tools in development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#logical-components">Logical components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#marconi">1. Marconi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-use-case-examples">2. Plutus use case examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#pab-plutus-application-backend">3. PAB (Plutus application backend)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#contract-monad-emulator">4. Contract monad emulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-contract-model-testing">5. Plutus contract model testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-contract-state-machine">6. Plutus contract state machine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#contract-api-also-known-as-contract-monad">7. Contract API (also known as Contract monad)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-chain-index">8. Plutus chain index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-ledger-constraints">9. Plutus ledger constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-tx-constraints">10. Plutus Tx constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#id10">11. Plutus ledger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/plutus-tools-component-descriptions.html#plutus-script-utils">12. Plutus script utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/explanations/rollback.html">What is a rollback?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/rollback.html#what-does-this-mean-for-dapps">What does this mean for dapps?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/explanations/pab.html">What is the PAB?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/pab.html#client-interface">Client interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/pab.html#other-components">Other components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/pab.html#chain-index">Chain index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/pab.html#alonzo-node">Alonzo node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/pab.html#wallet">Wallet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/pab.html#deployment-scenarios">Deployment Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/pab.html#hosted">Hosted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/pab.html#in-browser">In-browser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html">What is the order book pattern?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#example-distributed-exchange">Example: Distributed exchange</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#orders-and-plutus-scripts">Orders and Plutus scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#decentralisation">Decentralisation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#generalising-the-pattern">Generalising the pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#off-chain-oracles">Off-chain oracles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#on-chain-oracles">On-chain oracles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#state-machines">State machines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/explanations/order-book-pattern.html#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plutus/tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plutus/tutorials/basic-apps.html">Writing a basic Plutus app in an emulated environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#defining-the-types">Defining the types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#instances-for-data-types">Instances for data types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#defining-the-validator-script">Defining the validator script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#asking-for-input">Asking for input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#locking-the-funds">Locking the funds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#unlocking-the-funds">Unlocking the funds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#running-the-app-on-the-plutus-apps-emulator">Running the app on the Plutus apps emulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/basic-apps.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/tutorials/basic-apps-constraints.html">Extending the basic Plutus app with the constraints API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/tutorials/contract-testing.html">Property-based testing of Plutus contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#an-overview-of-the-guessing-game">An overview of the guessing game</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#emulated-wallets">Emulated wallets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#values-and-tokens">Values and <span class="xref std std-term">tokens</span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#introducing-contract-models">Introducing contract models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#generating-actions">Generating actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#modelling-expectations">Modelling expectations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#restricting-test-cases-with-preconditions">Restricting test cases with preconditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#performing-actions">Performing actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#shrinking-actions">Shrinking Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#debugging-the-model">Debugging the model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#adding-delays-to-test-cases">Adding delays to test cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#rerunning-a-failed-test">Rerunning a failed test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#controlling-the-log-level">Controlling the log-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#refining-preconditions">Refining preconditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#measuring-and-tuning-distributions">Measuring and tuning distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#custom-generators-vs-preconditions">Custom generators vs preconditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#instrumenting-contract-models-to-gather-statistics">Instrumenting contract models to gather statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#goal-directed-testing-with-dynamic-logic">Goal-directed testing with dynamic logic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#introducing-the-dynamic-logic-monad">Introducing the dynamic logic monad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#quantifiers-in-dynamic-logic">Quantifiers in dynamic logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#repeating-a-dynamic-logic-test">Repeating a dynamic logic test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#something-good-is-always-possible">Something good is always possible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#monitoring-and-tuning-dynamic-logic-tests">Monitoring and tuning dynamic logic tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#more-dynamic-logic">More dynamic logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#limitations">Limitations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#testing-only-via-contract-endpoints">Testing only via <span class="xref std std-term">contract endpoints</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#test-assumptions-on-timing">Test assumptions on timing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#testing-for-information-leaks">Testing for information leaks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-testing.html#further-examples">Further Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/tutorials/contract-models.html">Testing Plutus Contracts with Contract Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#basic-contract-models">Basic Contract Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#example-a-simple-escrow-contract">Example: A Simple Escrow Contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#the-contract-model-type">The Contract Model Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#what-contracts-shall-we-test">What contracts shall we test?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#what-actions-should-tests-perform">What actions should tests perform?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#generating-actions">Generating Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#running-tests-and-debugging-the-model">Running tests and debugging the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#analysing-the-distribution-of-tests">Analysing the distribution of tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#parameterising-models-and-dynamic-contract-instances">Parameterising Models and Dynamic Contract Instances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#adding-an-initial-action-and-test-case-phases">Adding an initial action, and test case phases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#dynamic-contract-instances">Dynamic contract instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#running-our-extended-tests-another-design-issue">Running our extended tests; another design issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id3">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#testing-no-locked-funds-with-dynamic-logic">Testing “No Locked Funds” with Dynamic Logic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#writing-and-testing-properties-using-dynamic-logic">Writing and testing properties using Dynamic Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#digression-revisiting-a-design-decision">Digression: revisiting a design decision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#fair-s-fair-unilateral-strategies">Fair’s fair: Unilateral strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#fixing-the-contract-refunds">Fixing the contract: refunds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id4">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#taking-time-into-account">Taking Time into Account</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#slots-and-posixtime">Slots and POSIXTime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#initialising-the-deadline">Initialising the deadline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#modelling-the-passage-of-time">Modelling the passage of time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#monitoring-and-the-distribution-of-tests">Monitoring and the distribution of tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#no-locked-funds">No locked funds?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#digression-testing-the-model-alone-for-speed">Digression: testing the model alone for speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id5">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#measuring-coverage-of-on-chain-code">Measuring coverage of on-chain code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#adding-a-coverage-index">Adding a coverage index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#measuring-coverage">Measuring coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#interpreting-the-coverage-annotations">Interpreting the coverage annotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#the-generated-coverage-report">The generated coverage report</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#crashes-and-how-to-tolerate-them">Crashes, and how to tolerate them</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id6">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#debugging-the-auction-contract-with-model-assertions">Debugging the Auction contract with model assertions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#modelling-the-auction-contract">Modelling the Auction contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id7">No locked funds?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#model-assertions-and-unexpected-expectations">Model assertions, and unexpected expectations.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#crashing-the-auction">Crashing the auction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#coverage-of-the-auction-contract">Coverage of the Auction contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id8">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/tutorials/contract-models.html#becoming-level-1-certification-ready">Becoming Level 1 Certification Ready</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/tutorials/contract-models.html#id9">Exercises</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plutus/howtos/index.html">How-to guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plutus/howtos/getting-started.html">How to get started with the Plutus Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/getting-started.html#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html">How to write a scalable Plutus app</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#the-building-blocks">The building blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#transaction-outputs">Transaction outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#state-of-transaction-outputs">State of transaction outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#changing-the-state-of-our-app">Changing the state of our app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#minting-policy-scripts">Minting Policy Scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#scalability-guidelines">Scalability guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#decentralised-exchange">Decentralised exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#marlowe">Marlowe</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/writing-a-scalable-app.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/howtos/handling-blockchain-events.html">How to handle blockchain events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/handling-blockchain-events.html#transaction-output-lifecycle">Transaction output lifecycle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/handling-blockchain-events.html#transaction-states">Transaction states</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/handling-blockchain-events.html#pab-functions-for-listening-to-state-changes">PAB functions for listening to state changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/howtos/analysing-scripts.html">How to analyse the cost and size of Plutus scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/analysing-scripts.html#resource-use-of-plutus-scripts">Resource use of Plutus scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/analysing-scripts.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/analysing-scripts.html#validator-scripts">Validator scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/analysing-scripts.html#partial-transactions">Partial transactions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plutus/howtos/plutus-spending-script-example.html">Plutus Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plutus/howtos/plutus-spending-script-example.html#what-is-a-plutus-spending-script">What is a Plutus spending script?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plutus/howtos/plutus-spending-script-example.html#an-example-of-using-a-plutus-spending-script">An example of using a Plutus spending script</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plutus/troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plutus/troubleshooting.html#error-codes">Error codes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architectural decision records</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Architectural Decision Records</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="0001-record-architecture-decisions.html">ADR 1: Record architectural decisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0001-record-architecture-decisions.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="0001-record-architecture-decisions.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0001-record-architecture-decisions.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0001-record-architecture-decisions.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0001-record-architecture-decisions.html#implications">Implications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0001-record-architecture-decisions.html#adr-template">ADR template</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0002-repository-standardization.html">ADR 2: Repository Standardization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0002-repository-standardization.html#implications">Implications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0003-marconi-monorepo.html">ADR 3: Move Marconi into a separate repository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0003-marconi-monorepo.html#related-decisions">Related Decisions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0004-marconi-initiative.html">ADR 4: Making a case for Marconi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#design-principles-of-marconi">Design principles of Marconi</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#indexing-solution">Indexing solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#query-and-storage">Query and storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#identification-of-events">Identification of events</a></li>
<li class="toctree-l3"><a class="reference internal" href="0004-marconi-initiative.html#event-streams">Event streams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0005-pab-indexing-solution-integration.html">ADR 5: PAB and indexing component integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#decisions">Decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#alternative-solutions">Alternative solutions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#make-sure-all-components-are-in-sync">Make sure all components are in sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#add-indexing-specific-functions-in-the-contract-api">Add indexing specific functions in the Contract API</a></li>
<li class="toctree-l4"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#query-functions-should-interact-with-a-single-source-of-truth">Query functions should interact with a single source of truth</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0005-pab-indexing-solution-integration.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0006-common-contract-api.html">ADR 6: Common Contract API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0006-common-contract-api.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html">ADR 7: Support reference inputs in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0007-support-reference-inputs-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html">ADR 8: Support inline datums in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0008-support-inline-datums-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html">ADR 9: Support reference scripts in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0009-support-reference-scripts-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html">ADR 10: Rolling back on-disk data for Marconi indexers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#decision">Decision</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#queries">Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#api-design">API Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="0010-marconi-indexer-rollbacks.html#implementation">Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html">ADR 11: Support return and total collateral when building transactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#alternatives">Alternatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="0011-support-return-and-total-collateral-when-building-transactions.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html">ADR 12: Commit to data types in cardano-api</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#define-our-own-data-types-for-off-chain-use">Define our own data types for off-chain use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0012-commit-to-data-types-in-cardano-api.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0013-tx-validity-time-range-fix.html">ADR 13: Transaction validity time range fix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#add-mustvalidateinslotrange-constraint">Add <code class="docutils literal notranslate"><span class="pre">MustValidateInSlotRange</span></code> constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#remove-mustvalidateintimerange">Remove <code class="docutils literal notranslate"><span class="pre">mustValidateInTimeRange</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#alter-mustvalidateintimerange">Alter <code class="docutils literal notranslate"><span class="pre">mustValidateInTimeRange</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0013-tx-validity-time-range-fix.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0014-marconi-query-interface.html">ADR 14: Marconi Query Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0014-marconi-query-interface.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0014-marconi-query-interface.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0014-marconi-query-interface.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0014-marconi-query-interface.html#decision">Decision</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0014-marconi-query-interface.html#implications">Implications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0015-time-conversion.html">ADR 15: Time conversion semantic change</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="0015-time-conversion.html#changing-the-representation-of-slotconfig-to-the-correct-one">Changing the representation of <code class="docutils literal notranslate"><span class="pre">SlotConfig</span></code> to the correct one</a></li>
<li class="toctree-l4"><a class="reference internal" href="0015-time-conversion.html#directly-use-epochinfo-in-the-emulator-and-contract-api">Directly use EpochInfo in the emulator and Contract API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="0015-time-conversion.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="0016-cardano-node-emulator.html">ADR 16: Self-contained cardano-node emulator component</a><ul>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="0016-cardano-node-emulator.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">ADR 17: End-to-end testing strategy for Plutus, cardano-ledger-api and cardano-node-client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="#types-of-plutus-tests-for-the-plutus-e2e-tests-haskell-framework">Types of Plutus tests for the <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code> Haskell framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#argument">Argument</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pros-of-building-and-maintaining-our-own-test-framework">Pros of building and maintaining our own test framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cons-of-building-and-maintaining-our-own-test-framework">Cons of building and maintaining our own test framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#additional-considerations">Additional Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alternatives">Alternatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#other-places-spinning-up-a-local-testnet">Other places spinning up a local testnet</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/cost-model-parameters.html">Cost model parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/bibliography.html">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/index.html#elsewhere">Elsewhere</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #fcfcfc" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Plutus Tools SDK User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Architectural Decision Records</a> &raquo;</li>
      <li>ADR 17: End-to-end testing strategy for Plutus, cardano-ledger-api and cardano-node-client</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/input-output-hk/plutus/blob/master/doc/adr/0017-end-to-end-testing-strategy.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="adr-17-end-to-end-testing-strategy-for-plutus-cardano-ledger-api-and-cardano-node-client">
<span id="end-to-end-testing-strategy"></span><h1>ADR 17: End-to-end testing strategy for Plutus, cardano-ledger-api and cardano-node-client<a class="headerlink" href="#adr-17-end-to-end-testing-strategy-for-plutus-cardano-ledger-api-and-cardano-node-client" title="Permalink to this heading"></a></h1>
<p>Date: 2022-12-02</p>
<section id="author-s">
<h2>Author(s)<a class="headerlink" href="#author-s" title="Permalink to this heading"></a></h2>
<p>james-iohk &lt;<a class="reference external" href="mailto:james&#46;browning&#37;&#52;&#48;iohk&#46;io">james<span>&#46;</span>browning<span>&#64;</span>iohk<span>&#46;</span>io</a>&gt;</p>
</section>
<section id="status">
<h2>Status<a class="headerlink" href="#status" title="Permalink to this heading"></a></h2>
<p>Draft</p>
</section>
<section id="context">
<h2>Context<a class="headerlink" href="#context" title="Permalink to this heading"></a></h2>
<p>End-to-end testing of <a class="reference external" href="https://github.com/input-output-hk/Plutus/">Plutus Core</a> functionality is
currently performed by a combination of automation and exploratory approaches, both are performed
on public <cite>preview</cite> and <cite>pre-prod</cite> testnets using a real node.
Automation test scenarios for Plutus are currently being run as part of the wider <a class="reference external" href="https://github.com/input-output-hk/cardano-node-tests/">cardano-node-tests</a> test suite, which uses a Python wrapper
for <code class="docutils literal notranslate"><span class="pre">cardano-cli</span></code>.
Those tests focus on general ledger/node/cli functionality and only cover a few key scenarios for
Plutus functionality, such as TxInfo and SECP256k1 builtins.</p>
<p>There is also ongoing development work to separate the functionality of <a class="reference external" href="https://github.com/input-output-hk/cardano-node/tree/master/cardano-api">cardano-api</a> out into two packages:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/input-output-hk/cardano-ledger/tree/master/libs/cardano-ledger-api">cardano-ledger-api</a> handles
the building and balancing of transactions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> will live in <a class="reference external" href="https://github.com/input-output-hk/cardano-node">cardano-node</a> and handle the submitting of balanced
transactions and querying the ledger state.</p></li>
</ul>
<p>Both of these packages are in early stage development and will require end-to-end test coverage.</p>
<p>This document outlines the decisions and arguments for an <strong>additional</strong> approach to end-to-end test
automation using a framework written in Haskell.</p>
<p>The exploratory testing approach is not in the scope of this document.</p>
</section>
<section id="decision">
<h2>Decision<a class="headerlink" href="#decision" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>We will create a new end-to-end testing framework written in Haskell called <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code> that
will initially be a package in <a class="reference external" href="https://github.com/input-output-hk/Plutus-apps/">plutus-apps</a>,
see <a class="reference internal" href="#argument-1">argument 1</a>.</p></li>
<li><p>We will use <a class="reference external" href="https://github.com/input-output-hk/cardano-node/tree/master/cardano-testnet/">cardano-testnet</a>
for configuring and initialising local test network environments, see <a class="reference internal" href="#argument-2">argument 2</a>.</p></li>
<li><p>We will initially use <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code> for building and balancing transactions, and to submit
balanced transactions and for querying the ledger, see <a class="reference internal" href="#argument-3">argument 3</a>.</p></li>
<li><p>When available, we will use <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> instead of <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code> for building and
balancing transactions, see <a class="reference internal" href="#argument-4">argument 4</a>.</p></li>
<li><p>When available, we will use <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> instead of <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code> to submit balanced
transactions and for querying the ledger state to make test assertions, see <a class="reference internal" href="#argument-5">argument 5</a>.</p></li>
<li><p>We will prioritise <code class="docutils literal notranslate"><span class="pre">Plutus</span></code> test coverage over <code class="docutils literal notranslate"><span class="pre">cardano-node</span></code>, see <a class="reference internal" href="#argument-6">argument 6</a>.</p></li>
<li><p>We will start by creating a few tests with the node/ledger apis without depending on <code class="docutils literal notranslate"><span class="pre">plutus-apps</span></code>
and then assess whether we want to use the Contract API and other off-chain tooling going forwards,
see <a class="reference internal" href="#argument-7">argument 7</a>.</p></li>
<li><p>We will continue adding a subset of Plutus tests to <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code>, see <a class="reference internal" href="#argument-8">argument 8</a>.</p></li>
</ul>
</section>
<section id="types-of-plutus-tests-for-the-plutus-e2e-tests-haskell-framework">
<h2>Types of Plutus tests for the <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code> Haskell framework<a class="headerlink" href="#types-of-plutus-tests-for-the-plutus-e2e-tests-haskell-framework" title="Permalink to this heading"></a></h2>
<p>All <code class="docutils literal notranslate"><span class="pre">Plutus</span></code> end-to-end testing requirements will be covered by <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code>.
In summary, with access to the Haskell and Plutus interfaces and reduced friction from using a
single programming language we are likely improve test coverage at this level.
For example, builtin functions and error scenarios.</p>
<p>Although we will be building out the end-to-end test coverage, it is more efficient to have fewer
and broader test scenarios at this level and a greater number of tests at the lower unit and
integration levels for stressing particular features and covering negative scenarios and edge cases.</p>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Any Plutus Core builtin function.
These may already be tested extensively in the lower unit/property/integration levels but there’s
value in having some coverage at the end-to-end level too.</p></li>
<li><p>Use cases that go beyond testing features in isolation.
Bringing together various functionality
helps demonstrate the capability of more realistic Plutus applications.</p></li>
<li><p>Functionality introduced by a new Plutus version.
This could mean that <code class="docutils literal notranslate"><span class="pre">ScriptContext</span></code> changes to accommodate an extended transaction body.</p></li>
<li><p>Functionality of old Plutus versions tested with each supporting script version.
Tests for old Plutus version functionality will also be run using the newer script versions.</p></li>
</ul>
</section>
</section>
<section id="argument">
<h2>Argument<a class="headerlink" href="#argument" title="Permalink to this heading"></a></h2>
<ol class="arabic simple" id="argument-1">
<li><p>The primary aim is to satisfy all of <code class="docutils literal notranslate"><span class="pre">Plutus</span></code> (core) end-to-end testing requirements,
although, this is an opportunity to also get coverage of other packages being developed such as
<code class="docutils literal notranslate"><span class="pre">cardano-testnet</span></code>, <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> and <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code>.
We can configure external packages and their versions using CHaPs so there is no need for
<code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code> to have its own repo. It will initially be be a package in <code class="docutils literal notranslate"><span class="pre">plutus-apps</span></code>.</p></li>
</ol>
<ol class="arabic simple" id="argument-2" start="2">
<li><p>There are a few options for configuring and starting a private testnet (see <a class="reference internal" href="#local-testnet">local testnet</a>
notes section).
We will use <code class="docutils literal notranslate"><span class="pre">cardano-testnet</span></code> to enable dynamic configuration in Haskell, which makes it easier
to design tests that can also run in the emulated environment.
Also, this is the approach officially supported by the node team.</p></li>
</ol>
<ol class="arabic simple" id="argument-3" start="3">
<li><p>The plan is to start building tests with <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code> because neither <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code>
or <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> are at the required stage of development. This allows us to immediately
proceed with building out the framework and test suite.</p></li>
</ol>
<ol class="arabic simple" id="argument-4" start="4">
<li><p>The ambition of <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> is to be the go-to api for building transactions for
application developers.
The UX and overall quality of this component will benefit from being included in these end-to-end
tests because of the high-level perspective applied during its design and development.
When ready we will begin incorporating it as a replacement for <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code>.</p></li>
</ol>
<ol class="arabic simple" id="argument-5" start="5">
<li><p><code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> will eventually replace <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code> as a interface with consensus.
As the expected means to submit and query for application developers, it is a vital we include it
under test in <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code>.
When ready we will begin incorporating it as a replacement for <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code>.</p></li>
</ol>
<ol class="arabic simple" id="argument-6" start="6">
<li><p>Although <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> and <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> are under test it isn’t feasible
to expect thorough coverage of all ledger and node functionality, such as staking and update
proposals, because the primary focus is to satisfy end-to-end testing requirements for <code class="docutils literal notranslate"><span class="pre">Plutus</span></code>.
Fortunately, much of that functionality is already being covered by <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code>.</p></li>
</ol>
<ol class="arabic simple" id="argument-7" start="7">
<li><p>Initially, a few tests will be created without depending on <a class="reference external" href="https://github.com/input-output-hk/Plutus-apps/">Plutus-apps</a>.
This entails building transactions with <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> and waiting for on-chain events
using <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> without use of the Contract api or the constraints library.
This approach allows us to build specific transactions, which is especially useful for testing
edge-cases and error scenarios that off-chain tooling may prohibit.
However, this approach will require more boilerplate code and this could negatively impact
readability of the tests.
Having assessed this approach, we may then decide to depend on <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code> for the
Contract api, which would give a uniform interface for off-chain code such as different node
backends (private and public testnets, and emulator) and chain-indexer queries
(<code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> or Marconi in future).
It should also reduce the amount of boilerplate code and provide additional features such as
trace logging.</p></li>
</ol>
<ol class="arabic simple" id="argument-8" start="8">
<li><p>There’s value continuing to test <code class="docutils literal notranslate"><span class="pre">cardano-cli</span></code> with Plutus transactions for specific cli
flags and the cli’s error handling with script evaluation.
Some examples of tests that should be covered:</p>
<ul class="simple">
<li><p>Cli flags that require use of Plutus scripts E.g. tx-out-reference-script-file or
calculate-plutus-script-cost</p></li>
<li><p>Cli behaviour when script evaluation passes. This could be displaying expected fee correctly.</p></li>
<li><p>Cli behaviour when script evaluation fails. This can be how different types errors are formatted.</p></li>
</ul>
</li>
<li><p>At some point, we may wish to incorporate the <a class="reference external" href="https://github.com/input-output-hk/Plutus-apps/pull/831">cardano-node-emulator</a> as an alternative to <code class="docutils literal notranslate"><span class="pre">cardano-testnet</span></code>.
This would enable us to run property based tests due to the node being much faster without consensus.
With CHaP, <code class="docutils literal notranslate"><span class="pre">cardano-node-emulator</span></code> would be released as a separate component, so no need to depend
on <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code>.</p></li>
<li><p>We reserve the option of including additional packages to test from <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code> at a later stage.</p></li>
</ol>
<section id="pros-of-building-and-maintaining-our-own-test-framework">
<h3>Pros of building and maintaining our own test framework<a class="headerlink" href="#pros-of-building-and-maintaining-our-own-test-framework" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Plutus tools team will have full ownership of the end-to-end test environment and its priorities
for <code class="docutils literal notranslate"><span class="pre">Plutus</span></code>.</p></li>
<li><p>Plutus scripts can be defined alongside the tests. <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code> requires
pre-compiled scripts.</p></li>
<li><p>Tests will demonstrate how these Haskell packages can be used together to guide Plutus application
development using the node apis. Particularly useful for less experienced Haskell developers.</p></li>
<li><p>Possible to define tests once and run at different levels. For example, on private or public
testnets and with <code class="docutils literal notranslate"><span class="pre">cardano-node-emulator</span></code> emulated node.</p></li>
<li><p>Benefits from use of all <code class="docutils literal notranslate"><span class="pre">Plutus</span></code> apis. For example, using PlutusTx to produce scripts using a
typed interface, and optionally the Contract monad from <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code>.</p></li>
<li><p>Have the opportunity to add more components under test at a later stage, such as Marconi or a PAB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cardano-cli</span></code> would not be a dependency for Plutus test coverage so no risk of being blocked by its
stage of development.</p></li>
<li><p>Less dependence on repetitive manual approach for regression testing because tests can be planned
and implemented in parallel with feature implementation and integration.</p></li>
<li><p>Plutus team can implement and review majority of tests in Haskell rather than Python, which is
likely to be the team’s preference.
Also won’t need to review as many tests in <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code>.</p></li>
<li><p>Less friction caused by cross-team: planning, dependencies and expectations. Plutus team won’t
need to wait for node test team to implement the tests. It’s likely that other node/cli features
will often be prioritised.</p></li>
<li><p>This approach will improve our high-level perspective of each component and help guide
UX improvements.</p></li>
<li><p>Now that some <code class="docutils literal notranslate"><span class="pre">plutus</span></code> tests exist in <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code> the process for adding new tests
will be relatively straightforward, for some it’s mostly a copy/paste job.
This means less work to support some duplicate tests in both frameworks.</p></li>
<li><p>Node team are not pressured to focus on Plutus scenarios, they retain control of their priorities.</p></li>
</ul>
</section>
<section id="cons-of-building-and-maintaining-our-own-test-framework">
<h3>Cons of building and maintaining our own test framework<a class="headerlink" href="#cons-of-building-and-maintaining-our-own-test-framework" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code> is well established and already has useful features such as: running tests in
different eras, transitioning between eras, reporting, and measuring deviations in script cost.</p></li>
<li><p>It could be quicker for us to get going to reusing the bash scripts <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code> have.
See <a class="reference internal" href="#local-testnet">local testnet</a> notes section for other examples of spinning up a local testnet.</p></li>
<li><p>We could continue getting <code class="docutils literal notranslate"><span class="pre">plutus</span></code> end-to-end test coverage without the need to build our own
framework because the node test team will continue to maintain theirs regardless.</p></li>
<li><p>Plutus team will still be required to support the node test team with defining and reviewing a
subset of Plutus tests in <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code>.</p></li>
<li><p>Node test team may grow, less delays in getting Plutus tests implemented by a Python developer.</p></li>
<li><p>The tests using <code class="docutils literal notranslate"><span class="pre">cardano-cli</span></code> already provide some assurance that downstream components are
working correctly, so there will be some duplication of test coverage by having an additional
framework.</p></li>
</ul>
</section>
</section>
<section id="additional-considerations">
<h2>Additional Considerations<a class="headerlink" href="#additional-considerations" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Business stakeholders will want to see test results to think about producing and storing a report.
It would be to open source this along with the tests, like <code class="docutils literal notranslate"><span class="pre">cardano-node-tests</span></code> have done.</p></li>
<li><p>At first, tests will be run on a private testnet but we must consider how these tests can also be
run on a public testnet. For example, initial wallet balances and utxos will need to be handled
dynamically because we’d only have control over these in the private testnet.</p></li>
<li><p>Seeing as <code class="docutils literal notranslate"><span class="pre">cardano-ledger-api</span></code> and <code class="docutils literal notranslate"><span class="pre">cardano-node-client</span></code> are still in early stages of production
it would make sense not to block creation of <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code>. We can begin using <code class="docutils literal notranslate"><span class="pre">cardano-api</span></code>
and switch over when ready.</p></li>
<li><p>End-to-end tests can be slow to execute and as the suite grows we may want to run a subset at more
frequent intervals. For example, we run tests for the latest Plutus version nightly but older
tests/versions are run weekly, or for tags/release only.</p></li>
</ul>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this heading"></a></h2>
<p>Instead of creating a new repository it is possible the end-to-end tests could live in <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code>.
Although, because the components under test span other repositories it would be restrictive and
additional work at the time when dependencies are updated in <code class="docutils literal notranslate"><span class="pre">Plutus-apps</span></code>, see <a class="reference internal" href="#argument-1">argument 1</a>.</p>
<p>We could use bash scripts to spin up a local testnet, which is the approach teams such as Djed and
Hydra took.
Although, the decision is to use <code class="docutils literal notranslate"><span class="pre">cardano-testnet</span></code>, see argument <a class="reference internal" href="#argument-2">argument 2</a>.</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this heading"></a></h2>
<p>This ADR document should be moved out of <code class="docutils literal notranslate"><span class="pre">Plutus-apps`</span></code> and into the new end-to-end test repository
once created.</p>
<p>Benchmarking hasn’t been covered above because we already have a team dedicated to testing cardano-node
performance that includes some Plutus scripts. It is an automated approach using <code class="docutils literal notranslate"><span class="pre">cardano-cli</span></code>.</p>
<section id="other-places-spinning-up-a-local-testnet">
<span id="local-testnet"></span><h3>Other places spinning up a local testnet<a class="headerlink" href="#other-places-spinning-up-a-local-testnet" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/woofpool/cardano-private-testnet-setup">https://github.com/woofpool/cardano-private-testnet-setup</a></p></li>
<li><p><a class="reference external" href="https://github.com/input-output-hk/mithril/mithril-test-lab">https://github.com/input-output-hk/mithril/mithril-test-lab</a></p></li>
<li><p><a class="reference external" href="https://github.com/input-output-hk/hydra/hydra-cluster">https://github.com/input-output-hk/hydra/hydra-cluster</a></p></li>
<li><p><a class="reference external" href="https://github.com/input-output-hk/cardano-node/tree/master/scripts/byron-to-alonzo">https://github.com/input-output-hk/cardano-node/tree/master/scripts/byron-to-alonzo</a></p></li>
<li><p><a class="reference external" href="https://github.com/input-output-hk/cardano-js-sdk/tree/master/packages/e2e/local-network">https://github.com/input-output-hk/cardano-js-sdk/tree/master/packages/e2e/local-network</a></p></li>
<li><p><a class="reference external" href="https://github.com/input-output-hk/cardano-wallet/blob/master/lib/wallet/exe/local-cluster.hs">https://github.com/input-output-hk/cardano-wallet/blob/master/lib/wallet/exe/local-cluster.hs</a></p></li>
<li><p><a class="reference external" href="https://github.com/mlabs-haskell/plutip">https://github.com/mlabs-haskell/plutip</a></p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="0016-cardano-node-emulator.html" class="btn btn-neutral float-left" title="ADR 16: Self-contained cardano-node emulator component" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../reference/index.html" class="btn btn-neutral float-right" title="Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1980, IOHK.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds     #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances   #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards     #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Auth</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Auth.html#API"><span class="hs-identifier">API</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#FrontendAPI"><span class="hs-identifier">FrontendAPI</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#server"><span class="hs-identifier">server</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#AuthStatus"><span class="hs-identifier">AuthStatus</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#AuthRole"><span class="hs-identifier">AuthRole</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier">Config</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#configJWTSignature"><span class="hs-identifier">configJWTSignature</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#configFrontendUrl"><span class="hs-identifier">configFrontendUrl</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#configGithubCbPath"><span class="hs-identifier">configGithubCbPath</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#configGithubClientId"><span class="hs-identifier">configGithubClientId</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#configGithubClientSecret"><span class="hs-identifier">configGithubClientSecret</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier">GithubEndpoints</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#mkGithubEndpoints"><span class="hs-identifier">mkGithubEndpoints</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#githubEndpointsAuthLocation"><span class="hs-identifier">githubEndpointsAuthLocation</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#githubEndpointsAccessTokenLocation"><span class="hs-identifier">githubEndpointsAccessTokenLocation</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#githubEndpointsApiBaseUrl"><span class="hs-identifier">githubEndpointsApiBaseUrl</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#githubEndpointsCallbackUri"><span class="hs-identifier">githubEndpointsCallbackUri</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Auth.Types.html"><span class="hs-identifier">Auth.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.Types.html#OAuthClientId"><span class="hs-identifier">OAuthClientId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthClientSecret"><span class="hs-identifier">OAuthClientSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthCode"><span class="hs-identifier">OAuthCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthToken"><span class="hs-identifier">OAuthToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#Token"><span class="hs-identifier">Token</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.Types.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#TokenProvider"><span class="hs-identifier">TokenProvider</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.Types.html#Github"><span class="hs-identifier">Github</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>                   </span><span class="annot"><a href="Auth.Types.html#addUserAgent"><span class="hs-identifier">addUserAgent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.Types.html#oAuthTokenAccessToken"><span class="hs-identifier">oAuthTokenAccessToken</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">makeLenses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier">Control.Monad.Logger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier">MonadLogger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier">logDebugN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier">logErrorN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Now.html"><span class="hs-identifier">Control.Monad.Now</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier">MonadNow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#getCurrentTime"><span class="hs-identifier">getCurrentTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#getPOSIXTime"><span class="hs-identifier">getPOSIXTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadReader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Trace.html"><span class="hs-identifier">Control.Monad.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier">attempt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trace.html#runTrace"><span class="hs-identifier">runTrace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier">withTrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Web.html"><span class="hs-identifier">Control.Monad.Web</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier">MonadWeb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#doRequest"><span class="hs-identifier">doRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#makeManager"><span class="hs-identifier">makeManager</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier">Control.Newtype.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier">Newtype</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier">O</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier">unpack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">String</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">eitherDecode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">parseJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">withObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator">(.:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">decodeUtf8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">encodeUtf8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">Data.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">NominalDiffTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">UTCTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">addUTCTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">Data.Time.Clock.POSIX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">POSIXTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">utcTimeToPOSIXSeconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gist.html"><span class="hs-identifier">Gist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gist.html#Gist"><span class="hs-identifier">Gist</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gist.html#GistId"><span class="hs-identifier">GistId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gist.html#NewGist"><span class="hs-identifier">NewGist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gist.html"><span class="hs-identifier">Gist</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/1gg4kr15bqc45qy51bbslazp866j59dk-http-conduit-lib-http-conduit-2.3.8-haddock-doc/share/doc/http-conduit/html/src"><span class="hs-identifier">Network.HTTP.Client.Conduit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">getUri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/1gg4kr15bqc45qy51bbslazp866j59dk-http-conduit-lib-http-conduit-2.3.8-haddock-doc/share/doc/http-conduit/html/src"><span class="hs-identifier">Network.HTTP.Conduit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">Request</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">parseRequest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">responseBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">responseStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier">setQueryString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/1gg4kr15bqc45qy51bbslazp866j59dk-http-conduit-lib-http-conduit-2.3.8-haddock-doc/share/doc/http-conduit/html/src"><span class="hs-identifier">Network.HTTP.Simple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/1gg4kr15bqc45qy51bbslazp866j59dk-http-conduit-lib-http-conduit-2.3.8-haddock-doc/share/doc/http-conduit/html/src"><span class="hs-identifier">addRequestHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">Network.HTTP.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">hAccept</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">statusIsSuccessful</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">Network.HTTP.Types.Status</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">status404</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">Servant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">Get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">Header</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">Headers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">JSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">NoContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">NoContent</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">QueryParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">ServerError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">ServerT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">StdMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier">GET</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>                </span><span class="annot"><a href="../file:///nix/store/xwv0l1a23x8kyayf6zgxf7hsrgwcdf0k-http-api-data-lib-http-api-data-0.4.3-haddock-doc/share/doc/http-api-data/html/src"><span class="hs-identifier">ToHttpApiData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">Verb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">addHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err401</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err404</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err500</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">errBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator">(:&lt;|&gt;)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator">(:&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator">(:&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2db8rv1yxysrl6b27nlz3c36rr7dhlz4-servant-purescript-lib-servant-purescript-0.9.0.2-haddock-doc/share/doc/servant-purescript/html/src"><span class="hs-identifier">Servant.API.BrowserHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2db8rv1yxysrl6b27nlz3c36rr7dhlz4-servant-purescript-lib-servant-purescript-0.9.0.2-haddock-doc/share/doc/servant-purescript/html/src"><span class="hs-identifier">BrowserHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">Servant.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier">BaseUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier">ClientError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier">FailureResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">ClientM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">mkClientEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier">parseBaseUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier">responseStatusCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>                       </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">runClientM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">Web.Cookie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">SetCookie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">defaultSetCookie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">parseCookies</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieExpires</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieHttpOnly</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieMaxAge</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>                   </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookiePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieSecure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier">setCookieValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier">Web.JWT</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JWT</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | https://gist.github.com/alpmestan/757094ecf9401f85c5ba367ca20b8900</span><span>
</span><span id="line-78"></span><span class="hs-keyword">type</span><span> </span><span id="GetRedirect"><span class="annot"><a href="Auth.html#GetRedirect"><span class="hs-identifier hs-var">GetRedirect</span></a></span></span><span> </span><span id="local-6989586621679740631"><span class="annot"><a href="#local-6989586621679740631"><span class="hs-identifier hs-type">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Verb</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier hs-type">GET</span></a></span><span> </span><span class="annot"><span class="hs-number">302</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">JSON</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679740631"><span class="hs-identifier hs-type">headers</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | We split out the API here because we don't want the Github</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- Callback to be exported for the frontend to call directly.</span><span>
</span><span id="line-82"></span><span class="hs-keyword">type</span><span> </span><span id="API"><span class="annot"><a href="Auth.html#API"><span class="hs-identifier hs-var">API</span></a></span></span><span>
</span><span id="line-83"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Auth.html#FrontendAPI"><span class="hs-identifier hs-type">FrontendAPI</span></a></span><span>
</span><span id="line-84"></span><span>       </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="Auth.html#CallbackAPI"><span class="hs-identifier hs-type">CallbackAPI</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">type</span><span> </span><span id="FrontendAPI"><span class="annot"><a href="Auth.html#FrontendAPI"><span class="hs-identifier hs-var">FrontendAPI</span></a></span></span><span>
</span><span id="line-87"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;oauth&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2db8rv1yxysrl6b27nlz3c36rr7dhlz4-servant-purescript-lib-servant-purescript-0.9.0.2-haddock-doc/share/doc/servant-purescript/html/src"><span class="hs-identifier hs-type">BrowserHeader</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Cookie&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;status&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Get</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">JSON</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Auth.html#AuthStatus"><span class="hs-identifier hs-type">AuthStatus</span></a></span><span>
</span><span id="line-88"></span><span>                    </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;github&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Auth.html#GetRedirect"><span class="hs-identifier hs-type">GetRedirect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>       </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&lt;|&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2db8rv1yxysrl6b27nlz3c36rr7dhlz4-servant-purescript-lib-servant-purescript-0.9.0.2-haddock-doc/share/doc/servant-purescript/html/src"><span class="hs-identifier hs-type">BrowserHeader</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Cookie&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;gists&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Gist.html#GistAPI"><span class="hs-identifier hs-type">Gist.GistAPI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">type</span><span> </span><span id="CallbackAPI"><span class="annot"><a href="Auth.html#CallbackAPI"><span class="hs-identifier hs-var">CallbackAPI</span></a></span></span><span>
</span><span id="line-92"></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;oauth&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;github&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;callback&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">QueryParam</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;code&quot;</span></span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthCode"><span class="hs-identifier hs-type">OAuthCode</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Auth.html#GetRedirect"><span class="hs-identifier hs-type">GetRedirect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Set-Cookie&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-type">SetCookie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span id="local-6989586621679740627"><span id="local-6989586621679740628"></span></span><span class="hs-keyword">data</span><span> </span><span id="AuthRole"><span class="annot"><a href="Auth.html#AuthRole"><span class="hs-identifier hs-var">AuthRole</span></a></span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Anonymous"><span class="annot"><a href="Auth.html#Anonymous"><span class="hs-identifier hs-var">Anonymous</span></a></span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="GithubUser"><span class="annot"><a href="Auth.html#GithubUser"><span class="hs-identifier hs-var">GithubUser</span></a></span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679740619"><span id="local-6989586621679740621"><span id="local-6989586621679740623"><span class="annot"><span class="annottext">Int -&gt; AuthRole -&gt; ShowS
[AuthRole] -&gt; ShowS
AuthRole -&gt; String
(Int -&gt; AuthRole -&gt; ShowS)
-&gt; (AuthRole -&gt; String) -&gt; ([AuthRole] -&gt; ShowS) -&gt; Show AuthRole
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AuthRole] -&gt; ShowS
$cshowList :: [AuthRole] -&gt; ShowS
show :: AuthRole -&gt; String
$cshow :: AuthRole -&gt; String
showsPrec :: Int -&gt; AuthRole -&gt; ShowS
$cshowsPrec :: Int -&gt; AuthRole -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740614"><span id="local-6989586621679740616"><span class="annot"><span class="annottext">AuthRole -&gt; AuthRole -&gt; Bool
(AuthRole -&gt; AuthRole -&gt; Bool)
-&gt; (AuthRole -&gt; AuthRole -&gt; Bool) -&gt; Eq AuthRole
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AuthRole -&gt; AuthRole -&gt; Bool
$c/= :: AuthRole -&gt; AuthRole -&gt; Bool
== :: AuthRole -&gt; AuthRole -&gt; Bool
$c== :: AuthRole -&gt; AuthRole -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. AuthRole -&gt; Rep AuthRole x)
-&gt; (forall x. Rep AuthRole x -&gt; AuthRole) -&gt; Generic AuthRole
forall x. Rep AuthRole x -&gt; AuthRole
forall x. AuthRole -&gt; Rep AuthRole x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AuthRole x -&gt; AuthRole
$cfrom :: forall x. AuthRole -&gt; Rep AuthRole x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740606"><span id="local-6989586621679740608"><span class="annot"><span class="annottext">Value -&gt; Parser [AuthRole]
Value -&gt; Parser AuthRole
(Value -&gt; Parser AuthRole)
-&gt; (Value -&gt; Parser [AuthRole]) -&gt; FromJSON AuthRole
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [AuthRole]
$cparseJSONList :: Value -&gt; Parser [AuthRole]
parseJSON :: Value -&gt; Parser AuthRole
$cparseJSON :: Value -&gt; Parser AuthRole
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740597"><span id="local-6989586621679740599"><span id="local-6989586621679740601"><span id="local-6989586621679740603"><span class="annot"><span class="annottext">[AuthRole] -&gt; Encoding
[AuthRole] -&gt; Value
AuthRole -&gt; Encoding
AuthRole -&gt; Value
(AuthRole -&gt; Value)
-&gt; (AuthRole -&gt; Encoding)
-&gt; ([AuthRole] -&gt; Value)
-&gt; ([AuthRole] -&gt; Encoding)
-&gt; ToJSON AuthRole
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [AuthRole] -&gt; Encoding
$ctoEncodingList :: [AuthRole] -&gt; Encoding
toJSONList :: [AuthRole] -&gt; Value
$ctoJSONList :: [AuthRole] -&gt; Value
toEncoding :: AuthRole -&gt; Encoding
$ctoEncoding :: AuthRole -&gt; Encoding
toJSON :: AuthRole -&gt; Value
$ctoJSON :: AuthRole -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span id="local-6989586621679740594"><span id="local-6989586621679740595"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="AuthStatus"><span class="annot"><a href="Auth.html#AuthStatus"><span class="hs-identifier hs-var">AuthStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span id="AuthStatus"><span class="annot"><a href="Auth.html#AuthStatus"><span class="hs-identifier hs-var">AuthStatus</span></a></span></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_authStatusAuthRole"><span class="annot"><span class="annottext">AuthStatus -&gt; AuthRole
</span><a href="Auth.html#_authStatusAuthRole"><span class="hs-identifier hs-var hs-var">_authStatusAuthRole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Auth.html#AuthRole"><span class="hs-identifier hs-type">AuthRole</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679740586"><span id="local-6989586621679740588"><span id="local-6989586621679740590"><span class="annot"><span class="annottext">Int -&gt; AuthStatus -&gt; ShowS
[AuthStatus] -&gt; ShowS
AuthStatus -&gt; String
(Int -&gt; AuthStatus -&gt; ShowS)
-&gt; (AuthStatus -&gt; String)
-&gt; ([AuthStatus] -&gt; ShowS)
-&gt; Show AuthStatus
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AuthStatus] -&gt; ShowS
$cshowList :: [AuthStatus] -&gt; ShowS
show :: AuthStatus -&gt; String
$cshow :: AuthStatus -&gt; String
showsPrec :: Int -&gt; AuthStatus -&gt; ShowS
$cshowsPrec :: Int -&gt; AuthStatus -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740582"><span id="local-6989586621679740584"><span class="annot"><span class="annottext">AuthStatus -&gt; AuthStatus -&gt; Bool
(AuthStatus -&gt; AuthStatus -&gt; Bool)
-&gt; (AuthStatus -&gt; AuthStatus -&gt; Bool) -&gt; Eq AuthStatus
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AuthStatus -&gt; AuthStatus -&gt; Bool
$c/= :: AuthStatus -&gt; AuthStatus -&gt; Bool
== :: AuthStatus -&gt; AuthStatus -&gt; Bool
$c== :: AuthStatus -&gt; AuthStatus -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. AuthStatus -&gt; Rep AuthStatus x)
-&gt; (forall x. Rep AuthStatus x -&gt; AuthStatus) -&gt; Generic AuthStatus
forall x. Rep AuthStatus x -&gt; AuthStatus
forall x. AuthStatus -&gt; Rep AuthStatus x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AuthStatus x -&gt; AuthStatus
$cfrom :: forall x. AuthStatus -&gt; Rep AuthStatus x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740576"><span id="local-6989586621679740578"><span class="annot"><span class="annottext">Value -&gt; Parser [AuthStatus]
Value -&gt; Parser AuthStatus
(Value -&gt; Parser AuthStatus)
-&gt; (Value -&gt; Parser [AuthStatus]) -&gt; FromJSON AuthStatus
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [AuthStatus]
$cparseJSONList :: Value -&gt; Parser [AuthStatus]
parseJSON :: Value -&gt; Parser AuthStatus
$cparseJSON :: Value -&gt; Parser AuthStatus
</span><a href="#local-6989586621679740576"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679740568"><span id="local-6989586621679740570"><span id="local-6989586621679740572"><span id="local-6989586621679740574"><span class="annot"><span class="annottext">[AuthStatus] -&gt; Encoding
[AuthStatus] -&gt; Value
AuthStatus -&gt; Encoding
AuthStatus -&gt; Value
(AuthStatus -&gt; Value)
-&gt; (AuthStatus -&gt; Encoding)
-&gt; ([AuthStatus] -&gt; Value)
-&gt; ([AuthStatus] -&gt; Encoding)
-&gt; ToJSON AuthStatus
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [AuthStatus] -&gt; Encoding
$ctoEncodingList :: [AuthStatus] -&gt; Encoding
toJSONList :: [AuthStatus] -&gt; Value
$ctoJSONList :: [AuthStatus] -&gt; Value
toEncoding :: AuthStatus -&gt; Encoding
$ctoEncoding :: AuthStatus -&gt; Encoding
toJSON :: AuthStatus -&gt; Value
$ctoJSON :: AuthStatus -&gt; Value
</span><a href="#local-6989586621679740568"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="GithubEndpoints"><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-var">GithubEndpoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span id="GithubEndpoints"><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-var">GithubEndpoints</span></a></span></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_githubEndpointsAuthLocation"><span class="annot"><span class="annottext">GithubEndpoints -&gt; Request
</span><a href="Auth.html#_githubEndpointsAuthLocation"><span class="hs-identifier hs-var hs-var">_githubEndpointsAuthLocation</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_githubEndpointsAccessTokenLocation"><span class="annot"><span class="annottext">GithubEndpoints -&gt; Request
</span><a href="Auth.html#_githubEndpointsAccessTokenLocation"><span class="hs-identifier hs-var hs-var">_githubEndpointsAccessTokenLocation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_githubEndpointsApiBaseUrl"><span class="annot"><span class="annottext">GithubEndpoints -&gt; BaseUrl
</span><a href="Auth.html#_githubEndpointsApiBaseUrl"><span class="hs-identifier hs-var hs-var">_githubEndpointsApiBaseUrl</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier hs-type">BaseUrl</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_githubEndpointsCallbackUri"><span class="annot"><span class="annottext">GithubEndpoints -&gt; Text
</span><a href="Auth.html#_githubEndpointsCallbackUri"><span class="hs-identifier hs-var hs-var">_githubEndpointsCallbackUri</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="githubEndpointsCallbackUri"><span id="githubEndpointsApiBaseUrl"><span id="githubEndpointsAccessTokenLocation"><span id="githubEndpointsAuthLocation"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">GithubEndpoints</span></span></span></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Config determined by Github.</span><span>
</span><span id="line-117"></span><span class="annot"><a href="Auth.html#mkGithubEndpoints"><span class="hs-identifier hs-type">mkGithubEndpoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-type">GithubEndpoints</span></a></span><span>
</span><span id="line-118"></span><span id="mkGithubEndpoints"><span class="annot"><span class="annottext">mkGithubEndpoints :: IO GithubEndpoints
</span><a href="Auth.html#mkGithubEndpoints"><span class="hs-identifier hs-var hs-var">mkGithubEndpoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679740562"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679740562"><span class="hs-identifier hs-var">_githubEndpointsAuthLocation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO Request
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m Request
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var">parseRequest</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GET https://github.com/login/oauth/authorize&quot;</span></span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679740561"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679740561"><span class="hs-identifier hs-var">_githubEndpointsAccessTokenLocation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO Request
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m Request
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var">parseRequest</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;POST https://github.com/login/oauth/access_token&quot;</span></span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621679740560"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679740560"><span class="hs-identifier hs-var">_githubEndpointsApiBaseUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO BaseUrl
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m BaseUrl
</span><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier hs-var">parseBaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://api.github.com&quot;</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740559"><span class="annot"><span class="annottext">_githubEndpointsCallbackUri :: Text
</span><a href="#local-6989586621679740559"><span class="hs-identifier hs-var hs-var">_githubEndpointsCallbackUri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/api/oauth/github/callback&quot;</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">GithubEndpoints -&gt; IO GithubEndpoints
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">GithubEndpoints :: Request -&gt; Request -&gt; BaseUrl -&gt; Text -&gt; GithubEndpoints
</span><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-type">GithubEndpoints</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Text
Request
BaseUrl
_githubEndpointsCallbackUri :: Text
_githubEndpointsApiBaseUrl :: BaseUrl
_githubEndpointsAccessTokenLocation :: Request
_githubEndpointsAuthLocation :: Request
_githubEndpointsCallbackUri :: Text
_githubEndpointsApiBaseUrl :: BaseUrl
_githubEndpointsAccessTokenLocation :: Request
_githubEndpointsAuthLocation :: Request
</span><a href="#local-6989586621679740559"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Config supplied at runtime.</span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="Config"><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-var">Config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span id="Config"><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-var">Config</span></a></span></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_configJWTSignature"><span class="annot"><span class="annottext">Config -&gt; EncodeSigner
</span><a href="Auth.html#_configJWTSignature"><span class="hs-identifier hs-var hs-var">_configJWTSignature</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-type">JWT.EncodeSigner</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_configFrontendUrl"><span class="annot"><span class="annottext">Config -&gt; Text
</span><a href="Auth.html#_configFrontendUrl"><span class="hs-identifier hs-var hs-var">_configFrontendUrl</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_configGithubCbPath"><span class="annot"><span class="annottext">Config -&gt; Text
</span><a href="Auth.html#_configGithubCbPath"><span class="hs-identifier hs-var hs-var">_configGithubCbPath</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_configGithubClientId"><span class="annot"><span class="annottext">Config -&gt; OAuthClientId
</span><a href="Auth.html#_configGithubClientId"><span class="hs-identifier hs-var hs-var">_configGithubClientId</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Auth.Types.html#OAuthClientId"><span class="hs-identifier hs-type">OAuthClientId</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_configGithubClientSecret"><span class="annot"><span class="annottext">Config -&gt; OAuthClientSecret
</span><a href="Auth.html#_configGithubClientSecret"><span class="hs-identifier hs-var hs-var">_configGithubClientSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Auth.Types.html#OAuthClientSecret"><span class="hs-identifier hs-type">OAuthClientSecret</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="configGithubClientSecret"><span id="configGithubClientId"><span id="configGithubCbPath"><span id="configFrontendUrl"><span id="configJWTSignature"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Config</span></span></span></span></span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679740550"><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679740549"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Config
</span><a href="#local-6989586621679740549"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; (Object -&gt; Parser Config) -&gt; Value -&gt; Parser Config
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;config&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser Config) -&gt; Value -&gt; Parser Config)
-&gt; (Object -&gt; Parser Config) -&gt; Value -&gt; Parser Config
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679740548"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>            </span><span id="local-6989586621679740547"><span class="annot"><span class="annottext">OAuthClientId
</span><a href="#local-6989586621679740547"><span class="hs-identifier hs-var">_configGithubClientId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser OAuthClientId
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;github-client-id&quot;</span></span><span>
</span><span id="line-143"></span><span>            </span><span id="local-6989586621679740546"><span class="annot"><span class="annottext">OAuthClientSecret
</span><a href="#local-6989586621679740546"><span class="hs-identifier hs-var">_configGithubClientSecret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser OAuthClientSecret
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;github-client-secret&quot;</span></span><span>
</span><span id="line-144"></span><span>            </span><span id="local-6989586621679740545"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740545"><span class="hs-identifier hs-var">_configJWTSignature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EncodeSigner
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.hmacSecret</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; EncodeSigner) -&gt; Parser Text -&gt; Parser EncodeSigner
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jwt-signature&quot;</span></span><span>
</span><span id="line-145"></span><span>            </span><span id="local-6989586621679740542"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740542"><span class="hs-identifier hs-var">_configFrontendUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;frontend-url&quot;</span></span><span>
</span><span id="line-146"></span><span>            </span><span id="local-6989586621679740541"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740541"><span class="hs-identifier hs-var">_configGithubCbPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679740548"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;github-cb-path&quot;</span></span><span>
</span><span id="line-147"></span><span>            </span><span class="annot"><span class="annottext">Config -&gt; Parser Config
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Config :: EncodeSigner
-&gt; Text -&gt; Text -&gt; OAuthClientId -&gt; OAuthClientSecret -&gt; Config
</span><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Text
EncodeSigner
OAuthClientSecret
OAuthClientId
_configGithubCbPath :: Text
_configFrontendUrl :: Text
_configJWTSignature :: EncodeSigner
_configGithubClientSecret :: OAuthClientSecret
_configGithubClientId :: OAuthClientId
_configGithubClientSecret :: OAuthClientSecret
_configGithubClientId :: OAuthClientId
_configGithubCbPath :: Text
_configFrontendUrl :: Text
_configJWTSignature :: EncodeSigner
</span><a href="#local-6989586621679740541"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">type</span><span> </span><span id="Env"><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-type">GithubEndpoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-152"></span><span class="annot"><a href="Auth.html#hSessionIdCookie"><span class="hs-identifier hs-type">hSessionIdCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-153"></span><span id="hSessionIdCookie"><span class="annot"><span class="annottext">hSessionIdCookie :: Text
</span><a href="Auth.html#hSessionIdCookie"><span class="hs-identifier hs-var hs-var">hSessionIdCookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;sessionId&quot;</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | The JWT key we can lookup for the Github token's value.</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Auth.html#githubTokenClaim"><span class="hs-identifier hs-type">githubTokenClaim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-157"></span><span id="githubTokenClaim"><span class="annot"><span class="annottext">githubTokenClaim :: Text
</span><a href="Auth.html#githubTokenClaim"><span class="hs-identifier hs-var hs-var">githubTokenClaim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;github-token&quot;</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-160"></span><span id="local-6989586621679740837"><span class="annot"><a href="Auth.html#redirect"><span class="hs-identifier hs-type">redirect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>       </span><span class="annot"><a href="../file:///nix/store/xwv0l1a23x8kyayf6zgxf7hsrgwcdf0k-http-api-data-lib-http-api-data-0.4.3-haddock-doc/share/doc/http-api-data/html/src"><span class="hs-identifier hs-type">ToHttpApiData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740837"><span class="hs-identifier hs-type">loc</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740837"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-comment">-- ^ what to put in the 'Location' header</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679740837"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span></span><span>
</span><span id="line-164"></span><span id="redirect"><span class="annot"><span class="annottext">redirect :: loc -&gt; Headers '[Header &quot;Location&quot; loc] NoContent
</span><a href="Auth.html#redirect"><span class="hs-identifier hs-var hs-var">redirect</span></a></span></span><span> </span><span id="local-6989586621679740537"><span class="annot"><span class="annottext">loc
</span><a href="#local-6989586621679740537"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">loc -&gt; NoContent -&gt; Headers '[Header &quot;Location&quot; loc] NoContent
forall (h :: Symbol) v orig new.
AddHeader h v orig new =&gt;
v -&gt; orig -&gt; new
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">addHeader</span></a></span><span> </span><span class="annot"><span class="annottext">loc
</span><a href="#local-6989586621679740537"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">NoContent
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">NoContent</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621679740719"><span class="annot"><a href="Auth.html#githubRedirect"><span class="hs-identifier hs-type">githubRedirect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-167"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740719"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740719"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span id="githubRedirect"><span class="annot"><span class="annottext">githubRedirect :: m (Headers '[Header &quot;Location&quot; Text] NoContent)
</span><a href="Auth.html#githubRedirect"><span class="hs-identifier hs-var hs-var">githubRedirect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Processing github redirect.&quot;</span></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679740535"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740535"><span class="hs-identifier hs-var">_configFrontendUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting Text Env Text -&gt; m Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const Text Config) -&gt; Env -&gt; Const Text Env
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const Text Config) -&gt; Env -&gt; Const Text Env)
-&gt; ((Text -&gt; Const Text Text) -&gt; Config -&gt; Const Text Config)
-&gt; Getting Text Env Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Const Text Text) -&gt; Config -&gt; Const Text Config
Lens' Config Text
</span><a href="Auth.html#configFrontendUrl"><span class="hs-identifier hs-var">configFrontendUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679740533"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740533"><span class="hs-identifier hs-var">_githubEndpointsCallbackUri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting Text Env Text -&gt; m Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GithubEndpoints -&gt; Const Text GithubEndpoints)
-&gt; Env -&gt; Const Text Env
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_1</span></a></span><span> </span><span class="annot"><span class="annottext">((GithubEndpoints -&gt; Const Text GithubEndpoints)
 -&gt; Env -&gt; Const Text Env)
-&gt; ((Text -&gt; Const Text Text)
    -&gt; GithubEndpoints -&gt; Const Text GithubEndpoints)
-&gt; Getting Text Env Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Const Text Text)
-&gt; GithubEndpoints -&gt; Const Text GithubEndpoints
Lens' GithubEndpoints Text
</span><a href="Auth.html#githubEndpointsCallbackUri"><span class="hs-identifier hs-var">githubEndpointsCallbackUri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679740532"><span class="annot"><span class="annottext">OAuthClientId
</span><a href="#local-6989586621679740532"><span class="hs-identifier hs-var">_configGithubClientId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting OAuthClientId Env OAuthClientId -&gt; m OAuthClientId
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const OAuthClientId Config)
-&gt; Env -&gt; Const OAuthClientId Env
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const OAuthClientId Config)
 -&gt; Env -&gt; Const OAuthClientId Env)
-&gt; ((OAuthClientId -&gt; Const OAuthClientId OAuthClientId)
    -&gt; Config -&gt; Const OAuthClientId Config)
-&gt; Getting OAuthClientId Env OAuthClientId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(OAuthClientId -&gt; Const OAuthClientId OAuthClientId)
-&gt; Config -&gt; Const OAuthClientId Config
Lens' Config OAuthClientId
</span><a href="Auth.html#configGithubClientId"><span class="hs-identifier hs-var">configGithubClientId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679740531"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679740531"><span class="hs-identifier hs-var">_githubEndpointsAuthLocation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting Request Env Request -&gt; m Request
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GithubEndpoints -&gt; Const Request GithubEndpoints)
-&gt; Env -&gt; Const Request Env
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_1</span></a></span><span> </span><span class="annot"><span class="annottext">((GithubEndpoints -&gt; Const Request GithubEndpoints)
 -&gt; Env -&gt; Const Request Env)
-&gt; ((Request -&gt; Const Request Request)
    -&gt; GithubEndpoints -&gt; Const Request GithubEndpoints)
-&gt; Getting Request Env Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Const Request Request)
-&gt; GithubEndpoints -&gt; Const Request GithubEndpoints
Lens' GithubEndpoints Request
</span><a href="Auth.html#githubEndpointsAuthLocation"><span class="hs-identifier hs-var">githubEndpointsAuthLocation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740530"><span class="annot"><span class="annottext">githubRedirectUrl :: Text
</span><a href="#local-6989586621679740530"><span class="hs-identifier hs-var hs-var">githubRedirectUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">URI -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">(URI -&gt; Text) -&gt; (Request -&gt; URI) -&gt; Request -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-177"></span><span>            </span><span class="annot"><span class="annottext">Request -&gt; URI
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var">getUri</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; URI) -&gt; (Request -&gt; Request) -&gt; Request -&gt; URI
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-178"></span><span>            </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var">setQueryString</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text -&gt; (ByteString, Maybe ByteString)
forall a. a -&gt; Text -&gt; (a, Maybe ByteString)
</span><a href="#local-6989586621679740528"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;redirect_uri&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (ByteString, Maybe ByteString))
-&gt; Text -&gt; (ByteString, Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-180"></span><span>                  </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740535"><span class="hs-identifier hs-var">_configFrontendUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740533"><span class="hs-identifier hs-var">_githubEndpointsCallbackUri</span></a></span><span>
</span><span id="line-181"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text -&gt; (ByteString, Maybe ByteString)
forall a. a -&gt; Text -&gt; (a, Maybe ByteString)
</span><a href="#local-6989586621679740528"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;scope&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740527"><span class="hs-identifier hs-var">oauthScopes</span></a></span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text -&gt; (ByteString, Maybe ByteString)
forall a. a -&gt; Text -&gt; (a, Maybe ByteString)
</span><a href="#local-6989586621679740528"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;client_id&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OAuthClientId -&gt; O OAuthClientId
forall n. Newtype n =&gt; n -&gt; O n
</span><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthClientId
</span><a href="#local-6989586621679740532"><span class="hs-identifier hs-var">_configGithubClientId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Text) -&gt; Request -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679740531"><span class="hs-identifier hs-var">_githubEndpointsAuthLocation</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Redirecting to: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740530"><span class="hs-identifier hs-var">githubRedirectUrl</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">Headers '[Header &quot;Location&quot; Text] NoContent
-&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers '[Header &quot;Location&quot; Text] NoContent
 -&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent))
-&gt; Headers '[Header &quot;Location&quot; Text] NoContent
-&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Headers '[Header &quot;Location&quot; Text] NoContent
forall loc.
ToHttpApiData loc =&gt;
loc -&gt; Headers '[Header &quot;Location&quot; loc] NoContent
</span><a href="Auth.html#redirect"><span class="hs-identifier hs-var">redirect</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740530"><span class="hs-identifier hs-var">githubRedirectUrl</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679740527"><span class="annot"><span class="annottext">oauthScopes :: Text
</span><a href="#local-6989586621679740527"><span class="hs-identifier hs-var hs-var">oauthScopes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;gist&quot;</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679740528"><span class="annot"><span class="annottext">param :: a -&gt; Text -&gt; (a, Maybe ByteString)
</span><a href="#local-6989586621679740528"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span id="local-6989586621679740526"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679740526"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679740525"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740525"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679740526"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740525"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Auth.html#twoWeeks"><span class="hs-identifier hs-type">twoWeeks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-type">NominalDiffTime</span></a></span><span>
</span><span id="line-192"></span><span id="twoWeeks"><span class="annot"><span class="annottext">twoWeeks :: NominalDiffTime
</span><a href="Auth.html#twoWeeks"><span class="hs-identifier hs-var hs-var">twoWeeks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">24</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">2</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Auth.html#expiryDuration"><span class="hs-identifier hs-type">expiryDuration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-type">NominalDiffTime</span></a></span><span>
</span><span id="line-195"></span><span id="expiryDuration"><span class="annot"><span class="annottext">expiryDuration :: NominalDiffTime
</span><a href="Auth.html#expiryDuration"><span class="hs-identifier hs-var hs-var">expiryDuration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="Auth.html#twoWeeks"><span class="hs-identifier hs-var">twoWeeks</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621679740723"><span class="annot"><a href="Auth.html#authStatus"><span class="hs-identifier hs-type">authStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-198"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Auth.html#AuthStatus"><span class="hs-identifier hs-type">AuthStatus</span></a></span></span><span>
</span><span id="line-201"></span><span id="authStatus"><span class="annot"><span class="annottext">authStatus :: Maybe Text -&gt; m AuthStatus
</span><a href="Auth.html#authStatus"><span class="hs-identifier hs-var hs-var">authStatus</span></a></span></span><span> </span><span id="local-6989586621679740520"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740520"><span class="hs-identifier hs-var">cookieHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679740519"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740519"><span class="hs-identifier hs-var">jwtSignature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting EncodeSigner Env EncodeSigner -&gt; m EncodeSigner
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const EncodeSigner Config)
-&gt; Env -&gt; Const EncodeSigner Env
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const EncodeSigner Config)
 -&gt; Env -&gt; Const EncodeSigner Env)
-&gt; ((EncodeSigner -&gt; Const EncodeSigner EncodeSigner)
    -&gt; Config -&gt; Const EncodeSigner Config)
-&gt; Getting EncodeSigner Env EncodeSigner
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(EncodeSigner -&gt; Const EncodeSigner EncodeSigner)
-&gt; Config -&gt; Const EncodeSigner Config
Lens' Config EncodeSigner
</span><a href="Auth.html#configJWTSignature"><span class="hs-identifier hs-var">configJWTSignature</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679740518"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740518"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m NominalDiffTime
forall (m :: * -&gt; *). MonadNow m =&gt; m NominalDiffTime
</span><a href="Control.Monad.Now.html#getPOSIXTime"><span class="hs-identifier hs-var">getPOSIXTime</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679740517"><span class="annot"><span class="annottext">AuthRole
</span><a href="#local-6989586621679740517"><span class="hs-identifier hs-var">_authStatusAuthRole</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EncodeSigner
-&gt; NominalDiffTime -&gt; Maybe Text -&gt; Either Text (Token 'Github)
</span><a href="Auth.html#extractGithubToken"><span class="hs-identifier hs-var">extractGithubToken</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740519"><span class="hs-identifier hs-var">jwtSignature</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740518"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740520"><span class="hs-identifier hs-var">cookieHeader</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>              </span><span class="annot"><span class="annottext">AuthRole -&gt; m AuthRole
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">AuthRole
</span><a href="Auth.html#GithubUser"><span class="hs-identifier hs-var">GithubUser</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679740515"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740515"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-210"></span><span>                    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Failed to extract github token at step: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740515"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-211"></span><span>                </span><span class="annot"><span class="annottext">AuthRole -&gt; m AuthRole
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">AuthRole
</span><a href="Auth.html#Anonymous"><span class="hs-identifier hs-var">Anonymous</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740514"><span class="annot"><span class="annottext">authStatusResult :: AuthStatus
</span><a href="#local-6989586621679740514"><span class="hs-identifier hs-var hs-var">authStatusResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthStatus :: AuthRole -&gt; AuthStatus
</span><a href="Auth.html#AuthStatus"><span class="hs-identifier hs-type">AuthStatus</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">AuthRole
_authStatusAuthRole :: AuthRole
_authStatusAuthRole :: AuthRole
</span><a href="#local-6989586621679740517"><span class="hs-glyph hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Authentication status is: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AuthStatus -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">AuthStatus
</span><a href="#local-6989586621679740514"><span class="hs-identifier hs-var">authStatusResult</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">AuthStatus -&gt; m AuthStatus
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">AuthStatus
</span><a href="#local-6989586621679740514"><span class="hs-identifier hs-var">authStatusResult</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Auth.html#extractGithubToken"><span class="hs-identifier hs-type">extractGithubToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-217"></span><span>       </span><span class="annot"><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-type">JWT.EncodeSigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-type">POSIXTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.Types.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Auth.Types.html#Github"><span class="hs-identifier hs-type">Github</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span id="extractGithubToken"><span class="annot"><span class="annottext">extractGithubToken :: EncodeSigner
-&gt; NominalDiffTime -&gt; Maybe Text -&gt; Either Text (Token 'Github)
</span><a href="Auth.html#extractGithubToken"><span class="hs-identifier hs-var hs-var">extractGithubToken</span></a></span></span><span> </span><span id="local-6989586621679740513"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740513"><span class="hs-identifier hs-var">signer</span></a></span></span><span> </span><span id="local-6989586621679740512"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740512"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span id="local-6989586621679740511"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740511"><span class="hs-identifier hs-var">cookieHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; TraceMaybe Text (Token 'Github) -&gt; Either Text (Token 'Github)
forall e a. e -&gt; TraceMaybe e a -&gt; Either e a
</span><a href="Control.Monad.Trace.html#runTrace"><span class="hs-identifier hs-var">runTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Reading cookies.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(TraceMaybe Text (Token 'Github) -&gt; Either Text (Token 'Github))
-&gt; TraceMaybe Text (Token 'Github) -&gt; Either Text (Token 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>        </span><span id="local-6989586621679740510"><span class="annot"><span class="annottext">Cookies
</span><a href="#local-6989586621679740510"><span class="hs-identifier hs-var">cookies</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Cookies
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">parseCookies</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Cookies) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Cookies
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Cookies)
-&gt; MaybeT (Writer (Last Text)) Text
-&gt; MaybeT (Writer (Last Text)) Cookies
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; MaybeT (Writer (Last Text)) Text
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740511"><span class="hs-identifier hs-var">cookieHeader</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TraceMaybe Text ()) -&gt; Text -&gt; TraceMaybe Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Looking for Session ID cookie: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cookies -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">Cookies
</span><a href="#local-6989586621679740510"><span class="hs-identifier hs-var">cookies</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span id="local-6989586621679740509"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679740509"><span class="hs-identifier hs-var">githubAuth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; MaybeT (Writer (Last Text)) ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; MaybeT (Writer (Last Text)) ByteString)
-&gt; Maybe ByteString -&gt; MaybeT (Writer (Last Text)) ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Cookies -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Auth.html#hSessionIdCookie"><span class="hs-identifier hs-var">hSessionIdCookie</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cookies
</span><a href="#local-6989586621679740510"><span class="hs-identifier hs-var">cookies</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TraceMaybe Text ()) -&gt; Text -&gt; TraceMaybe Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Reading JWT Cookie: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679740509"><span class="hs-identifier hs-var">githubAuth</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621679740507"><span class="annot"><span class="annottext">JWT UnverifiedJWT
</span><a href="#local-6989586621679740507"><span class="hs-identifier hs-var">unverifiedJwt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (JWT UnverifiedJWT)
-&gt; MaybeT (Writer (Last Text)) (JWT UnverifiedJWT)
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (JWT UnverifiedJWT)
 -&gt; MaybeT (Writer (Last Text)) (JWT UnverifiedJWT))
-&gt; (ByteString -&gt; Maybe (JWT UnverifiedJWT))
-&gt; ByteString
-&gt; MaybeT (Writer (Last Text)) (JWT UnverifiedJWT)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (JWT UnverifiedJWT)
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.decode</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe (JWT UnverifiedJWT))
-&gt; (ByteString -&gt; Text) -&gt; ByteString -&gt; Maybe (JWT UnverifiedJWT)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; MaybeT (Writer (Last Text)) (JWT UnverifiedJWT))
-&gt; ByteString -&gt; MaybeT (Writer (Last Text)) (JWT UnverifiedJWT)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679740509"><span class="hs-identifier hs-var">githubAuth</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Verifying JWT Cookie.&quot;</span></span><span>
</span><span id="line-226"></span><span>        </span><span id="local-6989586621679740505"><span class="annot"><span class="annottext">JWT VerifiedJWT
</span><a href="#local-6989586621679740505"><span class="hs-identifier hs-var">verifiedJwt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (JWT VerifiedJWT)
-&gt; MaybeT (Writer (Last Text)) (JWT VerifiedJWT)
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (JWT VerifiedJWT)
 -&gt; MaybeT (Writer (Last Text)) (JWT VerifiedJWT))
-&gt; Maybe (JWT VerifiedJWT)
-&gt; MaybeT (Writer (Last Text)) (JWT VerifiedJWT)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VerifySigner -&gt; JWT UnverifiedJWT -&gt; Maybe (JWT VerifiedJWT)
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncodeSigner -&gt; VerifySigner
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.toVerify</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740513"><span class="hs-identifier hs-var">signer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">JWT UnverifiedJWT
</span><a href="#local-6989586621679740507"><span class="hs-identifier hs-var">unverifiedJwt</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740502"><span class="annot"><span class="annottext">claims :: JWTClaimsSet
</span><a href="#local-6989586621679740502"><span class="hs-identifier hs-var hs-var">claims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JWT VerifiedJWT -&gt; JWTClaimsSet
forall r. JWT r -&gt; JWTClaimsSet
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.claims</span></a></span><span> </span><span class="annot"><span class="annottext">JWT VerifiedJWT
</span><a href="#local-6989586621679740505"><span class="hs-identifier hs-var">verifiedJwt</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Checking expiry date is set.&quot;</span></span><span>
</span><span id="line-229"></span><span>        </span><span id="local-6989586621679740500"><span class="annot"><span class="annottext">IntDate
</span><a href="#local-6989586621679740500"><span class="hs-identifier hs-var">expiry</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe IntDate -&gt; MaybeT (Writer (Last Text)) IntDate
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe IntDate -&gt; MaybeT (Writer (Last Text)) IntDate)
-&gt; Maybe IntDate -&gt; MaybeT (Writer (Last Text)) IntDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet -&gt; Maybe IntDate
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var hs-var">JWT.exp</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679740502"><span class="hs-identifier hs-var">claims</span></a></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Checking expiry date is valid.&quot;</span></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; TraceMaybe Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntDate -&gt; NominalDiffTime
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.secondsSinceEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">IntDate
</span><a href="#local-6989586621679740500"><span class="hs-identifier hs-var">expiry</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740512"><span class="hs-identifier hs-var">now</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Looking for Github token claim.&quot;</span></span><span>
</span><span id="line-233"></span><span>        </span><span id="local-6989586621679740496"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679740496"><span class="hs-identifier hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-234"></span><span>            </span><span class="annot"><span class="annottext">Maybe Value -&gt; MaybeT (Writer (Last Text)) Value
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; MaybeT (Writer (Last Text)) Value)
-&gt; (JWTClaimsSet -&gt; Maybe Value)
-&gt; JWTClaimsSet
-&gt; MaybeT (Writer (Last Text)) Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-235"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Map Text Value -&gt; Maybe Value
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Auth.html#githubTokenClaim"><span class="hs-identifier hs-var">githubTokenClaim</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text Value -&gt; Maybe Value)
-&gt; (JWTClaimsSet -&gt; Map Text Value) -&gt; JWTClaimsSet -&gt; Maybe Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="annottext">ClaimsMap -&gt; Map Text Value
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var hs-var">JWT.unClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">(ClaimsMap -&gt; Map Text Value)
-&gt; (JWTClaimsSet -&gt; ClaimsMap) -&gt; JWTClaimsSet -&gt; Map Text Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet -&gt; ClaimsMap
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var hs-var">JWT.unregisteredClaims</span></a></span><span> </span><span class="annot"><span class="annottext">(JWTClaimsSet -&gt; MaybeT (Writer (Last Text)) Value)
-&gt; JWTClaimsSet -&gt; MaybeT (Writer (Last Text)) Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679740502"><span class="hs-identifier hs-var">claims</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TraceMaybe Text ()
forall a. a -&gt; TraceMaybe a ()
</span><a href="Control.Monad.Trace.html#attempt"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TraceMaybe Text ()) -&gt; Text -&gt; TraceMaybe Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Extracting token as a string: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679740496"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Token 'Github) -&gt; TraceMaybe Text (Token 'Github)
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; MaybeT m a
</span><a href="Control.Monad.Trace.html#withTrace"><span class="hs-identifier hs-var">withTrace</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Token 'Github) -&gt; TraceMaybe Text (Token 'Github))
-&gt; Maybe (Token 'Github) -&gt; TraceMaybe Text (Token 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-240"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679740496"><span class="hs-identifier hs-var">json</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621679740492"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740492"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Token 'Github -&gt; Maybe (Token 'Github)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Token 'Github -&gt; Maybe (Token 'Github))
-&gt; Token 'Github -&gt; Maybe (Token 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token 'Github
forall (a :: TokenProvider). Text -&gt; Token a
</span><a href="Auth.Types.html#Token"><span class="hs-identifier hs-var">Token</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740492"><span class="hs-identifier hs-var">token</span></a></span><span>
</span><span id="line-242"></span><span>                </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Token 'Github)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span id="local-6989586621679740714"><span class="annot"><a href="Auth.html#githubCallback"><span class="hs-identifier hs-type">githubCallback</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-246"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-247"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-248"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-249"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-250"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthCode"><span class="hs-identifier hs-type">OAuthCode</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Headers</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Set-Cookie&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-type">SetCookie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Location&quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-253"></span><span id="githubCallback"><span class="annot"><span class="annottext">githubCallback :: Maybe OAuthCode
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
</span><a href="Auth.html#githubCallback"><span class="hs-identifier hs-var hs-var">githubCallback</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe OAuthCode
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">m (Either
     Text
     (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
        NoContent))
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall (m :: * -&gt; *) b.
(MonadLogger m, MonadError ServerError m) =&gt;
m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr500"><span class="hs-identifier hs-var">withErr500</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either
      Text
      (Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
         NoContent))
 -&gt; m (Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
         NoContent))
-&gt; (Text
    -&gt; m (Either
            Text
            (Headers
               '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
               NoContent)))
-&gt; Text
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  Text
  (Headers
     '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
-&gt; m (Either
        Text
        (Headers
           '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
           NoContent))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   Text
   (Headers
      '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
 -&gt; m (Either
         Text
         (Headers
            '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
            NoContent)))
-&gt; (Text
    -&gt; Either
         Text
         (Headers
            '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
            NoContent))
-&gt; Text
-&gt; m (Either
        Text
        (Headers
           '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
           NoContent))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Either
     Text
     (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(Text
 -&gt; m (Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
         NoContent))
-&gt; Text
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Expected a response from Github with an authorization code. Didn't get one!&quot;</span></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Auth.html#githubCallback"><span class="hs-identifier hs-var">githubCallback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679740489"><span class="annot"><span class="annottext">OAuthCode
</span><a href="#local-6989586621679740489"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679740488"><span class="annot"><span class="annottext">GithubEndpoints
</span><a href="#local-6989586621679740488"><span class="hs-identifier hs-var">githubEndpoints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting GithubEndpoints Env GithubEndpoints -&gt; m GithubEndpoints
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting GithubEndpoints Env GithubEndpoints
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_1</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679740487"><span class="annot"><span class="annottext">config :: Config
</span><a href="#local-6989586621679740487"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679740482"><span id="local-6989586621679740483"><span id="local-6989586621679740484"><span id="local-6989586621679740485"><span id="local-6989586621679740486"><span class="annot"><span class="annottext">Text
EncodeSigner
OAuthClientSecret
OAuthClientId
_configGithubClientSecret :: OAuthClientSecret
_configGithubClientId :: OAuthClientId
_configGithubCbPath :: Text
_configFrontendUrl :: Text
_configJWTSignature :: EncodeSigner
_configGithubClientSecret :: Config -&gt; OAuthClientSecret
_configGithubClientId :: Config -&gt; OAuthClientId
_configGithubCbPath :: Config -&gt; Text
_configFrontendUrl :: Config -&gt; Text
_configJWTSignature :: Config -&gt; EncodeSigner
</span><a href="#local-6989586621679740482"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting Config Env Config -&gt; m Config
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Config Env Config
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;OAuth Code received. Swapping for a long-lived token.&quot;</span></span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679740481"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679740481"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Manager
forall (m :: * -&gt; *). MonadWeb m =&gt; m Manager
</span><a href="Control.Monad.Web.html#makeManager"><span class="hs-identifier hs-var">makeManager</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679740480"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679740480"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">m (Either Text (Response ByteString)) -&gt; m (Response ByteString)
forall (m :: * -&gt; *) b.
(MonadLogger m, MonadError ServerError m) =&gt;
m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr500"><span class="hs-identifier hs-var">withErr500</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either Text (Response ByteString)) -&gt; m (Response ByteString))
-&gt; m (Either Text (Response ByteString)) -&gt; m (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Manager -&gt; Request -&gt; m (Either Text (Response ByteString))
forall (m :: * -&gt; *).
MonadWeb m =&gt;
Manager -&gt; Request -&gt; m (Either Text (Response ByteString))
</span><a href="Control.Monad.Web.html#doRequest"><span class="hs-identifier hs-var">doRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679740481"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; m (Either Text (Response ByteString)))
-&gt; Request -&gt; m (Either Text (Response ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GithubEndpoints -&gt; Config -&gt; OAuthCode -&gt; Request
</span><a href="Auth.html#makeTokenRequest"><span class="hs-identifier hs-var">makeTokenRequest</span></a></span><span> </span><span class="annot"><span class="annottext">GithubEndpoints
</span><a href="#local-6989586621679740488"><span class="hs-identifier hs-var">githubEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679740487"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthCode
</span><a href="#local-6989586621679740489"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679740478"><span class="annot"><span class="annottext">OAuthToken 'Github
</span><a href="#local-6989586621679740478"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">m (Either Text (OAuthToken 'Github)) -&gt; m (OAuthToken 'Github)
forall (m :: * -&gt; *) b.
(MonadLogger m, MonadError ServerError m) =&gt;
m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr500"><span class="hs-identifier hs-var">withErr500</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either Text (OAuthToken 'Github)) -&gt; m (OAuthToken 'Github))
-&gt; (Either String (OAuthToken 'Github)
    -&gt; m (Either Text (OAuthToken 'Github)))
-&gt; Either String (OAuthToken 'Github)
-&gt; m (OAuthToken 'Github)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either Text (OAuthToken 'Github)
-&gt; m (Either Text (OAuthToken 'Github))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Text (OAuthToken 'Github)
 -&gt; m (Either Text (OAuthToken 'Github)))
-&gt; (Either String (OAuthToken 'Github)
    -&gt; Either Text (OAuthToken 'Github))
-&gt; Either String (OAuthToken 'Github)
-&gt; m (Either Text (OAuthToken 'Github))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text)
-&gt; Either String (OAuthToken 'Github)
-&gt; Either Text (OAuthToken 'Github)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">Text.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (OAuthToken 'Github) -&gt; m (OAuthToken 'Github))
-&gt; Either String (OAuthToken 'Github) -&gt; m (OAuthToken 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Bool
</span><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier hs-var">statusIsSuccessful</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var hs-var">responseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679740480"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String (OAuthToken 'Github)
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">eitherDecode</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String (OAuthToken 'Github))
-&gt; ByteString -&gt; Either String (OAuthToken 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var hs-var">responseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679740480"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (OAuthToken 'Github)
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (OAuthToken 'Github))
-&gt; String -&gt; Either String (OAuthToken 'Github)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679740480"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679740475"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740475"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m UTCTime
forall (m :: * -&gt; *). MonadNow m =&gt; m UTCTime
</span><a href="Control.Monad.Now.html#getCurrentTime"><span class="hs-identifier hs-var">getCurrentTime</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740474"><span class="annot"><span class="annottext">cookie :: SetCookie
</span><a href="#local-6989586621679740474"><span class="hs-identifier hs-var hs-var">cookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncodeSigner -&gt; OAuthToken 'Github -&gt; UTCTime -&gt; SetCookie
</span><a href="Auth.html#createSessionCookie"><span class="hs-identifier hs-var">createSessionCookie</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740486"><span class="hs-identifier hs-var">_configJWTSignature</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthToken 'Github
</span><a href="#local-6989586621679740478"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740475"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Sending cookie.&quot;</span></span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">Headers
  '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers
   '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent
 -&gt; m (Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
         NoContent))
-&gt; (NoContent
    -&gt; Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
-&gt; NoContent
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
-&gt; Headers '[Header &quot;Location&quot; Text] NoContent
-&gt; Headers
     '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent
forall (h :: Symbol) v orig new.
AddHeader h v orig new =&gt;
v -&gt; orig -&gt; new
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">addHeader</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679740474"><span class="hs-identifier hs-var">cookie</span></a></span><span> </span><span class="annot"><span class="annottext">(Headers '[Header &quot;Location&quot; Text] NoContent
 -&gt; Headers
      '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
-&gt; (NoContent -&gt; Headers '[Header &quot;Location&quot; Text] NoContent)
-&gt; NoContent
-&gt; Headers
     '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NoContent -&gt; Headers '[Header &quot;Location&quot; Text] NoContent
forall (h :: Symbol) v orig new.
AddHeader h v orig new =&gt;
v -&gt; orig -&gt; new
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">addHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740485"><span class="hs-identifier hs-var">_configFrontendUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740484"><span class="hs-identifier hs-var">_configGithubCbPath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NoContent
 -&gt; m (Headers
         '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
         NoContent))
-&gt; NoContent
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NoContent
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">NoContent</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span id="local-6989586621679740763"><span id="local-6989586621679740764"><span class="annot"><a href="Auth.html#withErr"><span class="hs-identifier hs-type">withErr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-275"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740764"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740764"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740763"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740763"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-279"></span><span id="withErr"><span class="annot"><span class="annottext">withErr :: ServerError -&gt; m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr"><span class="hs-identifier hs-var hs-var">withErr</span></a></span></span><span> </span><span id="local-6989586621679740471"><span class="annot"><span class="annottext">ServerError
</span><a href="#local-6989586621679740471"><span class="hs-identifier hs-var">servantErr</span></a></span></span><span> </span><span id="local-6989586621679740470"><span class="annot"><span class="annottext">m (Either Text b)
</span><a href="#local-6989586621679740470"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">m (Either Text b)
</span><a href="#local-6989586621679740470"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either Text b) -&gt; (Either Text b -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679740469"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740469"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logErrorN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740469"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span class="annot"><span class="annottext">ServerError -&gt; m b
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerError -&gt; m b) -&gt; ServerError -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-284"></span><span>                </span><span class="annot"><span class="annottext">ServerError
</span><a href="#local-6989586621679740471"><span class="hs-identifier hs-var">servantErr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">LBS.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; Text -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740469"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679740467"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679740467"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679740467"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span id="local-6989586621679740793"><span id="local-6989586621679740796"><span class="annot"><a href="Auth.html#withErr500"><span class="hs-identifier hs-type">withErr500</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-288"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740796"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740796"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740793"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740796"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740793"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-289"></span><span id="withErr500"><span class="annot"><span class="annottext">withErr500 :: m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr500"><span class="hs-identifier hs-var hs-var">withErr500</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; m (Either Text b) -&gt; m b
forall (m :: * -&gt; *) b.
(MonadLogger m, MonadError ServerError m) =&gt;
ServerError -&gt; m (Either Text b) -&gt; m b
</span><a href="Auth.html#withErr"><span class="hs-identifier hs-var">withErr</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Auth.html#makeTokenRequest"><span class="hs-identifier hs-type">makeTokenRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-type">GithubEndpoints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthCode"><span class="hs-identifier hs-type">OAuthCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-292"></span><span id="makeTokenRequest"><span class="annot"><span class="annottext">makeTokenRequest :: GithubEndpoints -&gt; Config -&gt; OAuthCode -&gt; Request
</span><a href="Auth.html#makeTokenRequest"><span class="hs-identifier hs-var hs-var">makeTokenRequest</span></a></span></span><span> </span><span class="annot"><a href="Auth.html#GithubEndpoints"><span class="hs-identifier hs-type">GithubEndpoints</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679740463"><span id="local-6989586621679740464"><span id="local-6989586621679740465"><span id="local-6989586621679740466"><span class="annot"><span class="annottext">Text
Request
BaseUrl
_githubEndpointsCallbackUri :: Text
_githubEndpointsApiBaseUrl :: BaseUrl
_githubEndpointsAccessTokenLocation :: Request
_githubEndpointsAuthLocation :: Request
_githubEndpointsCallbackUri :: GithubEndpoints -&gt; Text
_githubEndpointsApiBaseUrl :: GithubEndpoints -&gt; BaseUrl
_githubEndpointsAccessTokenLocation :: GithubEndpoints -&gt; Request
_githubEndpointsAuthLocation :: GithubEndpoints -&gt; Request
</span><a href="#local-6989586621679740463"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Auth.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679740458"><span id="local-6989586621679740459"><span id="local-6989586621679740460"><span id="local-6989586621679740461"><span id="local-6989586621679740462"><span class="annot"><span class="annottext">Text
EncodeSigner
OAuthClientSecret
OAuthClientId
_configGithubClientSecret :: OAuthClientSecret
_configGithubClientId :: OAuthClientId
_configGithubCbPath :: Text
_configFrontendUrl :: Text
_configJWTSignature :: EncodeSigner
_configGithubClientSecret :: Config -&gt; OAuthClientSecret
_configGithubClientId :: Config -&gt; OAuthClientId
_configGithubCbPath :: Config -&gt; Text
_configFrontendUrl :: Config -&gt; Text
_configJWTSignature :: Config -&gt; EncodeSigner
</span><a href="#local-6989586621679740458"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679740457"><span class="annot"><span class="annottext">OAuthCode
</span><a href="#local-6989586621679740457"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><a href="../file:///nix/store/492bapj3ba14hw6h4z0nh1b52lmsbxxr-http-client-lib-http-client-0.7.13.1-haddock-doc/share/doc/http-client/html/src"><span class="hs-identifier hs-var">setQueryString</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)]
</span><a href="#local-6989586621679740456"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; (Request -&gt; Request) -&gt; Request -&gt; Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="Auth.Types.html#addUserAgent"><span class="hs-identifier hs-var">addUserAgent</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; (Request -&gt; Request) -&gt; Request -&gt; Request
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; Request -&gt; Request
</span><a href="../file:///nix/store/1gg4kr15bqc45qy51bbslazp866j59dk-http-conduit-lib-http-conduit-2.3.8-haddock-doc/share/doc/http-conduit/html/src"><span class="hs-identifier hs-var">addRequestHeader</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier hs-var">hAccept</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/json&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679740465"><span class="hs-identifier hs-var">_githubEndpointsAccessTokenLocation</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679740456"><span class="annot"><span class="annottext">params :: [(ByteString, Maybe ByteString)]
</span><a href="#local-6989586621679740456"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;client_id&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OAuthClientId -&gt; Maybe ByteString
forall a. (Newtype a, O a ~ Text) =&gt; a -&gt; Maybe ByteString
</span><a href="#local-6989586621679740455"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthClientId
</span><a href="#local-6989586621679740459"><span class="hs-identifier hs-var">_configGithubClientId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;client_secret&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OAuthClientSecret -&gt; Maybe ByteString
forall a. (Newtype a, O a ~ Text) =&gt; a -&gt; Maybe ByteString
</span><a href="#local-6989586621679740455"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthClientSecret
</span><a href="#local-6989586621679740458"><span class="hs-identifier hs-var">_configGithubClientSecret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;code&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OAuthCode -&gt; Maybe ByteString
forall a. (Newtype a, O a ~ Text) =&gt; a -&gt; Maybe ByteString
</span><a href="#local-6989586621679740455"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthCode
</span><a href="#local-6989586621679740457"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="#local-6989586621679740455"><span class="hs-identifier hs-type">param</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-303"></span><span>           </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679740761"><span class="annot"><a href="#local-6989586621679740761"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier hs-type">Newtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier hs-type">O</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740761"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740761"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679740455"><span class="annot"><span class="annottext">param :: a -&gt; Maybe ByteString
</span><a href="#local-6989586621679740455"><span class="hs-identifier hs-var hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; (a -&gt; ByteString) -&gt; a -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (a -&gt; Text) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall n. Newtype n =&gt; n -&gt; O n
</span><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Auth.html#createSessionCookie"><span class="hs-identifier hs-type">createSessionCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-type">JWT.EncodeSigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Auth.Types.html#OAuthToken"><span class="hs-identifier hs-type">OAuthToken</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Auth.Types.html#Github"><span class="hs-identifier hs-type">Github</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-type">UTCTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-type">SetCookie</span></a></span><span>
</span><span id="line-309"></span><span id="createSessionCookie"><span class="annot"><span class="annottext">createSessionCookie :: EncodeSigner -&gt; OAuthToken 'Github -&gt; UTCTime -&gt; SetCookie
</span><a href="Auth.html#createSessionCookie"><span class="hs-identifier hs-var hs-var">createSessionCookie</span></a></span></span><span> </span><span id="local-6989586621679740454"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740454"><span class="hs-identifier hs-var">signer</span></a></span></span><span> </span><span id="local-6989586621679740453"><span class="annot"><span class="annottext">OAuthToken 'Github
</span><a href="#local-6989586621679740453"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span id="local-6989586621679740452"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740452"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><span class="annottext">SetCookie
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">defaultSetCookie</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">setCookieName :: ByteString
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Auth.html#hSessionIdCookie"><span class="hs-identifier hs-var">hSessionIdCookie</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieValue :: ByteString
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740451"><span class="hs-identifier hs-var">cookieValue</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookiePath :: Maybe ByteString
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookiePath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieExpires :: Maybe UTCTime
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieExpires</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Maybe UTCTime
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740450"><span class="hs-identifier hs-var">expiryDate</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieMaxAge :: Maybe DiffTime
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieMaxAge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Maybe DiffTime
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Maybe DiffTime)
-&gt; (NominalDiffTime -&gt; DiffTime)
-&gt; NominalDiffTime
-&gt; Maybe DiffTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; DiffTime
forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; DiffTime)
-&gt; (NominalDiffTime -&gt; Rational) -&gt; NominalDiffTime -&gt; DiffTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toRational</span></a></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Maybe DiffTime)
-&gt; NominalDiffTime -&gt; Maybe DiffTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="Auth.html#expiryDuration"><span class="hs-identifier hs-var">expiryDuration</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieSecure :: Bool
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieSecure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieHttpOnly :: Bool
</span><a href="../file:///nix/store/5pd0c9nfysj5pyx0ynf144jac5qw0wb3-cookie-lib-cookie-0.4.5-haddock-doc/share/doc/cookie/html/src"><span class="hs-identifier hs-var">setCookieHttpOnly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-comment">-- Not accessible from JavaScript</span><span>
</span><span id="line-318"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679740450"><span class="annot"><span class="annottext">expiryDate :: UTCTime
</span><a href="#local-6989586621679740450"><span class="hs-identifier hs-var hs-var">expiryDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-var">addUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="Auth.html#expiryDuration"><span class="hs-identifier hs-var">expiryDuration</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740452"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679740451"><span class="annot"><span class="annottext">cookieValue :: Text
</span><a href="#local-6989586621679740451"><span class="hs-identifier hs-var hs-var">cookieValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncodeSigner -&gt; JOSEHeader -&gt; JWTClaimsSet -&gt; Text
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.encodeSigned</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740454"><span class="hs-identifier hs-var">signer</span></a></span><span> </span><span class="annot"><span class="annottext">JOSEHeader
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">JWTClaimsSet
</span><a href="#local-6989586621679740448"><span class="hs-identifier hs-var">jwtClaims</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679740448"><span class="annot"><span class="annottext">jwtClaims :: JWTClaimsSet
</span><a href="#local-6989586621679740448"><span class="hs-identifier hs-var hs-var">jwtClaims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">JWTClaimsSet
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">exp :: Maybe IntDate
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.exp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Maybe IntDate
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.numericDate</span></a></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Maybe IntDate)
-&gt; NominalDiffTime -&gt; Maybe IntDate
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; NominalDiffTime
</span><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679740450"><span class="hs-identifier hs-var">expiryDate</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unregisteredClaims :: ClaimsMap
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.unregisteredClaims</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>                  </span><span class="annot"><span class="annottext">Map Text Value -&gt; ClaimsMap
</span><a href="../file:///nix/store/5h4g70fqzyd4kdk7fv7ga1q985fhvymk-jwt-lib-jwt-0.11.0-haddock-doc/share/doc/jwt/html/src"><span class="hs-identifier hs-var">JWT.ClaimsMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text Value -&gt; ClaimsMap) -&gt; Map Text Value -&gt; ClaimsMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-327"></span><span>                  </span><span class="annot"><span class="annottext">[(Text, Value)] -&gt; Map Text Value
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span>
</span><span id="line-328"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Auth.html#githubTokenClaim"><span class="hs-identifier hs-var">githubTokenClaim</span></a></span><span>
</span><span id="line-329"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value)
-&gt; (Token 'Github -&gt; Text) -&gt; Token 'Github -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github -&gt; Text
forall n. Newtype n =&gt; n -&gt; O n
</span><a href="../file:///nix/store/ndym3i5f1brfc2p8gl7xlxxvdlii09kc-newtype-generics-lib-newtype-generics-0.6.2-haddock-doc/share/doc/newtype-generics/html/src"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(Token 'Github -&gt; Value) -&gt; Token 'Github -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthToken 'Github -&gt; Token 'Github
forall (a :: TokenProvider). OAuthToken a -&gt; Token a
</span><a href="Auth.Types.html#oAuthTokenAccessToken"><span class="hs-identifier hs-var hs-var">oAuthTokenAccessToken</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthToken 'Github
</span><a href="#local-6989586621679740453"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span id="local-6989586621679740718"><span class="annot"><a href="Auth.html#getGists"><span class="hs-identifier hs-type">getGists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-334"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-335"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-336"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-337"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-338"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-339"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-340"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740718"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gist.html#Gist"><span class="hs-identifier hs-type">Gist</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-343"></span><span id="getGists"><span class="annot"><span class="annottext">getGists :: Maybe Text -&gt; m [Gist]
</span><a href="Auth.html#getGists"><span class="hs-identifier hs-var hs-var">getGists</span></a></span></span><span> </span><span id="local-6989586621679740443"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740443"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; (Token 'Github -&gt; ClientM [Gist]) -&gt; m [Gist]
forall (m :: * -&gt; *) a.
(MonadNow m, MonadLogger m, MonadError ServerError m, MonadWeb m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; (Token 'Github -&gt; ClientM a) -&gt; m a
</span><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-var">withGithubToken</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740443"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679740441"><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740441"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Token 'Github) -&gt; ClientM [Gist]
</span><a href="Gist.html#getGists"><span class="hs-identifier hs-var">Gist.getGists</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Token 'Github) -&gt; ClientM [Gist])
-&gt; Maybe (Token 'Github) -&gt; ClientM [Gist]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github -&gt; Maybe (Token 'Github)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740441"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621679740717"><span class="annot"><a href="Auth.html#createNewGist"><span class="hs-identifier hs-type">createNewGist</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-346"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-348"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-349"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-350"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-351"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-352"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gist.html#NewGist"><span class="hs-identifier hs-type">NewGist</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740717"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Gist.html#Gist"><span class="hs-identifier hs-type">Gist</span></a></span></span><span>
</span><span id="line-356"></span><span id="createNewGist"><span class="annot"><span class="annottext">createNewGist :: Maybe Text -&gt; NewGist -&gt; m Gist
</span><a href="Auth.html#createNewGist"><span class="hs-identifier hs-var hs-var">createNewGist</span></a></span></span><span> </span><span id="local-6989586621679740438"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740438"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679740437"><span class="annot"><span class="annottext">NewGist
</span><a href="#local-6989586621679740437"><span class="hs-identifier hs-var">newGist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; (Token 'Github -&gt; ClientM Gist) -&gt; m Gist
forall (m :: * -&gt; *) a.
(MonadNow m, MonadLogger m, MonadError ServerError m, MonadWeb m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; (Token 'Github -&gt; ClientM a) -&gt; m a
</span><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-var">withGithubToken</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740438"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679740436"><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740436"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Token 'Github) -&gt; NewGist -&gt; ClientM Gist
</span><a href="Gist.html#createNewGist"><span class="hs-identifier hs-var">Gist.createNewGist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token 'Github -&gt; Maybe (Token 'Github)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740436"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NewGist
</span><a href="#local-6989586621679740437"><span class="hs-identifier hs-var">newGist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span id="local-6989586621679740716"><span class="annot"><a href="Auth.html#getGist"><span class="hs-identifier hs-type">getGist</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-360"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-361"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-362"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-363"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-364"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-365"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-366"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gist.html#GistId"><span class="hs-identifier hs-type">GistId</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Gist.html#Gist"><span class="hs-identifier hs-type">Gist</span></a></span></span><span>
</span><span id="line-370"></span><span id="getGist"><span class="annot"><span class="annottext">getGist :: Maybe Text -&gt; GistId -&gt; m Gist
</span><a href="Auth.html#getGist"><span class="hs-identifier hs-var hs-var">getGist</span></a></span></span><span> </span><span id="local-6989586621679740433"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740433"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679740432"><span class="annot"><span class="annottext">GistId
</span><a href="#local-6989586621679740432"><span class="hs-identifier hs-var">gistId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; (Token 'Github -&gt; ClientM Gist) -&gt; m Gist
forall (m :: * -&gt; *) a.
(MonadNow m, MonadLogger m, MonadError ServerError m, MonadWeb m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; (Token 'Github -&gt; ClientM a) -&gt; m a
</span><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-var">withGithubToken</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740433"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679740431"><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740431"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Token 'Github) -&gt; GistId -&gt; ClientM Gist
</span><a href="Gist.html#getGist"><span class="hs-identifier hs-var">Gist.getGist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token 'Github -&gt; Maybe (Token 'Github)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740431"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GistId
</span><a href="#local-6989586621679740432"><span class="hs-identifier hs-var">gistId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621679740715"><span class="annot"><a href="Auth.html#updateGist"><span class="hs-identifier hs-type">updateGist</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-374"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-375"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-376"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-377"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-378"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-379"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-380"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gist.html#GistId"><span class="hs-identifier hs-type">GistId</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gist.html#NewGist"><span class="hs-identifier hs-type">NewGist</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Gist.html#Gist"><span class="hs-identifier hs-type">Gist</span></a></span></span><span>
</span><span id="line-385"></span><span id="updateGist"><span class="annot"><span class="annottext">updateGist :: Maybe Text -&gt; GistId -&gt; NewGist -&gt; m Gist
</span><a href="Auth.html#updateGist"><span class="hs-identifier hs-var hs-var">updateGist</span></a></span></span><span> </span><span id="local-6989586621679740428"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740428"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679740427"><span class="annot"><span class="annottext">GistId
</span><a href="#local-6989586621679740427"><span class="hs-identifier hs-var">gistId</span></a></span></span><span> </span><span id="local-6989586621679740426"><span class="annot"><span class="annottext">NewGist
</span><a href="#local-6989586621679740426"><span class="hs-identifier hs-var">newGist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; (Token 'Github -&gt; ClientM Gist) -&gt; m Gist
forall (m :: * -&gt; *) a.
(MonadNow m, MonadLogger m, MonadError ServerError m, MonadWeb m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; (Token 'Github -&gt; ClientM a) -&gt; m a
</span><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-var">withGithubToken</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740428"><span class="hs-identifier hs-var">header</span></a></span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679740425"><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740425"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Token 'Github) -&gt; GistId -&gt; NewGist -&gt; ClientM Gist
</span><a href="Gist.html#updateGist"><span class="hs-identifier hs-var">Gist.updateGist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token 'Github -&gt; Maybe (Token 'Github)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740425"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GistId
</span><a href="#local-6989586621679740427"><span class="hs-identifier hs-var">gistId</span></a></span><span> </span><span class="annot"><span class="annottext">NewGist
</span><a href="#local-6989586621679740426"><span class="hs-identifier hs-var">newGist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span id="local-6989586621679740746"><span id="local-6989586621679740748"><span class="annot"><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-type">withGithubToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-391"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-392"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-393"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-394"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-395"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-396"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-397"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Auth.Types.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Auth.Types.html#Github"><span class="hs-identifier hs-type">Github</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier hs-type">ClientM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740746"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740748"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740746"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-401"></span><span id="withGithubToken"><span class="annot"><span class="annottext">withGithubToken :: Maybe Text -&gt; (Token 'Github -&gt; ClientM a) -&gt; m a
</span><a href="Auth.html#withGithubToken"><span class="hs-identifier hs-var hs-var">withGithubToken</span></a></span></span><span> </span><span id="local-6989586621679740423"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740423"><span class="hs-identifier hs-var">cookieHeader</span></a></span></span><span> </span><span id="local-6989586621679740422"><span class="annot"><span class="annottext">Token 'Github -&gt; ClientM a
</span><a href="#local-6989586621679740422"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679740421"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679740421"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting BaseUrl Env BaseUrl -&gt; m BaseUrl
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GithubEndpoints -&gt; Const BaseUrl GithubEndpoints)
-&gt; Env -&gt; Const BaseUrl Env
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_1</span></a></span><span> </span><span class="annot"><span class="annottext">((GithubEndpoints -&gt; Const BaseUrl GithubEndpoints)
 -&gt; Env -&gt; Const BaseUrl Env)
-&gt; ((BaseUrl -&gt; Const BaseUrl BaseUrl)
    -&gt; GithubEndpoints -&gt; Const BaseUrl GithubEndpoints)
-&gt; Getting BaseUrl Env BaseUrl
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(BaseUrl -&gt; Const BaseUrl BaseUrl)
-&gt; GithubEndpoints -&gt; Const BaseUrl GithubEndpoints
Lens' GithubEndpoints BaseUrl
</span><a href="Auth.html#githubEndpointsApiBaseUrl"><span class="hs-identifier hs-var">githubEndpointsApiBaseUrl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679740420"><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740420"><span class="hs-identifier hs-var">jwtSignature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting EncodeSigner Env EncodeSigner -&gt; m EncodeSigner
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const EncodeSigner Config)
-&gt; Env -&gt; Const EncodeSigner Env
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const EncodeSigner Config)
 -&gt; Env -&gt; Const EncodeSigner Env)
-&gt; ((EncodeSigner -&gt; Const EncodeSigner EncodeSigner)
    -&gt; Config -&gt; Const EncodeSigner Config)
-&gt; Getting EncodeSigner Env EncodeSigner
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(EncodeSigner -&gt; Const EncodeSigner EncodeSigner)
-&gt; Config -&gt; Const EncodeSigner Config
Lens' Config EncodeSigner
</span><a href="Auth.html#configJWTSignature"><span class="hs-identifier hs-var">configJWTSignature</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Initialising connection manager.&quot;</span></span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679740419"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679740419"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Manager
forall (m :: * -&gt; *). MonadWeb m =&gt; m Manager
</span><a href="Control.Monad.Web.html#makeManager"><span class="hs-identifier hs-var">makeManager</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679740418"><span class="annot"><span class="annottext">clientEnv :: ClientEnv
</span><a href="#local-6989586621679740418"><span class="hs-identifier hs-var hs-var">clientEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ClientEnv
</span><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier hs-var">mkClientEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679740419"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621679740421"><span class="hs-identifier hs-var">baseUrl</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679740417"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740417"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m NominalDiffTime
forall (m :: * -&gt; *). MonadNow m =&gt; m NominalDiffTime
</span><a href="Control.Monad.Now.html#getPOSIXTime"><span class="hs-identifier hs-var">getPOSIXTime</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Extracting token.&quot;</span></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EncodeSigner
-&gt; NominalDiffTime -&gt; Maybe Text -&gt; Either Text (Token 'Github)
</span><a href="Auth.html#extractGithubToken"><span class="hs-identifier hs-var">extractGithubToken</span></a></span><span> </span><span class="annot"><span class="annottext">EncodeSigner
</span><a href="#local-6989586621679740420"><span class="hs-identifier hs-var">jwtSignature</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679740417"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740423"><span class="hs-identifier hs-var">cookieHeader</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679740416"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740416"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logErrorN</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-412"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Failed to extract github token at step: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679740416"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><span class="annottext">ServerError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err401</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679740415"><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740415"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Making github request with token.&quot;</span></span><span>
</span><span id="line-416"></span><span>            </span><span id="local-6989586621679740414"><span class="annot"><span class="annottext">Either ClientError a
</span><a href="#local-6989586621679740414"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either ClientError a) -&gt; m (Either ClientError a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either ClientError a) -&gt; m (Either ClientError a))
-&gt; IO (Either ClientError a) -&gt; m (Either ClientError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a))
-&gt; ClientEnv -&gt; ClientM a -&gt; IO (Either ClientError a)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
forall a. ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
</span><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier hs-var">runClientM</span></a></span><span> </span><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621679740418"><span class="hs-identifier hs-var">clientEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientM a -&gt; IO (Either ClientError a))
-&gt; ClientM a -&gt; IO (Either ClientError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github -&gt; ClientM a
</span><a href="#local-6989586621679740422"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Token 'Github
</span><a href="#local-6989586621679740415"><span class="hs-identifier hs-var">token</span></a></span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ClientError a
</span><a href="#local-6989586621679740414"><span class="hs-identifier hs-var">response</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-418"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier hs-type">FailureResponse</span></a></span><span> </span><span class="annot"><span class="annottext">RequestF () (BaseUrl, ByteString)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679740412"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679740412"><span class="hs-identifier hs-var">failureResponse</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Response -&gt; Status
forall a. ResponseF a -&gt; Status
</span><a href="../file:///nix/store/bp0ml9hvqnwczc48023rn371h6pzz2r6-servant-client-core-lib-servant-client-core-0.18.3-haddock-doc/share/doc/servant-client-core/html/src"><span class="hs-identifier hs-var hs-var">responseStatusCode</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679740412"><span class="hs-identifier hs-var">failureResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../file:///nix/store/l4lfxjil1m4gxl7vxqznrxkzn3ibjqvx-http-types-lib-http-types-0.12.3-haddock-doc/share/doc/http-types/html/src"><span class="hs-identifier hs-var">status404</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-420"></span><span>                        </span><span class="annot"><span class="annottext">ServerError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err404</span></a></span><span>
</span><span id="line-421"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679740411"><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621679740411"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>                    </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logErrorN</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-423"></span><span>                        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Failed to read github endpoint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ClientError -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621679740411"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-424"></span><span>                    </span><span class="annot"><span class="annottext">ServerError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span>
</span><span id="line-425"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679740410"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679740410"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>                  </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadLogger m =&gt; Text -&gt; m ()
</span><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-var">logDebugN</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Github request successful.&quot;</span></span><span>
</span><span id="line-427"></span><span>                  </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679740410"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span id="local-6989586621679740409"><span class="annot"><a href="Auth.html#server"><span class="hs-identifier hs-type">server</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-430"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Now.html#MonadNow"><span class="hs-identifier hs-type">MonadNow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-431"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Web.html#MonadWeb"><span class="hs-identifier hs-type">MonadWeb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-432"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2asw7plc1yllcl4zg8wsh6r9qjcajryd-monad-logger-lib-monad-logger-0.3.37-haddock-doc/share/doc/monad-logger/html/src"><span class="hs-identifier hs-type">MonadLogger</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-433"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-435"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Auth.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-436"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerT</span></a></span><span> </span><span class="annot"><a href="Auth.html#API"><span class="hs-identifier hs-type">API</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740409"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-438"></span><span id="server"><span class="annot"><span class="annottext">server :: ServerT API m
</span><a href="Auth.html#server"><span class="hs-identifier hs-var hs-var">server</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; m AuthStatus
forall (m :: * -&gt; *).
(MonadNow m, MonadLogger m, MonadReader Env m) =&gt;
Maybe Text -&gt; m AuthStatus
</span><a href="Auth.html#authStatus"><span class="hs-identifier hs-var">authStatus</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; m AuthStatus)
-&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent)
-&gt; (Maybe Text -&gt; m AuthStatus)
   :&lt;|&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent)
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (Headers '[Header &quot;Location&quot; Text] NoContent)
forall (m :: * -&gt; *).
(MonadLogger m, MonadReader Env m) =&gt;
m (Headers '[Header &quot;Location&quot; Text] NoContent)
</span><a href="Auth.html#githubRedirect"><span class="hs-identifier hs-var">githubRedirect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; m AuthStatus)
 :&lt;|&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent))
-&gt; (Maybe Text
    -&gt; m [Gist]
       :&lt;|&gt; ((NewGist -&gt; m Gist)
             :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist))))
-&gt; ((Maybe Text -&gt; m AuthStatus)
    :&lt;|&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent))
   :&lt;|&gt; (Maybe Text
         -&gt; m [Gist]
            :&lt;|&gt; ((NewGist -&gt; m Gist)
                  :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist))))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span>
</span><span id="line-440"></span><span>     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679740408"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740408"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>          </span><span class="annot"><span class="annottext">Maybe Text -&gt; m [Gist]
forall (m :: * -&gt; *).
(MonadNow m, MonadLogger m, MonadWeb m, MonadError ServerError m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; m [Gist]
</span><a href="Auth.html#getGists"><span class="hs-identifier hs-var">getGists</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740408"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">m [Gist]
-&gt; ((NewGist -&gt; m Gist)
    :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist)))
-&gt; m [Gist]
   :&lt;|&gt; ((NewGist -&gt; m Gist)
         :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist)))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; NewGist -&gt; m Gist
forall (m :: * -&gt; *).
(MonadNow m, MonadLogger m, MonadWeb m, MonadError ServerError m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; NewGist -&gt; m Gist
</span><a href="Auth.html#createNewGist"><span class="hs-identifier hs-var">createNewGist</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740408"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">(NewGist -&gt; m Gist)
-&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist))
-&gt; (NewGist -&gt; m Gist)
   :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; GistId -&gt; m Gist
forall (m :: * -&gt; *).
(MonadNow m, MonadLogger m, MonadWeb m, MonadError ServerError m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; GistId -&gt; m Gist
</span><a href="Auth.html#getGist"><span class="hs-identifier hs-var">getGist</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740408"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">(GistId -&gt; m Gist)
-&gt; (GistId -&gt; NewGist -&gt; m Gist)
-&gt; (GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist)
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span>
</span><span id="line-442"></span><span>          </span><span class="annot"><span class="annottext">Maybe Text -&gt; GistId -&gt; NewGist -&gt; m Gist
forall (m :: * -&gt; *).
(MonadNow m, MonadLogger m, MonadWeb m, MonadError ServerError m,
 MonadIO m, MonadReader Env m) =&gt;
Maybe Text -&gt; GistId -&gt; NewGist -&gt; m Gist
</span><a href="Auth.html#updateGist"><span class="hs-identifier hs-var">updateGist</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679740408"><span class="hs-identifier hs-var">header</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Maybe Text -&gt; m AuthStatus)
  :&lt;|&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent))
 :&lt;|&gt; (Maybe Text
       -&gt; m [Gist]
          :&lt;|&gt; ((NewGist -&gt; m Gist)
                :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist)))))
-&gt; (Maybe OAuthCode
    -&gt; m (Headers
            '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
            NoContent))
-&gt; (((Maybe Text -&gt; m AuthStatus)
     :&lt;|&gt; m (Headers '[Header &quot;Location&quot; Text] NoContent))
    :&lt;|&gt; (Maybe Text
          -&gt; m [Gist]
             :&lt;|&gt; ((NewGist -&gt; m Gist)
                   :&lt;|&gt; ((GistId -&gt; m Gist) :&lt;|&gt; (GistId -&gt; NewGist -&gt; m Gist)))))
   :&lt;|&gt; (Maybe OAuthCode
         -&gt; m (Headers
                 '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text]
                 NoContent))
forall a b. a -&gt; b -&gt; a :&lt;|&gt; b
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-operator hs-var">:&lt;|&gt;</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><span class="annottext">Maybe OAuthCode
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
forall (m :: * -&gt; *).
(MonadLogger m, MonadWeb m, MonadError ServerError m, MonadNow m,
 MonadReader Env m) =&gt;
Maybe OAuthCode
-&gt; m (Headers
        '[Header &quot;Set-Cookie&quot; SetCookie, Header &quot;Location&quot; Text] NoContent)
</span><a href="Auth.html#githubCallback"><span class="hs-identifier hs-var">githubCallback</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span id="local-6989586621679740844"><span class="annot"><a href="Auth.html#showText"><span class="hs-identifier hs-type">showText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679740844"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679740844"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span></span><span>
</span><span id="line-446"></span><span id="showText"><span class="annot"><span class="annottext">showText :: a -&gt; Text
</span><a href="Auth.html#showText"><span class="hs-identifier hs-var hs-var">showText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">Text.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (a -&gt; String) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-447"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Playground.Interpreter.Util</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Playground.Interpreter.Util.html#stage"><span class="hs-identifier">stage</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Interpreter.Util.html#renderInstanceTrace"><span class="hs-identifier">renderInstanceTrace</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier">Control.Foldl</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Traversal'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">preview</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">run</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">eitherDecode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/snd5q6v3qrq7cdxpn9nlwg98vvy50j53-data-default-lib-data-default-0.7.1.1-haddock-doc/share/doc/data-default/html/src"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Playground.Types.html"><span class="hs-identifier">Playground.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#ContractCall"><span class="hs-identifier">ContractCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#AddBlocks"><span class="hs-identifier">AddBlocks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#AddBlocksUntil"><span class="hs-identifier">AddBlocksUntil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#CallEndpoint"><span class="hs-identifier">CallEndpoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#PayToWallet"><span class="hs-identifier">PayToWallet</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#EvaluationResult"><span class="hs-identifier">EvaluationResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                         </span><span class="annot"><a href="Playground.Types.html#Expression"><span class="hs-identifier">Expression</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#FunctionSchema"><span class="hs-identifier">FunctionSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#FunctionSchema"><span class="hs-identifier">FunctionSchema</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#PlaygroundError"><span class="hs-identifier">PlaygroundError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#JsonDecodingError"><span class="hs-identifier">JsonDecodingError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#OtherError"><span class="hs-identifier">OtherError</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                         </span><span class="annot"><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier">SimulatorWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier">SimulatorWallet</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#amount"><span class="hs-identifier">amount</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#argument"><span class="hs-identifier">argument</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#argumentValues"><span class="hs-identifier">argumentValues</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#caller"><span class="hs-identifier">caller</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#decodingError"><span class="hs-identifier">decodingError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>                         </span><span class="annot"><a href="Playground.Types.html#endpointDescription"><span class="hs-identifier">endpointDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#expected"><span class="hs-identifier">expected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#input"><span class="hs-identifier">input</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#recipient"><span class="hs-identifier">recipient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#sender"><span class="hs-identifier">sender</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#simulatorWalletWallet"><span class="hs-identifier">simulatorWalletWallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Playground.Types.html"><span class="hs-identifier">Playground.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Contract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Contract</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractInstanceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace.Emulator.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorRuntimeError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorJSONDecodingError</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">_ContractLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>                                    </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">_ReceiveEndpointCall</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">cilMessage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace.Playground</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">PlaygroundTrace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">runPlaygroundStream</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">walletInstanceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace.Playground</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace.Playground</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trace</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">defaultLayoutOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">layoutPretty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">vsep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter.Render.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">renderStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2v7aw0qgl2v0lwasqg0zsrzfb9jxmbfn-streaming-lib-streaming-0.2.3.1-haddock-doc/share/doc/streaming/html/src"><span class="hs-identifier">Streaming.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2v7aw0qgl2v0lwasqg0zsrzfb9jxmbfn-streaming-lib-streaming-0.2.3.1-haddock-doc/share/doc/streaming/html/src"><span class="hs-identifier">fst'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Folds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorEventFoldM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Folds</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Folds</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.MultiAgent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorEvent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">chainEvent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">eteEvent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">instanceEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">foldEmulatorStreamM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">WalletNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">fromWalletNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">mockWalletPaymentPubKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EndpointDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">getEndpointDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Unfortunately any uncaught errors in the interpreter kill the</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- thread that is running it rather than returning the error. This</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- means we need to handle all expected errors in the expression we</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- are interpreting. This gets a little tricky because we have to</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- decode JSON inside the interpreter (since we don't have access to</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- it's type outside) so we need to wrap the @apply functions up in</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- something that can throw errors.</span><span>
</span><span id="line-65"></span><span id="local-6989586621679739670"><span class="annot"><a href="Playground.Interpreter.Util.html#playgroundDecode"><span class="hs-identifier hs-type">playgroundDecode</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-66"></span><span>       </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739670"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Playground.Types.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739670"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-67"></span><span id="playgroundDecode"><span class="annot"><span class="annottext">playgroundDecode :: String -&gt; ByteString -&gt; Either PlaygroundError a
</span><a href="Playground.Interpreter.Util.html#playgroundDecode"><span class="hs-identifier hs-var hs-var">playgroundDecode</span></a></span></span><span> </span><span id="local-6989586621679739555"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739555"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span id="local-6989586621679739554"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739554"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; PlaygroundError)
-&gt; Either String a -&gt; Either PlaygroundError a
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679739553"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739553"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-70"></span><span>             </span><span class="annot"><span class="annottext">JsonDecodingError :: String -&gt; String -&gt; String -&gt; PlaygroundError
</span><a href="Playground.Types.html#JsonDecodingError"><span class="hs-identifier hs-type">JsonDecodingError</span></a></span><span>
</span><span id="line-71"></span><span>                 </span><span class="hs-special">{</span><span class="annot"><span class="annottext">String
expected :: String
expected :: String
</span><a href="#local-6989586621679739555"><span class="hs-identifier hs-var hs-var">expected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">input :: String
</span><a href="Playground.Types.html#input"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739554"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decodingError :: String
</span><a href="Playground.Types.html#decodingError"><span class="hs-identifier hs-var">decodingError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739553"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; Either PlaygroundError a)
-&gt; Either String a -&gt; Either PlaygroundError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Either String a
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">eitherDecode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739554"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679739676"><span class="annot"><a href="Playground.Interpreter.Util.html#funds"><span class="hs-identifier hs-type">funds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">WalletNumber</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEventFoldM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739676"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">WalletNumber</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-75"></span><span id="funds"><span class="annot"><span class="annottext">funds :: [WalletNumber] -&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
</span><a href="Playground.Interpreter.Util.html#funds"><span class="hs-identifier hs-var hs-var">funds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent (Map WalletNumber Value)
-&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
forall (m :: * -&gt; *) a b. Monad m =&gt; Fold a b -&gt; FoldM m a b
</span><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier hs-var">L.generalize</span></a></span><span> </span><span class="annot"><span class="annottext">(Fold EmulatorEvent (Map WalletNumber Value)
 -&gt; EmulatorEventFoldM effs (Map WalletNumber Value))
-&gt; ([WalletNumber] -&gt; Fold EmulatorEvent (Map WalletNumber Value))
-&gt; [WalletNumber]
-&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map WalletNumber (Fold EmulatorEvent Value)
-&gt; Fold EmulatorEvent (Map WalletNumber Value)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sequenceA</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WalletNumber (Fold EmulatorEvent Value)
 -&gt; Fold EmulatorEvent (Map WalletNumber Value))
-&gt; ([WalletNumber] -&gt; Map WalletNumber (Fold EmulatorEvent Value))
-&gt; [WalletNumber]
-&gt; Fold EmulatorEvent (Map WalletNumber Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(WalletNumber, Fold EmulatorEvent Value)]
-&gt; Map WalletNumber (Fold EmulatorEvent Value)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(WalletNumber, Fold EmulatorEvent Value)]
 -&gt; Map WalletNumber (Fold EmulatorEvent Value))
-&gt; ([WalletNumber] -&gt; [(WalletNumber, Fold EmulatorEvent Value)])
-&gt; [WalletNumber]
-&gt; Map WalletNumber (Fold EmulatorEvent Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletNumber -&gt; (WalletNumber, Fold EmulatorEvent Value))
-&gt; [WalletNumber] -&gt; [(WalletNumber, Fold EmulatorEvent Value)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679739546"><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739546"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739546"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Fold EmulatorEvent Value
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Folds.walletFunds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739546"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679739544"><span class="annot"><a href="Playground.Interpreter.Util.html#fees"><span class="hs-identifier hs-type">fees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">WalletNumber</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEventFoldM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739544"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">WalletNumber</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-78"></span><span id="fees"><span class="annot"><span class="annottext">fees :: [WalletNumber] -&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
</span><a href="Playground.Interpreter.Util.html#fees"><span class="hs-identifier hs-var hs-var">fees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent (Map WalletNumber Value)
-&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
forall (m :: * -&gt; *) a b. Monad m =&gt; Fold a b -&gt; FoldM m a b
</span><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier hs-var">L.generalize</span></a></span><span> </span><span class="annot"><span class="annottext">(Fold EmulatorEvent (Map WalletNumber Value)
 -&gt; EmulatorEventFoldM effs (Map WalletNumber Value))
-&gt; ([WalletNumber] -&gt; Fold EmulatorEvent (Map WalletNumber Value))
-&gt; [WalletNumber]
-&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map WalletNumber (Fold EmulatorEvent Value)
-&gt; Fold EmulatorEvent (Map WalletNumber Value)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sequenceA</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WalletNumber (Fold EmulatorEvent Value)
 -&gt; Fold EmulatorEvent (Map WalletNumber Value))
-&gt; ([WalletNumber] -&gt; Map WalletNumber (Fold EmulatorEvent Value))
-&gt; [WalletNumber]
-&gt; Fold EmulatorEvent (Map WalletNumber Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(WalletNumber, Fold EmulatorEvent Value)]
-&gt; Map WalletNumber (Fold EmulatorEvent Value)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(WalletNumber, Fold EmulatorEvent Value)]
 -&gt; Map WalletNumber (Fold EmulatorEvent Value))
-&gt; ([WalletNumber] -&gt; [(WalletNumber, Fold EmulatorEvent Value)])
-&gt; [WalletNumber]
-&gt; Map WalletNumber (Fold EmulatorEvent Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletNumber -&gt; (WalletNumber, Fold EmulatorEvent Value))
-&gt; [WalletNumber] -&gt; [(WalletNumber, Fold EmulatorEvent Value)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679739542"><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739542"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739542"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Fold EmulatorEvent Value
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Folds.walletFees</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739542"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679739682"><span class="annot"><a href="Playground.Interpreter.Util.html#renderInstanceTrace"><span class="hs-identifier hs-type">renderInstanceTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceTag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEventFoldM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739682"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span></span><span>
</span><span id="line-81"></span><span id="renderInstanceTrace"><span class="annot"><span class="annottext">renderInstanceTrace :: [ContractInstanceTag] -&gt; EmulatorEventFoldM effs Text
</span><a href="Playground.Interpreter.Util.html#renderInstanceTrace"><span class="hs-identifier hs-var hs-var">renderInstanceTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">Fold EmulatorEvent Text -&gt; EmulatorEventFoldM effs Text
forall (m :: * -&gt; *) a b. Monad m =&gt; Fold a b -&gt; FoldM m a b
</span><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier hs-var">L.generalize</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">(Fold EmulatorEvent Text -&gt; EmulatorEventFoldM effs Text)
-&gt; ([ContractInstanceTag] -&gt; Fold EmulatorEvent Text)
-&gt; [ContractInstanceTag]
-&gt; EmulatorEventFoldM effs Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([[EmulatorTimeEvent ContractInstanceLog]] -&gt; Text)
-&gt; Fold EmulatorEvent [[EmulatorTimeEvent ContractInstanceLog]]
-&gt; Fold EmulatorEvent Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimpleDocStream Any -&gt; Text
forall ann. SimpleDocStream ann -&gt; Text
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">renderStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(SimpleDocStream Any -&gt; Text)
-&gt; ([[EmulatorTimeEvent ContractInstanceLog]]
    -&gt; SimpleDocStream Any)
-&gt; [[EmulatorTimeEvent ContractInstanceLog]]
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutOptions -&gt; Doc Any -&gt; SimpleDocStream Any
forall ann. LayoutOptions -&gt; Doc ann -&gt; SimpleDocStream ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">layoutPretty</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutOptions
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">defaultLayoutOptions</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; SimpleDocStream Any)
-&gt; ([[EmulatorTimeEvent ContractInstanceLog]] -&gt; Doc Any)
-&gt; [[EmulatorTimeEvent ContractInstanceLog]]
-&gt; SimpleDocStream Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc Any] -&gt; Doc Any
forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">vsep</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc Any] -&gt; Doc Any)
-&gt; ([[EmulatorTimeEvent ContractInstanceLog]] -&gt; [Doc Any])
-&gt; [[EmulatorTimeEvent ContractInstanceLog]]
-&gt; Doc Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([EmulatorTimeEvent ContractInstanceLog] -&gt; Doc Any)
-&gt; [[EmulatorTimeEvent ContractInstanceLog]] -&gt; [Doc Any]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[EmulatorTimeEvent ContractInstanceLog] -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">(Fold EmulatorEvent [[EmulatorTimeEvent ContractInstanceLog]]
 -&gt; Fold EmulatorEvent Text)
-&gt; ([ContractInstanceTag]
    -&gt; Fold EmulatorEvent [[EmulatorTimeEvent ContractInstanceLog]])
-&gt; [ContractInstanceTag]
-&gt; Fold EmulatorEvent Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceTag
 -&gt; Fold EmulatorEvent [EmulatorTimeEvent ContractInstanceLog])
-&gt; [ContractInstanceTag]
-&gt; Fold EmulatorEvent [[EmulatorTimeEvent ContractInstanceLog]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceTag
-&gt; Fold EmulatorEvent [EmulatorTimeEvent ContractInstanceLog]
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Folds.instanceLog</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Events that are of interest to users of the Playground</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Playground.Interpreter.Util.html#isInteresting"><span class="hs-identifier hs-type">isInteresting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-88"></span><span id="isInteresting"><span class="annot"><span class="annottext">isInteresting :: EmulatorEvent -&gt; Bool
</span><a href="Playground.Interpreter.Util.html#isInteresting"><span class="hs-identifier hs-var hs-var">isInteresting</span></a></span></span><span> </span><span id="local-6989586621679739537"><span class="annot"><span class="annottext">EmulatorEvent
</span><a href="#local-6989586621679739537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739709"><span id="local-6989586621679739710"><span class="annot"><a href="#local-6989586621679739536"><span class="hs-identifier hs-type">matches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Traversal'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739710"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739709"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679739710"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-90"></span><span>        </span><span id="local-6989586621679739536"><span class="annot"><span class="annottext">matches :: Traversal' s a -&gt; s -&gt; Bool
</span><a href="#local-6989586621679739536"><span class="hs-identifier hs-var hs-var">matches</span></a></span></span><span> </span><span id="local-6989586621679739535"><span class="annot"><span class="annottext">Traversal' s a
</span><a href="#local-6989586621679739535"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Bool) -&gt; (s -&gt; Maybe a) -&gt; s -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (First a) s a -&gt; s -&gt; Maybe a
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (First a) s a
Traversal' s a
</span><a href="#local-6989586621679739535"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Traversal' EmulatorEvent ChainEvent -&gt; EmulatorEvent -&gt; Bool
forall s a. Traversal' s a -&gt; s -&gt; Bool
</span><a href="#local-6989586621679739536"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; EmulatorEvent -&gt; f EmulatorEvent
forall e1 e2.
Lens (EmulatorTimeEvent e1) (EmulatorTimeEvent e2) e1 e2
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">eteEvent</span></a></span><span> </span><span class="annot"><span class="annottext">((EmulatorEvent' -&gt; f EmulatorEvent')
 -&gt; EmulatorEvent -&gt; f EmulatorEvent)
-&gt; ((ChainEvent -&gt; f ChainEvent)
    -&gt; EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; (ChainEvent -&gt; f ChainEvent)
-&gt; EmulatorEvent
-&gt; f EmulatorEvent
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainEvent -&gt; f ChainEvent) -&gt; EmulatorEvent' -&gt; f EmulatorEvent'
Prism' EmulatorEvent' ChainEvent
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">chainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent
</span><a href="#local-6989586621679739537"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Traversal' EmulatorEvent (EndpointDescription, Value)
-&gt; EmulatorEvent -&gt; Bool
forall s a. Traversal' s a -&gt; s -&gt; Bool
</span><a href="#local-6989586621679739536"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; EmulatorEvent -&gt; f EmulatorEvent
forall e1 e2.
Lens (EmulatorTimeEvent e1) (EmulatorTimeEvent e2) e1 e2
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">eteEvent</span></a></span><span> </span><span class="annot"><span class="annottext">((EmulatorEvent' -&gt; f EmulatorEvent')
 -&gt; EmulatorEvent -&gt; f EmulatorEvent)
-&gt; (((EndpointDescription, Value)
     -&gt; f (EndpointDescription, Value))
    -&gt; EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; ((EndpointDescription, Value) -&gt; f (EndpointDescription, Value))
-&gt; EmulatorEvent
-&gt; f EmulatorEvent
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; EmulatorEvent' -&gt; f EmulatorEvent'
Prism' EmulatorEvent' ContractInstanceLog
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">instanceEvent</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractInstanceLog -&gt; f ContractInstanceLog)
 -&gt; EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; (((EndpointDescription, Value)
     -&gt; f (EndpointDescription, Value))
    -&gt; ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; ((EndpointDescription, Value) -&gt; f (EndpointDescription, Value))
-&gt; EmulatorEvent'
-&gt; f EmulatorEvent'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceMsg -&gt; f ContractInstanceMsg)
-&gt; ContractInstanceLog -&gt; f ContractInstanceLog
Lens' ContractInstanceLog ContractInstanceMsg
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">cilMessage</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractInstanceMsg -&gt; f ContractInstanceMsg)
 -&gt; ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; (((EndpointDescription, Value)
     -&gt; f (EndpointDescription, Value))
    -&gt; ContractInstanceMsg -&gt; f ContractInstanceMsg)
-&gt; ((EndpointDescription, Value) -&gt; f (EndpointDescription, Value))
-&gt; ContractInstanceLog
-&gt; f ContractInstanceLog
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((EndpointDescription, Value) -&gt; f (EndpointDescription, Value))
-&gt; ContractInstanceMsg -&gt; f ContractInstanceMsg
Prism' ContractInstanceMsg (EndpointDescription, Value)
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">_ReceiveEndpointCall</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent
</span><a href="#local-6989586621679739537"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Traversal' EmulatorEvent Value -&gt; EmulatorEvent -&gt; Bool
forall s a. Traversal' s a -&gt; s -&gt; Bool
</span><a href="#local-6989586621679739536"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; EmulatorEvent -&gt; f EmulatorEvent
forall e1 e2.
Lens (EmulatorTimeEvent e1) (EmulatorTimeEvent e2) e1 e2
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">eteEvent</span></a></span><span> </span><span class="annot"><span class="annottext">((EmulatorEvent' -&gt; f EmulatorEvent')
 -&gt; EmulatorEvent -&gt; f EmulatorEvent)
-&gt; ((Value -&gt; f Value) -&gt; EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; (Value -&gt; f Value)
-&gt; EmulatorEvent
-&gt; f EmulatorEvent
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; EmulatorEvent' -&gt; f EmulatorEvent'
Prism' EmulatorEvent' ContractInstanceLog
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">instanceEvent</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractInstanceLog -&gt; f ContractInstanceLog)
 -&gt; EmulatorEvent' -&gt; f EmulatorEvent')
-&gt; ((Value -&gt; f Value)
    -&gt; ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; (Value -&gt; f Value)
-&gt; EmulatorEvent'
-&gt; f EmulatorEvent'
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceMsg -&gt; f ContractInstanceMsg)
-&gt; ContractInstanceLog -&gt; f ContractInstanceLog
Lens' ContractInstanceLog ContractInstanceMsg
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">cilMessage</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractInstanceMsg -&gt; f ContractInstanceMsg)
 -&gt; ContractInstanceLog -&gt; f ContractInstanceLog)
-&gt; ((Value -&gt; f Value)
    -&gt; ContractInstanceMsg -&gt; f ContractInstanceMsg)
-&gt; (Value -&gt; f Value)
-&gt; ContractInstanceLog
-&gt; f ContractInstanceLog
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; f Value) -&gt; ContractInstanceMsg -&gt; f ContractInstanceMsg
Prism' ContractInstanceMsg Value
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">_ContractLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent
</span><a href="#local-6989586621679739537"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621679739648"><span class="annot"><a href="Playground.Interpreter.Util.html#evaluationResultFold"><span class="hs-identifier hs-type">evaluationResultFold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">WalletNumber</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEventFoldM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739648"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Playground.Types.html#EvaluationResult"><span class="hs-identifier hs-type">EvaluationResult</span></a></span></span><span>
</span><span id="line-96"></span><span id="evaluationResultFold"><span class="annot"><span class="annottext">evaluationResultFold :: [WalletNumber] -&gt; EmulatorEventFoldM effs EvaluationResult
</span><a href="Playground.Interpreter.Util.html#evaluationResultFold"><span class="hs-identifier hs-var hs-var">evaluationResultFold</span></a></span></span><span> </span><span id="local-6989586621679739532"><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739532"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739531"><span class="annot"><span class="annottext">pkh :: WalletNumber -&gt; (PaymentPubKeyHash, WalletNumber)
</span><a href="#local-6989586621679739531"><span class="hs-identifier hs-var hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679739530"><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739530"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; PaymentPubKeyHash
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">mockWalletPaymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; PaymentPubKeyHash) -&gt; Wallet -&gt; PaymentPubKeyHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739530"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739530"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[[AnnotatedTx]]
-&gt; [EmulatorEvent]
-&gt; Text
-&gt; [SimulatorWallet]
-&gt; [SimulatorWallet]
-&gt; [(PaymentPubKeyHash, WalletNumber)]
-&gt; EvaluationResult
</span><a href="Playground.Types.html#EvaluationResult"><span class="hs-identifier hs-var">Playground.Types.EvaluationResult</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="annot"><span class="annottext">([[AnnotatedTx]]
 -&gt; [EmulatorEvent]
 -&gt; Text
 -&gt; [SimulatorWallet]
 -&gt; [SimulatorWallet]
 -&gt; [(PaymentPubKeyHash, WalletNumber)]
 -&gt; EvaluationResult)
-&gt; FoldM (Eff effs) EmulatorEvent [[AnnotatedTx]]
-&gt; FoldM
     (Eff effs)
     EmulatorEvent
     ([EmulatorEvent]
      -&gt; Text
      -&gt; [SimulatorWallet]
      -&gt; [SimulatorWallet]
      -&gt; [(PaymentPubKeyHash, WalletNumber)]
      -&gt; EvaluationResult)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent [[AnnotatedTx]]
-&gt; FoldM (Eff effs) EmulatorEvent [[AnnotatedTx]]
forall (m :: * -&gt; *) a b. Monad m =&gt; Fold a b -&gt; FoldM m a b
</span><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier hs-var">L.generalize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[AnnotatedTx]] -&gt; [[AnnotatedTx]]
forall a. [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">([[AnnotatedTx]] -&gt; [[AnnotatedTx]])
-&gt; Fold EmulatorEvent [[AnnotatedTx]]
-&gt; Fold EmulatorEvent [[AnnotatedTx]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent [[AnnotatedTx]]
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Folds.annotatedBlockchain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>            </span><span class="annot"><span class="annottext">FoldM
  (Eff effs)
  EmulatorEvent
  ([EmulatorEvent]
   -&gt; Text
   -&gt; [SimulatorWallet]
   -&gt; [SimulatorWallet]
   -&gt; [(PaymentPubKeyHash, WalletNumber)]
   -&gt; EvaluationResult)
-&gt; FoldM (Eff effs) EmulatorEvent [EmulatorEvent]
-&gt; FoldM
     (Eff effs)
     EmulatorEvent
     (Text
      -&gt; [SimulatorWallet]
      -&gt; [SimulatorWallet]
      -&gt; [(PaymentPubKeyHash, WalletNumber)]
      -&gt; EvaluationResult)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent [EmulatorEvent]
-&gt; FoldM (Eff effs) EmulatorEvent [EmulatorEvent]
forall (m :: * -&gt; *) a b. Monad m =&gt; Fold a b -&gt; FoldM m a b
</span><a href="../file:///nix/store/x2wlc4pzn9czb22sf65hrxm8lv8917aj-foldl-lib-foldl-1.4.13-haddock-doc/share/doc/foldl/html/src"><span class="hs-identifier hs-var">L.generalize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; Bool) -&gt; [EmulatorEvent] -&gt; [EmulatorEvent]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; Bool
</span><a href="Playground.Interpreter.Util.html#isInteresting"><span class="hs-identifier hs-var">isInteresting</span></a></span><span> </span><span class="annot"><span class="annottext">([EmulatorEvent] -&gt; [EmulatorEvent])
-&gt; Fold EmulatorEvent [EmulatorEvent]
-&gt; Fold EmulatorEvent [EmulatorEvent]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fold EmulatorEvent [EmulatorEvent]
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Folds.emulatorLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="annottext">FoldM
  (Eff effs)
  EmulatorEvent
  (Text
   -&gt; [SimulatorWallet]
   -&gt; [SimulatorWallet]
   -&gt; [(PaymentPubKeyHash, WalletNumber)]
   -&gt; EvaluationResult)
-&gt; FoldM (Eff effs) EmulatorEvent Text
-&gt; FoldM
     (Eff effs)
     EmulatorEvent
     ([SimulatorWallet]
      -&gt; [SimulatorWallet]
      -&gt; [(PaymentPubKeyHash, WalletNumber)]
      -&gt; EvaluationResult)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[ContractInstanceTag] -&gt; FoldM (Eff effs) EmulatorEvent Text
forall (effs :: [* -&gt; *]).
[ContractInstanceTag] -&gt; EmulatorEventFoldM effs Text
</span><a href="Playground.Interpreter.Util.html#renderInstanceTrace"><span class="hs-identifier hs-var">renderInstanceTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; ContractInstanceTag
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">walletInstanceTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; ContractInstanceTag)
-&gt; (WalletNumber -&gt; Wallet) -&gt; WalletNumber -&gt; ContractInstanceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletNumber -&gt; ContractInstanceTag)
-&gt; [WalletNumber] -&gt; [ContractInstanceTag]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739532"><span class="hs-identifier hs-var">wallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><span class="annottext">FoldM
  (Eff effs)
  EmulatorEvent
  ([SimulatorWallet]
   -&gt; [SimulatorWallet]
   -&gt; [(PaymentPubKeyHash, WalletNumber)]
   -&gt; EvaluationResult)
-&gt; FoldM (Eff effs) EmulatorEvent [SimulatorWallet]
-&gt; FoldM
     (Eff effs)
     EmulatorEvent
     ([SimulatorWallet]
      -&gt; [(PaymentPubKeyHash, WalletNumber)] -&gt; EvaluationResult)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WalletNumber Value -&gt; [SimulatorWallet])
-&gt; FoldM (Eff effs) EmulatorEvent (Map WalletNumber Value)
-&gt; FoldM (Eff effs) EmulatorEvent [SimulatorWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((WalletNumber, Value) -&gt; SimulatorWallet)
-&gt; [(WalletNumber, Value)] -&gt; [SimulatorWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletNumber -&gt; Value -&gt; SimulatorWallet)
-&gt; (WalletNumber, Value) -&gt; SimulatorWallet
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; Value -&gt; SimulatorWallet
</span><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier hs-var">SimulatorWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(WalletNumber, Value)] -&gt; [SimulatorWallet])
-&gt; (Map WalletNumber Value -&gt; [(WalletNumber, Value)])
-&gt; Map WalletNumber Value
-&gt; [SimulatorWallet]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map WalletNumber Value -&gt; [(WalletNumber, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WalletNumber]
-&gt; FoldM (Eff effs) EmulatorEvent (Map WalletNumber Value)
forall (effs :: [* -&gt; *]).
[WalletNumber] -&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
</span><a href="Playground.Interpreter.Util.html#funds"><span class="hs-identifier hs-var">funds</span></a></span><span> </span><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739532"><span class="hs-identifier hs-var">wallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><span class="annottext">FoldM
  (Eff effs)
  EmulatorEvent
  ([SimulatorWallet]
   -&gt; [(PaymentPubKeyHash, WalletNumber)] -&gt; EvaluationResult)
-&gt; FoldM (Eff effs) EmulatorEvent [SimulatorWallet]
-&gt; FoldM
     (Eff effs)
     EmulatorEvent
     ([(PaymentPubKeyHash, WalletNumber)] -&gt; EvaluationResult)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WalletNumber Value -&gt; [SimulatorWallet])
-&gt; FoldM (Eff effs) EmulatorEvent (Map WalletNumber Value)
-&gt; FoldM (Eff effs) EmulatorEvent [SimulatorWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((WalletNumber, Value) -&gt; SimulatorWallet)
-&gt; [(WalletNumber, Value)] -&gt; [SimulatorWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletNumber -&gt; Value -&gt; SimulatorWallet)
-&gt; (WalletNumber, Value) -&gt; SimulatorWallet
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; Value -&gt; SimulatorWallet
</span><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier hs-var">SimulatorWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(WalletNumber, Value)] -&gt; [SimulatorWallet])
-&gt; (Map WalletNumber Value -&gt; [(WalletNumber, Value)])
-&gt; Map WalletNumber Value
-&gt; [SimulatorWallet]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map WalletNumber Value -&gt; [(WalletNumber, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WalletNumber]
-&gt; FoldM (Eff effs) EmulatorEvent (Map WalletNumber Value)
forall (effs :: [* -&gt; *]).
[WalletNumber] -&gt; EmulatorEventFoldM effs (Map WalletNumber Value)
</span><a href="Playground.Interpreter.Util.html#fees"><span class="hs-identifier hs-var">fees</span></a></span><span> </span><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739532"><span class="hs-identifier hs-var">wallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">FoldM
  (Eff effs)
  EmulatorEvent
  ([(PaymentPubKeyHash, WalletNumber)] -&gt; EvaluationResult)
-&gt; FoldM
     (Eff effs) EmulatorEvent [(PaymentPubKeyHash, WalletNumber)]
-&gt; EmulatorEventFoldM effs EvaluationResult
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(PaymentPubKeyHash, WalletNumber)]
-&gt; FoldM
     (Eff effs) EmulatorEvent [(PaymentPubKeyHash, WalletNumber)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletNumber -&gt; (PaymentPubKeyHash, WalletNumber))
-&gt; [WalletNumber] -&gt; [(PaymentPubKeyHash, WalletNumber)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; (PaymentPubKeyHash, WalletNumber)
</span><a href="#local-6989586621679739531"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739532"><span class="hs-identifier hs-var">wallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Evaluate a JSON payload from the Playground frontend against a given contract schema.</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Playground.Interpreter.Util.html#stage"><span class="hs-identifier hs-type">stage</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-108"></span><span>       </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679739522"><span class="annot"><a href="#local-6989586621679739522"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679739521"><span class="annot"><a href="#local-6989586621679739521"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679739520"><span class="annot"><a href="#local-6989586621679739520"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-109"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739521"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-110"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739522"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-111"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739522"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-112"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739522"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679739520"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">BSL.ByteString</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">BSL.ByteString</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Playground.Types.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a></span><span> </span><span class="annot"><a href="Playground.Types.html#EvaluationResult"><span class="hs-identifier hs-type">EvaluationResult</span></a></span><span>
</span><span id="line-117"></span><span id="stage"><span class="annot"><span class="annottext">stage :: Contract w s Text a
-&gt; ByteString
-&gt; ByteString
-&gt; Either PlaygroundError EvaluationResult
</span><a href="Playground.Interpreter.Util.html#stage"><span class="hs-identifier hs-var hs-var">stage</span></a></span></span><span> </span><span id="local-6989586621679739519"><span class="annot"><span class="annottext">Contract w s Text a
</span><a href="#local-6989586621679739519"><span class="hs-identifier hs-var">contract</span></a></span></span><span> </span><span id="local-6989586621679739518"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739518"><span class="hs-identifier hs-var">programJson</span></a></span></span><span> </span><span id="local-6989586621679739517"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739517"><span class="hs-identifier hs-var">simulatorWalletsJson</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679739516"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739516"><span class="hs-identifier hs-var">simulationJson</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; Either PlaygroundError String
forall a.
FromJSON a =&gt;
String -&gt; ByteString -&gt; Either PlaygroundError a
</span><a href="Playground.Interpreter.Util.html#playgroundDecode"><span class="hs-identifier hs-var">playgroundDecode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;String&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739518"><span class="hs-identifier hs-var">programJson</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679739515"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679739515"><span class="hs-identifier hs-var">simulation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Playground.Types.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; Either PlaygroundError [Expression]
forall a.
FromJSON a =&gt;
String -&gt; ByteString -&gt; Either PlaygroundError a
</span><a href="Playground.Interpreter.Util.html#playgroundDecode"><span class="hs-identifier hs-var">playgroundDecode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[Expression schema]&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either PlaygroundError [Expression])
-&gt; (String -&gt; ByteString)
-&gt; String
-&gt; Either PlaygroundError [Expression]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either PlaygroundError [Expression])
-&gt; String -&gt; Either PlaygroundError [Expression]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739516"><span class="hs-identifier hs-var">simulationJson</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679739513"><span class="annot"><span class="annottext">[SimulatorWallet]
</span><a href="#local-6989586621679739513"><span class="hs-identifier hs-var">simulatorWallets</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier hs-type">SimulatorWallet</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; Either PlaygroundError [SimulatorWallet]
forall a.
FromJSON a =&gt;
String -&gt; ByteString -&gt; Either PlaygroundError a
</span><a href="Playground.Interpreter.Util.html#playgroundDecode"><span class="hs-identifier hs-var">playgroundDecode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[SimulatorWallet]&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739517"><span class="hs-identifier hs-var">simulatorWalletsJson</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739512"><span class="annot"><span class="annottext">config :: EmulatorConfig
</span><a href="#local-6989586621679739512"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialChainState -&gt; Params -&gt; EmulatorConfig
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Plutus.Trace.Playground.EmulatorConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Wallet Value -&gt; InitialChainState
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Wallet Value -&gt; InitialChainState)
-&gt; Map Wallet Value -&gt; InitialChainState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[SimulatorWallet] -&gt; Map Wallet Value
</span><a href="Playground.Interpreter.Util.html#toInitialDistribution"><span class="hs-identifier hs-var">toInitialDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">[SimulatorWallet]
</span><a href="#local-6989586621679739513"><span class="hs-identifier hs-var">simulatorWallets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621679739509"><span class="annot"><span class="annottext">allWallets :: [WalletNumber]
</span><a href="#local-6989586621679739509"><span class="hs-identifier hs-var hs-var">allWallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimulatorWallet -&gt; WalletNumber
</span><a href="Playground.Types.html#simulatorWalletWallet"><span class="hs-identifier hs-var hs-var">simulatorWalletWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorWallet -&gt; WalletNumber)
-&gt; [SimulatorWallet] -&gt; [WalletNumber]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[SimulatorWallet]
</span><a href="#local-6989586621679739513"><span class="hs-identifier hs-var">simulatorWallets</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621679739508"><span class="annot"><span class="annottext">final :: Either
  PlaygroundError
  (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
</span><a href="#local-6989586621679739508"><span class="hs-identifier hs-var hs-var">final</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff
  '[]
  (Either
     PlaygroundError
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
-&gt; Either
     PlaygroundError
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
forall a. Eff '[] a -&gt; a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-126"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[]
   (Either
      PlaygroundError
      (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
 -&gt; Either
      PlaygroundError
      (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
-&gt; Eff
     '[]
     (Either
        PlaygroundError
        (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
-&gt; Either
     PlaygroundError
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error PlaygroundError]
  (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
-&gt; Eff
     '[]
     (Either
        PlaygroundError
        (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span>
</span><span id="line-127"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[Error PlaygroundError]
   (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
 -&gt; Eff
      '[]
      (Either
         PlaygroundError
         (Of EvaluationResult (Either EmulatorErr (), EmulatorState))))
-&gt; Eff
     '[Error PlaygroundError]
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
-&gt; Eff
     '[]
     (Either
        PlaygroundError
        (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FoldM (Eff '[Error PlaygroundError]) EmulatorEvent EvaluationResult
-&gt; Stream
     (Of (LogMessage EmulatorEvent))
     (Eff '[Error PlaygroundError])
     (Either EmulatorErr (), EmulatorState)
-&gt; Eff
     '[Error PlaygroundError]
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
forall (effs :: [* -&gt; *]) a b.
FoldM (Eff effs) EmulatorEvent b
-&gt; Stream (Of (LogMessage EmulatorEvent)) (Eff effs) a
-&gt; Eff effs (Of b a)
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">foldEmulatorStreamM</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Playground.Types.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WalletNumber]
-&gt; FoldM
     (Eff '[Error PlaygroundError]) EmulatorEvent EvaluationResult
forall (effs :: [* -&gt; *]).
[WalletNumber] -&gt; EmulatorEventFoldM effs EvaluationResult
</span><a href="Playground.Interpreter.Util.html#evaluationResultFold"><span class="hs-identifier hs-var">evaluationResultFold</span></a></span><span> </span><span class="annot"><span class="annottext">[WalletNumber]
</span><a href="#local-6989586621679739509"><span class="hs-identifier hs-var">allWallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><span class="annottext">(Stream
   (Of (LogMessage EmulatorEvent))
   (Eff '[Error PlaygroundError])
   (Either EmulatorErr (), EmulatorState)
 -&gt; Eff
      '[Error PlaygroundError]
      (Of EvaluationResult (Either EmulatorErr (), EmulatorState)))
-&gt; Stream
     (Of (LogMessage EmulatorEvent))
     (Eff '[Error PlaygroundError])
     (Either EmulatorErr (), EmulatorState)
-&gt; Eff
     '[Error PlaygroundError]
     (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorConfig
-&gt; Contract w s Text ()
-&gt; PlaygroundTrace ()
-&gt; Stream
     (Of (LogMessage EmulatorEvent))
     (Eff '[Error PlaygroundError])
     (Either EmulatorErr (), EmulatorState)
forall w (s :: Row *) e (effs :: [* -&gt; *]) a.
(ContractConstraints s, Show e, ToJSON e, ToJSON w, Monoid w) =&gt;
EmulatorConfig
-&gt; Contract w s e ()
-&gt; PlaygroundTrace a
-&gt; Stream
     (Of (LogMessage EmulatorEvent))
     (Eff effs)
     (Either EmulatorErr a, EmulatorState)
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">runPlaygroundStream</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorConfig
</span><a href="#local-6989586621679739512"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Contract w s Text a -&gt; Contract w s Text ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Contract w s Text a
</span><a href="#local-6989586621679739519"><span class="hs-identifier hs-var">contract</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; PlaygroundTrace ())
-&gt; [Expression] -&gt; PlaygroundTrace ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="annot"><span class="annottext">Expression -&gt; PlaygroundTrace ()
</span><a href="Playground.Interpreter.Util.html#expressionToTrace"><span class="hs-identifier hs-var">expressionToTrace</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679739515"><span class="hs-identifier hs-var">simulation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either
  PlaygroundError
  (Of EvaluationResult (Either EmulatorErr (), EmulatorState))
</span><a href="#local-6989586621679739508"><span class="hs-identifier hs-var">final</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679739506"><span class="annot"><span class="annottext">PlaygroundError
</span><a href="#local-6989586621679739506"><span class="hs-identifier hs-var">err</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlaygroundError -&gt; Either PlaygroundError EvaluationResult
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaygroundError -&gt; Either PlaygroundError EvaluationResult)
-&gt; (PlaygroundError -&gt; PlaygroundError)
-&gt; PlaygroundError
-&gt; Either PlaygroundError EvaluationResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PlaygroundError
</span><a href="Playground.Types.html#OtherError"><span class="hs-identifier hs-var">OtherError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PlaygroundError)
-&gt; (PlaygroundError -&gt; String)
-&gt; PlaygroundError
-&gt; PlaygroundError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PlaygroundError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(PlaygroundError -&gt; Either PlaygroundError EvaluationResult)
-&gt; PlaygroundError -&gt; Either PlaygroundError EvaluationResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PlaygroundError
</span><a href="#local-6989586621679739506"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679739504"><span class="annot"><span class="annottext">Of EvaluationResult (Either EmulatorErr (), EmulatorState)
</span><a href="#local-6989586621679739504"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvaluationResult -&gt; Either PlaygroundError EvaluationResult
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Of EvaluationResult (Either EmulatorErr (), EmulatorState)
-&gt; EvaluationResult
forall a b. Of a b -&gt; a
</span><a href="../file:///nix/store/2v7aw0qgl2v0lwasqg0zsrzfb9jxmbfn-streaming-lib-streaming-0.2.3.1-haddock-doc/share/doc/streaming/html/src"><span class="hs-identifier hs-var">fst'</span></a></span><span> </span><span class="annot"><span class="annottext">Of EvaluationResult (Either EmulatorErr (), EmulatorState)
</span><a href="#local-6989586621679739504"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Playground.Interpreter.Util.html#toInitialDistribution"><span class="hs-identifier hs-type">toInitialDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier hs-type">SimulatorWallet</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-135"></span><span id="toInitialDistribution"><span class="annot"><span class="annottext">toInitialDistribution :: [SimulatorWallet] -&gt; Map Wallet Value
</span><a href="Playground.Interpreter.Util.html#toInitialDistribution"><span class="hs-identifier hs-var hs-var">toInitialDistribution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Wallet, Value)] -&gt; Map Wallet Value
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Wallet, Value)] -&gt; Map Wallet Value)
-&gt; ([SimulatorWallet] -&gt; [(Wallet, Value)])
-&gt; [SimulatorWallet]
-&gt; Map Wallet Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorWallet -&gt; (Wallet, Value))
-&gt; [SimulatorWallet] -&gt; [(Wallet, Value)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#SimulatorWallet"><span class="hs-identifier hs-type">SimulatorWallet</span></a></span><span> </span><span id="local-6989586621679739503"><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739503"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679739502"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739502"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739503"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739502"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Playground.Interpreter.Util.html#expressionToTrace"><span class="hs-identifier hs-type">expressionToTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Playground.Types.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">PlaygroundTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span id="expressionToTrace"><span class="annot"><span class="annottext">expressionToTrace :: Expression -&gt; PlaygroundTrace ()
</span><a href="Playground.Interpreter.Util.html#expressionToTrace"><span class="hs-identifier hs-var hs-var">expressionToTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Playground.Types.html#AddBlocks"><span class="hs-identifier hs-type">AddBlocks</span></a></span><span> </span><span id="local-6989586621679739501"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679739501"><span class="hs-identifier hs-var">blcks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff
  '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
    EmulatedWalletAPI]
  Slot
-&gt; PlaygroundTrace ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
     EmulatedWalletAPI]
   Slot
 -&gt; PlaygroundTrace ())
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     Slot
-&gt; PlaygroundTrace ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     Slot
forall (effs :: [* -&gt; *]).
Member Waiting effs =&gt;
Natural -&gt; Eff effs Slot
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Trace.waitNSlots</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural
 -&gt; Eff
      '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
        EmulatedWalletAPI]
      Slot)
-&gt; Natural
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679739501"><span class="hs-identifier hs-var">blcks</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="Playground.Types.html#AddBlocksUntil"><span class="hs-identifier hs-type">AddBlocksUntil</span></a></span><span> </span><span id="local-6989586621679739499"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679739499"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff
  '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
    EmulatedWalletAPI]
  Slot
-&gt; PlaygroundTrace ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
     EmulatedWalletAPI]
   Slot
 -&gt; PlaygroundTrace ())
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     Slot
-&gt; PlaygroundTrace ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     Slot
forall (effs :: [* -&gt; *]).
Member Waiting effs =&gt;
Slot -&gt; Eff effs Slot
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Trace.waitUntilSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679739499"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Playground.Types.html#PayToWallet"><span class="hs-identifier hs-type">PayToWallet</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679739497"><span class="annot"><span class="annottext">WalletNumber
sender :: WalletNumber
sender :: forall a. ContractCall a -&gt; WalletNumber
</span><a href="#local-6989586621679739497"><span class="hs-identifier hs-var hs-var">sender</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679739496"><span class="annot"><span class="annottext">WalletNumber
recipient :: WalletNumber
recipient :: forall a. ContractCall a -&gt; WalletNumber
</span><a href="#local-6989586621679739496"><span class="hs-identifier hs-var hs-var">recipient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679739495"><span class="annot"><span class="annottext">Value
amount :: Value
amount :: forall a. ContractCall a -&gt; Value
</span><a href="#local-6989586621679739495"><span class="hs-identifier hs-var hs-var">amount</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff
  '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
    EmulatedWalletAPI]
  TxId
-&gt; PlaygroundTrace ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
     EmulatedWalletAPI]
   TxId
 -&gt; PlaygroundTrace ())
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     TxId
-&gt; PlaygroundTrace ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Wallet
-&gt; Value
-&gt; Eff
     '[RunContractPlayground, Error EmulatorRuntimeError, Waiting,
       EmulatedWalletAPI]
     TxId
forall (effs :: [* -&gt; *]).
Member EmulatedWalletAPI effs =&gt;
Wallet -&gt; Wallet -&gt; Value -&gt; Eff effs TxId
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Trace.payToWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739497"><span class="hs-identifier hs-var">sender</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739496"><span class="hs-identifier hs-var">recipient</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739495"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Playground.Types.html#CallEndpoint"><span class="hs-identifier hs-type">CallEndpoint</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679739493"><span class="annot"><span class="annottext">WalletNumber
caller :: WalletNumber
caller :: forall a. ContractCall a -&gt; WalletNumber
</span><a href="#local-6989586621679739493"><span class="hs-identifier hs-var hs-var">caller</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">argumentValues :: forall a. ContractCall a -&gt; FunctionSchema a
</span><a href="Playground.Types.html#argumentValues"><span class="hs-identifier hs-var">argumentValues</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="Playground.Types.html#FunctionSchema"><span class="hs-identifier hs-type">FunctionSchema</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679739492"><span class="annot"><span class="annottext">EndpointDescription
endpointDescription :: EndpointDescription
endpointDescription :: forall a. FunctionSchema a -&gt; EndpointDescription
</span><a href="#local-6989586621679739492"><span class="hs-identifier hs-var hs-var">endpointDescription</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">argument :: forall a. FunctionSchema a -&gt; a
</span><a href="Playground.Types.html#argument"><span class="hs-identifier hs-var">argument</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679739491"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739491"><span class="hs-identifier hs-var">rawArgument</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739490"><span class="annot"><span class="annottext">fromString :: Value -&gt; Maybe ByteString
</span><a href="#local-6989586621679739490"><span class="hs-identifier hs-var hs-var">fromString</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.String</span></a></span><span> </span><span id="local-6989586621679739488"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679739488"><span class="hs-identifier hs-var">string</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">Text.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679739488"><span class="hs-identifier hs-var">string</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="annot"><a href="#local-6989586621679739490"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe ByteString
</span><a href="#local-6989586621679739490"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739491"><span class="hs-identifier hs-var">rawArgument</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679739485"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739485"><span class="hs-identifier hs-var">string</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String Value
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">JSON.eitherDecode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679739485"><span class="hs-identifier hs-var">string</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>                    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679739484"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739484"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>                        </span><span class="annot"><span class="annottext">EmulatorRuntimeError -&gt; PlaygroundTrace ()
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span>
</span><span id="line-150"></span><span>                            </span><span class="annot"><span class="annottext">(EmulatorRuntimeError -&gt; PlaygroundTrace ())
-&gt; EmulatorRuntimeError -&gt; PlaygroundTrace ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; EmulatorRuntimeError
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EmulatorJSONDecodingError</span></a></span><span>
</span><span id="line-151"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error extracting JSON from arguments. Expected an array of JSON strings. &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-152"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739484"><span class="hs-identifier hs-var">errs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                              </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739491"><span class="hs-identifier hs-var">rawArgument</span></a></span><span>
</span><span id="line-154"></span><span>                    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679739483"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739483"><span class="hs-identifier hs-var">argument</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>                        </span><span class="annot"><span class="annottext">Wallet -&gt; String -&gt; Value -&gt; PlaygroundTrace ()
forall (effs :: [* -&gt; *]).
Member RunContractPlayground effs =&gt;
Wallet -&gt; String -&gt; Value -&gt; Eff effs ()
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Trace.callEndpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">fromWalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">WalletNumber
</span><a href="#local-6989586621679739493"><span class="hs-identifier hs-var">caller</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EndpointDescription -&gt; String
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var hs-var">getEndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621679739492"><span class="hs-identifier hs-var">endpointDescription</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739483"><span class="hs-identifier hs-var">argument</span></a></span><span>
</span><span id="line-156"></span><span>            </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>                </span><span class="annot"><span class="annottext">EmulatorRuntimeError -&gt; PlaygroundTrace ()
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span>
</span><span id="line-158"></span><span>                    </span><span class="annot"><span class="annottext">(EmulatorRuntimeError -&gt; PlaygroundTrace ())
-&gt; EmulatorRuntimeError -&gt; PlaygroundTrace ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; EmulatorRuntimeError
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EmulatorJSONDecodingError</span></a></span><span>
</span><span id="line-159"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected a String, but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739491"><span class="hs-identifier hs-var">rawArgument</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>                      </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679739491"><span class="hs-identifier hs-var">rawArgument</span></a></span><span>
</span><span id="line-161"></span></pre></body></html>
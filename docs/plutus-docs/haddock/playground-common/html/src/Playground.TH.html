<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures   #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators    #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Playground.TH</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Playground.TH.html#mkFunction"><span class="hs-identifier">mkFunction</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.TH.html#mkFunctions"><span class="hs-identifier">mkFunctions</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.TH.html#ensureKnownCurrencies"><span class="hs-identifier">ensureKnownCurrencies</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.TH.html#mkSchemaDefinitions"><span class="hs-identifier">mkSchemaDefinitions</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.TH.html#mkSingleFunction"><span class="hs-identifier">mkSingleFunction</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.TH.html#mkKnownCurrencies"><span class="hs-identifier">mkKnownCurrencies</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Language.Haskell.TH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">NormalB</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Clause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Clause</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Dec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">FunD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">SigD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">TySynD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ValD</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ListE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">VarE</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>                            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">TyConI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">VarI</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">VarP</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>                            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">AppT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ArrowT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ConT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ForallT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">ListT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">TupleT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">VarT</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">lookupValueName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">mkName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">nameBase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>                            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">normalB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">reify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">sigD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">valD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier">varP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Playground.Schema.html"><span class="hs-identifier">Playground.Schema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Schema.html#endpointsToSchemas"><span class="hs-identifier">endpointsToSchemas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Playground.Types.html"><span class="hs-identifier">Playground.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#FunctionSchema"><span class="hs-identifier">FunctionSchema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Playground.Types.html#FunctionSchema"><span class="hs-identifier">FunctionSchema</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Playground.Types.html#adaCurrency"><span class="hs-identifier">adaCurrency</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Schema.html"><span class="hs-identifier">Schema</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Schema.html#FormSchema"><span class="hs-identifier">FormSchema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Schema.html#toSchema"><span class="hs-identifier">toSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EndpointDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EndpointDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><a href="Playground.TH.html#mkFunctions"><span class="hs-identifier hs-type">mkFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-28"></span><span id="mkFunctions"><span class="annot"><span class="annottext">mkFunctions :: [Name] -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkFunctions"><span class="hs-identifier hs-var hs-var">mkFunctions</span></a></span></span><span> </span><span id="local-6989586621679739883"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679739883"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-29"></span><span>    </span><span id="local-6989586621679739882"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679739882"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Q Dec) -&gt; [Name] -&gt; Q [Dec]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Dec
</span><a href="Playground.TH.html#mkFunction%27"><span class="hs-identifier hs-var">mkFunction'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679739883"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739879"><span class="annot"><span class="annottext">newNames :: [Exp]
</span><a href="#local-6989586621679739879"><span class="hs-identifier hs-var hs-var">newNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; [Name] -&gt; [Exp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="#local-6989586621679739878"><span class="hs-identifier hs-var">mkNewName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679739883"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-31"></span><span>        </span><span id="local-6989586621679739877"><span class="annot"><span class="annottext">schemas :: Dec
</span><a href="#local-6989586621679739877"><span class="hs-identifier hs-var hs-var">schemas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">VarP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;schemas&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">NormalB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ListE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679739879"><span class="hs-identifier hs-var">newNames</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; Q [Dec]) -&gt; [Dec] -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679739882"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739877"><span class="hs-identifier hs-var">schemas</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>    </span><span id="local-6989586621679739878"><span class="annot"><span class="annottext">mkNewName :: Name -&gt; Exp
</span><a href="#local-6989586621679739878"><span class="hs-identifier hs-var hs-var">mkNewName</span></a></span></span><span> </span><span id="local-6989586621679739876"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739876"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; (String -&gt; Name) -&gt; String -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Exp) -&gt; String -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">nameBase</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739876"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Schema&quot;</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Playground.TH.html#registeredKnownCurrenciesBindingName"><span class="hs-identifier hs-type">registeredKnownCurrenciesBindingName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-37"></span><span id="registeredKnownCurrenciesBindingName"><span class="annot"><span class="annottext">registeredKnownCurrenciesBindingName :: String
</span><a href="Playground.TH.html#registeredKnownCurrenciesBindingName"><span class="hs-identifier hs-var hs-var">registeredKnownCurrenciesBindingName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;registeredKnownCurrencies&quot;</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Playground.TH.html#unlessBound"><span class="hs-identifier hs-type">unlessBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span id="unlessBound"><span class="annot"><span class="annottext">unlessBound :: String -&gt; (Name -&gt; Q [Dec]) -&gt; Q [Dec]
</span><a href="Playground.TH.html#unlessBound"><span class="hs-identifier hs-var hs-var">unlessBound</span></a></span></span><span> </span><span id="local-6989586621679739872"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739872"><span class="hs-identifier hs-var">bindingName</span></a></span></span><span> </span><span id="local-6989586621679739871"><span class="annot"><span class="annottext">Name -&gt; Q [Dec]
</span><a href="#local-6989586621679739871"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679739870"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679739870"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q (Maybe Name)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">lookupValueName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739872"><span class="hs-identifier hs-var">bindingName</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679739870"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q [Dec]
</span><a href="#local-6989586621679739871"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Q [Dec]) -&gt; Name -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739872"><span class="hs-identifier hs-var">bindingName</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Playground.TH.html#ensureKnownCurrencies"><span class="hs-identifier hs-type">ensureKnownCurrencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span id="ensureKnownCurrencies"><span class="annot"><span class="annottext">ensureKnownCurrencies :: Q [Dec]
</span><a href="Playground.TH.html#ensureKnownCurrencies"><span class="hs-identifier hs-var hs-var">ensureKnownCurrencies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (Name -&gt; Q [Dec]) -&gt; Q [Dec]
</span><a href="Playground.TH.html#unlessBound"><span class="hs-identifier hs-var">unlessBound</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Playground.TH.html#registeredKnownCurrenciesBindingName"><span class="hs-identifier hs-var">registeredKnownCurrenciesBindingName</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Q [Dec]) -&gt; Q [Dec]) -&gt; (Name -&gt; Q [Dec]) -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><span class="annottext">[Name] -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkKnownCurrencies"><span class="hs-identifier hs-var">mkKnownCurrencies</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Playground.TH.html#schemaBindingName"><span class="hs-identifier hs-type">schemaBindingName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-52"></span><span id="schemaBindingName"><span class="annot"><span class="annottext">schemaBindingName :: String
</span><a href="Playground.TH.html#schemaBindingName"><span class="hs-identifier hs-var hs-var">schemaBindingName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;schemas&quot;</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-pragma">{-# ANN</span><span> </span><span class="annot"><a href="Playground.TH.html#mkSchemaDefinitions"><span class="hs-pragma hs-type">mkSchemaDefinitions</span></a></span><span>
</span><span id="line-55"></span><span>          </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma">&quot;HLint: ignore Redundant bracket&quot;</span></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-pragma hs-type">String</span></a></span><span class="hs-pragma">)</span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Playground.TH.html#mkSchemaDefinitions"><span class="hs-identifier hs-type">mkSchemaDefinitions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span id="mkSchemaDefinitions"><span class="annot"><span class="annottext">mkSchemaDefinitions :: Name -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkSchemaDefinitions"><span class="hs-identifier hs-var hs-var">mkSchemaDefinitions</span></a></span></span><span> </span><span id="local-6989586621679739868"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739868"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679739867"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739867"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739868"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739867"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">TyConI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">TySynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679739866"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739866"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>            </span><span id="local-6989586621679739865"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679739865"><span class="hs-identifier hs-var">schemas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[|</span><span class="hs-identifier">endpointsToSchemas</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; (Name -&gt; Q [Dec]) -&gt; Q [Dec]
</span><a href="Playground.TH.html#unlessBound"><span class="hs-identifier hs-var">unlessBound</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Playground.TH.html#schemaBindingName"><span class="hs-identifier hs-var">schemaBindingName</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Q [Dec]) -&gt; Q [Dec]) -&gt; (Name -&gt; Q [Dec]) -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679739864"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739864"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>                </span><span id="local-6989586621679739863"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739863"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TypeQ -&gt; Q Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">sigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739864"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">[t|</span><span class="hs-special">[</span><span class="hs-identifier">FunctionSchema</span><span> </span><span class="hs-identifier">FormSchema</span><span class="hs-special">]</span><span class="hs-special">|]</span><span>
</span><span id="line-66"></span><span>                </span><span id="local-6989586621679739862"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739862"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PatQ -&gt; BodyQ -&gt; [Q Dec] -&gt; Q Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">valD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; PatQ
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">varP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739864"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpQ -&gt; BodyQ
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">normalB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; ExpQ
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679739865"><span class="hs-identifier hs-var">schemas</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>                </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739863"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739862"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>        </span><span id="local-6989586621679739861"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739861"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q [Dec]) -&gt; String -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-70"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect Name type provided to mkSchemaDefinitions. Got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-71"></span><span>            </span><span class="annot"><span class="annottext">Info -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739861"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{-{- HLINT ignore mkFunction -}-}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Playground.TH.html#mkFunction"><span class="hs-identifier hs-type">mkFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span id="mkFunction"><span class="annot"><span class="annottext">mkFunction :: Name -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkFunction"><span class="hs-identifier hs-var hs-var">mkFunction</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Q [Dec]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q [Dec]) -&gt; String -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkFunction has been replaced by mkFunctions&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;replace all calls to mkFunction with a single call to mkFunctions, e.g.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; | $(mkFunction 'functionOne)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; | $(mkFunction 'functionTwo)&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;becomes:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; | $(mkFunctions ['functionOne, 'functionTwo])&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679739857"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739857"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679739858"><span class="annot"><span class="annottext">&lt;/&gt; :: String -&gt; String -&gt; String
</span><a href="#local-6989586621679739858"><span class="hs-operator hs-var hs-var">&lt;/&gt;</span></a></span></span><span> </span><span id="local-6989586621679739856"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739856"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739857"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679739856"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Playground.TH.html#mkSingleFunction"><span class="hs-identifier hs-type">mkSingleFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span id="mkSingleFunction"><span class="annot"><span class="annottext">mkSingleFunction :: Name -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkSingleFunction"><span class="hs-identifier hs-var hs-var">mkSingleFunction</span></a></span></span><span> </span><span id="local-6989586621679739855"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739855"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679739854"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739854"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Dec
</span><a href="Playground.TH.html#mkFunction%27"><span class="hs-identifier hs-var">mkFunction'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739855"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739854"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Playground.TH.html#mkFunction%27"><span class="hs-identifier hs-type">mkFunction'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span>
</span><span id="line-97"></span><span id="mkFunction%27"><span class="annot"><span class="annottext">mkFunction' :: Name -&gt; Q Dec
</span><a href="Playground.TH.html#mkFunction%27"><span class="hs-identifier hs-var hs-var">mkFunction'</span></a></span></span><span> </span><span id="local-6989586621679739853"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739853"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739852"><span class="annot"><span class="annottext">newName :: Name
</span><a href="#local-6989586621679739852"><span class="hs-identifier hs-var hs-var">newName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Name) -&gt; String -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">nameBase</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739853"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Schema&quot;</span></span><span>
</span><span id="line-99"></span><span>        </span><span id="local-6989586621679739851"><span class="annot"><span class="annottext">fn :: EndpointDescription
</span><a href="#local-6989586621679739851"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EndpointDescription
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; EndpointDescription) -&gt; String -&gt; EndpointDescription
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">nameBase</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739853"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679739850"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679739850"><span class="hs-identifier hs-var">expression</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; EndpointDescription -&gt; ExpQ
</span><a href="Playground.TH.html#mkFunctionExp"><span class="hs-identifier hs-var">mkFunctionExp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739853"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621679739851"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Dec -&gt; Q Dec
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Q Dec) -&gt; Dec -&gt; Q Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">FunD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739852"><span class="hs-identifier hs-var">newName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Pat] -&gt; Body -&gt; [Dec] -&gt; Clause
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">Clause</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">NormalB</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679739850"><span class="hs-identifier hs-var">expression</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">{-{- HLINT ignore mkFunctionExp -}-}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Playground.TH.html#mkFunctionExp"><span class="hs-identifier hs-type">mkFunctionExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-106"></span><span id="mkFunctionExp"><span class="annot"><span class="annottext">mkFunctionExp :: Name -&gt; EndpointDescription -&gt; ExpQ
</span><a href="Playground.TH.html#mkFunctionExp"><span class="hs-identifier hs-var hs-var">mkFunctionExp</span></a></span></span><span> </span><span id="local-6989586621679739848"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739848"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679739847"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621679739847"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679739846"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739846"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Info
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739848"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679739846"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">VarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679739845"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739845"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Dec
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739844"><span class="annot"><span class="annottext">ts :: [Type]
</span><a href="#local-6989586621679739844"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739845"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-111"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">EndpointDescription -&gt; [Type] -&gt; ExpQ
</span><a href="Playground.TH.html#toSchemas"><span class="hs-identifier hs-var">toSchemas</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621679739847"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679739844"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">Info
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExpQ
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect Name type provided to mkFunction&quot;</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">{- HLINT ignore toSchemas &quot;Redundant bracket&quot; -}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Playground.TH.html#toSchemas"><span class="hs-identifier hs-type">toSchemas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-117"></span><span id="toSchemas"><span class="annot"><span class="annottext">toSchemas :: EndpointDescription -&gt; [Type] -&gt; ExpQ
</span><a href="Playground.TH.html#toSchemas"><span class="hs-identifier hs-var hs-var">toSchemas</span></a></span></span><span> </span><span id="local-6989586621679739841"><span class="annot"><span class="annottext">EndpointDescription
</span><a href="#local-6989586621679739841"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679739840"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679739840"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679739839"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679739839"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; ExpQ -&gt; ExpQ) -&gt; ExpQ -&gt; [Type] -&gt; ExpQ
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679739837"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739837"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679739836"><span class="annot"><span class="annottext">ExpQ
</span><a href="#local-6989586621679739836"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="hs-identifier">toSchema</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="">$e</span><span class="hs-special">|]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[|</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">|]</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679739840"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">[|</span><span class="hs-identifier">FunctionSchema</span><span> </span><span class="hs-identifier">fn</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">es</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">{-{- HLINT ignore args -}-}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span id="args"><span class="annot"><span class="annottext">args :: Type -&gt; [Type]
</span><a href="Playground.TH.html#args"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ArrowT</span></a></span><span> </span><span id="local-6989586621679739835"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739835"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679739834"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739834"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739835"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739834"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">ConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">ConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">ForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679739833"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739833"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739833"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">ConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">TupleT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">AppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">VarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679739832"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739832"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739832"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Playground.TH.html#args"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span id="local-6989586621679739831"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739831"><span class="hs-identifier hs-var">a</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Type]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [Type]) -&gt; String -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;incorrect type in template haskell function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679739831"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Playground.TH.html#mkKnownCurrencies"><span class="hs-identifier hs-type">mkKnownCurrencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-type">Dec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span id="mkKnownCurrencies"><span class="annot"><span class="annottext">mkKnownCurrencies :: [Name] -&gt; Q [Dec]
</span><a href="Playground.TH.html#mkKnownCurrencies"><span class="hs-identifier hs-var hs-var">mkKnownCurrencies</span></a></span></span><span> </span><span id="local-6989586621679739830"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679739830"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679739829"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679739829"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Playground.TH.html#registeredKnownCurrenciesBindingName"><span class="hs-identifier hs-var">registeredKnownCurrenciesBindingName</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span id="local-6989586621679739828"><span class="annot"><span class="annottext">sig :: Dec
</span><a href="#local-6989586621679739828"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">SigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739829"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">AppT</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ListT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">mkName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;KnownCurrency&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>        </span><span id="local-6989586621679739827"><span class="annot"><span class="annottext">names :: [Exp]
</span><a href="#local-6989586621679739827"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; [Name] -&gt; [Exp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Playground.Types.adaCurrency</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679739830"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679739826"><span class="annot"><span class="annottext">body :: Body
</span><a href="#local-6989586621679739826"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">NormalB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ListE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679739827"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span id="local-6989586621679739825"><span class="annot"><span class="annottext">val :: Dec
</span><a href="#local-6989586621679739825"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Dec
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">ValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/template-haskell-2.16.0.0/src"><span class="hs-identifier hs-var">VarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679739829"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679739826"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739828"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679739825"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span></pre></body></html>
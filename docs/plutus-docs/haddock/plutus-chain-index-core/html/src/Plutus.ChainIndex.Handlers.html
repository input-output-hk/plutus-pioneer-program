<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns          #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">{-| Handlers for the 'ChainIndexQueryEffect' and the 'ChainIndexControlEffect' -}</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.ChainIndex.Handlers</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#handleQuery"><span class="hs-identifier">handleQuery</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#handleControl"><span class="hs-identifier">handleControl</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#restoreStateFromDb"><span class="hs-identifier">restoreStateFromDb</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getResumePoints"><span class="hs-identifier">getResumePoints</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier">ChainIndexState</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Const</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Lens'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_Just</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(^?)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">foldM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Eff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Member</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator">(~&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Beam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">BeamableDb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Beam.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">BeamEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">combined</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">selectList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">selectOne</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">selectPage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">logError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">logWarn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Pagination</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Page</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Page</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">nextPageQuery</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">pageItems</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">PageQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Reader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">ask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">State</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">gets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/7wzfiy4wk5kzaxcc0ka4k83khpnfw6gx-fingertree-lib-fingertree-0.1.5.0-haddock-doc/share/doc/fingertree/html/src"><span class="hs-identifier">Data.FingerTree</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FT</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">catMaybes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">maybeToList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">Database.Beam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">Columnar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Identity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">SqlSelect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">TableEntity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">aggregate_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">all_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">countAll_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">filter_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">in_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>                      </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">limit_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">nub_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">select</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">val_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">BeamSqlBackendCanSerialize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">Database.Beam.Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">HasSqlEqualityCheck</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">asc_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">desc_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">exists_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">guard_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">isJust_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">isNothing_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">leftJoin_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">orderBy_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>                            </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">update</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(&amp;&amp;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(/=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(&lt;-.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(&lt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(==.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator">(&gt;.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">Database.Beam.Schema.Tables</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier">zipTables</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier">Database.Beam.Sqlite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier">Sqlite</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">DatumHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">cardanoAddressCredential</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Ada</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">AssetClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">AssetClass</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">flattenValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html"><span class="hs-identifier">Plutus.ChainIndex.Api</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#IsUtxoResponse"><span class="hs-identifier">IsUtxoResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#IsUtxoResponse"><span class="hs-identifier">IsUtxoResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier">QueryResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier">QueryResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>                              </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#TxosResponse"><span class="hs-identifier">TxosResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#TxosResponse"><span class="hs-identifier">TxosResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier">UtxosResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier">UtxosResponse</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexError.html"><span class="hs-identifier">Plutus.ChainIndex.ChainIndexError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexError.html#ChainIndexError"><span class="hs-identifier">ChainIndexError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html"><span class="hs-identifier">Plutus.ChainIndex.ChainIndexLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier">ChainIndexLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Compatibility.html"><span class="hs-identifier">Plutus.ChainIndex.Compatibility</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Compatibility.html#toCardanoPoint"><span class="hs-identifier">toCardanoPoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html"><span class="hs-identifier">Plutus.ChainIndex.DbSchema</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html"><span class="hs-identifier">Plutus.ChainIndex.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ChainIndexControlEffect"><span class="hs-identifier">ChainIndexControlEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ChainIndexQueryEffect"><span class="hs-identifier">ChainIndexQueryEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Tx.html"><span class="hs-identifier">Plutus.ChainIndex.Tx</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Tx.html"><span class="hs-identifier">Plutus.ChainIndex.Tx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.TxUtxoBalance.html"><span class="hs-identifier">Plutus.ChainIndex.TxUtxoBalance</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TxUtxoBalance</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html"><span class="hs-identifier">Plutus.ChainIndex.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainSyncBlock"><span class="hs-identifier">ChainSyncBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Depth"><span class="hs-identifier">Depth</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Diagnostics"><span class="hs-identifier">Diagnostics</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Point"><span class="hs-identifier">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Tip"><span class="hs-identifier">Tip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>                                </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxProcessOption"><span class="hs-identifier">TxProcessOption</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier">TxUtxoBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#fromReferenceScript"><span class="hs-identifier">fromReferenceScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#tipAsPoint"><span class="hs-identifier">tipAsPoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html"><span class="hs-identifier">Plutus.ChainIndex.UtxoState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#InsertUtxoSuccess"><span class="hs-identifier">InsertUtxoSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#RollbackResult"><span class="hs-identifier">RollbackResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoIndex"><span class="hs-identifier">UtxoIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html"><span class="hs-identifier">Plutus.ChainIndex.UtxoState</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UtxoState</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">datumHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V2.Ledger.Api</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx.Builtins.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">emptyByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">type</span><span> </span><span id="ChainIndexState"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-var">ChainIndexState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoIndex"><span class="hs-identifier hs-type">UtxoIndex</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621679725199"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getResumePoints"><span class="hs-identifier hs-type">getResumePoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725199"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725199"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-74"></span><span id="getResumePoints"><span class="annot"><span class="annottext">getResumePoints :: Eff effs [ChainPoint]
</span><a href="Plutus.ChainIndex.Handlers.html#getResumePoints"><span class="hs-identifier hs-var hs-var">getResumePoints</span></a></span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TipRow] -&gt; [ChainPoint])
-&gt; Eff effs [TipRow] -&gt; Eff effs [ChainPoint]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TipRow -&gt; Maybe ChainPoint) -&gt; [TipRow] -&gt; [ChainPoint]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point -&gt; Maybe ChainPoint
</span><a href="Plutus.ChainIndex.Compatibility.html#toCardanoPoint"><span class="hs-identifier hs-var">toCardanoPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; Maybe ChainPoint)
-&gt; (TipRow -&gt; Point) -&gt; TipRow -&gt; Maybe ChainPoint
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; Point
</span><a href="Plutus.ChainIndex.Types.html#tipAsPoint"><span class="hs-identifier hs-var">tipAsPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(Tip -&gt; Point) -&gt; (TipRow -&gt; Tip) -&gt; TipRow -&gt; Point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TipRow -&gt; Tip
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe TipRow -&gt; Tip) -&gt; (TipRow -&gt; Maybe TipRow) -&gt; TipRow -&gt; Tip
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TipRow -&gt; Maybe TipRow
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">(Eff effs [TipRow] -&gt; Eff effs [ChainPoint])
-&gt; (DatabaseEntity Sqlite Db (TableEntity TipRowT)
    -&gt; Eff effs [TipRow])
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Eff effs [ChainPoint]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite TipRow -&gt; Eff effs [TipRow]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite TipRow -&gt; Eff effs [TipRow])
-&gt; (DatabaseEntity Sqlite Db (TableEntity TipRowT)
    -&gt; SqlSelect Sqlite TipRow)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Eff effs [TipRow]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect Sqlite TipRow
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; SqlSelect Sqlite TipRow)
-&gt; (DatabaseEntity Sqlite Db (TableEntity TipRowT)
    -&gt; Q Sqlite
         Db
         QBaseScope
         (TipRowT (QGenExpr QValueContext Sqlite QBaseScope)))
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; SqlSelect Sqlite TipRow
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TipRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QOrd Sqlite (QNested QBaseScope) Word64)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (TipRowT (QExpr Sqlite (QNested QBaseScope))))
forall s a ordering be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, SqlOrderable be ordering,
 ThreadRewritable (QNested s) a) =&gt;
(a -&gt; ordering)
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">orderBy_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QExpr Sqlite (QNested QBaseScope) Word64
-&gt; QOrd Sqlite (QNested QBaseScope) Word64
forall be s a. BeamSqlBackend be =&gt; QExpr be s a -&gt; QOrd be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">desc_</span></a></span><span> </span><span class="annot"><span class="annottext">(QExpr Sqlite (QNested QBaseScope) Word64
 -&gt; QOrd Sqlite (QNested QBaseScope) Word64)
-&gt; (TipRowT (QExpr Sqlite (QNested QBaseScope))
    -&gt; QExpr Sqlite (QNested QBaseScope) Word64)
-&gt; TipRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QOrd Sqlite (QNested QBaseScope) Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QExpr Sqlite (QNested QBaseScope) Word64
forall (f :: * -&gt; *). TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#_tipRowSlot"><span class="hs-identifier hs-var hs-var">_tipRowSlot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (TipRowT (QExpr Sqlite (QNested QBaseScope)))
 -&gt; Q Sqlite
      Db
      QBaseScope
      (TipRowT (QGenExpr QValueContext Sqlite QBaseScope)))
-&gt; (DatabaseEntity Sqlite Db (TableEntity TipRowT)
    -&gt; Q Sqlite
         Db
         (QNested QBaseScope)
         (TipRowT (QExpr Sqlite (QNested QBaseScope))))
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="annot"><span class="annottext">(DatabaseEntity Sqlite Db (TableEntity TipRowT)
 -&gt; Eff effs [ChainPoint])
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Eff effs [ChainPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span id="local-6989586621679725193"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#handleQuery"><span class="hs-identifier hs-type">handleQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725193"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725193"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexError.html#ChainIndexError"><span class="hs-identifier hs-type">ChainIndexError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725193"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725193"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ChainIndexQueryEffect"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725193"><span class="hs-identifier hs-type">effs</span></a></span></span><span>
</span><span id="line-85"></span><span id="handleQuery"><span class="annot"><span class="annottext">handleQuery :: ChainIndexQueryEffect ~&gt; Eff effs
</span><a href="Plutus.ChainIndex.Handlers.html#handleQuery"><span class="hs-identifier hs-var hs-var">handleQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#DatumFromHash"><span class="hs-identifier hs-type">DatumFromHash</span></a></span><span> </span><span id="local-6989586621679725191"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725191"><span class="hs-identifier hs-var">dh</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Eff effs (Maybe Datum)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
DatumHash -&gt; Eff effs (Maybe Datum)
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumFromHash"><span class="hs-identifier hs-var">getDatumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725191"><span class="hs-identifier hs-var">dh</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ValidatorFromHash"><span class="hs-identifier hs-type">ValidatorFromHash</span></a></span><span> </span><span id="local-6989586621679725188"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679725188"><span class="hs-identifier hs-var">hash</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Eff effs (Maybe (Versioned Validator))
forall (effs :: [* -&gt; *]) i o.
(Member (BeamEffect Sqlite) effs, HasDbType i,
 DbType i ~ ByteString, HasDbType o, DbType o ~ ByteString) =&gt;
i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-var">getScriptFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679725188"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#MintingPolicyFromHash"><span class="hs-identifier hs-type">MintingPolicyFromHash</span></a></span><span> </span><span id="local-6989586621679725185"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679725185"><span class="hs-identifier hs-var">hash</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; Eff effs (Maybe (Versioned MintingPolicy))
forall (effs :: [* -&gt; *]) i o.
(Member (BeamEffect Sqlite) effs, HasDbType i,
 DbType i ~ ByteString, HasDbType o, DbType o ~ ByteString) =&gt;
i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-var">getScriptFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679725185"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#RedeemerFromHash"><span class="hs-identifier hs-type">RedeemerFromHash</span></a></span><span> </span><span id="local-6989586621679725183"><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621679725183"><span class="hs-identifier hs-var">hash</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RedeemerHash -&gt; Eff effs (Maybe Redeemer)
forall (effs :: [* -&gt; *]) i o.
(Member (BeamEffect Sqlite) effs, HasDbType i,
 DbType i ~ ByteString, HasDbType o, DbType o ~ ByteString) =&gt;
i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getRedeemerFromHash"><span class="hs-identifier hs-var">getRedeemerFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621679725183"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#StakeValidatorFromHash"><span class="hs-identifier hs-type">StakeValidatorFromHash</span></a></span><span> </span><span id="local-6989586621679725180"><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621679725180"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash -&gt; Eff effs (Maybe (Versioned StakeValidator))
forall (effs :: [* -&gt; *]) i o.
(Member (BeamEffect Sqlite) effs, HasDbType i,
 DbType i ~ ByteString, HasDbType o, DbType o ~ ByteString) =&gt;
i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-var">getScriptFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621679725180"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#TxFromTxId"><span class="hs-identifier hs-type">TxFromTxId</span></a></span><span> </span><span id="local-6989586621679725178"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679725178"><span class="hs-identifier hs-var">txId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Eff effs (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxFromTxId"><span class="hs-identifier hs-var">getTxFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679725178"><span class="hs-identifier hs-var">txId</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#TxOutFromRef"><span class="hs-identifier hs-type">TxOutFromRef</span></a></span><span> </span><span id="local-6989586621679725175"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725175"><span class="hs-identifier hs-var">tor</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxOutFromRef"><span class="hs-identifier hs-var">getTxOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725175"><span class="hs-identifier hs-var">tor</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#UnspentTxOutFromRef"><span class="hs-identifier hs-type">UnspentTxOutFromRef</span></a></span><span> </span><span id="local-6989586621679725172"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725172"><span class="hs-identifier hs-var">tor</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoutFromRef"><span class="hs-identifier hs-var">getUtxoutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725172"><span class="hs-identifier hs-var">tor</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#UtxoSetMembership"><span class="hs-identifier hs-type">UtxoSetMembership</span></a></span><span> </span><span id="local-6989586621679725169"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725169"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>        </span><span id="local-6989586621679725168"><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725168"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; Eff effs (UtxoState TxUtxoBalance)
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#tip"><span class="hs-identifier hs-var">UtxoState.tip</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725168"><span class="hs-identifier hs-var">utxoState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>            </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexError -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError
</span><a href="Plutus.ChainIndex.ChainIndexError.html#QueryFailedNoTip"><span class="hs-identifier hs-var">QueryFailedNoTip</span></a></span><span>
</span><span id="line-98"></span><span>            </span><span id="local-6989586621679725163"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725163"><span class="hs-identifier hs-var">tp</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsUtxoResponse -&gt; Eff effs IsUtxoResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Bool -&gt; IsUtxoResponse
</span><a href="Plutus.ChainIndex.Api.html#IsUtxoResponse"><span class="hs-identifier hs-var">IsUtxoResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725163"><span class="hs-identifier hs-var">tp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; UtxoState TxUtxoBalance -&gt; Bool
</span><a href="Plutus.ChainIndex.TxUtxoBalance.html#isUnspentOutput"><span class="hs-identifier hs-var">TxUtxoBalance.isUnspentOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725169"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725168"><span class="hs-identifier hs-var">utxoState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#UtxoSetAtAddress"><span class="hs-identifier hs-type">UtxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621679725160"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725160"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725159"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725159"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetAtAddress"><span class="hs-identifier hs-var">getUtxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725160"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725159"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#UnspentTxOutSetAtAddress"><span class="hs-identifier hs-type">UnspentTxOutSetAtAddress</span></a></span><span> </span><span id="local-6989586621679725156"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725156"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725155"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725155"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef
-&gt; Credential
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="Plutus.ChainIndex.Handlers.html#getTxOutSetAtAddress"><span class="hs-identifier hs-var">getTxOutSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725156"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725155"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#DatumsAtAddress"><span class="hs-identifier hs-type">DatumsAtAddress</span></a></span><span> </span><span id="local-6989586621679725152"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725152"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725151"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725151"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential -&gt; Eff effs (QueryResponse [Datum])
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef
-&gt; Credential -&gt; Eff effs (QueryResponse [Datum])
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumsAtAddress"><span class="hs-identifier hs-var">getDatumsAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725152"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725151"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#UtxoSetWithCurrency"><span class="hs-identifier hs-type">UtxoSetWithCurrency</span></a></span><span> </span><span id="local-6989586621679725148"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725148"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725147"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679725147"><span class="hs-identifier hs-var">assetClass</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; AssetClass -&gt; Eff effs UtxosResponse
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef -&gt; AssetClass -&gt; Eff effs UtxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetWithCurrency"><span class="hs-identifier hs-var">getUtxoSetWithCurrency</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725148"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679725147"><span class="hs-identifier hs-var">assetClass</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#TxoSetAtAddress"><span class="hs-identifier hs-type">TxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621679725144"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725144"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725143"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725143"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; Credential -&gt; Eff effs TxosResponse
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef -&gt; Credential -&gt; Eff effs TxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getTxoSetAtAddress"><span class="hs-identifier hs-var">getTxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725144"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725143"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#TxsFromTxIds"><span class="hs-identifier hs-type">TxsFromTxIds</span></a></span><span> </span><span id="local-6989586621679725140"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679725140"><span class="hs-identifier hs-var">txids</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TxId] -&gt; Eff effs [ChainIndexTx]
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
[TxId] -&gt; Eff effs [ChainIndexTx]
</span><a href="Plutus.ChainIndex.Handlers.html#getTxsFromTxIds"><span class="hs-identifier hs-var">getTxsFromTxIds</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679725140"><span class="hs-identifier hs-var">txids</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexQueryEffect x
</span><a href="Plutus.ChainIndex.Effects.html#GetTip"><span class="hs-identifier hs-var">GetTip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff effs x
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
Eff effs Tip
</span><a href="Plutus.ChainIndex.Handlers.html#getTip"><span class="hs-identifier hs-var">getTip</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679725624"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTip"><span class="hs-identifier hs-type">getTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725624"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725624"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span></span><span>
</span><span id="line-109"></span><span id="getTip"><span class="annot"><span class="annottext">getTip :: Eff effs Tip
</span><a href="Plutus.ChainIndex.Handlers.html#getTip"><span class="hs-identifier hs-var hs-var">getTip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe TipRow -&gt; Tip) -&gt; Eff effs (Maybe TipRow) -&gt; Eff effs Tip
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TipRow -&gt; Tip
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff effs (Maybe TipRow) -&gt; Eff effs Tip)
-&gt; (Q Sqlite
      Db
      QBaseScope
      (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
    -&gt; Eff effs (Maybe TipRow))
-&gt; Q Sqlite
     Db
     QBaseScope
     (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs Tip
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite TipRow -&gt; Eff effs (Maybe TipRow)
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite TipRow -&gt; Eff effs (Maybe TipRow))
-&gt; (Q Sqlite
      Db
      QBaseScope
      (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
    -&gt; SqlSelect Sqlite TipRow)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs (Maybe TipRow)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect Sqlite TipRow
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Eff effs Tip)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs Tip
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (TipRowT (QExpr Sqlite (QNested QBaseScope))))
forall s a be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, ThreadRewritable (QNested s) a) =&gt;
Integer
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">limit_</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TipRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QOrd Sqlite (QNested (QNested QBaseScope)) Word64)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (TipRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (WithRewrittenThread
        (QNested (QNested QBaseScope))
        (QNested QBaseScope)
        (TipRowT (QExpr Sqlite (QNested (QNested QBaseScope)))))
forall s a ordering be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, SqlOrderable be ordering,
 ThreadRewritable (QNested s) a) =&gt;
(a -&gt; ordering)
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">orderBy_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Word64
-&gt; QOrd Sqlite (QNested (QNested QBaseScope)) Word64
forall be s a. BeamSqlBackend be =&gt; QExpr be s a -&gt; QOrd be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">desc_</span></a></span><span> </span><span class="annot"><span class="annottext">(QExpr Sqlite (QNested (QNested QBaseScope)) Word64
 -&gt; QOrd Sqlite (QNested (QNested QBaseScope)) Word64)
-&gt; (TipRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
    -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Word64)
-&gt; TipRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QOrd Sqlite (QNested (QNested QBaseScope)) Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Word64
forall (f :: * -&gt; *). TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#_tipRowSlot"><span class="hs-identifier hs-var hs-var">_tipRowSlot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (TipRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679725676"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getDatumFromHash"><span class="hs-identifier hs-type">getDatumFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725676"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725676"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span id="getDatumFromHash"><span class="annot"><span class="annottext">getDatumFromHash :: DatumHash -&gt; Eff effs (Maybe Datum)
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumFromHash"><span class="hs-identifier hs-var hs-var">getDatumFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe Datum)
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var">queryOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe Datum))
-&gt; (DatumHash -&gt; SqlSelect Sqlite ByteString)
-&gt; DatumHash
-&gt; Eff effs (Maybe Datum)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity DatumRowT))
-&gt; (forall (f :: * -&gt; *).
    DatumRowT f -&gt; Columnar f (DbType DatumHash))
-&gt; (forall (f :: * -&gt; *). DatumRowT f -&gt; Columnar f ByteString)
-&gt; DatumHash
-&gt; SqlSelect Sqlite ByteString
forall key (table :: (* -&gt; *) -&gt; *) value.
(HasDbType key, HasSqlEqualityCheck Sqlite (DbType key),
 BeamSqlBackendCanSerialize Sqlite (DbType key)) =&gt;
(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var">queryKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity DatumRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#datumRows"><span class="hs-identifier hs-var hs-var">datumRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). DatumRowT f -&gt; Columnar f ByteString
forall (f :: * -&gt; *). DatumRowT f -&gt; Columnar f (DbType DatumHash)
</span><a href="Plutus.ChainIndex.DbSchema.html#_datumRowHash"><span class="hs-identifier hs-var hs-var">_datumRowHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). DatumRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_datumRowDatum"><span class="hs-identifier hs-var hs-var">_datumRowDatum</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="local-6989586621679725660"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTxFromTxId"><span class="hs-identifier hs-type">getTxFromTxId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725660"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725660"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-115"></span><span id="getTxFromTxId"><span class="annot"><span class="annottext">getTxFromTxId :: TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxFromTxId"><span class="hs-identifier hs-var hs-var">getTxFromTxId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var">queryOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe ChainIndexTx))
-&gt; (TxId -&gt; SqlSelect Sqlite ByteString)
-&gt; TxId
-&gt; Eff effs (Maybe ChainIndexTx)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT))
-&gt; (forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f (DbType TxId))
-&gt; (forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString)
-&gt; TxId
-&gt; SqlSelect Sqlite ByteString
forall key (table :: (* -&gt; *) -&gt; *) value.
(HasDbType key, HasSqlEqualityCheck Sqlite (DbType key),
 BeamSqlBackendCanSerialize Sqlite (DbType key)) =&gt;
(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var">queryKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var hs-var">txRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString
forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f (DbType TxId)
</span><a href="Plutus.ChainIndex.DbSchema.html#_txRowTxId"><span class="hs-identifier hs-var hs-var">_txRowTxId</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_txRowTx"><span class="hs-identifier hs-var hs-var">_txRowTx</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679725669"><span id="local-6989586621679725671"><span id="local-6989586621679725672"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-type">getScriptFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725672"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725671"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725671"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725669"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725669"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679725671"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725672"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725669"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-125"></span><span id="getScriptFromHash"><span class="annot"><span class="annottext">getScriptFromHash :: i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-var hs-var">getScriptFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe o)
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var">queryOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe o))
-&gt; (i -&gt; SqlSelect Sqlite ByteString) -&gt; i -&gt; Eff effs (Maybe o)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity ScriptRowT))
-&gt; (forall (f :: * -&gt; *). ScriptRowT f -&gt; Columnar f (DbType i))
-&gt; (forall (f :: * -&gt; *). ScriptRowT f -&gt; Columnar f ByteString)
-&gt; i
-&gt; SqlSelect Sqlite ByteString
forall key (table :: (* -&gt; *) -&gt; *) value.
(HasDbType key, HasSqlEqualityCheck Sqlite (DbType key),
 BeamSqlBackendCanSerialize Sqlite (DbType key)) =&gt;
(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var">queryKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity ScriptRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#scriptRows"><span class="hs-identifier hs-var hs-var">scriptRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ScriptRowT f -&gt; Columnar f ByteString
forall (f :: * -&gt; *). ScriptRowT f -&gt; Columnar f (DbType i)
</span><a href="Plutus.ChainIndex.DbSchema.html#_scriptRowHash"><span class="hs-identifier hs-var hs-var">_scriptRowHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). ScriptRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_scriptRowScript"><span class="hs-identifier hs-var hs-var">_scriptRowScript</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679725123"><span id="local-6989586621679725124"><span id="local-6989586621679725125"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getRedeemerFromHash"><span class="hs-identifier hs-type">getRedeemerFromHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725125"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725124"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725124"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725123"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725123"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679725124"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725125"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725123"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-135"></span><span id="getRedeemerFromHash"><span class="annot"><span class="annottext">getRedeemerFromHash :: i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getRedeemerFromHash"><span class="hs-identifier hs-var hs-var">getRedeemerFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe o)
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var">queryOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs (Maybe o))
-&gt; (i -&gt; SqlSelect Sqlite ByteString) -&gt; i -&gt; Eff effs (Maybe o)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity RedeemerRowT))
-&gt; (forall (f :: * -&gt; *). RedeemerRowT f -&gt; Columnar f (DbType i))
-&gt; (forall (f :: * -&gt; *). RedeemerRowT f -&gt; Columnar f ByteString)
-&gt; i
-&gt; SqlSelect Sqlite ByteString
forall key (table :: (* -&gt; *) -&gt; *) value.
(HasDbType key, HasSqlEqualityCheck Sqlite (DbType key),
 BeamSqlBackendCanSerialize Sqlite (DbType key)) =&gt;
(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var">queryKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity RedeemerRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#redeemerRows"><span class="hs-identifier hs-var hs-var">redeemerRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). RedeemerRowT f -&gt; Columnar f ByteString
forall (f :: * -&gt; *). RedeemerRowT f -&gt; Columnar f (DbType i)
</span><a href="Plutus.ChainIndex.DbSchema.html#_redeemerRowHash"><span class="hs-identifier hs-var hs-var">_redeemerRowHash</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). RedeemerRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_redeemerRowRedeemer"><span class="hs-identifier hs-var hs-var">_redeemerRowRedeemer</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679725604"><span id="local-6989586621679725605"><span id="local-6989586621679725608"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-type">queryKeyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725608"><span class="hs-identifier hs-type">key</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">HasSqlEqualityCheck</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725608"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendCanSerialize</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725608"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725612"><span class="annot"><a href="#local-6989586621679725612"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#Db"><span class="hs-identifier hs-type">Db</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725612"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679725612"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725605"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725610"><span class="annot"><a href="#local-6989586621679725610"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679725605"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725610"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">Columnar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725610"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725608"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725609"><span class="annot"><a href="#local-6989586621679725609"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679725605"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725609"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">Columnar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725609"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725604"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679725608"><span class="hs-identifier hs-type">key</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">SqlSelect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725604"><span class="hs-identifier hs-type">value</span></a></span></span></span></span><span>
</span><span id="line-146"></span><span id="queryKeyValue"><span class="annot"><span class="annottext">queryKeyValue :: (forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var hs-var">queryKeyValue</span></a></span></span><span> </span><span id="local-6989586621679725119"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table)
</span><a href="#local-6989586621679725119"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621679725118"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key)
</span><a href="#local-6989586621679725118"><span class="hs-identifier hs-var">getKey</span></a></span></span><span> </span><span id="local-6989586621679725117"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). table f -&gt; Columnar f value
</span><a href="#local-6989586621679725117"><span class="hs-identifier hs-var">getValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; DbType key
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679725115"><span class="annot"><span class="annottext">DbType key
</span><a href="#local-6989586621679725115"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope value)
-&gt; SqlSelect
     Sqlite
     (QExprToIdentity (QGenExpr QValueContext Sqlite QBaseScope value))
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope value)
 -&gt; SqlSelect
      Sqlite
      (QExprToIdentity (QGenExpr QValueContext Sqlite QBaseScope value)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope value)
-&gt; SqlSelect
     Sqlite
     (QExprToIdentity (QGenExpr QValueContext Sqlite QBaseScope value))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">table (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; QGenExpr QValueContext Sqlite QBaseScope value
forall (f :: * -&gt; *). table f -&gt; Columnar f value
</span><a href="#local-6989586621679725117"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">(table (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QGenExpr QValueContext Sqlite QBaseScope value)
-&gt; Q Sqlite
     Db
     QBaseScope
     (table (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(table (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QExpr Sqlite QBaseScope Bool)
-&gt; Q Sqlite
     Db
     QBaseScope
     (table (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (table (QGenExpr QValueContext Sqlite QBaseScope))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725113"><span class="annot"><span class="annottext">table (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679725113"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">table (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; Columnar (QGenExpr QValueContext Sqlite QBaseScope) (DbType key)
forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key)
</span><a href="#local-6989586621679725118"><span class="hs-identifier hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">table (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679725113"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite QBaseScope (DbType key)
-&gt; QGenExpr QValueContext Sqlite QBaseScope (DbType key)
-&gt; QExpr Sqlite QBaseScope Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope (DbType key))
-&gt; QGenExpr QValueContext Sqlite QBaseScope (DbType key)
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope (DbType key))
DbType key
</span><a href="#local-6989586621679725115"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity table)
-&gt; Q Sqlite
     Db
     QBaseScope
     (table (QGenExpr QValueContext Sqlite QBaseScope))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity table)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table)
</span><a href="#local-6989586621679725119"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679725613"><span id="local-6989586621679725614"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-type">queryOne</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725614"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725613"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">SqlSelect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725613"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725614"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725613"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-154"></span><span id="queryOne"><span class="annot"><span class="annottext">queryOne :: SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var hs-var">queryOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (DbType o) -&gt; Maybe o)
-&gt; Eff effs (Maybe (DbType o)) -&gt; Eff effs (Maybe o)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DbType o -&gt; o) -&gt; Maybe (DbType o) -&gt; Maybe o
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">DbType o -&gt; o
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff effs (Maybe (DbType o)) -&gt; Eff effs (Maybe o))
-&gt; (SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe (DbType o)))
-&gt; SqlSelect Sqlite (DbType o)
-&gt; Eff effs (Maybe o)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe (DbType o))
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679725478"><span id="local-6989586621679725479"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#queryList"><span class="hs-identifier hs-type">queryList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725479"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725478"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">SqlSelect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725478"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725479"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679725478"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-162"></span><span id="queryList"><span class="annot"><span class="annottext">queryList :: SqlSelect Sqlite (DbType o) -&gt; Eff effs [o]
</span><a href="Plutus.ChainIndex.Handlers.html#queryList"><span class="hs-identifier hs-var hs-var">queryList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([DbType o] -&gt; [o]) -&gt; Eff effs [DbType o] -&gt; Eff effs [o]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DbType o -&gt; o) -&gt; [DbType o] -&gt; [o]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">DbType o -&gt; o
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff effs [DbType o] -&gt; Eff effs [o])
-&gt; (SqlSelect Sqlite (DbType o) -&gt; Eff effs [DbType o])
-&gt; SqlSelect Sqlite (DbType o)
-&gt; Eff effs [o]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (DbType o) -&gt; Eff effs [DbType o]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Get the 'ChainIndexTxOut' for a 'TxOutRef'.</span><span>
</span><span id="line-166"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTxOutFromRef"><span class="hs-identifier hs-type">getTxOutFromRef</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725657"><span class="annot"><a href="#local-6989586621679725657"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725657"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725657"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725657"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">L.DecoratedTxOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span id="getTxOutFromRef"><span class="annot"><span class="annottext">getTxOutFromRef :: TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxOutFromRef"><span class="hs-identifier hs-var hs-var">getTxOutFromRef</span></a></span></span><span> </span><span id="local-6989586621679725111"><span class="annot"><span class="annottext">ref :: TxOutRef
</span><a href="#local-6989586621679725111"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">{</span><span id="local-6989586621679725109"><span class="annot"><span class="annottext">TxId
txOutRefId :: TxOutRef -&gt; TxId
txOutRefId :: TxId
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txOutRefId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679725107"><span class="annot"><span class="annottext">Integer
txOutRefIdx :: TxOutRef -&gt; Integer
txOutRefIdx :: Integer
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txOutRefIdx</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679725105"><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621679725105"><span class="hs-identifier hs-var">mTx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Eff effs (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxFromTxId"><span class="hs-identifier hs-var">getTxFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679725109"><span class="hs-identifier hs-var">txOutRefId</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- Find the output in the tx matching the output ref</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
</span><a href="#local-6989586621679725105"><span class="hs-identifier hs-var">mTx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTx
-&gt; Getting
     (First ChainIndexTxOut) (Maybe ChainIndexTx) ChainIndexTxOut
-&gt; Maybe ChainIndexTxOut
forall s a. s -&gt; Getting (First a) s a -&gt; Maybe a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; Const (First ChainIndexTxOut) ChainIndexTx)
-&gt; Maybe ChainIndexTx
-&gt; Const (First ChainIndexTxOut) (Maybe ChainIndexTx)
forall a b. Prism (Maybe a) (Maybe b) a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_Just</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexTx -&gt; Const (First ChainIndexTxOut) ChainIndexTx)
 -&gt; Maybe ChainIndexTx
 -&gt; Const (First ChainIndexTxOut) (Maybe ChainIndexTx))
-&gt; ((ChainIndexTxOut
     -&gt; Const (First ChainIndexTxOut) ChainIndexTxOut)
    -&gt; ChainIndexTx -&gt; Const (First ChainIndexTxOut) ChainIndexTx)
-&gt; Getting
     (First ChainIndexTxOut) (Maybe ChainIndexTx) ChainIndexTxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; [ChainIndexTxOut])
-&gt; Optic'
     (-&gt;) (Const (First ChainIndexTxOut)) ChainIndexTx [ChainIndexTxOut]
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [ChainIndexTxOut]
</span><a href="Plutus.ChainIndex.Tx.html#txOuts"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="annot"><span class="annottext">Optic'
  (-&gt;) (Const (First ChainIndexTxOut)) ChainIndexTx [ChainIndexTxOut]
-&gt; ((ChainIndexTxOut
     -&gt; Const (First ChainIndexTxOut) ChainIndexTxOut)
    -&gt; [ChainIndexTxOut]
    -&gt; Const (First ChainIndexTxOut) [ChainIndexTxOut])
-&gt; (ChainIndexTxOut
    -&gt; Const (First ChainIndexTxOut) ChainIndexTxOut)
-&gt; ChainIndexTx
-&gt; Const (First ChainIndexTxOut) ChainIndexTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index [ChainIndexTxOut]
-&gt; Traversal' [ChainIndexTxOut] (IxValue [ChainIndexTxOut])
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679725107"><span class="hs-identifier hs-var">txOutRefIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TxOutNotFound"><span class="hs-identifier hs-var">TxOutNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725111"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff effs ()
-&gt; Eff effs (Maybe DecoratedTxOut)
-&gt; Eff effs (Maybe DecoratedTxOut)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679725102"><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679725102"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#makeChainIndexTxOut"><span class="hs-identifier hs-var">makeChainIndexTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679725102"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Get the 'ChainIndexTxOut' for a 'TxOutRef'.</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getUtxoutFromRef"><span class="hs-identifier hs-type">getUtxoutFromRef</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725100"><span class="annot"><a href="#local-6989586621679725100"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725100"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725100"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725100"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">L.DecoratedTxOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="getUtxoutFromRef"><span class="annot"><span class="annottext">getUtxoutFromRef :: TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoutFromRef"><span class="hs-identifier hs-var hs-var">getUtxoutFromRef</span></a></span></span><span> </span><span id="local-6989586621679725099"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725099"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679725098"><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
</span><a href="#local-6989586621679725098"><span class="hs-identifier hs-var">mTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (DbType ChainIndexTxOut)
-&gt; Eff effs (Maybe ChainIndexTxOut)
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#queryOne"><span class="hs-identifier hs-var">queryOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite (DbType ChainIndexTxOut)
 -&gt; Eff effs (Maybe ChainIndexTxOut))
-&gt; SqlSelect Sqlite (DbType ChainIndexTxOut)
-&gt; Eff effs (Maybe ChainIndexTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT))
-&gt; (forall (f :: * -&gt; *).
    UtxoRowT f -&gt; Columnar f (DbType TxOutRef))
-&gt; (forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString)
-&gt; TxOutRef
-&gt; SqlSelect Sqlite ByteString
forall key (table :: (* -&gt; *) -&gt; *) value.
(HasDbType key, HasSqlEqualityCheck Sqlite (DbType key),
 BeamSqlBackendCanSerialize Sqlite (DbType key)) =&gt;
(forall (f :: * -&gt; *). Db f -&gt; f (TableEntity table))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f (DbType key))
-&gt; (forall (f :: * -&gt; *). table f -&gt; Columnar f value)
-&gt; key
-&gt; SqlSelect Sqlite value
</span><a href="Plutus.ChainIndex.Handlers.html#queryKeyValue"><span class="hs-identifier hs-var">queryKeyValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var hs-var">utxoOutRefRows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString
forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f (DbType TxOutRef)
</span><a href="Plutus.ChainIndex.DbSchema.html#_utxoRowOutRef"><span class="hs-identifier hs-var hs-var">_utxoRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_utxoRowTxOut"><span class="hs-identifier hs-var hs-var">_utxoRowTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725099"><span class="hs-identifier hs-var">txOutRef</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
</span><a href="#local-6989586621679725098"><span class="hs-identifier hs-var">mTxOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TxOutNotFound"><span class="hs-identifier hs-var">TxOutNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725099"><span class="hs-identifier hs-var">txOutRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff effs ()
-&gt; Eff effs (Maybe DecoratedTxOut)
-&gt; Eff effs (Maybe DecoratedTxOut)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679725094"><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679725094"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#makeChainIndexTxOut"><span class="hs-identifier hs-var">makeChainIndexTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679725094"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#makeChainIndexTxOut"><span class="hs-identifier hs-type">makeChainIndexTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725544"><span class="annot"><a href="#local-6989586621679725544"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725544"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725544"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndex.ChainIndexTxOut</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725544"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">L.DecoratedTxOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="makeChainIndexTxOut"><span class="annot"><span class="annottext">makeChainIndexTxOut :: ChainIndexTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#makeChainIndexTxOut"><span class="hs-identifier hs-var hs-var">makeChainIndexTxOut</span></a></span></span><span> </span><span id="local-6989586621679725093"><span class="annot"><span class="annottext">txout :: ChainIndexTxOut
</span><a href="#local-6989586621679725093"><span class="hs-identifier hs-var">txout</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndexTxOut</span></a></span><span> </span><span id="local-6989586621679725091"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621679725091"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span id="local-6989586621679725090"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679725090"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679725089"><span class="annot"><span class="annottext">OutputDatum
</span><a href="#local-6989586621679725089"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679725088"><span class="annot"><span class="annottext">ReferenceScript
</span><a href="#local-6989586621679725088"><span class="hs-identifier hs-var">refScript</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679725087"><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
</span><a href="#local-6989586621679725087"><span class="hs-identifier hs-var">datumWithHash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OutputDatum -&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
</span><a href="#local-6989586621679725086"><span class="hs-identifier hs-var">getDatumWithHash</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="#local-6989586621679725089"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Credential
forall era. AddressInEra era -&gt; Credential
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.cardanoAddressCredential</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621679725091"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">PubKeyCredential</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut))
-&gt; Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
-&gt; Value
-&gt; Maybe (DatumHash, DatumFromQuery)
-&gt; Maybe (Versioned Script)
-&gt; Maybe DecoratedTxOut
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.mkPubkeyDecoratedTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621679725091"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679725090"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
</span><a href="#local-6989586621679725087"><span class="hs-identifier hs-var">datumWithHash</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Script)
</span><a href="#local-6989586621679725083"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptCredential</span></a></span><span> </span><span id="local-6989586621679725081"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679725081"><span class="hs-identifier hs-var">vh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
</span><a href="#local-6989586621679725087"><span class="hs-identifier hs-var">datumWithHash</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679725080"><span class="annot"><span class="annottext">(DatumHash, DatumFromQuery)
</span><a href="#local-6989586621679725080"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>          </span><span id="local-6989586621679725079"><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679725079"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Eff effs (Maybe (Versioned Validator))
forall (effs :: [* -&gt; *]) i o.
(Member (BeamEffect Sqlite) effs, HasDbType i,
 DbType i ~ ByteString, HasDbType o, DbType o ~ ByteString) =&gt;
i -&gt; Eff effs (Maybe o)
</span><a href="Plutus.ChainIndex.Handlers.html#getScriptFromHash"><span class="hs-identifier hs-var">getScriptFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679725081"><span class="hs-identifier hs-var">vh</span></a></span><span>
</span><span id="line-211"></span><span>          </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut))
-&gt; Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
-&gt; Value
-&gt; (DatumHash, DatumFromQuery)
-&gt; Maybe (Versioned Script)
-&gt; Maybe (Versioned Validator)
-&gt; Maybe DecoratedTxOut
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.mkScriptDecoratedTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621679725091"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679725090"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash, DatumFromQuery)
</span><a href="#local-6989586621679725080"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Script)
</span><a href="#local-6989586621679725083"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679725079"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-comment">-- If the txout comes from a script address, the Datum should not be Nothing</span><span>
</span><span id="line-214"></span><span>          </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; Eff effs ()) -&gt; ChainIndexLog -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#NoDatumScriptAddr"><span class="hs-identifier hs-var">NoDatumScriptAddr</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679725093"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-215"></span><span>          </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; Eff effs (Maybe DecoratedTxOut)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621679725086"><span class="hs-identifier hs-type">getDatumWithHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725544"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">L.DatumFromQuery</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679725086"><span class="annot"><span class="annottext">getDatumWithHash :: OutputDatum -&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
</span><a href="#local-6989586621679725086"><span class="hs-identifier hs-var hs-var">getDatumWithHash</span></a></span></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">NoOutputDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
-&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="#local-6989586621679725086"><span class="hs-identifier hs-var">getDatumWithHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatumHash</span></a></span><span> </span><span id="local-6989586621679725074"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725074"><span class="hs-identifier hs-var">dh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>        </span><span id="local-6989586621679725073"><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679725073"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Eff effs (Maybe Datum)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
DatumHash -&gt; Eff effs (Maybe Datum)
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumFromHash"><span class="hs-identifier hs-var">getDatumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725074"><span class="hs-identifier hs-var">dh</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
-&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (DatumHash, DatumFromQuery)
 -&gt; Eff effs (Maybe (DatumHash, DatumFromQuery)))
-&gt; Maybe (DatumHash, DatumFromQuery)
-&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash, DatumFromQuery) -&gt; Maybe (DatumHash, DatumFromQuery)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725074"><span class="hs-identifier hs-var">dh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DatumFromQuery
-&gt; (Datum -&gt; DatumFromQuery) -&gt; Maybe Datum -&gt; DatumFromQuery
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">DatumFromQuery
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.DatumUnknown</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumFromQuery
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.DatumInBody</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679725073"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="#local-6989586621679725086"><span class="hs-identifier hs-var">getDatumWithHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span id="local-6989586621679725068"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679725068"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Maybe (DatumHash, DatumFromQuery)
-&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (DatumHash, DatumFromQuery)
 -&gt; Eff effs (Maybe (DatumHash, DatumFromQuery)))
-&gt; Maybe (DatumHash, DatumFromQuery)
-&gt; Eff effs (Maybe (DatumHash, DatumFromQuery))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash, DatumFromQuery) -&gt; Maybe (DatumHash, DatumFromQuery)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679725068"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumFromQuery
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">L.DatumInline</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679725068"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679725083"><span class="annot"><span class="annottext">script :: Maybe (Versioned Script)
</span><a href="#local-6989586621679725083"><span class="hs-identifier hs-var hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReferenceScript -&gt; Maybe (Versioned Script)
</span><a href="Plutus.ChainIndex.Types.html#fromReferenceScript"><span class="hs-identifier hs-var">fromReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><a href="#local-6989586621679725088"><span class="hs-identifier hs-var">refScript</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetAtAddress"><span class="hs-identifier hs-type">getUtxoSetAtAddress</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725633"><span class="annot"><a href="#local-6989586621679725633"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725633"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725633"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725633"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">PageQuery</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725633"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-type">UtxosResponse</span></a></span><span>
</span><span id="line-236"></span><span id="getUtxoSetAtAddress"><span class="annot"><span class="annottext">getUtxoSetAtAddress :: PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetAtAddress"><span class="hs-identifier hs-var hs-var">getUtxoSetAtAddress</span></a></span></span><span> </span><span id="local-6989586621679725066"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725066"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; DbType Credential
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679725065"><span class="annot"><span class="annottext">DbType Credential
</span><a href="#local-6989586621679725065"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679725064"><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725064"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; Eff effs (UtxoState TxUtxoBalance)
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#tip"><span class="hs-identifier hs-var">UtxoState.tip</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725064"><span class="hs-identifier hs-var">utxoState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>          </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TipIsGenesis"><span class="hs-identifier hs-var">TipIsGenesis</span></a></span><span>
</span><span id="line-242"></span><span>          </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Eff effs UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Page TxOutRef -&gt; UtxosResponse
</span><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-var">UtxosResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Maybe (PageQuery TxOutRef) -&gt; [TxOutRef] -&gt; Page TxOutRef
forall a. PageQuery a -&gt; Maybe (PageQuery a) -&gt; [a] -&gt; Page a
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Page</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725066"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>      </span><span id="local-6989586621679725062"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725062"><span class="hs-identifier hs-var">tp</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725061"><span class="annot"><span class="annottext">query :: Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725061"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>                </span><span id="local-6989586621679725060"><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725060"><span class="hs-identifier hs-var">rowRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowOutRef"><span class="hs-identifier hs-var hs-var">_unspentOutputRowOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>                </span><span id="local-6989586621679725057"><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725057"><span class="hs-identifier hs-var">rowCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested (QNested QBaseScope)))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; (WithRewrittenThread
      (QNested (QNested (QNested QBaseScope)))
      (QNested (QNested QBaseScope))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString)
    -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (Retag
        Nullable
        (WithRewrittenThread
           (QNested (QNested (QNested QBaseScope)))
           (QNested (QNested QBaseScope))
           (QGenExpr
              QValueContext
              Sqlite
              (QNested (QNested (QNested QBaseScope)))
              ByteString)))
forall s r be (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Projectible be r,
 ThreadRewritable (QNested s) r,
 Retaggable (QExpr be s) (WithRewrittenThread (QNested s) s r)) =&gt;
Q be db (QNested s) r
-&gt; (WithRewrittenThread (QNested s) s r -&gt; QExpr be s Bool)
-&gt; Q be db s (Retag Nullable (WithRewrittenThread (QNested s) s r))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">leftJoin_</span></a></span><span>
</span><span id="line-247"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AddressRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QGenExpr
      QValueContext
      Sqlite
      (QNested (QNested (QNested QBaseScope)))
      ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AddressRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowOutRef"><span class="hs-identifier hs-var hs-var">_addressRowOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AddressRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QExpr Sqlite (QNested (QNested (QNested QBaseScope))) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AddressRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AddressRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725055"><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
</span><a href="#local-6989586621679725055"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; Columnar
     (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowCred"><span class="hs-identifier hs-var hs-var">_addressRowCred</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
</span><a href="#local-6989586621679725055"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested (QNested QBaseScope)))
  ByteString
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
-&gt; QExpr Sqlite (QNested (QNested (QNested QBaseScope))) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
DbType Credential
</span><a href="#local-6989586621679725065"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AddressRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                           </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725052"><span class="annot"><span class="annottext">WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725052"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725052"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725060"><span class="hs-identifier hs-var">rowRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                </span><span id="local-6989586621679725051"><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725051"><span class="hs-identifier hs-var">utxi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested (QNested QBaseScope)))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; (WithRewrittenThread
      (QNested (QNested (QNested QBaseScope)))
      (QNested (QNested QBaseScope))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString)
    -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (Retag
        Nullable
        (WithRewrittenThread
           (QNested (QNested (QNested QBaseScope)))
           (QNested (QNested QBaseScope))
           (QGenExpr
              QValueContext
              Sqlite
              (QNested (QNested (QNested QBaseScope)))
              ByteString)))
forall s r be (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Projectible be r,
 ThreadRewritable (QNested s) r,
 Retaggable (QExpr be s) (WithRewrittenThread (QNested s) s r)) =&gt;
Q be db (QNested s) r
-&gt; (WithRewrittenThread (QNested s) s r -&gt; QExpr be s Bool)
-&gt; Q be db s (Retag Nullable (WithRewrittenThread (QNested s) s r))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">leftJoin_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnmatchedInputRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QGenExpr
      QValueContext
      Sqlite
      (QNested (QNested (QNested QBaseScope)))
      ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowOutRef"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested (QNested QBaseScope)))
   (UnmatchedInputRowT
      (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested (QNested QBaseScope)))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725048"><span class="annot"><span class="annottext">WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725048"><span class="hs-identifier hs-var">utxi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725060"><span class="hs-identifier hs-var">rowRef</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725048"><span class="hs-identifier hs-var">utxi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; Q Sqlite Db (QNested (QNested QBaseScope)) ()
forall be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
QExpr be s Bool -&gt; Q be db s ()
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">guard_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall be a nonNullA s ctxt.
SqlDeconstructMaybe be a nonNullA s =&gt;
a -&gt; QGenExpr ctxt be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">isNothing_</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725051"><span class="hs-identifier hs-var">utxi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; Q Sqlite Db (QNested (QNested QBaseScope)) ()
forall be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
QExpr be s Bool -&gt; Q be db s ()
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">guard_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall be a nonNullA s ctxt.
SqlDeconstructMaybe be a nonNullA s =&gt;
a -&gt; QGenExpr ctxt be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">isJust_</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725057"><span class="hs-identifier hs-var">rowCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725060"><span class="hs-identifier hs-var">rowRef</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>          </span><span id="local-6989586621679725047"><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725047"><span class="hs-identifier hs-var">outRefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PageQuery ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Eff effs (Page ByteString)
forall dbt a (db :: (* -&gt; *) -&gt; *) (effs :: [* -&gt; *]).
(FromBackendRow dbt a, HasSqlValueSyntax (Synt dbt) a,
 Member (BeamEffect dbt) effs, HasQBuilder dbt) =&gt;
PageQuery a
-&gt; Q dbt
     db
     (QNested (QNested QBaseScope))
     (QExpr dbt (QNested (QNested QBaseScope)) a)
-&gt; Eff effs (Page a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectPage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; ByteString)
-&gt; PageQuery TxOutRef -&gt; PageQuery ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725066"><span class="hs-identifier hs-var">pageQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725061"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725046"><span class="annot"><span class="annottext">page :: Page TxOutRef
</span><a href="#local-6989586621679725046"><span class="hs-identifier hs-var hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; TxOutRef) -&gt; Page ByteString -&gt; Page TxOutRef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725047"><span class="hs-identifier hs-var">outRefs</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>          </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Eff effs UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Page TxOutRef -&gt; UtxosResponse
</span><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-var">UtxosResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725062"><span class="hs-identifier hs-var">tp</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725046"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTxOutSetAtAddress"><span class="hs-identifier hs-type">getTxOutSetAtAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725631"><span class="annot"><a href="#local-6989586621679725631"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725631"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725631"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725631"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">PageQuery</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725631"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-type">QueryResponse</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">L.DecoratedTxOut</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span id="getTxOutSetAtAddress"><span class="annot"><span class="annottext">getTxOutSetAtAddress :: PageQuery TxOutRef
-&gt; Credential
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="Plutus.ChainIndex.Handlers.html#getTxOutSetAtAddress"><span class="hs-identifier hs-var hs-var">getTxOutSetAtAddress</span></a></span></span><span> </span><span id="local-6989586621679725045"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725045"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span id="local-6989586621679725044"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725044"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-type">UtxosResponse</span></a></span><span> </span><span id="local-6989586621679725043"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725043"><span class="hs-identifier hs-var">tip</span></a></span></span><span> </span><span id="local-6989586621679725042"><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725042"><span class="hs-identifier hs-var">page</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetAtAddress"><span class="hs-identifier hs-var">getUtxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725045"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679725044"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725043"><span class="hs-identifier hs-var">tip</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)]
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TxOutRef, DecoratedTxOut)]
-&gt; Maybe (PageQuery TxOutRef)
-&gt; QueryResponse [(TxOutRef, DecoratedTxOut)]
forall a. a -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse a
</span><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-var">QueryResponse</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="annottext">Tip
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621679725041"><span class="annot"><span class="annottext">[Maybe DecoratedTxOut]
</span><a href="#local-6989586621679725041"><span class="hs-identifier hs-var">mtxouts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut))
-&gt; [TxOutRef] -&gt; Eff effs [Maybe DecoratedTxOut]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoutFromRef"><span class="hs-identifier hs-var">getUtxoutFromRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; [TxOutRef]
forall a. Page a -&gt; [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var hs-var">pageItems</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725042"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725039"><span class="annot"><span class="annottext">txouts :: [(TxOutRef, DecoratedTxOut)]
</span><a href="#local-6989586621679725039"><span class="hs-identifier hs-var hs-var">txouts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725038"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679725037"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679725038"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725038"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679725036"><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621679725036"><span class="hs-identifier hs-var">mo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
-&gt; [Maybe DecoratedTxOut] -&gt; [(TxOutRef, Maybe DecoratedTxOut)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; [TxOutRef]
forall a. Page a -&gt; [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var hs-var">pageItems</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725042"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe DecoratedTxOut]
</span><a href="#local-6989586621679725041"><span class="hs-identifier hs-var">mtxouts</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679725037"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679725037"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut -&gt; [DecoratedTxOut]
forall a. Maybe a -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DecoratedTxOut
</span><a href="#local-6989586621679725036"><span class="hs-identifier hs-var">mo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">QueryResponse [(TxOutRef, DecoratedTxOut)]
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryResponse [(TxOutRef, DecoratedTxOut)]
 -&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)]))
-&gt; QueryResponse [(TxOutRef, DecoratedTxOut)]
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, DecoratedTxOut)]
-&gt; Maybe (PageQuery TxOutRef)
-&gt; QueryResponse [(TxOutRef, DecoratedTxOut)]
forall a. a -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse a
</span><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-var">QueryResponse</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, DecoratedTxOut)]
</span><a href="#local-6989586621679725039"><span class="hs-identifier hs-var">txouts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; Maybe (PageQuery TxOutRef)
forall a. Page a -&gt; Maybe (PageQuery a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var hs-var">nextPageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725042"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getDatumsAtAddress"><span class="hs-identifier hs-type">getDatumsAtAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725630"><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">PageQuery</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-type">QueryResponse</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span id="getDatumsAtAddress"><span class="annot"><span class="annottext">getDatumsAtAddress :: PageQuery TxOutRef
-&gt; Credential -&gt; Eff effs (QueryResponse [Datum])
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumsAtAddress"><span class="hs-identifier hs-var hs-var">getDatumsAtAddress</span></a></span></span><span> </span><span id="local-6989586621679725035"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725035"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; DbType Credential
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679725034"><span class="annot"><span class="annottext">DbType Credential
</span><a href="#local-6989586621679725034"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679725033"><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725033"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; Eff effs (UtxoState TxUtxoBalance)
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#tip"><span class="hs-identifier hs-var">UtxoState.tip</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725033"><span class="hs-identifier hs-var">utxoState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TipIsGenesis"><span class="hs-identifier hs-var">TipIsGenesis</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">QueryResponse [Datum] -&gt; Eff effs (QueryResponse [Datum])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Datum] -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse [Datum]
forall a. a -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse a
</span><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-var">QueryResponse</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">Tip
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725032"><span class="annot"><span class="annottext">emptyHash :: DbType DatumHash
</span><a href="#local-6989586621679725032"><span class="hs-identifier hs-var hs-var">emptyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; DbType DatumHash
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; DbType DatumHash) -&gt; DatumHash -&gt; DbType DatumHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">DatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">emptyByteString</span></a></span><span>
</span><span id="line-298"></span><span>          </span><span id="local-6989586621679725030"><span class="annot"><span class="annottext">queryPage :: Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725030"><span class="hs-identifier hs-var hs-var">queryPage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="annottext">(AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowOutRef"><span class="hs-identifier hs-var hs-var">_addressRowOutRef</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested QBaseScope))
   (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested QBaseScope))
      (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725029"><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
</span><a href="#local-6989586621679725029"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>                         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; Columnar
     (QExpr Sqlite (QNested (QNested QBaseScope))) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowCred"><span class="hs-identifier hs-var hs-var">_addressRowCred</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
</span><a href="#local-6989586621679725029"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
DbType Credential
</span><a href="#local-6989586621679725034"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>                         </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; Columnar
     (QExpr Sqlite (QNested (QNested QBaseScope))) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowDatumHash"><span class="hs-identifier hs-var hs-var">_addressRowDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
</span><a href="#local-6989586621679725029"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">/=.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725032"><span class="hs-identifier hs-var">emptyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested QBaseScope))
   (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested QBaseScope))
      (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>          </span><span id="local-6989586621679725027"><span class="annot"><span class="annottext">queryAll :: SqlSelect
  Sqlite
  (QExprToIdentity
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)))
</span><a href="#local-6989586621679725027"><span class="hs-identifier hs-var hs-var">queryAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect
     Sqlite
     (QExprToIdentity
        (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; SqlSelect
      Sqlite
      (QExprToIdentity
         (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))))
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect
     Sqlite
     (QExprToIdentity
        (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QExpr Sqlite QBaseScope Bool)
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725026"><span class="annot"><span class="annottext">AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679725026"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; Columnar (QGenExpr QValueContext Sqlite QBaseScope) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowCred"><span class="hs-identifier hs-var hs-var">_addressRowCred</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679725026"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite QBaseScope ByteString
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
-&gt; QExpr Sqlite QBaseScope Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
DbType Credential
</span><a href="#local-6989586621679725034"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-307"></span><span>                       </span><span class="annot"><span class="annottext">QExpr Sqlite QBaseScope Bool
-&gt; QExpr Sqlite QBaseScope Bool -&gt; QExpr Sqlite QBaseScope Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; Columnar (QGenExpr QValueContext Sqlite QBaseScope) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowDatumHash"><span class="hs-identifier hs-var hs-var">_addressRowDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679725026"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite QBaseScope ByteString
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
-&gt; QExpr Sqlite QBaseScope Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">/=.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
HaskellLiteralForQExpr
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
</span><a href="#local-6989586621679725032"><span class="hs-identifier hs-var">emptyHash</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Q Sqlite
      Db
      QBaseScope
      (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; Q Sqlite
     Db
     QBaseScope
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621679725025"><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725025"><span class="hs-identifier hs-var">pRefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PageQuery ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Eff effs (Page ByteString)
forall dbt a (db :: (* -&gt; *) -&gt; *) (effs :: [* -&gt; *]).
(FromBackendRow dbt a, HasSqlValueSyntax (Synt dbt) a,
 Member (BeamEffect dbt) effs, HasQBuilder dbt) =&gt;
PageQuery a
-&gt; Q dbt
     db
     (QNested (QNested QBaseScope))
     (QExpr dbt (QNested (QNested QBaseScope)) a)
-&gt; Eff effs (Page a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectPage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; ByteString)
-&gt; PageQuery TxOutRef -&gt; PageQuery ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725035"><span class="hs-identifier hs-var">pageQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725030"><span class="hs-identifier hs-var">queryPage</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725024"><span class="annot"><span class="annottext">page :: Page TxOutRef
</span><a href="#local-6989586621679725024"><span class="hs-identifier hs-var hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; TxOutRef) -&gt; Page ByteString -&gt; Page TxOutRef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725025"><span class="hs-identifier hs-var">pRefs</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621679725023"><span class="annot"><span class="annottext">[(Credential, TxOutRef, Maybe DatumHash)]
</span><a href="#local-6989586621679725023"><span class="hs-identifier hs-var">row_l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Credential, TxOutRef, Maybe DatumHash) -&gt; Bool)
-&gt; [(Credential, TxOutRef, Maybe DatumHash)]
-&gt; [(Credential, TxOutRef, Maybe DatumHash)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679725022"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725022"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; [TxOutRef] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.elem</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679725022"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; [TxOutRef]
forall a. Page a -&gt; [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var hs-var">pageItems</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725024"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Credential, TxOutRef, Maybe DatumHash)]
 -&gt; [(Credential, TxOutRef, Maybe DatumHash)])
-&gt; Eff effs [(Credential, TxOutRef, Maybe DatumHash)]
-&gt; Eff effs [(Credential, TxOutRef, Maybe DatumHash)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (DbType (Credential, TxOutRef, Maybe DatumHash))
-&gt; Eff effs [(Credential, TxOutRef, Maybe DatumHash)]
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs [o]
</span><a href="Plutus.ChainIndex.Handlers.html#queryList"><span class="hs-identifier hs-var">queryList</span></a></span><span> </span><span class="annot"><span class="annottext">SqlSelect
  Sqlite
  (QExprToIdentity
     (AddressRowT (QGenExpr QValueContext Sqlite QBaseScope)))
SqlSelect Sqlite (DbType (Credential, TxOutRef, Maybe DatumHash))
</span><a href="#local-6989586621679725027"><span class="hs-identifier hs-var">queryAll</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span id="local-6989586621679725020"><span class="annot"><span class="annottext">[Datum]
</span><a href="#local-6989586621679725020"><span class="hs-identifier hs-var">datums</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe Datum] -&gt; [Datum]
forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe Datum] -&gt; [Datum])
-&gt; Eff effs [Maybe Datum] -&gt; Eff effs [Datum]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Credential, TxOutRef, Maybe DatumHash) -&gt; Eff effs (Maybe Datum))
-&gt; [(Credential, TxOutRef, Maybe DatumHash)]
-&gt; Eff effs [Maybe Datum]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential, TxOutRef, Maybe DatumHash) -&gt; Eff effs (Maybe Datum)
</span><a href="#local-6989586621679725019"><span class="hs-identifier hs-var">f_map</span></a></span><span> </span><span class="annot"><span class="annottext">[(Credential, TxOutRef, Maybe DatumHash)]
</span><a href="#local-6989586621679725023"><span class="hs-identifier hs-var">row_l</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><span class="annottext">QueryResponse [Datum] -&gt; Eff effs (QueryResponse [Datum])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryResponse [Datum] -&gt; Eff effs (QueryResponse [Datum]))
-&gt; QueryResponse [Datum] -&gt; Eff effs (QueryResponse [Datum])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Datum] -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse [Datum]
forall a. a -&gt; Maybe (PageQuery TxOutRef) -&gt; QueryResponse a
</span><a href="Plutus.ChainIndex.Api.html#QueryResponse"><span class="hs-identifier hs-var">QueryResponse</span></a></span><span> </span><span class="annot"><span class="annottext">[Datum]
</span><a href="#local-6989586621679725020"><span class="hs-identifier hs-var">datums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; Maybe (PageQuery TxOutRef)
forall a. Page a -&gt; Maybe (PageQuery a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var hs-var">nextPageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725024"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621679725019"><span class="hs-identifier hs-type">f_map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725630"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679725019"><span class="annot"><span class="annottext">f_map :: (Credential, TxOutRef, Maybe DatumHash) -&gt; Eff effs (Maybe Datum)
</span><a href="#local-6989586621679725019"><span class="hs-identifier hs-var hs-var">f_map</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; Eff effs (Maybe Datum)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="#local-6989586621679725019"><span class="hs-identifier hs-var">f_map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679725018"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725018"><span class="hs-identifier hs-var">dh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Eff effs (Maybe Datum)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
DatumHash -&gt; Eff effs (Maybe Datum)
</span><a href="Plutus.ChainIndex.Handlers.html#getDatumFromHash"><span class="hs-identifier hs-var">getDatumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679725018"><span class="hs-identifier hs-var">dh</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetWithCurrency"><span class="hs-identifier hs-type">getUtxoSetWithCurrency</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725628"><span class="annot"><a href="#local-6989586621679725628"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725628"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725628"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725628"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">PageQuery</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725628"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-type">UtxosResponse</span></a></span><span>
</span><span id="line-330"></span><span id="getUtxoSetWithCurrency"><span class="annot"><span class="annottext">getUtxoSetWithCurrency :: PageQuery TxOutRef -&gt; AssetClass -&gt; Eff effs UtxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getUtxoSetWithCurrency"><span class="hs-identifier hs-var hs-var">getUtxoSetWithCurrency</span></a></span></span><span> </span><span id="local-6989586621679725017"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725017"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetClass -&gt; DbType AssetClass
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679725016"><span class="annot"><span class="annottext">DbType AssetClass
</span><a href="#local-6989586621679725016"><span class="hs-identifier hs-var">assetClass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679725015"><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725015"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; Eff effs (UtxoState TxUtxoBalance)
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#tip"><span class="hs-identifier hs-var">UtxoState.tip</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679725015"><span class="hs-identifier hs-var">utxoState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>          </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TipIsGenesis"><span class="hs-identifier hs-var">TipIsGenesis</span></a></span><span>
</span><span id="line-336"></span><span>          </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Eff effs UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Page TxOutRef -&gt; UtxosResponse
</span><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-var">UtxosResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Maybe (PageQuery TxOutRef) -&gt; [TxOutRef] -&gt; Page TxOutRef
forall a. PageQuery a -&gt; Maybe (PageQuery a) -&gt; [a] -&gt; Page a
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Page</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725017"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span id="local-6989586621679725014"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725014"><span class="hs-identifier hs-var">tp</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725013"><span class="annot"><span class="annottext">query :: Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725013"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>                </span><span id="local-6989586621679725012"><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725012"><span class="hs-identifier hs-var">rowRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowOutRef"><span class="hs-identifier hs-var hs-var">_unspentOutputRowOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (UnspentOutputRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>                </span><span id="local-6989586621679725011"><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725011"><span class="hs-identifier hs-var">rowClass</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested (QNested QBaseScope)))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; (WithRewrittenThread
      (QNested (QNested (QNested QBaseScope)))
      (QNested (QNested QBaseScope))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString)
    -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (Retag
        Nullable
        (WithRewrittenThread
           (QNested (QNested (QNested QBaseScope)))
           (QNested (QNested QBaseScope))
           (QGenExpr
              QValueContext
              Sqlite
              (QNested (QNested (QNested QBaseScope)))
              ByteString)))
forall s r be (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Projectible be r,
 ThreadRewritable (QNested s) r,
 Retaggable (QExpr be s) (WithRewrittenThread (QNested s) s r)) =&gt;
Q be db (QNested s) r
-&gt; (WithRewrittenThread (QNested s) s r -&gt; QExpr be s Bool)
-&gt; Q be db s (Retag Nullable (WithRewrittenThread (QNested s) s r))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">leftJoin_</span></a></span><span>
</span><span id="line-341"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AssetClassRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QGenExpr
      QValueContext
      Sqlite
      (QNested (QNested (QNested QBaseScope)))
      ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AssetClassRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClassRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall (f :: * -&gt; *). AssetClassRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_assetClassRowOutRef"><span class="hs-identifier hs-var hs-var">_assetClassRowOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AssetClassRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QExpr Sqlite (QNested (QNested (QNested QBaseScope))) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AssetClassRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AssetClassRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725009"><span class="annot"><span class="annottext">AssetClassRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
</span><a href="#local-6989586621679725009"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssetClassRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; Columnar
     (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))) ByteString
forall (f :: * -&gt; *). AssetClassRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_assetClassRowAssetClass"><span class="hs-identifier hs-var hs-var">_assetClassRowAssetClass</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClassRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
</span><a href="#local-6989586621679725009"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested (QNested QBaseScope)))
  ByteString
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
-&gt; QExpr Sqlite (QNested (QNested (QNested QBaseScope))) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
DbType AssetClass
</span><a href="#local-6989586621679725016"><span class="hs-identifier hs-var">assetClass</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (AssetClassRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AssetClassRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#assetClassRows"><span class="hs-identifier hs-var hs-var">assetClassRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725006"><span class="annot"><span class="annottext">WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725006"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725006"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725012"><span class="hs-identifier hs-var">rowRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                </span><span id="local-6989586621679725005"><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725005"><span class="hs-identifier hs-var">utxi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested (QNested QBaseScope)))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
-&gt; (WithRewrittenThread
      (QNested (QNested (QNested QBaseScope)))
      (QNested (QNested QBaseScope))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString)
    -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (Retag
        Nullable
        (WithRewrittenThread
           (QNested (QNested (QNested QBaseScope)))
           (QNested (QNested QBaseScope))
           (QGenExpr
              QValueContext
              Sqlite
              (QNested (QNested (QNested QBaseScope)))
              ByteString)))
forall s r be (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Projectible be r,
 ThreadRewritable (QNested s) r,
 Retaggable (QExpr be s) (WithRewrittenThread (QNested s) s r)) =&gt;
Q be db (QNested s) r
-&gt; (WithRewrittenThread (QNested s) s r -&gt; QExpr be s Bool)
-&gt; Q be db s (Retag Nullable (WithRewrittenThread (QNested s) s r))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">leftJoin_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnmatchedInputRowT
   (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
 -&gt; QGenExpr
      QValueContext
      Sqlite
      (QNested (QNested (QNested QBaseScope)))
      ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT
  (QExpr Sqlite (QNested (QNested (QNested QBaseScope))))
-&gt; QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowOutRef"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested (QNested QBaseScope)))
   (UnmatchedInputRowT
      (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested (QNested QBaseScope)))
      (QGenExpr
         QValueContext
         Sqlite
         (QNested (QNested (QNested QBaseScope)))
         ByteString))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (QGenExpr
        QValueContext
        Sqlite
        (QNested (QNested (QNested QBaseScope)))
        ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested (QNested QBaseScope)))
     (UnmatchedInputRowT
        (QExpr Sqlite (QNested (QNested (QNested QBaseScope)))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679725004"><span class="annot"><span class="annottext">WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725004"><span class="hs-identifier hs-var">utxi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725012"><span class="hs-identifier hs-var">rowRef</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
WithRewrittenThread
  (QNested (QNested (QNested QBaseScope)))
  (QNested (QNested QBaseScope))
  (QGenExpr
     QValueContext
     Sqlite
     (QNested (QNested (QNested QBaseScope)))
     ByteString)
</span><a href="#local-6989586621679725004"><span class="hs-identifier hs-var">utxi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; Q Sqlite Db (QNested (QNested QBaseScope)) ()
forall be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
QExpr be s Bool -&gt; Q be db s ()
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">guard_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall be a nonNullA s ctxt.
SqlDeconstructMaybe be a nonNullA s =&gt;
a -&gt; QGenExpr ctxt be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">isNothing_</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725005"><span class="hs-identifier hs-var">utxi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) Bool
-&gt; Q Sqlite Db (QNested (QNested QBaseScope)) ()
forall be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
QExpr be s Bool -&gt; Q be db s ()
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">guard_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall be a nonNullA s ctxt.
SqlDeconstructMaybe be a nonNullA s =&gt;
a -&gt; QGenExpr ctxt be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">isJust_</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr
  QValueContext
  Sqlite
  (QNested (QNested QBaseScope))
  (Maybe ByteString)
</span><a href="#local-6989586621679725011"><span class="hs-identifier hs-var">rowClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
</span><a href="#local-6989586621679725012"><span class="hs-identifier hs-var">rowRef</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>          </span><span id="local-6989586621679725003"><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725003"><span class="hs-identifier hs-var">outRefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PageQuery ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Eff effs (Page ByteString)
forall dbt a (db :: (* -&gt; *) -&gt; *) (effs :: [* -&gt; *]).
(FromBackendRow dbt a, HasSqlValueSyntax (Synt dbt) a,
 Member (BeamEffect dbt) effs, HasQBuilder dbt) =&gt;
PageQuery a
-&gt; Q dbt
     db
     (QNested (QNested QBaseScope))
     (QExpr dbt (QNested (QNested QBaseScope)) a)
-&gt; Eff effs (Page a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectPage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; ByteString)
-&gt; PageQuery TxOutRef -&gt; PageQuery ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679725017"><span class="hs-identifier hs-var">pageQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679725013"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679725002"><span class="annot"><span class="annottext">page :: Page TxOutRef
</span><a href="#local-6989586621679725002"><span class="hs-identifier hs-var hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; TxOutRef) -&gt; Page ByteString -&gt; Page TxOutRef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679725003"><span class="hs-identifier hs-var">outRefs</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>          </span><span class="annot"><span class="annottext">UtxosResponse -&gt; Eff effs UtxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Page TxOutRef -&gt; UtxosResponse
</span><a href="Plutus.ChainIndex.Api.html#UtxosResponse"><span class="hs-identifier hs-var">UtxosResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679725014"><span class="hs-identifier hs-var">tp</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679725002"><span class="hs-identifier hs-var">page</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTxsFromTxIds"><span class="hs-identifier hs-type">getTxsFromTxIds</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725625"><span class="annot"><a href="#local-6989586621679725625"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725625"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725625"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span id="getTxsFromTxIds"><span class="annot"><span class="annottext">getTxsFromTxIds :: [TxId] -&gt; Eff effs [ChainIndexTx]
</span><a href="Plutus.ChainIndex.Handlers.html#getTxsFromTxIds"><span class="hs-identifier hs-var hs-var">getTxsFromTxIds</span></a></span></span><span> </span><span id="local-6989586621679725001"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679725001"><span class="hs-identifier hs-var">txIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621679725000"><span class="annot"><span class="annottext">txIds' :: [ByteString]
</span><a href="#local-6989586621679725000"><span class="hs-identifier hs-var hs-var">txIds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxId -&gt; ByteString) -&gt; [TxId] -&gt; [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679725001"><span class="hs-identifier hs-var">txIds</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621679724999"><span class="annot"><span class="annottext">query :: Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
</span><a href="#local-6989586621679724999"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">(TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_txRowTx"><span class="hs-identifier hs-var hs-var">_txRowTx</span></a></span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope ByteString))
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QExpr Sqlite QBaseScope Bool)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724998"><span class="annot"><span class="annottext">TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679724998"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; Columnar (QGenExpr QValueContext Sqlite QBaseScope) ByteString
forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_txRowTxId"><span class="hs-identifier hs-var hs-var">_txRowTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
</span><a href="#local-6989586621679724998"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite QBaseScope ByteString
-&gt; [QGenExpr QValueContext Sqlite QBaseScope ByteString]
-&gt; QExpr Sqlite QBaseScope Bool
forall (expr :: * -&gt; *) a. SqlIn expr a =&gt; a -&gt; [a] -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">`in_`</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; [ByteString]
-&gt; [QGenExpr QValueContext Sqlite QBaseScope ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679725000"><span class="hs-identifier hs-var">txIds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>          </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Q Sqlite
      Db
      QBaseScope
      (TxRowT (QGenExpr QValueContext Sqlite QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TxRowT)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TxRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var hs-var">txRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679724997"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679724997"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs [ByteString]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs [ByteString])
-&gt; SqlSelect Sqlite ByteString -&gt; Eff effs [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; SqlSelect
     Sqlite
     (QExprToIdentity
        (QGenExpr QValueContext Sqlite QBaseScope ByteString))
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
</span><a href="#local-6989586621679724999"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; Eff effs [ChainIndexTx]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([ChainIndexTx] -&gt; Eff effs [ChainIndexTx])
-&gt; [ChainIndexTx] -&gt; Eff effs [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ChainIndexTx) -&gt; [ByteString] -&gt; [ChainIndexTx]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainIndexTx
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679724997"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#getTxoSetAtAddress"><span class="hs-identifier hs-type">getTxoSetAtAddress</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725626"><span class="annot"><a href="#local-6989586621679725626"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725626"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725626"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725626"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">PageQuery</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725626"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Api.html#TxosResponse"><span class="hs-identifier hs-type">TxosResponse</span></a></span><span>
</span><span id="line-379"></span><span id="getTxoSetAtAddress"><span class="annot"><span class="annottext">getTxoSetAtAddress :: PageQuery TxOutRef -&gt; Credential -&gt; Eff effs TxosResponse
</span><a href="Plutus.ChainIndex.Handlers.html#getTxoSetAtAddress"><span class="hs-identifier hs-var hs-var">getTxoSetAtAddress</span></a></span></span><span> </span><span id="local-6989586621679724996"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679724996"><span class="hs-identifier hs-var">pageQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; DbType Credential
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679724995"><span class="annot"><span class="annottext">DbType Credential
</span><a href="#local-6989586621679724995"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679724994"><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724994"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; Eff effs (UtxoState TxUtxoBalance)
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#tip"><span class="hs-identifier hs-var">UtxoState.tip</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724994"><span class="hs-identifier hs-var">utxoState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logWarn</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#TipIsGenesis"><span class="hs-identifier hs-var">TipIsGenesis</span></a></span><span>
</span><span id="line-384"></span><span>          </span><span class="annot"><span class="annottext">TxosResponse -&gt; Eff effs TxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Page TxOutRef -&gt; TxosResponse
</span><a href="Plutus.ChainIndex.Api.html#TxosResponse"><span class="hs-identifier hs-var">TxosResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Maybe (PageQuery TxOutRef) -&gt; [TxOutRef] -&gt; Page TxOutRef
forall a. PageQuery a -&gt; Maybe (PageQuery a) -&gt; [a] -&gt; Page a
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Page</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679724996"><span class="hs-identifier hs-var">pageQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PageQuery TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="annottext">Tip
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-386"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679724993"><span class="annot"><span class="annottext">query :: Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679724993"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>                </span><span class="annot"><span class="annottext">(AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowOutRef"><span class="hs-identifier hs-var hs-var">_addressRowOutRef</span></a></span><span>
</span><span id="line-388"></span><span>                  </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested QBaseScope))
   (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested QBaseScope))
      (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
 -&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724992"><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
</span><a href="#local-6989586621679724992"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
-&gt; Columnar
     (QExpr Sqlite (QNested (QNested QBaseScope))) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowCred"><span class="hs-identifier hs-var hs-var">_addressRowCred</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))
</span><a href="#local-6989586621679724992"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; QExpr Sqlite (QNested (QNested QBaseScope)) ByteString
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
DbType Credential
</span><a href="#local-6989586621679724995"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>                  </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested (QNested QBaseScope))
   (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
 -&gt; Q Sqlite
      Db
      (QNested (QNested QBaseScope))
      (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope)))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (AddressRowT (QExpr Sqlite (QNested (QNested QBaseScope))))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>          </span><span id="local-6989586621679724991"><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679724991"><span class="hs-identifier hs-var">txOutRefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PageQuery ByteString
-&gt; Q Sqlite
     Db
     (QNested (QNested QBaseScope))
     (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
-&gt; Eff effs (Page ByteString)
forall dbt a (db :: (* -&gt; *) -&gt; *) (effs :: [* -&gt; *]).
(FromBackendRow dbt a, HasSqlValueSyntax (Synt dbt) a,
 Member (BeamEffect dbt) effs, HasQBuilder dbt) =&gt;
PageQuery a
-&gt; Q dbt
     db
     (QNested (QNested QBaseScope))
     (QExpr dbt (QNested (QNested QBaseScope)) a)
-&gt; Eff effs (Page a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectPage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; ByteString)
-&gt; PageQuery TxOutRef -&gt; PageQuery ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621679724996"><span class="hs-identifier hs-var">pageQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested (QNested QBaseScope))
  (QExpr Sqlite (QNested (QNested QBaseScope)) ByteString)
</span><a href="#local-6989586621679724993"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-391"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679724990"><span class="annot"><span class="annottext">page :: Page TxOutRef
</span><a href="#local-6989586621679724990"><span class="hs-identifier hs-var hs-var">page</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; TxOutRef) -&gt; Page ByteString -&gt; Page TxOutRef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Page ByteString
</span><a href="#local-6989586621679724991"><span class="hs-identifier hs-var">txOutRefs'</span></a></span><span>
</span><span id="line-392"></span><span>          </span><span class="annot"><span class="annottext">TxosResponse -&gt; Eff effs TxosResponse
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxosResponse -&gt; Eff effs TxosResponse)
-&gt; TxosResponse -&gt; Eff effs TxosResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef -&gt; TxosResponse
</span><a href="Plutus.ChainIndex.Api.html#TxosResponse"><span class="hs-identifier hs-var">TxosResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Page TxOutRef
</span><a href="#local-6989586621679724990"><span class="hs-identifier hs-var">page</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#appendBlocks"><span class="hs-identifier hs-type">appendBlocks</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679725427"><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainSyncBlock"><span class="hs-identifier hs-type">ChainSyncBlock</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725427"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span id="appendBlocks"><span class="annot"><span class="annottext">appendBlocks :: [ChainSyncBlock] -&gt; Eff effs ()
</span><a href="Plutus.ChainIndex.Handlers.html#appendBlocks"><span class="hs-identifier hs-var hs-var">appendBlocks</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#appendBlocks"><span class="hs-identifier hs-var">appendBlocks</span></a></span><span> </span><span id="local-6989586621679724988"><span class="annot"><span class="annottext">[ChainSyncBlock]
</span><a href="#local-6989586621679724988"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-405"></span><span>        </span><span id="local-6989586621679724987"><span class="annot"><span class="annottext">processBlock :: (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
 [UtxoState TxUtxoBalance])
-&gt; ChainSyncBlock
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
</span><a href="#local-6989586621679724987"><span class="hs-identifier hs-var hs-var">processBlock</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679724986"><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724986"><span class="hs-identifier hs-var">utxoIndexState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724985"><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724985"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724984"><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724984"><span class="hs-identifier hs-var">utxoStates</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621679724982"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724982"><span class="hs-identifier hs-var">tip_</span></a></span></span><span> </span><span id="local-6989586621679724981"><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724981"><span class="hs-identifier hs-var">transactions</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679724980"><span class="annot"><span class="annottext">newUtxoState :: UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724980"><span class="hs-identifier hs-var hs-var">newUtxoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tip -&gt; [ChainIndexTx] -&gt; UtxoState TxUtxoBalance
</span><a href="Plutus.ChainIndex.TxUtxoBalance.html#fromBlock"><span class="hs-identifier hs-var">TxUtxoBalance.fromBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724982"><span class="hs-identifier hs-var">tip_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ChainIndexTx, TxProcessOption) -&gt; ChainIndexTx)
-&gt; [(ChainIndexTx, TxProcessOption)] -&gt; [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx, TxProcessOption) -&gt; ChainIndexTx
forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724981"><span class="hs-identifier hs-var">transactions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
-&gt; ChainIndexState
-&gt; Either InsertUtxoFailed (InsertUtxoSuccess TxUtxoBalance)
forall a.
(Monoid a, Eq a) =&gt;
UtxoState a
-&gt; UtxoIndex a -&gt; Either InsertUtxoFailed (InsertUtxoSuccess a)
</span><a href="Plutus.ChainIndex.UtxoState.html#insert"><span class="hs-identifier hs-var">UtxoState.insert</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724980"><span class="hs-identifier hs-var">newUtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724986"><span class="hs-identifier hs-var">utxoIndexState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-408"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679724977"><span class="annot"><span class="annottext">InsertUtxoFailed
</span><a href="#local-6989586621679724977"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>                    </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; Eff effs ()) -&gt; ChainIndexLog -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#Err"><span class="hs-identifier hs-var">Err</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexError -&gt; ChainIndexLog)
-&gt; ChainIndexError -&gt; ChainIndexLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InsertUtxoFailed -&gt; ChainIndexError
</span><a href="Plutus.ChainIndex.ChainIndexError.html#InsertionFailed"><span class="hs-identifier hs-var">InsertionFailed</span></a></span><span> </span><span class="annot"><span class="annottext">InsertUtxoFailed
</span><a href="#local-6989586621679724977"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-410"></span><span>                    </span><span class="annot"><span class="annottext">(ChainIndexState, [(ChainIndexTx, TxProcessOption)],
 [UtxoState TxUtxoBalance])
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724986"><span class="hs-identifier hs-var">utxoIndexState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724985"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724984"><span class="hs-identifier hs-var">utxoStates</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#InsertUtxoSuccess"><span class="hs-identifier hs-type">InsertUtxoSuccess</span></a></span><span class="hs-special">{</span><span id="local-6989586621679724973"><span class="annot"><span class="annottext">ChainIndexState
newIndex :: forall a. InsertUtxoSuccess a -&gt; UtxoIndex a
newIndex :: ChainIndexState
</span><a href="Plutus.ChainIndex.UtxoState.html#newIndex"><span class="hs-identifier hs-var hs-var">newIndex</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724971"><span class="annot"><span class="annottext">InsertUtxoPosition
insertPosition :: forall a. InsertUtxoSuccess a -&gt; InsertUtxoPosition
insertPosition :: InsertUtxoPosition
</span><a href="Plutus.ChainIndex.UtxoState.html#insertPosition"><span class="hs-identifier hs-var hs-var">insertPosition</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>                    </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; Eff effs ()) -&gt; ChainIndexLog -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; InsertUtxoPosition -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#InsertionSuccess"><span class="hs-identifier hs-var">InsertionSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724982"><span class="hs-identifier hs-var">tip_</span></a></span><span> </span><span class="annot"><span class="annottext">InsertUtxoPosition
</span><a href="#local-6989586621679724971"><span class="hs-identifier hs-var">insertPosition</span></a></span><span>
</span><span id="line-413"></span><span>                    </span><span class="annot"><span class="annottext">(ChainIndexState, [(ChainIndexTx, TxProcessOption)],
 [UtxoState TxUtxoBalance])
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724973"><span class="hs-identifier hs-var">newIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724981"><span class="hs-identifier hs-var">transactions</span></a></span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
-&gt; [(ChainIndexTx, TxProcessOption)]
-&gt; [(ChainIndexTx, TxProcessOption)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724985"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724980"><span class="hs-identifier hs-var">newUtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance
-&gt; [UtxoState TxUtxoBalance] -&gt; [UtxoState TxUtxoBalance]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724984"><span class="hs-identifier hs-var">utxoStates</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679724968"><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724968"><span class="hs-identifier hs-var">oldIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State ChainIndexState) effs =&gt;
Eff effs ChainIndexState
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679724967"><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724967"><span class="hs-identifier hs-var">newIndex</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724966"><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724966"><span class="hs-identifier hs-var">transactions</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724965"><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724965"><span class="hs-identifier hs-var">utxoStates</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((ChainIndexState, [(ChainIndexTx, TxProcessOption)],
  [UtxoState TxUtxoBalance])
 -&gt; ChainSyncBlock
 -&gt; Eff
      effs
      (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
       [UtxoState TxUtxoBalance]))
-&gt; (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
    [UtxoState TxUtxoBalance])
-&gt; [ChainSyncBlock]
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexState, [(ChainIndexTx, TxProcessOption)],
 [UtxoState TxUtxoBalance])
-&gt; ChainSyncBlock
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
forall (effs :: [* -&gt; *]).
FindElem (LogMsg ChainIndexLog) effs =&gt;
(ChainIndexState, [(ChainIndexTx, TxProcessOption)],
 [UtxoState TxUtxoBalance])
-&gt; ChainSyncBlock
-&gt; Eff
     effs
     (ChainIndexState, [(ChainIndexTx, TxProcessOption)],
      [UtxoState TxUtxoBalance])
</span><a href="#local-6989586621679724987"><span class="hs-identifier hs-var">processBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724968"><span class="hs-identifier hs-var">oldIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ChainSyncBlock]
</span><a href="#local-6989586621679724988"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679724964"><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621679724964"><span class="hs-identifier hs-var">depth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader Depth) effs =&gt;
Eff effs Depth
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679724963"><span class="annot"><span class="annottext">BeamEffect Sqlite ()
</span><a href="#local-6989586621679724963"><span class="hs-identifier hs-var">reduceOldUtxoDbEffect</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Depth -&gt; ChainIndexState -&gt; ReduceBlockCountResult TxUtxoBalance
forall a.
Monoid a =&gt;
Depth -&gt; UtxoIndex a -&gt; ReduceBlockCountResult a
</span><a href="Plutus.ChainIndex.UtxoState.html#reduceBlockCount"><span class="hs-identifier hs-var">UtxoState.reduceBlockCount</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="#local-6989586621679724964"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724967"><span class="hs-identifier hs-var">newIndex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance
</span><a href="Plutus.ChainIndex.UtxoState.html#BlockCountNotReduced"><span class="hs-identifier hs-var">UtxoState.BlockCountNotReduced</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><span class="annottext">ChainIndexState -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724967"><span class="hs-identifier hs-var">newIndex</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ())
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ()))
-&gt; BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; BeamEffect Sqlite ()
forall dbt. [BeamEffect dbt ()] -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Combined</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>      </span><span id="local-6989586621679724959"><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance
</span><a href="#local-6989586621679724959"><span class="hs-identifier hs-var">lbcResult</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><span class="annottext">ChainIndexState -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; Eff effs ()) -&gt; ChainIndexState -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance -&gt; ChainIndexState
forall a. ReduceBlockCountResult a -&gt; UtxoIndex a
</span><a href="Plutus.ChainIndex.UtxoState.html#reducedIndex"><span class="hs-identifier hs-var hs-var">UtxoState.reducedIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance
</span><a href="#local-6989586621679724959"><span class="hs-identifier hs-var">lbcResult</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ())
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ()))
-&gt; BeamEffect Sqlite () -&gt; Eff effs (BeamEffect Sqlite ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#reduceOldUtxoDb"><span class="hs-identifier hs-var">reduceOldUtxoDb</span></a></span><span> </span><span class="annot"><span class="annottext">(Tip -&gt; BeamEffect Sqlite ()) -&gt; Tip -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Tip
forall a. UtxoState a -&gt; Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#_usTip"><span class="hs-identifier hs-var hs-var">UtxoState._usTip</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoState TxUtxoBalance -&gt; Tip) -&gt; UtxoState TxUtxoBalance -&gt; Tip
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance -&gt; UtxoState TxUtxoBalance
forall a. ReduceBlockCountResult a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#combinedState"><span class="hs-identifier hs-var hs-var">UtxoState.combinedState</span></a></span><span> </span><span class="annot"><span class="annottext">ReduceBlockCountResult TxUtxoBalance
</span><a href="#local-6989586621679724959"><span class="hs-identifier hs-var">lbcResult</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; Eff effs ()
forall dbt (effs :: [* -&gt; *]).
Member (BeamEffect dbt) effs =&gt;
[BeamEffect dbt ()] -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">combined</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BeamEffect Sqlite ()
</span><a href="#local-6989586621679724963"><span class="hs-identifier hs-var">reduceOldUtxoDbEffect</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Db InsertRows -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#insertRows"><span class="hs-identifier hs-var">insertRows</span></a></span><span> </span><span class="annot"><span class="annottext">(Db InsertRows -&gt; BeamEffect Sqlite ())
-&gt; Db InsertRows -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexTx, TxProcessOption) -&gt; Db InsertRows)
-&gt; [(ChainIndexTx, TxProcessOption)] -&gt; Db InsertRows
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679724952"><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724952"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724951"><span class="annot"><span class="annottext">TxProcessOption
</span><a href="#local-6989586621679724951"><span class="hs-identifier hs-var">opt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TxProcessOption -&gt; Bool
</span><a href="Plutus.ChainIndex.Types.html#tpoStoreTx"><span class="hs-identifier hs-var hs-var">tpoStoreTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxProcessOption
</span><a href="#local-6989586621679724951"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; Db InsertRows
</span><a href="Plutus.ChainIndex.Handlers.html#fromTx"><span class="hs-identifier hs-var">fromTx</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724952"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Db InsertRows
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724966"><span class="hs-identifier hs-var">transactions</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx] -&gt; [UtxoState TxUtxoBalance] -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#insertUtxoDb"><span class="hs-identifier hs-var">insertUtxoDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ChainIndexTx, TxProcessOption) -&gt; ChainIndexTx)
-&gt; [(ChainIndexTx, TxProcessOption)] -&gt; [ChainIndexTx]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx, TxProcessOption) -&gt; ChainIndexTx
forall a b. (a, b) -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTx, TxProcessOption)]
</span><a href="#local-6989586621679724966"><span class="hs-identifier hs-var">transactions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724965"><span class="hs-identifier hs-var">utxoStates</span></a></span><span>
</span><span id="line-428"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#handleControl"><span class="hs-identifier hs-type">handleControl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679724947"><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexError.html#ChainIndexError"><span class="hs-identifier hs-type">ChainIndexError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.ChainIndexLog.html#ChainIndexLog"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ChainIndexControlEffect"><span class="hs-identifier hs-type">ChainIndexControlEffect</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-440"></span><span id="handleControl"><span class="annot"><span class="annottext">handleControl :: ChainIndexControlEffect ~&gt; Eff effs
</span><a href="Plutus.ChainIndex.Handlers.html#handleControl"><span class="hs-identifier hs-var hs-var">handleControl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#AppendBlocks"><span class="hs-identifier hs-type">AppendBlocks</span></a></span><span> </span><span id="local-6989586621679724945"><span class="annot"><span class="annottext">[ChainSyncBlock]
</span><a href="#local-6989586621679724945"><span class="hs-identifier hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ChainSyncBlock] -&gt; Eff effs ()
forall (effs :: [* -&gt; *]).
(Member (State ChainIndexState) effs, Member (Reader Depth) effs,
 Member (BeamEffect Sqlite) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
[ChainSyncBlock] -&gt; Eff effs ()
</span><a href="Plutus.ChainIndex.Handlers.html#appendBlocks"><span class="hs-identifier hs-var">appendBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainSyncBlock]
</span><a href="#local-6989586621679724945"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#Rollback"><span class="hs-identifier hs-type">Rollback</span></a></span><span> </span><span id="local-6989586621679724943"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679724943"><span class="hs-identifier hs-var">tip_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>        </span><span id="local-6989586621679724942"><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724942"><span class="hs-identifier hs-var">oldIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State ChainIndexState) effs =&gt;
Eff effs ChainIndexState
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point
-&gt; ChainIndexState
-&gt; Either RollbackFailed (RollbackResult TxUtxoBalance)
</span><a href="Plutus.ChainIndex.TxUtxoBalance.html#rollback"><span class="hs-identifier hs-var">TxUtxoBalance.rollback</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679724943"><span class="hs-identifier hs-var">tip_</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724942"><span class="hs-identifier hs-var">oldIndex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-445"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679724940"><span class="annot"><span class="annottext">RollbackFailed
</span><a href="#local-6989586621679724940"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679724939"><span class="annot"><span class="annottext">reason :: ChainIndexError
</span><a href="#local-6989586621679724939"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RollbackFailed -&gt; ChainIndexError
</span><a href="Plutus.ChainIndex.ChainIndexError.html#RollbackFailed"><span class="hs-identifier hs-var">RollbackFailed</span></a></span><span> </span><span class="annot"><span class="annottext">RollbackFailed
</span><a href="#local-6989586621679724940"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-447"></span><span>                </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; Eff effs ()) -&gt; ChainIndexLog -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#Err"><span class="hs-identifier hs-var">Err</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError
</span><a href="#local-6989586621679724939"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-448"></span><span>                </span><span class="annot"><span class="annottext">ChainIndexError -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError
</span><a href="#local-6989586621679724939"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-449"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#RollbackResult"><span class="hs-identifier hs-type">RollbackResult</span></a></span><span class="hs-special">{</span><span id="local-6989586621679724936"><span class="annot"><span class="annottext">Tip
newTip :: forall a. RollbackResult a -&gt; Tip
newTip :: Tip
</span><a href="Plutus.ChainIndex.UtxoState.html#newTip"><span class="hs-identifier hs-var hs-var">newTip</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724934"><span class="annot"><span class="annottext">ChainIndexState
rolledBackIndex :: forall a. RollbackResult a -&gt; UtxoIndex a
rolledBackIndex :: ChainIndexState
</span><a href="Plutus.ChainIndex.UtxoState.html#rolledBackIndex"><span class="hs-identifier hs-var hs-var">rolledBackIndex</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>                </span><span class="annot"><span class="annottext">ChainIndexState -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724934"><span class="hs-identifier hs-var">rolledBackIndex</span></a></span><span>
</span><span id="line-451"></span><span>                </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; Eff effs ()
forall dbt (effs :: [* -&gt; *]).
Member (BeamEffect dbt) effs =&gt;
[BeamEffect dbt ()] -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">combined</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#rollbackUtxoDb"><span class="hs-identifier hs-var">rollbackUtxoDb</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; BeamEffect Sqlite ()) -&gt; Point -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; Point
</span><a href="Plutus.ChainIndex.Types.html#tipAsPoint"><span class="hs-identifier hs-var">tipAsPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724936"><span class="hs-identifier hs-var">newTip</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>                </span><span class="annot"><span class="annottext">ChainIndexLog -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; Eff effs ()) -&gt; ChainIndexLog -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tip -&gt; ChainIndexLog
</span><a href="Plutus.ChainIndex.ChainIndexLog.html#RollbackSuccess"><span class="hs-identifier hs-var">RollbackSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724936"><span class="hs-identifier hs-var">newTip</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Effects.html#ResumeSync"><span class="hs-identifier hs-type">ResumeSync</span></a></span><span> </span><span id="local-6989586621679724929"><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679724929"><span class="hs-identifier hs-var">tip_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; Eff effs ()
forall dbt (effs :: [* -&gt; *]).
Member (BeamEffect dbt) effs =&gt;
[BeamEffect dbt ()] -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">combined</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#rollbackUtxoDb"><span class="hs-identifier hs-var">rollbackUtxoDb</span></a></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="#local-6989586621679724929"><span class="hs-identifier hs-var">tip_</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>        </span><span id="local-6989586621679724928"><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724928"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs ChainIndexState
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
Eff effs ChainIndexState
</span><a href="Plutus.ChainIndex.Handlers.html#restoreStateFromDb"><span class="hs-identifier hs-var">restoreStateFromDb</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="annottext">ChainIndexState -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState
</span><a href="#local-6989586621679724928"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexControlEffect x
</span><a href="Plutus.ChainIndex.Effects.html#CollectGarbage"><span class="hs-identifier hs-var">CollectGarbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>        </span><span class="hs-comment">-- Rebuild the index using only transactions that still have at</span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-comment">-- least one output in the UTXO set</span><span>
</span><span id="line-460"></span><span>        </span><span id="local-6989586621679724926"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679724926"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; [TxId]) -&gt; Eff effs [TxId]
forall s a (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
(s -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexState -&gt; [TxId]) -&gt; Eff effs [TxId])
-&gt; (ChainIndexState -&gt; [TxId]) -&gt; Eff effs [TxId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-461"></span><span>            </span><span class="annot"><span class="annottext">Set TxId -&gt; [TxId]
forall a. Set a -&gt; [a]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span>
</span><span id="line-462"></span><span>            </span><span class="annot"><span class="annottext">(Set TxId -&gt; [TxId])
-&gt; (ChainIndexState -&gt; Set TxId) -&gt; ChainIndexState -&gt; [TxId]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; TxId) -&gt; Set TxOutRef -&gt; Set TxId
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.map</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxId
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txOutRefId</span></a></span><span>
</span><span id="line-463"></span><span>            </span><span class="annot"><span class="annottext">(Set TxOutRef -&gt; Set TxId)
-&gt; (ChainIndexState -&gt; Set TxOutRef) -&gt; ChainIndexState -&gt; Set TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; Set TxOutRef
</span><a href="Plutus.ChainIndex.TxUtxoBalance.html#unspentOutputs"><span class="hs-identifier hs-var">TxUtxoBalance.unspentOutputs</span></a></span><span>
</span><span id="line-464"></span><span>            </span><span class="annot"><span class="annottext">(UtxoState TxUtxoBalance -&gt; Set TxOutRef)
-&gt; (ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; ChainIndexState
-&gt; Set TxOutRef
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679724922"><span class="annot"><span class="annottext">Db InsertRows
</span><a href="#local-6989586621679724922"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; Db InsertRows) -&gt; [ChainIndexTx] -&gt; Db InsertRows
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; Db InsertRows
</span><a href="Plutus.ChainIndex.Handlers.html#fromTx"><span class="hs-identifier hs-var">fromTx</span></a></span><span> </span><span class="annot"><span class="annottext">([ChainIndexTx] -&gt; Db InsertRows)
-&gt; ([Maybe ChainIndexTx] -&gt; [ChainIndexTx])
-&gt; [Maybe ChainIndexTx]
-&gt; Db InsertRows
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe ChainIndexTx] -&gt; [ChainIndexTx]
forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe ChainIndexTx] -&gt; Db InsertRows)
-&gt; Eff effs [Maybe ChainIndexTx] -&gt; Eff effs (Db InsertRows)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TxId -&gt; Eff effs (Maybe ChainIndexTx))
-&gt; [TxId] -&gt; Eff effs [Maybe ChainIndexTx]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Eff effs (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]).
Member (BeamEffect Sqlite) effs =&gt;
TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><a href="Plutus.ChainIndex.Handlers.html#getTxFromTxId"><span class="hs-identifier hs-var">getTxFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679724926"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; Eff effs ()
forall dbt (effs :: [* -&gt; *]).
Member (BeamEffect dbt) effs =&gt;
[BeamEffect dbt ()] -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">combined</span></a></span><span> </span><span class="annot"><span class="annottext">([BeamEffect Sqlite ()] -&gt; Eff effs ())
-&gt; [BeamEffect Sqlite ()] -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-467"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite DatumRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite DatumRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite DatumRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity DatumRowT)
-&gt; SqlDelete Sqlite DatumRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity DatumRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity DatumRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#datumRows"><span class="hs-identifier hs-var hs-var">datumRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite ScriptRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite ScriptRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite ScriptRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity ScriptRowT)
-&gt; SqlDelete Sqlite ScriptRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity ScriptRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity ScriptRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#scriptRows"><span class="hs-identifier hs-var hs-var">scriptRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite RedeemerRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite RedeemerRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite RedeemerRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity RedeemerRowT)
-&gt; SqlDelete Sqlite RedeemerRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity RedeemerRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity RedeemerRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#redeemerRows"><span class="hs-identifier hs-var hs-var">redeemerRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite TxRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite TxRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite TxRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TxRowT)
-&gt; SqlDelete Sqlite TxRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TxRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var hs-var">txRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
-&gt; SqlDelete Sqlite UtxoRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var hs-var">utxoOutRefRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite AddressRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite AddressRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite AddressRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; SqlDelete Sqlite AddressRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite AssetClassRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite AssetClassRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite AssetClassRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
-&gt; SqlDelete Sqlite AssetClassRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var">truncateTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AssetClassRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#assetClassRows"><span class="hs-identifier hs-var hs-var">assetClassRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()]
-&gt; [BeamEffect Sqlite ()] -&gt; [BeamEffect Sqlite ()]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Const [BeamEffect Sqlite ()] (Db Any) -&gt; [BeamEffect Sqlite ()]
forall a k (b :: k). Const a b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">getConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Any
-&gt; (forall tbl.
    (IsDatabaseEntity Any tbl,
     DatabaseEntityRegularRequirements Any tbl) =&gt;
    DatabaseEntity Sqlite Db tbl
    -&gt; InsertRows tbl -&gt; Const [BeamEffect Sqlite ()] (Any tbl))
-&gt; Db (DatabaseEntity Sqlite Db)
-&gt; Db InsertRows
-&gt; Const [BeamEffect Sqlite ()] (Db Any)
forall be (db :: (* -&gt; *) -&gt; *) (m :: * -&gt; *) (f :: * -&gt; *)
       (g :: * -&gt; *) (h :: * -&gt; *).
(Database be db, Applicative m) =&gt;
Proxy be
-&gt; (forall tbl.
    (IsDatabaseEntity be tbl,
     DatabaseEntityRegularRequirements be tbl) =&gt;
    f tbl -&gt; g tbl -&gt; m (h tbl))
-&gt; db f
-&gt; db g
-&gt; m (db h)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">zipTables</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Any
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724917"><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db tbl
</span><a href="#local-6989586621679724917"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span id="local-6989586621679724915"><span class="annot"><a href="#local-6989586621679724915"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; Const [BeamEffect Sqlite ()] (Any tbl)
forall k a (b :: k). a -&gt; Const a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
-&gt; DatabaseEntity Sqlite Db (TableEntity t)
-&gt; [t Identity]
-&gt; BeamEffect Sqlite ()
forall dbt (table :: (* -&gt; *) -&gt; *) (db :: (* -&gt; *) -&gt; *).
BeamableDb dbt table =&gt;
Int
-&gt; DatabaseEntity dbt db (TableEntity table)
-&gt; [table Identity]
-&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">AddRowsInBatches</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Plutus.ChainIndex.Handlers.html#batchSize"><span class="hs-identifier hs-var">batchSize</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db tbl
DatabaseEntity Sqlite Db (TableEntity t)
</span><a href="#local-6989586621679724917"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">[t Identity]
</span><a href="#local-6989586621679724915"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Db InsertRows
</span><a href="#local-6989586621679724922"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>            </span><span id="local-6989586621679724920"><span class="annot"><span class="annottext">truncateTable :: DatabaseEntity be db (TableEntity table) -&gt; SqlDelete be table
</span><a href="#local-6989586621679724920"><span class="hs-identifier hs-var hs-var">truncateTable</span></a></span></span><span> </span><span id="local-6989586621679724911"><span class="annot"><span class="annottext">DatabaseEntity be db (TableEntity table)
</span><a href="#local-6989586621679724911"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity be db (TableEntity table)
</span><a href="#local-6989586621679724911"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QExpr be s Bool -&gt; table (QExpr be Any) -&gt; QExpr be s Bool
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QExpr be s Bool) -&gt; QExpr be s Bool
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
HaskellLiteralForQExpr (QExpr be s Bool)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexControlEffect x
</span><a href="Plutus.ChainIndex.Effects.html#GetDiagnostics"><span class="hs-identifier hs-var">GetDiagnostics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff effs x
forall (effs :: [* -&gt; *]).
(Member (BeamEffect Sqlite) effs,
 Member (State ChainIndexState) effs) =&gt;
Eff effs Diagnostics
</span><a href="Plutus.ChainIndex.Handlers.html#diagnostics"><span class="hs-identifier hs-var">diagnostics</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">-- Use a batch size of 200 so that we don't hit the sql too-many-variables</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- limit.</span><span>
</span><span id="line-483"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#batchSize"><span class="hs-identifier hs-type">batchSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-484"></span><span id="batchSize"><span class="annot"><span class="annottext">batchSize :: Int
</span><a href="Plutus.ChainIndex.Handlers.html#batchSize"><span class="hs-identifier hs-var hs-var">batchSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#insertUtxoDb"><span class="hs-identifier hs-type">insertUtxoDb</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState.UtxoState</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span id="insertUtxoDb"><span class="annot"><span class="annottext">insertUtxoDb :: [ChainIndexTx] -&gt; [UtxoState TxUtxoBalance] -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#insertUtxoDb"><span class="hs-identifier hs-var hs-var">insertUtxoDb</span></a></span></span><span> </span><span id="local-6989586621679724907"><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621679724907"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span id="local-6989586621679724906"><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724906"><span class="hs-identifier hs-var">utxoStates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-492"></span><span>        </span><span id="local-6989586621679724905"><span class="annot"><span class="annottext">go :: ([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
-&gt; UtxoState TxUtxoBalance
-&gt; ([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
</span><a href="#local-6989586621679724905"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679724904"><span class="annot"><span class="annottext">([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
</span><a href="#local-6989586621679724904"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState.UtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">TxUtxoBalance
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
</span><a href="#local-6989586621679724904"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><a href="#local-6989586621679724905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679724902"><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724902"><span class="hs-identifier hs-var">tipRows</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724901"><span class="annot"><span class="annottext">[UnspentOutputRowT f]
</span><a href="#local-6989586621679724901"><span class="hs-identifier hs-var">unspentRows</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724900"><span class="annot"><span class="annottext">[UnmatchedInputRowT f]
</span><a href="#local-6989586621679724900"><span class="hs-identifier hs-var">unmatchedRows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState.UtxoState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span> </span><span id="local-6989586621679724898"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724898"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span id="local-6989586621679724897"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724897"><span class="hs-identifier hs-var">inputs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679724896"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724896"><span class="hs-identifier hs-var">tip</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-495"></span><span>                </span><span id="local-6989586621679724895"><span class="annot"><span class="annottext">tipRowId :: PrimaryKey TipRowT f
</span><a href="#local-6989586621679724895"><span class="hs-identifier hs-var hs-var">tipRowId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Columnar f Word64 -&gt; PrimaryKey TipRowT f
forall (f :: * -&gt; *). Columnar f Word64 -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#TipRowId"><span class="hs-identifier hs-var">TipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; DbType Slot
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tip -&gt; Slot
</span><a href="Plutus.ChainIndex.Types.html#tipSlot"><span class="hs-identifier hs-var hs-var">tipSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724896"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>                </span><span id="local-6989586621679724892"><span class="annot"><span class="annottext">newTips :: [TipRow]
</span><a href="#local-6989586621679724892"><span class="hs-identifier hs-var hs-var">newTips</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe TipRow] -&gt; [TipRow]
forall a. [Maybe a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tip -&gt; DbType Tip
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621679724896"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-497"></span><span>                </span><span id="local-6989586621679724891"><span class="annot"><span class="annottext">newUnspent :: [UnspentOutputRowT f]
</span><a href="#local-6989586621679724891"><span class="hs-identifier hs-var hs-var">newUnspent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT f
-&gt; Columnar f ByteString -&gt; UnspentOutputRowT f
forall (f :: * -&gt; *).
PrimaryKey TipRowT f
-&gt; Columnar f ByteString -&gt; UnspentOutputRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#UnspentOutputRow"><span class="hs-identifier hs-var">UnspentOutputRow</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT f
</span><a href="#local-6989586621679724895"><span class="hs-identifier hs-var">tipRowId</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; UnspentOutputRowT f)
-&gt; (TxOutRef -&gt; ByteString) -&gt; TxOutRef -&gt; UnspentOutputRowT f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; UnspentOutputRowT f)
-&gt; [TxOutRef] -&gt; [UnspentOutputRowT f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; [TxOutRef]
forall a. Set a -&gt; [a]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724898"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-498"></span><span>                </span><span id="local-6989586621679724889"><span class="annot"><span class="annottext">newUnmatched :: [UnmatchedInputRowT f]
</span><a href="#local-6989586621679724889"><span class="hs-identifier hs-var hs-var">newUnmatched</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT f
-&gt; Columnar f ByteString -&gt; UnmatchedInputRowT f
forall (f :: * -&gt; *).
PrimaryKey TipRowT f
-&gt; Columnar f ByteString -&gt; UnmatchedInputRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#UnmatchedInputRow"><span class="hs-identifier hs-var">UnmatchedInputRow</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT f
</span><a href="#local-6989586621679724895"><span class="hs-identifier hs-var">tipRowId</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; UnmatchedInputRowT f)
-&gt; (TxOutRef -&gt; ByteString) -&gt; TxOutRef -&gt; UnmatchedInputRowT f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ByteString
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; UnmatchedInputRowT f)
-&gt; [TxOutRef] -&gt; [UnmatchedInputRowT f]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; [TxOutRef]
forall a. Set a -&gt; [a]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724897"><span class="hs-identifier hs-var">inputs</span></a></span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-500"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724892"><span class="hs-identifier hs-var">newTips</span></a></span><span> </span><span class="annot"><span class="annottext">[TipRow] -&gt; [TipRow] -&gt; [TipRow]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724902"><span class="hs-identifier hs-var">tipRows</span></a></span><span>
</span><span id="line-501"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT f]
</span><a href="#local-6989586621679724891"><span class="hs-identifier hs-var">newUnspent</span></a></span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT f]
-&gt; [UnspentOutputRowT f] -&gt; [UnspentOutputRowT f]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT f]
</span><a href="#local-6989586621679724901"><span class="hs-identifier hs-var">unspentRows</span></a></span><span>
</span><span id="line-502"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT f]
</span><a href="#local-6989586621679724889"><span class="hs-identifier hs-var">newUnmatched</span></a></span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT f]
-&gt; [UnmatchedInputRowT f] -&gt; [UnmatchedInputRowT f]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT f]
</span><a href="#local-6989586621679724900"><span class="hs-identifier hs-var">unmatchedRows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679724887"><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724887"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724886"><span class="annot"><span class="annottext">[UnspentOutputRowT Identity]
</span><a href="#local-6989586621679724886"><span class="hs-identifier hs-var">ur</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724885"><span class="annot"><span class="annottext">[UnmatchedInputRowT Identity]
</span><a href="#local-6989586621679724885"><span class="hs-identifier hs-var">umr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([TipRow], [UnspentOutputRowT Identity],
  [UnmatchedInputRowT Identity])
 -&gt; UtxoState TxUtxoBalance
 -&gt; ([TipRow], [UnspentOutputRowT Identity],
     [UnmatchedInputRowT Identity]))
-&gt; ([TipRow], [UnspentOutputRowT Identity],
    [UnmatchedInputRowT Identity])
-&gt; [UtxoState TxUtxoBalance]
-&gt; ([TipRow], [UnspentOutputRowT Identity],
    [UnmatchedInputRowT Identity])
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">([TipRow], [UnspentOutputRowT Identity],
 [UnmatchedInputRowT Identity])
-&gt; UtxoState TxUtxoBalance
-&gt; ([TipRow], [UnspentOutputRowT Identity],
    [UnmatchedInputRowT Identity])
forall (f :: * -&gt; *).
(Columnar f Word64 ~ Word64, Columnar f ByteString ~ ByteString) =&gt;
([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
-&gt; UtxoState TxUtxoBalance
-&gt; ([TipRow], [UnspentOutputRowT f], [UnmatchedInputRowT f])
</span><a href="#local-6989586621679724905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#TipRow"><span class="hs-identifier hs-type">TipRow</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnspentOutputRow"><span class="hs-identifier hs-type">UnspentOutputRow</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnmatchedInputRow"><span class="hs-identifier hs-type">UnmatchedInputRow</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance]
</span><a href="#local-6989586621679724906"><span class="hs-identifier hs-var">utxoStates</span></a></span><span>
</span><span id="line-504"></span><span>        </span><span id="local-6989586621679724881"><span class="annot"><span class="annottext">outs :: [(ChainIndexTxOut, TxOutRef)]
</span><a href="#local-6989586621679724881"><span class="hs-identifier hs-var hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)])
-&gt; [ChainIndexTx] -&gt; [(ChainIndexTxOut, TxOutRef)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)]
</span><a href="Plutus.ChainIndex.Tx.html#txOutsWithRef"><span class="hs-identifier hs-var">txOutsWithRef</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTx]
</span><a href="#local-6989586621679724907"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Db InsertRows -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#insertRows"><span class="hs-identifier hs-var">insertRows</span></a></span><span> </span><span class="annot"><span class="annottext">(Db InsertRows -&gt; BeamEffect Sqlite ())
-&gt; Db InsertRows -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Db InsertRows
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-506"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tipRows :: InsertRows (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var">tipRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TipRow] -&gt; InsertRows (TableEntity TipRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724887"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unspentOutputRows :: InsertRows (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var">unspentOutputRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT Identity]
-&gt; InsertRows (TableEntity UnspentOutputRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT Identity]
</span><a href="#local-6989586621679724886"><span class="hs-identifier hs-var">ur</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unmatchedInputRows :: InsertRows (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var">unmatchedInputRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT Identity]
-&gt; InsertRows (TableEntity UnmatchedInputRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT Identity]
</span><a href="#local-6989586621679724885"><span class="hs-identifier hs-var">umr</span></a></span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxoOutRefRows :: InsertRows (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var">utxoOutRefRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UtxoRowT Identity] -&gt; InsertRows (TableEntity UtxoRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">([UtxoRowT Identity] -&gt; InsertRows (TableEntity UtxoRowT))
-&gt; [UtxoRowT Identity] -&gt; InsertRows (TableEntity UtxoRowT)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexTxOut, TxOutRef) -&gt; UtxoRowT Identity)
-&gt; [(ChainIndexTxOut, TxOutRef)] -&gt; [UtxoRowT Identity]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679724878"><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679724878"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724877"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724877"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar Identity ByteString
-&gt; Columnar Identity ByteString -&gt; UtxoRowT Identity
forall (f :: * -&gt; *).
Columnar f ByteString -&gt; Columnar f ByteString -&gt; UtxoRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#UtxoRow"><span class="hs-identifier hs-var">UtxoRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; DbType TxOutRef
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724877"><span class="hs-identifier hs-var">txOutRef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; DbType ChainIndexTxOut
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><a href="#local-6989586621679724878"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ChainIndexTxOut, TxOutRef)]
</span><a href="#local-6989586621679724881"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#reduceOldUtxoDb"><span class="hs-identifier hs-type">reduceOldUtxoDb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span id="reduceOldUtxoDb"><span class="annot"><span class="annottext">reduceOldUtxoDb :: Tip -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#reduceOldUtxoDb"><span class="hs-identifier hs-var hs-var">reduceOldUtxoDb</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="Plutus.ChainIndex.Types.html#TipAtGenesis"><span class="hs-identifier hs-var">TipAtGenesis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; BeamEffect Sqlite ()
forall dbt. [BeamEffect dbt ()] -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Combined</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#reduceOldUtxoDb"><span class="hs-identifier hs-var">reduceOldUtxoDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Tip"><span class="hs-identifier hs-type">Tip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; DbType Slot
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679724874"><span class="annot"><span class="annottext">DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlockNumber
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; BeamEffect Sqlite ()
forall dbt. [BeamEffect dbt ()] -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Combined</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-comment">-- Delete all the tips before 'slot'</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; (forall s.
    (forall s'. TipRowT (QExpr Sqlite s')) -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite TipRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724873"><span class="annot"><span class="annottext">forall s'. TipRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724873"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite s) -&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#_tipRowSlot"><span class="hs-identifier hs-var hs-var">_tipRowSlot</span></a></span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite s)
forall s'. TipRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724873"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&lt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-comment">-- Assign all the older utxo changes to 'slot'</span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlUpdate Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlUpdate dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">UpdateRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlUpdate Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlUpdate Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; (forall s. UnspentOutputRowT (QField s) -&gt; QAssignment Sqlite s)
-&gt; (forall s.
    UnspentOutputRowT (QExpr Sqlite s) -&gt; QExpr Sqlite s Bool)
-&gt; SqlUpdate Sqlite UnspentOutputRowT
forall be (table :: (* -&gt; *) -&gt; *) (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Beamable table) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. table (QField s) -&gt; QAssignment be s)
-&gt; (forall s. table (QExpr be s) -&gt; QExpr be s Bool)
-&gt; SqlUpdate be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724871"><span class="annot"><span class="annottext">UnspentOutputRowT (QField s)
</span><a href="#local-6989586621679724871"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QField s) -&gt; PrimaryKey TipRowT (QField s)
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowTip"><span class="hs-identifier hs-var hs-var">_unspentOutputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QField s)
</span><a href="#local-6989586621679724871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QField s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s) -&gt; QAssignment Sqlite s
forall be s lhs rhs.
SqlUpdatable be s lhs rhs =&gt;
lhs -&gt; rhs -&gt; QAssignment be s
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&lt;-.</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Sqlite s) Word64
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). Columnar f Word64 -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#TipRowId"><span class="hs-identifier hs-var">TipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724869"><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724869"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowTip"><span class="hs-identifier hs-var hs-var">_unspentOutputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724869"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&lt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlUpdate Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlUpdate dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">UpdateRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlUpdate Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlUpdate Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; (forall s.
    UnmatchedInputRowT (QField s) -&gt; QAssignment Sqlite s)
-&gt; (forall s.
    UnmatchedInputRowT (QExpr Sqlite s) -&gt; QExpr Sqlite s Bool)
-&gt; SqlUpdate Sqlite UnmatchedInputRowT
forall be (table :: (* -&gt; *) -&gt; *) (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Beamable table) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. table (QField s) -&gt; QAssignment be s)
-&gt; (forall s. table (QExpr be s) -&gt; QExpr be s Bool)
-&gt; SqlUpdate be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724867"><span class="annot"><span class="annottext">UnmatchedInputRowT (QField s)
</span><a href="#local-6989586621679724867"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QField s) -&gt; PrimaryKey TipRowT (QField s)
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowTip"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QField s)
</span><a href="#local-6989586621679724867"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QField s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s) -&gt; QAssignment Sqlite s
forall be s lhs rhs.
SqlUpdatable be s lhs rhs =&gt;
lhs -&gt; rhs -&gt; QAssignment be s
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&lt;-.</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Sqlite s) Word64
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). Columnar f Word64 -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#TipRowId"><span class="hs-identifier hs-var">TipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724865"><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724865"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowTip"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724865"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&lt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">-- Among these older changes, delete the matching input/output pairs</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- We're deleting only the outputs here, the matching input is deleted by a trigger (See Main.hs)</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
-&gt; (forall s.
    (forall s'. UtxoRowT (QExpr Sqlite s')) -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite UtxoRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var hs-var">utxoOutRefRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724864"><span class="annot"><span class="annottext">forall s'. UtxoRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724864"><span class="hs-identifier hs-var">utxoRow</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-531"></span><span>            </span><span class="annot"><span class="annottext">Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
-&gt; QExpr Sqlite s Bool
forall be a (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, HasQBuilder be, Projectible be a) =&gt;
Q be db s a -&gt; QExpr be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">exists_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnmatchedInputRowT (QExpr Sqlite s) -&gt; QExpr Sqlite s Bool)
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span>
</span><span id="line-532"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724863"><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724863"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowTip"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724863"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span>
</span><span id="line-534"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoRowT (QExpr Sqlite s) -&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_utxoRowOutRef"><span class="hs-identifier hs-var hs-var">_utxoRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoRowT (QExpr Sqlite s)
forall s'. UtxoRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724864"><span class="hs-identifier hs-var">utxoRow</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s ByteString
-&gt; QGenExpr QValueContext Sqlite s ByteString
-&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowOutRef"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724863"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; (forall s.
    (forall s'. UnspentOutputRowT (QExpr Sqlite s'))
    -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite UnspentOutputRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span>
</span><span id="line-537"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724862"><span class="annot"><span class="annottext">forall s'. UnspentOutputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724862"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowTip"><span class="hs-identifier hs-var hs-var">_unspentOutputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
forall s'. UnspentOutputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724862"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span>
</span><span id="line-539"></span><span>            </span><span class="annot"><span class="annottext">Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
-&gt; QExpr Sqlite s Bool
forall be a (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, HasQBuilder be, Projectible be a) =&gt;
Q be db s a -&gt; QExpr be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">exists_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnmatchedInputRowT (QExpr Sqlite s) -&gt; QExpr Sqlite s Bool)
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span>
</span><span id="line-540"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724861"><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724861"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-541"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowTip"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724861"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724874"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span>
</span><span id="line-542"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowOutRef"><span class="hs-identifier hs-var hs-var">_unspentOutputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
forall s'. UnspentOutputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724862"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s ByteString
-&gt; QGenExpr QValueContext Sqlite s ByteString
-&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowOutRef"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724861"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; Q Sqlite Db s (UnmatchedInputRowT (QExpr Sqlite s))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#rollbackUtxoDb"><span class="hs-identifier hs-type">rollbackUtxoDb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span id="rollbackUtxoDb"><span class="annot"><span class="annottext">rollbackUtxoDb :: Point -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#rollbackUtxoDb"><span class="hs-identifier hs-var hs-var">rollbackUtxoDb</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point
</span><a href="Plutus.ChainIndex.Types.html#PointAtGenesis"><span class="hs-identifier hs-var">PointAtGenesis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; (forall s.
    (forall s'. TipRowT (QExpr Sqlite s')) -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite TipRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QExpr Sqlite s Bool
-&gt; TipRowT (QExpr Sqlite Any) -&gt; QExpr Sqlite s Bool
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QExpr Sqlite s Bool) -&gt; QExpr Sqlite s Bool
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
HaskellLiteralForQExpr (QExpr Sqlite s Bool)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#rollbackUtxoDb"><span class="hs-identifier hs-var">rollbackUtxoDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; DbType Slot
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679724858"><span class="annot"><span class="annottext">DbType Slot
</span><a href="#local-6989586621679724858"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BlockId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BeamEffect Sqlite ()] -&gt; BeamEffect Sqlite ()
forall dbt. [BeamEffect dbt ()] -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Combined</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite TipRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; (forall s.
    (forall s'. TipRowT (QExpr Sqlite s')) -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite TipRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724857"><span class="annot"><span class="annottext">forall s'. TipRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724857"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite s) -&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#_tipRowSlot"><span class="hs-identifier hs-var hs-var">_tipRowSlot</span></a></span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite s)
forall s'. TipRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724857"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724858"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UtxoRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
-&gt; (forall s.
    (forall s'. UtxoRowT (QExpr Sqlite s')) -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite UtxoRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var hs-var">utxoOutRefRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724856"><span class="annot"><span class="annottext">forall s'. UtxoRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724856"><span class="hs-identifier hs-var">utxoRow</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-552"></span><span>            </span><span class="annot"><span class="annottext">Q Sqlite Db s (UnspentOutputRowT (QExpr Sqlite s))
-&gt; QExpr Sqlite s Bool
forall be a (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, HasQBuilder be, Projectible be a) =&gt;
Q be db s a -&gt; QExpr be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">exists_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnspentOutputRowT (QExpr Sqlite s) -&gt; QExpr Sqlite s Bool)
-&gt; Q Sqlite Db s (UnspentOutputRowT (QExpr Sqlite s))
-&gt; Q Sqlite Db s (UnspentOutputRowT (QExpr Sqlite s))
forall r be (db :: (* -&gt; *) -&gt; *) s.
BeamSqlBackend be =&gt;
(r -&gt; QExpr be s Bool) -&gt; Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">filter_</span></a></span><span>
</span><span id="line-553"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724855"><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724855"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowTip"><span class="hs-identifier hs-var hs-var">_unspentOutputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724855"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724858"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool -&gt; QExpr Sqlite s Bool
forall be context s.
BeamSqlBackend be =&gt;
QGenExpr context be s Bool
-&gt; QGenExpr context be s Bool -&gt; QGenExpr context be s Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&amp;&amp;.</span></a></span><span>
</span><span id="line-555"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoRowT (QExpr Sqlite s) -&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_utxoRowOutRef"><span class="hs-identifier hs-var hs-var">_utxoRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoRowT (QExpr Sqlite s)
forall s'. UtxoRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724856"><span class="hs-identifier hs-var">utxoRow</span></a></span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s ByteString
-&gt; QGenExpr QValueContext Sqlite s ByteString
-&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) a. SqlEq expr a =&gt; a -&gt; a -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">==.</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) ByteString
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowOutRef"><span class="hs-identifier hs-var hs-var">_unspentOutputRowOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
</span><a href="#local-6989586621679724855"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; Q Sqlite Db s (UnspentOutputRowT (QExpr Sqlite s))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UnspentOutputRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; (forall s.
    (forall s'. UnspentOutputRowT (QExpr Sqlite s'))
    -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite UnspentOutputRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724854"><span class="annot"><span class="annottext">forall s'. UnspentOutputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724854"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnspentOutputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unspentOutputRowTip"><span class="hs-identifier hs-var hs-var">_unspentOutputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT (QExpr Sqlite s)
forall s'. UnspentOutputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724854"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724858"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlDelete Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ()
forall (table :: (* -&gt; *) -&gt; *) dbt.
Beamable table =&gt;
SqlDelete dbt table -&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">DeleteRows</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlDelete Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ())
-&gt; SqlDelete Sqlite UnmatchedInputRowT -&gt; BeamEffect Sqlite ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; (forall s.
    (forall s'. UnmatchedInputRowT (QExpr Sqlite s'))
    -&gt; QExpr Sqlite s Bool)
-&gt; SqlDelete Sqlite UnmatchedInputRowT
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724853"><span class="annot"><span class="annottext">forall s'. UnmatchedInputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724853"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimaryKey TipRowT (QExpr Sqlite s)
-&gt; Columnar (QExpr Sqlite s) Word64
forall (f :: * -&gt; *). PrimaryKey TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#unTipRowId"><span class="hs-identifier hs-var hs-var">unTipRowId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
-&gt; PrimaryKey TipRowT (QExpr Sqlite s)
forall (f :: * -&gt; *). UnmatchedInputRowT f -&gt; PrimaryKey TipRowT f
</span><a href="Plutus.ChainIndex.DbSchema.html#_unmatchedInputRowTip"><span class="hs-identifier hs-var hs-var">_unmatchedInputRowTip</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT (QExpr Sqlite s)
forall s'. UnmatchedInputRowT (QExpr Sqlite s')
</span><a href="#local-6989586621679724853"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QGenExpr QValueContext Sqlite s Word64
-&gt; QGenExpr QValueContext Sqlite s Word64 -&gt; QExpr Sqlite s Bool
forall (expr :: * -&gt; *) e. SqlOrd expr e =&gt; e -&gt; e -&gt; expr Bool
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-operator hs-var">&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
-&gt; QGenExpr QValueContext Sqlite s Word64
forall a. SqlValable a =&gt; HaskellLiteralForQExpr a -&gt; a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">val_</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellLiteralForQExpr (QGenExpr QValueContext Sqlite s Word64)
DbType Slot
</span><a href="#local-6989586621679724858"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span id="local-6989586621679725423"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#restoreStateFromDb"><span class="hs-identifier hs-type">restoreStateFromDb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725423"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725423"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span></span><span>
</span><span id="line-562"></span><span id="restoreStateFromDb"><span class="annot"><span class="annottext">restoreStateFromDb :: Eff effs ChainIndexState
</span><a href="Plutus.ChainIndex.Handlers.html#restoreStateFromDb"><span class="hs-identifier hs-var hs-var">restoreStateFromDb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621679724852"><span class="annot"><span class="annottext">[UnspentOutputRowT Identity]
</span><a href="#local-6989586621679724852"><span class="hs-identifier hs-var">uo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (UnspentOutputRowT Identity)
-&gt; Eff effs [UnspentOutputRowT Identity]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite (UnspentOutputRowT Identity)
 -&gt; Eff effs [UnspentOutputRowT Identity])
-&gt; (Q Sqlite
      Db
      QBaseScope
      (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
    -&gt; SqlSelect Sqlite (UnspentOutputRowT Identity))
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs [UnspentOutputRowT Identity]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect Sqlite (UnspentOutputRowT Identity)
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Eff effs [UnspentOutputRowT Identity])
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs [UnspentOutputRowT Identity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnspentOutputRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnspentOutputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnspentOutputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unspentOutputRows"><span class="hs-identifier hs-var hs-var">unspentOutputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679724851"><span class="annot"><span class="annottext">[UnmatchedInputRowT Identity]
</span><a href="#local-6989586621679724851"><span class="hs-identifier hs-var">ui</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite (UnmatchedInputRowT Identity)
-&gt; Eff effs [UnmatchedInputRowT Identity]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite (UnmatchedInputRowT Identity)
 -&gt; Eff effs [UnmatchedInputRowT Identity])
-&gt; (Q Sqlite
      Db
      QBaseScope
      (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
    -&gt; SqlSelect Sqlite (UnmatchedInputRowT Identity))
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs [UnmatchedInputRowT Identity]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect Sqlite (UnmatchedInputRowT Identity)
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; Eff effs [UnmatchedInputRowT Identity])
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Eff effs [UnmatchedInputRowT Identity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
-&gt; Q Sqlite
     Db
     QBaseScope
     (UnmatchedInputRowT (QGenExpr QValueContext Sqlite QBaseScope))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UnmatchedInputRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UnmatchedInputRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#unmatchedInputRows"><span class="hs-identifier hs-var hs-var">unmatchedInputRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679724850"><span class="annot"><span class="annottext">balances :: Map Word64 TxUtxoBalance
</span><a href="#local-6989586621679724850"><span class="hs-identifier hs-var hs-var">balances</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxUtxoBalance -&gt; TxUtxoBalance -&gt; TxUtxoBalance)
-&gt; [(Word64, TxUtxoBalance)] -&gt; Map Word64 TxUtxoBalance
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromListWith</span></a></span><span> </span><span class="annot"><span class="annottext">TxUtxoBalance -&gt; TxUtxoBalance -&gt; TxUtxoBalance
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word64, TxUtxoBalance)] -&gt; Map Word64 TxUtxoBalance)
-&gt; [(Word64, TxUtxoBalance)] -&gt; Map Word64 TxUtxoBalance
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(UnspentOutputRowT Identity -&gt; (Word64, TxUtxoBalance))
-&gt; [UnspentOutputRowT Identity] -&gt; [(Word64, TxUtxoBalance)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnspentOutputRowT Identity -&gt; (Word64, TxUtxoBalance)
</span><a href="#local-6989586621679724848"><span class="hs-identifier hs-var">outputToTxUtxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">[UnspentOutputRowT Identity]
</span><a href="#local-6989586621679724852"><span class="hs-identifier hs-var">uo</span></a></span><span> </span><span class="annot"><span class="annottext">[(Word64, TxUtxoBalance)]
-&gt; [(Word64, TxUtxoBalance)] -&gt; [(Word64, TxUtxoBalance)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(UnmatchedInputRowT Identity -&gt; (Word64, TxUtxoBalance))
-&gt; [UnmatchedInputRowT Identity] -&gt; [(Word64, TxUtxoBalance)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">UnmatchedInputRowT Identity -&gt; (Word64, TxUtxoBalance)
</span><a href="#local-6989586621679724847"><span class="hs-identifier hs-var">inputToTxUtxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">[UnmatchedInputRowT Identity]
</span><a href="#local-6989586621679724851"><span class="hs-identifier hs-var">ui</span></a></span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621679724846"><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724846"><span class="hs-identifier hs-var">tips</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite TipRow -&gt; Eff effs [TipRow]
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs [a]
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite TipRow -&gt; Eff effs [TipRow])
-&gt; (Q Sqlite
      Db
      (QNested QBaseScope)
      (TipRowT (QExpr Sqlite (QNested QBaseScope)))
    -&gt; SqlSelect Sqlite TipRow)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Eff effs [TipRow]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; SqlSelect Sqlite TipRow
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (TipRowT (QGenExpr QValueContext Sqlite QBaseScope))
 -&gt; SqlSelect Sqlite TipRow)
-&gt; (Q Sqlite
      Db
      (QNested QBaseScope)
      (TipRowT (QExpr Sqlite (QNested QBaseScope)))
    -&gt; Q Sqlite
         Db
         QBaseScope
         (TipRowT (QGenExpr QValueContext Sqlite QBaseScope)))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; SqlSelect Sqlite TipRow
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TipRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QOrd Sqlite (QNested QBaseScope) Word64)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (TipRowT (QExpr Sqlite (QNested QBaseScope))))
forall s a ordering be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, SqlOrderable be ordering,
 ThreadRewritable (QNested s) a) =&gt;
(a -&gt; ordering)
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">orderBy_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QExpr Sqlite (QNested QBaseScope) Word64
-&gt; QOrd Sqlite (QNested QBaseScope) Word64
forall be s a. BeamSqlBackend be =&gt; QExpr be s a -&gt; QOrd be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">asc_</span></a></span><span> </span><span class="annot"><span class="annottext">(QExpr Sqlite (QNested QBaseScope) Word64
 -&gt; QOrd Sqlite (QNested QBaseScope) Word64)
-&gt; (TipRowT (QExpr Sqlite (QNested QBaseScope))
    -&gt; QExpr Sqlite (QNested QBaseScope) Word64)
-&gt; TipRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QOrd Sqlite (QNested QBaseScope) Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TipRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QExpr Sqlite (QNested QBaseScope) Word64
forall (f :: * -&gt; *). TipRowT f -&gt; Columnar f Word64
</span><a href="Plutus.ChainIndex.DbSchema.html#_tipRowSlot"><span class="hs-identifier hs-var hs-var">_tipRowSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>        </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (TipRowT (QExpr Sqlite (QNested QBaseScope)))
 -&gt; Eff effs [TipRow])
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Eff effs [TipRow]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TipRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TipRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TipRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TipRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#tipRows"><span class="hs-identifier hs-var hs-var">tipRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexState -&gt; Eff effs ChainIndexState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; Eff effs ChainIndexState)
-&gt; ChainIndexState -&gt; Eff effs ChainIndexState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoState TxUtxoBalance] -&gt; ChainIndexState
forall v a. Measured v a =&gt; [a] -&gt; FingerTree v a
</span><a href="../file:///nix/store/7wzfiy4wk5kzaxcc0ka4k83khpnfw6gx-fingertree-lib-fingertree-0.1.5.0-haddock-doc/share/doc/fingertree/html/src"><span class="hs-identifier hs-var">FT.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([UtxoState TxUtxoBalance] -&gt; ChainIndexState)
-&gt; ([TipRow] -&gt; [UtxoState TxUtxoBalance])
-&gt; [TipRow]
-&gt; ChainIndexState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TipRow -&gt; UtxoState TxUtxoBalance)
-&gt; [TipRow] -&gt; [UtxoState TxUtxoBalance]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Word64 TxUtxoBalance -&gt; TipRow -&gt; UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724844"><span class="hs-identifier hs-var">toUtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Word64 TxUtxoBalance
</span><a href="#local-6989586621679724850"><span class="hs-identifier hs-var">balances</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TipRow] -&gt; ChainIndexState) -&gt; [TipRow] -&gt; ChainIndexState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TipRow]
</span><a href="#local-6989586621679724846"><span class="hs-identifier hs-var">tips</span></a></span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-571"></span><span>        </span><span class="annot"><a href="#local-6989586621679724848"><span class="hs-identifier hs-type">outputToTxUtxoBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnspentOutputRow"><span class="hs-identifier hs-type">UnspentOutputRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>        </span><span id="local-6989586621679724848"><span class="annot"><span class="annottext">outputToTxUtxoBalance :: UnspentOutputRowT Identity -&gt; (Word64, TxUtxoBalance)
</span><a href="#local-6989586621679724848"><span class="hs-identifier hs-var hs-var">outputToTxUtxoBalance</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnspentOutputRow"><span class="hs-identifier hs-type">UnspentOutputRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#TipRowId"><span class="hs-identifier hs-type">TipRowId</span></a></span><span> </span><span id="local-6989586621679724843"><span class="annot"><a href="#local-6989586621679724843"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679724842"><span class="annot"><span class="annottext">Columnar Identity ByteString
</span><a href="#local-6989586621679724842"><span class="hs-identifier hs-var">outRef</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
Columnar Identity Word64
</span><a href="#local-6989586621679724843"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; Set TxOutRef -&gt; TxUtxoBalance
</span><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-var">TxUtxoBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; Set TxOutRef
forall a. a -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DbType TxOutRef -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar Identity ByteString
DbType TxOutRef
</span><a href="#local-6989586621679724842"><span class="hs-identifier hs-var">outRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>        </span><span class="annot"><a href="#local-6989586621679724847"><span class="hs-identifier hs-type">inputToTxUtxoBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnmatchedInputRow"><span class="hs-identifier hs-type">UnmatchedInputRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>        </span><span id="local-6989586621679724847"><span class="annot"><span class="annottext">inputToTxUtxoBalance :: UnmatchedInputRowT Identity -&gt; (Word64, TxUtxoBalance)
</span><a href="#local-6989586621679724847"><span class="hs-identifier hs-var hs-var">inputToTxUtxoBalance</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#UnmatchedInputRow"><span class="hs-identifier hs-type">UnmatchedInputRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#TipRowId"><span class="hs-identifier hs-type">TipRowId</span></a></span><span> </span><span id="local-6989586621679724840"><span class="annot"><a href="#local-6989586621679724840"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679724839"><span class="annot"><span class="annottext">Columnar Identity ByteString
</span><a href="#local-6989586621679724839"><span class="hs-identifier hs-var">outRef</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
Columnar Identity Word64
</span><a href="#local-6989586621679724840"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; Set TxOutRef -&gt; TxUtxoBalance
</span><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-var">TxUtxoBalance</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; Set TxOutRef
forall a. a -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DbType TxOutRef -&gt; TxOutRef
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar Identity ByteString
DbType TxOutRef
</span><a href="#local-6989586621679724839"><span class="hs-identifier hs-var">outRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>        </span><span class="annot"><a href="#local-6989586621679724844"><span class="hs-identifier hs-type">toUtxoState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#TipRow"><span class="hs-identifier hs-type">TipRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState.UtxoState</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span>
</span><span id="line-578"></span><span>        </span><span id="local-6989586621679724844"><span class="annot"><span class="annottext">toUtxoState :: Map Word64 TxUtxoBalance -&gt; TipRow -&gt; UtxoState TxUtxoBalance
</span><a href="#local-6989586621679724844"><span class="hs-identifier hs-var hs-var">toUtxoState</span></a></span></span><span> </span><span id="local-6989586621679724838"><span class="annot"><span class="annottext">Map Word64 TxUtxoBalance
</span><a href="#local-6989586621679724838"><span class="hs-identifier hs-var">balances</span></a></span></span><span> </span><span id="local-6989586621679724837"><span class="annot"><span class="annottext">tip :: TipRow
</span><a href="#local-6989586621679724837"><span class="hs-identifier hs-var">tip</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#TipRow"><span class="hs-identifier hs-type">TipRow</span></a></span><span> </span><span id="local-6989586621679724835"><span class="annot"><span class="annottext">Columnar Identity Word64
</span><a href="#local-6989586621679724835"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="annot"><span class="annottext">Columnar Identity ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Columnar Identity Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxUtxoBalance -&gt; Tip -&gt; UtxoState TxUtxoBalance
forall a. a -&gt; Tip -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState.UtxoState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxUtxoBalance
-&gt; Word64 -&gt; Map Word64 TxUtxoBalance -&gt; TxUtxoBalance
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.findWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">TxUtxoBalance
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
Columnar Identity Word64
</span><a href="#local-6989586621679724835"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">Map Word64 TxUtxoBalance
</span><a href="#local-6989586621679724838"><span class="hs-identifier hs-var">balances</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DbType Tip -&gt; Tip
forall a. HasDbType a =&gt; DbType a -&gt; a
</span><a href="Plutus.ChainIndex.DbSchema.html#fromDbValue"><span class="hs-identifier hs-var">fromDbValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TipRow -&gt; Maybe TipRow
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TipRow
</span><a href="#local-6989586621679724837"><span class="hs-identifier hs-var">tip</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-keyword">data</span><span> </span><span id="InsertRows"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span></span><span> </span><span id="local-6989586621679724833"><span class="annot"><a href="#local-6989586621679724833"><span class="hs-identifier hs-type">te</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679724832"><span id="InsertRows"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamableDb</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724832"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679724832"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724832"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span id="local-6989586621679724831"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679724826"><span id="local-6989586621679724828"><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724831"><span class="hs-identifier hs-type">te</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span id="local-6989586621679724824"><span class="annot"><span class="annottext">[t Identity]
</span><a href="#local-6989586621679724824"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679724823"><span class="annot"><span class="annottext">&lt;&gt; :: InsertRows te -&gt; InsertRows te -&gt; InsertRows te
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span id="local-6989586621679724822"><span class="annot"><span class="annottext">[t Identity]
</span><a href="#local-6989586621679724822"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[t Identity] -&gt; InsertRows (TableEntity t)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[t Identity]
</span><a href="#local-6989586621679724824"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[t Identity] -&gt; [t Identity] -&gt; [t Identity]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[t Identity]
[t Identity]
</span><a href="#local-6989586621679724822"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-586"></span><span id="local-6989586621679724821"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679724815"><span id="local-6989586621679724817"><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamableDb</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724821"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679724821"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621679724813"><span class="annot"><span class="annottext">mempty :: InsertRows (TableEntity t)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[t Identity] -&gt; InsertRows (TableEntity t)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#insertRows"><span class="hs-identifier hs-type">insertRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#Db"><span class="hs-identifier hs-type">Db</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span id="insertRows"><span class="annot"><span class="annottext">insertRows :: Db InsertRows -&gt; BeamEffect Sqlite ()
</span><a href="Plutus.ChainIndex.Handlers.html#insertRows"><span class="hs-identifier hs-var hs-var">insertRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Const (BeamEffect Sqlite ()) (Db Any) -&gt; BeamEffect Sqlite ()
forall a k (b :: k). Const a b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">getConst</span></a></span><span> </span><span class="annot"><span class="annottext">(Const (BeamEffect Sqlite ()) (Db Any) -&gt; BeamEffect Sqlite ())
-&gt; (Db InsertRows -&gt; Const (BeamEffect Sqlite ()) (Db Any))
-&gt; Db InsertRows
-&gt; BeamEffect Sqlite ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Any
-&gt; (forall tbl.
    (IsDatabaseEntity Any tbl,
     DatabaseEntityRegularRequirements Any tbl) =&gt;
    DatabaseEntity Sqlite Db tbl
    -&gt; InsertRows tbl -&gt; Const (BeamEffect Sqlite ()) (Any tbl))
-&gt; Db (DatabaseEntity Sqlite Db)
-&gt; Db InsertRows
-&gt; Const (BeamEffect Sqlite ()) (Db Any)
forall be (db :: (* -&gt; *) -&gt; *) (m :: * -&gt; *) (f :: * -&gt; *)
       (g :: * -&gt; *) (h :: * -&gt; *).
(Database be db, Applicative m) =&gt;
Proxy be
-&gt; (forall tbl.
    (IsDatabaseEntity be tbl,
     DatabaseEntityRegularRequirements be tbl) =&gt;
    f tbl -&gt; g tbl -&gt; m (h tbl))
-&gt; db f
-&gt; db g
-&gt; m (db h)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">zipTables</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Any
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679724812"><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db tbl
</span><a href="#local-6989586621679724812"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span id="local-6989586621679724811"><span class="annot"><a href="#local-6989586621679724811"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BeamEffect Sqlite () -&gt; Const (BeamEffect Sqlite ()) (Any tbl)
forall k a (b :: k). a -&gt; Const a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamEffect Sqlite () -&gt; Const (BeamEffect Sqlite ()) (Any tbl))
-&gt; BeamEffect Sqlite () -&gt; Const (BeamEffect Sqlite ()) (Any tbl)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; DatabaseEntity Sqlite Db (TableEntity t)
-&gt; [t Identity]
-&gt; BeamEffect Sqlite ()
forall dbt (table :: (* -&gt; *) -&gt; *) (db :: (* -&gt; *) -&gt; *).
BeamableDb dbt table =&gt;
Int
-&gt; DatabaseEntity dbt db (TableEntity table)
-&gt; [table Identity]
-&gt; BeamEffect dbt ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">AddRowsInBatches</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Plutus.ChainIndex.Handlers.html#batchSize"><span class="hs-identifier hs-var">batchSize</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db tbl
DatabaseEntity Sqlite Db (TableEntity t)
</span><a href="#local-6989586621679724812"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">[t Identity]
</span><a href="#local-6989586621679724811"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#fromTx"><span class="hs-identifier hs-type">fromTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#Db"><span class="hs-identifier hs-type">Db</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span>
</span><span id="line-593"></span><span id="fromTx"><span class="annot"><span class="annottext">fromTx :: ChainIndexTx -&gt; Db InsertRows
</span><a href="Plutus.ChainIndex.Handlers.html#fromTx"><span class="hs-identifier hs-var hs-var">fromTx</span></a></span></span><span> </span><span id="local-6989586621679724810"><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Db InsertRows
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">datumRows :: InsertRows (TableEntity DatumRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#datumRows"><span class="hs-identifier hs-var">datumRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DatumRowT Identity] -&gt; InsertRows (TableEntity DatumRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">([DatumRowT Identity] -&gt; InsertRows (TableEntity DatumRowT))
-&gt; ([(DatumHash, Datum)] -&gt; [DatumRowT Identity])
-&gt; [(DatumHash, Datum)]
-&gt; InsertRows (TableEntity DatumRowT)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((DatumHash, Datum) -&gt; DatumRowT Identity)
-&gt; [(DatumHash, Datum)] -&gt; [DatumRowT Identity]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash, Datum) -&gt; DatumRowT Identity
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">([(DatumHash, Datum)] -&gt; InsertRows (TableEntity DatumRowT))
-&gt; [(DatumHash, Datum)] -&gt; InsertRows (TableEntity DatumRowT)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map DatumHash Datum -&gt; [(DatumHash, Datum)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map DatumHash Datum -&gt; [(DatumHash, Datum)])
-&gt; Map DatumHash Datum -&gt; [(DatumHash, Datum)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum -&gt; [ChainIndexTxOut] -&gt; Map DatumHash Datum
</span><a href="#local-6989586621679724808"><span class="hs-identifier hs-var">updateMapWithInlineDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTx -&gt; Map DatumHash Datum
</span><a href="Plutus.ChainIndex.Types.html#_citxData"><span class="hs-identifier hs-var hs-var">_citxData</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [ChainIndexTxOut]
</span><a href="Plutus.ChainIndex.Tx.html#txOuts"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scriptRows :: InsertRows (TableEntity ScriptRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#scriptRows"><span class="hs-identifier hs-var">scriptRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ChainIndexTx (Map ScriptHash (Versioned Script))
-&gt; InsertRows (TableEntity ScriptRowT)
forall (t :: (* -&gt; *) -&gt; *) k v.
(BeamableDb Sqlite t, HasDbType (k, v),
 DbType (k, v) ~ t Identity) =&gt;
Lens' ChainIndexTx (Map k v) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724806"><span class="hs-identifier hs-var">fromMap</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' ChainIndexTx (Map ScriptHash (Versioned Script))
</span><a href="Plutus.ChainIndex.Types.html#citxScripts"><span class="hs-identifier hs-var">citxScripts</span></a></span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">redeemerRows :: InsertRows (TableEntity RedeemerRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#redeemerRows"><span class="hs-identifier hs-var">redeemerRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; [(RedeemerHash, Redeemer)])
-&gt; InsertRows (TableEntity RedeemerRowT)
forall (t :: (* -&gt; *) -&gt; *) k v.
(BeamableDb Sqlite t, HasDbType (k, v),
 DbType (k, v) ~ t Identity) =&gt;
(ChainIndexTx -&gt; [(k, v)]) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724804"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RedeemerHash Redeemer -&gt; [(RedeemerHash, Redeemer)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map RedeemerHash Redeemer -&gt; [(RedeemerHash, Redeemer)])
-&gt; (ChainIndexTx -&gt; Map RedeemerHash Redeemer)
-&gt; ChainIndexTx
-&gt; [(RedeemerHash, Redeemer)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; Map RedeemerHash Redeemer
</span><a href="Plutus.ChainIndex.Tx.html#txRedeemersWithHash"><span class="hs-identifier hs-var">txRedeemersWithHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txRows :: InsertRows (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var">txRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxRowT Identity] -&gt; InsertRows (TableEntity TxRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(TxId, ChainIndexTx) -&gt; DbType (TxId, ChainIndexTx)
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTx -&gt; TxId
</span><a href="Plutus.ChainIndex.Types.html#_citxTxId"><span class="hs-identifier hs-var hs-var">_citxTxId</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">addressRows :: InsertRows (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var">addressRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AddressRowT Identity] -&gt; InsertRows (TableEntity AddressRowT)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">([AddressRowT Identity] -&gt; InsertRows (TableEntity AddressRowT))
-&gt; (ChainIndexTx -&gt; [AddressRowT Identity])
-&gt; ChainIndexTx
-&gt; InsertRows (TableEntity AddressRowT)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((ChainIndexTxOut, TxOutRef) -&gt; AddressRowT Identity)
-&gt; [(ChainIndexTxOut, TxOutRef)] -&gt; [AddressRowT Identity]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Credential, TxOutRef, Maybe DatumHash) -&gt; AddressRowT Identity
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">((Credential, TxOutRef, Maybe DatumHash) -&gt; AddressRowT Identity)
-&gt; ((ChainIndexTxOut, TxOutRef)
    -&gt; (Credential, TxOutRef, Maybe DatumHash))
-&gt; (ChainIndexTxOut, TxOutRef)
-&gt; AddressRowT Identity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut, TxOutRef)
-&gt; (Credential, TxOutRef, Maybe DatumHash)
</span><a href="#local-6989586621679724801"><span class="hs-identifier hs-var">credential</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ChainIndexTxOut, TxOutRef)] -&gt; [AddressRowT Identity])
-&gt; (ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)])
-&gt; ChainIndexTx
-&gt; [AddressRowT Identity]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)]
</span><a href="Plutus.ChainIndex.Tx.html#txOutsWithRef"><span class="hs-identifier hs-var">txOutsWithRef</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; InsertRows (TableEntity AddressRowT))
-&gt; ChainIndexTx -&gt; InsertRows (TableEntity AddressRowT)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">assetClassRows :: InsertRows (TableEntity AssetClassRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#assetClassRows"><span class="hs-identifier hs-var">assetClassRows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; [(AssetClass, TxOutRef)])
-&gt; InsertRows (TableEntity AssetClassRowT)
forall (t :: (* -&gt; *) -&gt; *) k v.
(BeamableDb Sqlite t, HasDbType (k, v),
 DbType (k, v) ~ t Identity) =&gt;
(ChainIndexTx -&gt; [(k, v)]) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724804"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ChainIndexTxOut, TxOutRef) -&gt; [(AssetClass, TxOutRef)])
-&gt; [(ChainIndexTxOut, TxOutRef)] -&gt; [(AssetClass, TxOutRef)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut, TxOutRef) -&gt; [(AssetClass, TxOutRef)]
</span><a href="#local-6989586621679724800"><span class="hs-identifier hs-var">assetClasses</span></a></span><span> </span><span class="annot"><span class="annottext">([(ChainIndexTxOut, TxOutRef)] -&gt; [(AssetClass, TxOutRef)])
-&gt; (ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)])
-&gt; ChainIndexTx
-&gt; [(AssetClass, TxOutRef)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [(ChainIndexTxOut, TxOutRef)]
</span><a href="Plutus.ChainIndex.Tx.html#txOutsWithRef"><span class="hs-identifier hs-var">txOutsWithRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>        </span><span class="annot"><a href="#local-6989586621679724801"><span class="hs-identifier hs-type">credential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndex.ChainIndexTxOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Credential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>        </span><span id="local-6989586621679724801"><span class="annot"><span class="annottext">credential :: (ChainIndexTxOut, TxOutRef)
-&gt; (Credential, TxOutRef, Maybe DatumHash)
</span><a href="#local-6989586621679724801"><span class="hs-identifier hs-var hs-var">credential</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndexTxOut</span></a></span><span class="hs-special">{</span><span id="local-6989586621679724799"><span class="annot"><span class="annottext">CardanoAddress
citoAddress :: ChainIndexTxOut -&gt; CardanoAddress
citoAddress :: CardanoAddress
</span><a href="Plutus.ChainIndex.Types.html#citoAddress"><span class="hs-identifier hs-var hs-var">citoAddress</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679724797"><span class="annot"><span class="annottext">OutputDatum
citoDatum :: ChainIndexTxOut -&gt; OutputDatum
citoDatum :: OutputDatum
</span><a href="Plutus.ChainIndex.Types.html#citoDatum"><span class="hs-identifier hs-var hs-var">citoDatum</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724795"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724795"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoAddress -&gt; Credential
forall era. AddressInEra era -&gt; Credential
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">cardanoAddressCredential</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621679724799"><span class="hs-identifier hs-var">citoAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724795"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OutputDatum -&gt; Maybe DatumHash
</span><a href="#local-6989586621679724794"><span class="hs-identifier hs-var">getHashFromDatum</span></a></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="#local-6989586621679724797"><span class="hs-identifier hs-var">citoDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><a href="#local-6989586621679724800"><span class="hs-identifier hs-type">assetClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndex.ChainIndexTxOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">AssetClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>        </span><span id="local-6989586621679724800"><span class="annot"><span class="annottext">assetClasses :: (ChainIndexTxOut, TxOutRef) -&gt; [(AssetClass, TxOutRef)]
</span><a href="#local-6989586621679724800"><span class="hs-identifier hs-var hs-var">assetClasses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndexTxOut</span></a></span><span class="hs-special">{</span><span id="local-6989586621679724793"><span class="annot"><span class="annottext">Value
citoValue :: ChainIndexTxOut -&gt; Value
citoValue :: Value
</span><a href="Plutus.ChainIndex.Types.html#citoValue"><span class="hs-identifier hs-var hs-var">citoValue</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724791"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724791"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-607"></span><span>          </span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; (AssetClass, TxOutRef))
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(AssetClass, TxOutRef)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679724790"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679724790"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724789"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679724789"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CurrencySymbol, TokenName) -&gt; AssetClass
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">AssetClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679724790"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679724789"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679724791"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>               </span><span class="hs-comment">-- We don't store the 'AssetClass' when it is the Ada currency.</span><span>
</span><span id="line-609"></span><span>               </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)]
 -&gt; [(AssetClass, TxOutRef)])
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(AssetClass, TxOutRef)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; Bool)
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(CurrencySymbol, TokenName, Integer)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679724788"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679724788"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679724787"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679724787"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Ada.adaSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679724788"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Ada.adaToken</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; TokenName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679724787"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>               </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)]
 -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(CurrencySymbol, TokenName, Integer)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">flattenValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679724793"><span class="hs-identifier hs-var">citoValue</span></a></span><span>
</span><span id="line-611"></span><span>        </span><span id="local-6989586621679725304"><span id="local-6989586621679725305"><span id="local-6989586621679725306"><span class="annot"><a href="#local-6989586621679724806"><span class="hs-identifier hs-type">fromMap</span></a></span><span>
</span><span id="line-612"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamableDb</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725306"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679725305"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679725304"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679725305"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679725304"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725306"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725305"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725304"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725306"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-615"></span><span>        </span><span id="local-6989586621679724806"><span class="annot"><span class="annottext">fromMap :: Lens' ChainIndexTx (Map k v) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724806"><span class="hs-identifier hs-var hs-var">fromMap</span></a></span></span><span> </span><span id="local-6989586621679724782"><span class="annot"><span class="annottext">Lens' ChainIndexTx (Map k v)
</span><a href="#local-6989586621679724782"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; [(k, v)]) -&gt; InsertRows (TableEntity t)
forall (t :: (* -&gt; *) -&gt; *) k v.
(BeamableDb Sqlite t, HasDbType (k, v),
 DbType (k, v) ~ t Identity) =&gt;
(ChainIndexTx -&gt; [(k, v)]) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724804"><span class="hs-identifier hs-var">fromPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map k v -&gt; [(k, v)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map k v -&gt; [(k, v)])
-&gt; (ChainIndexTx -&gt; Map k v) -&gt; ChainIndexTx -&gt; [(k, v)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Map k v) ChainIndexTx (Map k v) -&gt; ChainIndexTx -&gt; Map k v
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Map k v) ChainIndexTx (Map k v)
Lens' ChainIndexTx (Map k v)
</span><a href="#local-6989586621679724782"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span id="local-6989586621679725301"><span id="local-6989586621679725302"><span id="local-6989586621679725303"><span class="annot"><a href="#local-6989586621679724804"><span class="hs-identifier hs-type">fromPairs</span></a></span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamableDb</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#HasDbType"><span class="hs-identifier hs-type">HasDbType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679725302"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679725301"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.DbSchema.html#DbType"><span class="hs-identifier hs-type">DbType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679725302"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679725301"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTx"><span class="hs-identifier hs-type">ChainIndexTx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679725302"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679725301"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-type">InsertRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-620"></span><span>        </span><span id="local-6989586621679724804"><span class="annot"><span class="annottext">fromPairs :: (ChainIndexTx -&gt; [(k, v)]) -&gt; InsertRows (TableEntity t)
</span><a href="#local-6989586621679724804"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679724781"><span class="annot"><span class="annottext">ChainIndexTx -&gt; [(k, v)]
</span><a href="#local-6989586621679724781"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[t Identity] -&gt; InsertRows (TableEntity t)
forall (t :: (* -&gt; *) -&gt; *).
BeamableDb Sqlite t =&gt;
[t Identity] -&gt; InsertRows (TableEntity t)
</span><a href="Plutus.ChainIndex.Handlers.html#InsertRows"><span class="hs-identifier hs-var">InsertRows</span></a></span><span> </span><span class="annot"><span class="annottext">([t Identity] -&gt; InsertRows (TableEntity t))
-&gt; (ChainIndexTx -&gt; [t Identity])
-&gt; ChainIndexTx
-&gt; InsertRows (TableEntity t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; t Identity) -&gt; [(k, v)] -&gt; [t Identity]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; t Identity
forall a. HasDbType a =&gt; a -&gt; DbType a
</span><a href="Plutus.ChainIndex.DbSchema.html#toDbValue"><span class="hs-identifier hs-var">toDbValue</span></a></span><span> </span><span class="annot"><span class="annottext">([(k, v)] -&gt; [t Identity])
-&gt; (ChainIndexTx -&gt; [(k, v)]) -&gt; ChainIndexTx -&gt; [t Identity]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx -&gt; [(k, v)]
</span><a href="#local-6989586621679724781"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTx -&gt; InsertRows (TableEntity t))
-&gt; ChainIndexTx -&gt; InsertRows (TableEntity t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTx
</span><a href="#local-6989586621679724810"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span>        </span><span class="annot"><a href="#local-6989586621679724808"><span class="hs-identifier hs-type">updateMapWithInlineDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndex.ChainIndexTxOut</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span>
</span><span id="line-623"></span><span>        </span><span id="local-6989586621679724808"><span class="annot"><span class="annottext">updateMapWithInlineDatum :: Map DatumHash Datum -&gt; [ChainIndexTxOut] -&gt; Map DatumHash Datum
</span><a href="#local-6989586621679724808"><span class="hs-identifier hs-var hs-var">updateMapWithInlineDatum</span></a></span></span><span> </span><span id="local-6989586621679724780"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724780"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724780"><span class="hs-identifier hs-var">witness</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span class="annot"><a href="#local-6989586621679724808"><span class="hs-identifier hs-var">updateMapWithInlineDatum</span></a></span><span> </span><span id="local-6989586621679724779"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724779"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ChainIndex.Types.html#ChainIndexTxOut"><span class="hs-identifier hs-type">ChainIndexTxOut</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">citoDatum :: ChainIndexTxOut -&gt; OutputDatum
</span><a href="Plutus.ChainIndex.Types.html#citoDatum"><span class="hs-identifier hs-var">citoDatum</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span id="local-6989586621679724778"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679724778"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679724777"><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724777"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-625"></span><span>          </span><span class="annot"><span class="annottext">Map DatumHash Datum -&gt; [ChainIndexTxOut] -&gt; Map DatumHash Datum
</span><a href="#local-6989586621679724808"><span class="hs-identifier hs-var">updateMapWithInlineDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumHash -&gt; Datum -&gt; Map DatumHash Datum -&gt; Map DatumHash Datum
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679724778"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679724778"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724779"><span class="hs-identifier hs-var">witness</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724777"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-626"></span><span>        </span><span class="annot"><a href="#local-6989586621679724808"><span class="hs-identifier hs-var">updateMapWithInlineDatum</span></a></span><span> </span><span id="local-6989586621679724775"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724775"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679724774"><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724774"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum -&gt; [ChainIndexTxOut] -&gt; Map DatumHash Datum
</span><a href="#local-6989586621679724808"><span class="hs-identifier hs-var">updateMapWithInlineDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679724775"><span class="hs-identifier hs-var">witness</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724774"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>        </span><span class="annot"><a href="#local-6989586621679724794"><span class="hs-identifier hs-type">getHashFromDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span>
</span><span id="line-629"></span><span>        </span><span id="local-6989586621679724794"><span class="annot"><span class="annottext">getHashFromDatum :: OutputDatum -&gt; Maybe DatumHash
</span><a href="#local-6989586621679724794"><span class="hs-identifier hs-var hs-var">getHashFromDatum</span></a></span></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">NoOutputDatum</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-630"></span><span>        </span><span class="annot"><a href="#local-6989586621679724794"><span class="hs-identifier hs-var">getHashFromDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatumHash</span></a></span><span> </span><span id="local-6989586621679724773"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679724773"><span class="hs-identifier hs-var">dh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Maybe DatumHash
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679724773"><span class="hs-identifier hs-var">dh</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span class="annot"><a href="#local-6989586621679724794"><span class="hs-identifier hs-var">getHashFromDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">OutputDatum</span></a></span><span> </span><span id="local-6989586621679724772"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679724772"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Maybe DatumHash
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679724772"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-comment">-- note that the datum hash for inline datum is implicitly added in datumRows</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span id="local-6989586621679725380"><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#diagnostics"><span class="hs-identifier hs-type">diagnostics</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">BeamEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/c2ys4mf3ij618ysqljn71b9gp0j0imn5-beam-sqlite-lib-beam-sqlite-0.5.1.2-haddock-doc/share/doc/beam-sqlite/html/src"><span class="hs-identifier hs-type">Sqlite</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725380"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679725380"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679725380"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#Diagnostics"><span class="hs-identifier hs-type">Diagnostics</span></a></span></span><span>
</span><span id="line-639"></span><span id="diagnostics"><span class="annot"><span class="annottext">diagnostics :: Eff effs Diagnostics
</span><a href="Plutus.ChainIndex.Handlers.html#diagnostics"><span class="hs-identifier hs-var hs-var">diagnostics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679724771"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724771"><span class="hs-identifier hs-var">numTransactions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer)
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer))
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope Integer)
    -&gt; SqlSelect Sqlite Integer)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; SqlSelect Sqlite Integer
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope Integer)
 -&gt; Eff effs (Maybe Integer))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QAgg Sqlite (QNested QBaseScope) Integer)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TxRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall be a r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Aggregable be a, Projectible be r,
 Projectible be a, ContextRewritable a,
 ThreadRewritable
   (QNested s) (WithRewrittenContext a QValueContext)) =&gt;
(r -&gt; a)
-&gt; Q be db (QNested s) r
-&gt; Q be
     db
     s
     (WithRewrittenThread
        (QNested s) s (WithRewrittenContext a QValueContext))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">aggregate_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
-&gt; TxRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QAgg Sqlite (QNested QBaseScope) Integer
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
forall be a s. (BeamSqlBackend be, Integral a) =&gt; QAgg be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">countAll_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TxRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TxRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TxRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var hs-var">txRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>    </span><span id="local-6989586621679724770"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679724770"><span class="hs-identifier hs-var">txIds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs [TxId]
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs [o]
</span><a href="Plutus.ChainIndex.Handlers.html#queryList"><span class="hs-identifier hs-var">queryList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs [TxId])
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope ByteString)
    -&gt; SqlSelect Sqlite ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Eff effs [TxId]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; SqlSelect Sqlite ByteString
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope ByteString)
 -&gt; Eff effs [TxId])
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Eff effs [TxId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall (f :: * -&gt; *). TxRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_txRowTxId"><span class="hs-identifier hs-var hs-var">_txRowTxId</span></a></span><span> </span><span class="annot"><span class="annottext">(TxRowT (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (TxRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TxRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (TxRowT (QExpr Sqlite (QNested QBaseScope))))
forall s a be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, ThreadRewritable (QNested s) a) =&gt;
Integer
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">limit_</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity TxRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (TxRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity TxRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity TxRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#txRows"><span class="hs-identifier hs-var hs-var">txRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679724769"><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724769"><span class="hs-identifier hs-var">unspentTxOuts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite ByteString -&gt; Eff effs [ChainIndexTxOut]
forall (effs :: [* -&gt; *]) o.
(Member (BeamEffect Sqlite) effs, HasDbType o) =&gt;
SqlSelect Sqlite (DbType o) -&gt; Eff effs [o]
</span><a href="Plutus.ChainIndex.Handlers.html#queryList"><span class="hs-identifier hs-var">queryList</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite ByteString -&gt; Eff effs [ChainIndexTxOut])
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope ByteString)
    -&gt; SqlSelect Sqlite ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Eff effs [ChainIndexTxOut]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; SqlSelect Sqlite ByteString
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope ByteString)
 -&gt; Eff effs [ChainIndexTxOut])
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Eff effs [ChainIndexTxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoRowT (QGenExpr QValueContext Sqlite QBaseScope)
-&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString
forall (f :: * -&gt; *). UtxoRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_utxoRowTxOut"><span class="hs-identifier hs-var hs-var">_utxoRowTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoRowT (QGenExpr QValueContext Sqlite QBaseScope)
 -&gt; QGenExpr QValueContext Sqlite QBaseScope ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (UtxoRowT (QGenExpr QValueContext Sqlite QBaseScope))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (UtxoRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (UtxoRowT (QExpr Sqlite (QNested QBaseScope))))
forall s a be (db :: (* -&gt; *) -&gt; *).
(Projectible be a, ThreadRewritable (QNested s) a) =&gt;
Integer
-&gt; Q be db (QNested s) a
-&gt; Q be db s (WithRewrittenThread (QNested s) s a)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">limit_</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (UtxoRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity UtxoRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity UtxoRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#utxoOutRefRows"><span class="hs-identifier hs-var hs-var">utxoOutRefRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679724768"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724768"><span class="hs-identifier hs-var">numScripts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer)
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer))
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope Integer)
    -&gt; SqlSelect Sqlite Integer)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; SqlSelect Sqlite Integer
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope Integer)
 -&gt; Eff effs (Maybe Integer))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QAgg Sqlite (QNested QBaseScope) Integer)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (ScriptRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall be a r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Aggregable be a, Projectible be r,
 Projectible be a, ContextRewritable a,
 ThreadRewritable
   (QNested s) (WithRewrittenContext a QValueContext)) =&gt;
(r -&gt; a)
-&gt; Q be db (QNested s) r
-&gt; Q be
     db
     s
     (WithRewrittenThread
        (QNested s) s (WithRewrittenContext a QValueContext))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">aggregate_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
-&gt; ScriptRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QAgg Sqlite (QNested QBaseScope) Integer
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
forall be a s. (BeamSqlBackend be, Integral a) =&gt; QAgg be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">countAll_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity ScriptRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (ScriptRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity ScriptRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity ScriptRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#scriptRows"><span class="hs-identifier hs-var hs-var">scriptRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>    </span><span id="local-6989586621679724767"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724767"><span class="hs-identifier hs-var">numAddresses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer)
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer))
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope Integer)
    -&gt; SqlSelect Sqlite Integer)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; SqlSelect Sqlite Integer
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope Integer)
 -&gt; Eff effs (Maybe Integer))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
 -&gt; QAgg Sqlite (QNested QBaseScope) Integer)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall be a r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Aggregable be a, Projectible be r,
 Projectible be a, ContextRewritable a,
 ThreadRewritable
   (QNested s) (WithRewrittenContext a QValueContext)) =&gt;
(r -&gt; a)
-&gt; Q be db (QNested s) r
-&gt; Q be
     db
     s
     (WithRewrittenThread
        (QNested s) s (WithRewrittenContext a QValueContext))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">aggregate_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
-&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
-&gt; QAgg Sqlite (QNested QBaseScope) Integer
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
forall be a s. (BeamSqlBackend be, Integral a) =&gt; QAgg be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">countAll_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
 -&gt; Q Sqlite
      Db
      QBaseScope
      (WithRewrittenThread
         (QNested QBaseScope)
         QBaseScope
         (WithRewrittenContext
            (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext)))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested QBaseScope)
  (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall be r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Projectible be r) =&gt;
Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">nub_</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
 -&gt; Q Sqlite
      Db
      (QNested QBaseScope)
      (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
forall (f :: * -&gt; *). AddressRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_addressRowCred"><span class="hs-identifier hs-var hs-var">_addressRowCred</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (AddressRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AddressRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (AddressRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AddressRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AddressRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#addressRows"><span class="hs-identifier hs-var hs-var">addressRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>    </span><span id="local-6989586621679724766"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724766"><span class="hs-identifier hs-var">numAssetClasses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer)
forall dbt a (effs :: [* -&gt; *]).
(FromBackendRow dbt a, Member (BeamEffect dbt) effs) =&gt;
SqlSelect dbt a -&gt; Eff effs (Maybe a)
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">selectOne</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlSelect Sqlite Integer -&gt; Eff effs (Maybe Integer))
-&gt; (Q Sqlite
      Db
      QBaseScope
      (QGenExpr QValueContext Sqlite QBaseScope Integer)
    -&gt; SqlSelect Sqlite Integer)
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  QBaseScope
  (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; SqlSelect Sqlite Integer
forall be (db :: (* -&gt; *) -&gt; *) res.
(BeamSqlBackend be, HasQBuilder be, Projectible be res) =&gt;
Q be db QBaseScope res -&gt; SqlSelect be (QExprToIdentity res)
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   QBaseScope
   (QGenExpr QValueContext Sqlite QBaseScope Integer)
 -&gt; Eff effs (Maybe Integer))
-&gt; Q Sqlite
     Db
     QBaseScope
     (QGenExpr QValueContext Sqlite QBaseScope Integer)
-&gt; Eff effs (Maybe Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
 -&gt; QAgg Sqlite (QNested QBaseScope) Integer)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall be a r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Aggregable be a, Projectible be r,
 Projectible be a, ContextRewritable a,
 ThreadRewritable
   (QNested s) (WithRewrittenContext a QValueContext)) =&gt;
(r -&gt; a)
-&gt; Q be db (QNested s) r
-&gt; Q be
     db
     s
     (WithRewrittenThread
        (QNested s) s (WithRewrittenContext a QValueContext))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">aggregate_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
-&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
-&gt; QAgg Sqlite (QNested QBaseScope) Integer
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">QAgg Sqlite (QNested QBaseScope) Integer
forall be a s. (BeamSqlBackend be, Integral a) =&gt; QAgg be s a
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">countAll_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
 -&gt; Q Sqlite
      Db
      QBaseScope
      (WithRewrittenThread
         (QNested QBaseScope)
         QBaseScope
         (WithRewrittenContext
            (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext)))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     QBaseScope
     (WithRewrittenThread
        (QNested QBaseScope)
        QBaseScope
        (WithRewrittenContext
           (QAgg Sqlite (QNested QBaseScope) Integer) QValueContext))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Q Sqlite
  Db
  (QNested QBaseScope)
  (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall be r (db :: (* -&gt; *) -&gt; *) s.
(BeamSqlBackend be, Projectible be r) =&gt;
Q be db s r -&gt; Q be db s r
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">nub_</span></a></span><span> </span><span class="annot"><span class="annottext">(Q Sqlite
   Db
   (QNested QBaseScope)
   (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
 -&gt; Q Sqlite
      Db
      (QNested QBaseScope)
      (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClassRowT (QExpr Sqlite (QNested QBaseScope))
-&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString
forall (f :: * -&gt; *). AssetClassRowT f -&gt; Columnar f ByteString
</span><a href="Plutus.ChainIndex.DbSchema.html#_assetClassRowAssetClass"><span class="hs-identifier hs-var hs-var">_assetClassRowAssetClass</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetClassRowT (QExpr Sqlite (QNested QBaseScope))
 -&gt; QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (AssetClassRowT (QExpr Sqlite (QNested QBaseScope)))
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (QGenExpr QValueContext Sqlite (QNested QBaseScope) ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
-&gt; Q Sqlite
     Db
     (QNested QBaseScope)
     (AssetClassRowT (QExpr Sqlite (QNested QBaseScope)))
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
(Database be db, BeamSqlBackend be) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; Q be db s (table (QExpr be s))
</span><a href="../file:///nix/store/zv01l0dglhvi9ciyhxw8dbsnx4rlgpy7-beam-core-lib-beam-core-0.9.2.1-haddock-doc/share/doc/beam-core/html/src"><span class="hs-identifier hs-var">all_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
-&gt; DatabaseEntity Sqlite Db (TableEntity AssetClassRowT)
forall (f :: * -&gt; *). Db f -&gt; f (TableEntity AssetClassRowT)
</span><a href="Plutus.ChainIndex.DbSchema.html#assetClassRows"><span class="hs-identifier hs-var hs-var">assetClassRows</span></a></span><span> </span><span class="annot"><span class="annottext">Db (DatabaseEntity Sqlite Db)
</span><a href="Plutus.ChainIndex.DbSchema.html#db"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="Plutus.ChainIndex.Types.html#TxUtxoBalance"><span class="hs-identifier hs-type">TxUtxoBalance</span></a></span><span> </span><span id="local-6989586621679724765"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724765"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span id="local-6989586621679724764"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724764"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UtxoState TxUtxoBalance -&gt; TxUtxoBalance
forall a. UtxoState a -&gt; a
</span><a href="Plutus.ChainIndex.UtxoState.html#_usTxUtxoData"><span class="hs-identifier hs-var hs-var">UtxoState._usTxUtxoData</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoState TxUtxoBalance -&gt; TxUtxoBalance)
-&gt; (ChainIndexState -&gt; UtxoState TxUtxoBalance)
-&gt; ChainIndexState
-&gt; TxUtxoBalance
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexState -&gt; UtxoState TxUtxoBalance
forall a. Monoid a =&gt; UtxoIndex a -&gt; UtxoState a
</span><a href="Plutus.ChainIndex.UtxoState.html#utxoState"><span class="hs-identifier hs-var">UtxoState.utxoState</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexState -&gt; TxUtxoBalance)
-&gt; Eff effs ChainIndexState -&gt; Eff effs TxUtxoBalance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State ChainIndexState) effs =&gt;
Eff effs ChainIndexState
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ChainIndex.Handlers.html#ChainIndexState"><span class="hs-identifier hs-type">ChainIndexState</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="annottext">Diagnostics -&gt; Eff effs Diagnostics
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Diagnostics -&gt; Eff effs Diagnostics)
-&gt; Diagnostics -&gt; Eff effs Diagnostics
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Diagnostics :: Integer
-&gt; Integer
-&gt; Integer
-&gt; Integer
-&gt; Int
-&gt; Int
-&gt; [TxId]
-&gt; [ChainIndexTxOut]
-&gt; Diagnostics
</span><a href="Plutus.ChainIndex.Types.html#Diagnostics"><span class="hs-identifier hs-type">Diagnostics</span></a></span><span>
</span><span id="line-649"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numTransactions :: Integer
</span><a href="Plutus.ChainIndex.Types.html#numTransactions"><span class="hs-identifier hs-var">numTransactions</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer -&gt; Integer
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724771"><span class="hs-identifier hs-var">numTransactions</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numScripts :: Integer
</span><a href="Plutus.ChainIndex.Types.html#numScripts"><span class="hs-identifier hs-var">numScripts</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer -&gt; Integer
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724768"><span class="hs-identifier hs-var">numScripts</span></a></span><span>
</span><span id="line-651"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAddresses :: Integer
</span><a href="Plutus.ChainIndex.Types.html#numAddresses"><span class="hs-identifier hs-var">numAddresses</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer -&gt; Integer
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724767"><span class="hs-identifier hs-var">numAddresses</span></a></span><span>
</span><span id="line-652"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAssetClasses :: Integer
</span><a href="Plutus.ChainIndex.Types.html#numAssetClasses"><span class="hs-identifier hs-var">numAssetClasses</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer -&gt; Integer
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679724766"><span class="hs-identifier hs-var">numAssetClasses</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numUnspentOutputs :: Int
</span><a href="Plutus.ChainIndex.Types.html#numUnspentOutputs"><span class="hs-identifier hs-var">numUnspentOutputs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724765"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numUnmatchedInputs :: Int
</span><a href="Plutus.ChainIndex.Types.html#numUnmatchedInputs"><span class="hs-identifier hs-var">numUnmatchedInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679724764"><span class="hs-identifier hs-var">inputs</span></a></span><span>
</span><span id="line-655"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">someTransactions :: [TxId]
</span><a href="Plutus.ChainIndex.Types.html#someTransactions"><span class="hs-identifier hs-var">someTransactions</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621679724770"><span class="hs-identifier hs-var">txIds</span></a></span><span>
</span><span id="line-656"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unspentTxOuts :: [ChainIndexTxOut]
</span><a href="Plutus.ChainIndex.Types.html#unspentTxOuts"><span class="hs-identifier hs-var">unspentTxOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ChainIndexTxOut]
</span><a href="#local-6989586621679724769"><span class="hs-identifier hs-var">unspentTxOuts</span></a></span><span>
</span><span id="line-657"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-658"></span></pre></body></html>
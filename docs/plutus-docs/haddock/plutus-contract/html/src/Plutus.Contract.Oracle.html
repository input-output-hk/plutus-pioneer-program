<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass     #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric      #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude  #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell    #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications   #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-simplifiable-class-constraints #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-specialise #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-omit-interface-pragmas #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">{- Note [Oracle incorrect implementation]

This current Oracle implementation uses the
'Constraints.mustIncludeDatumInTxWithHash' constraint which used to add a datum
in transaction body. However, cardano-ledger enforces a rule (rewording the
rule here..) in which a datum in the transaction body needs to have the same
hash as a datum in one of the transaction's outputs.

However, now that we have fixed the bug in
'Constraints.mustIncludeDatumInTxWithHash' so work with this ledger rule, the
Oracle implementation does not work anymore, and examples in the
plutus-use-cases Haskell package now fail because of this.

Therefore, for now, we will comment out the failing test cases until we rewrite
this Oracle module to work with inline datums instead of datums in the
transaction body. This implies upgrades some of the examples in
`plutus-use-cases` to PlutusV2.
-}</span><span>
</span><span id="line-33"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Oracle</span><span class="hs-special">(</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Signed messages</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-comment">-- $oracles</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier">Observation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier">SignedMessage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Checking signed messages</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier">SignedMessageCheckError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier">checkSignature</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-identifier">checkHashConstraints</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkHashOffChain"><span class="hs-identifier">checkHashOffChain</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageOffChain"><span class="hs-identifier">verifySignedMessageOffChain</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageOnChain"><span class="hs-identifier">verifySignedMessageOnChain</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageConstraints"><span class="hs-identifier">verifySignedMessageConstraints</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Signing messages</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#signMessage"><span class="hs-identifier">signMessage</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#signObservation"><span class="hs-identifier">signObservation</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Signing messages with no passphrase</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#signMessage%27"><span class="hs-identifier">signMessage'</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#signObservation%27"><span class="hs-identifier">signObservation'</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ry2dz8v15w24fs3v0kp3gg27jfms22qc-cardano-crypto-lib-cardano-crypto-1.1.1-haddock-doc/share/doc/cardano-crypto/html/src"><span class="hs-identifier">Cardano.Crypto.Wallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ry2dz8v15w24fs3v0kp3gg27jfms22qc-cardano-crypto-lib-cardano-crypto-1.1.1-haddock-doc/share/doc/cardano-crypto/html/src"><span class="hs-identifier">XPrv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">FromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">fromBuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">toBuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">makeIsDataIndexed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">makeLift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">pure</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Right</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(==)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>                         </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">verifyEd25519Signature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">($)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(&amp;&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPrivateKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">unPaymentPrivateKey</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Constraints</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints.OnChain.V1</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Constraints</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Passphrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PubKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Signature</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Crypto</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">Crypto</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Datum</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">DatumHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">DatumHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Scripts</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">LedgerBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">LedgerBytes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Contexts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">ScriptContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">POSIXTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Haskell</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- $oracles</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- This module provides a way to verify signed messages, and a type for</span><span>
</span><span id="line-79"></span><span class="hs-comment">--  observations (for example, the price of a commodity on a given date).</span><span>
</span><span id="line-80"></span><span class="hs-comment">--  Together, the two can be used to implement trusted oracles:</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">--  * The oracle observes a value, for example 'Price' and constructs a value</span><span>
</span><span id="line-83"></span><span class="hs-comment">--    @o = @ 'Observation' @Price@.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--  * The oracle then calls 'signMessage' @o pk@ with its own private key to</span><span>
</span><span id="line-85"></span><span class="hs-comment">--    produce a 'SignedMessage' @(@'Observation' @Price)@.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--  * The signed message is passed to the contract as the redeemer of some</span><span>
</span><span id="line-87"></span><span class="hs-comment">--    unspent output. __Important:__ The redeeming transaction must include the</span><span>
</span><span id="line-88"></span><span class="hs-comment">--    message 'o' as a datum. This is because we can't hash anything in</span><span>
</span><span id="line-89"></span><span class="hs-comment">--    on-chain code, and therefore have to rely on the node to do it for us</span><span>
</span><span id="line-90"></span><span class="hs-comment">--    via the pending transaction's map of datum hashes to datums.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--    (The constraints resolution mechanism takes care of including the message)</span><span>
</span><span id="line-92"></span><span class="hs-comment">--  * The contract then calls 'checkSignature' to check the signature, and</span><span>
</span><span id="line-93"></span><span class="hs-comment">--    produces a constraint ensuring that the signed hash is really the hash</span><span>
</span><span id="line-94"></span><span class="hs-comment">--    of the datum.</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | A value that was observed at a specific point in time</span><span>
</span><span id="line-97"></span><span id="local-6989586621680811686"><span id="local-6989586621680811687"></span></span><span class="hs-keyword">data</span><span> </span><span id="Observation"><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-var">Observation</span></a></span></span><span> </span><span id="local-6989586621680811826"><span class="annot"><a href="#local-6989586621680811826"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Observation"><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-var">Observation</span></a></span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="obsValue"><span class="annot"><span class="annottext">Observation a -&gt; a
</span><a href="Plutus.Contract.Oracle.html#obsValue"><span class="hs-identifier hs-var hs-var">obsValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680811826"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- ^ The value</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="obsTime"><span class="annot"><span class="annottext">Observation a -&gt; POSIXTime
</span><a href="Plutus.Contract.Oracle.html#obsTime"><span class="hs-identifier hs-var hs-var">obsTime</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTime</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- ^ The time at which the value was observed</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Observation a -&gt; Rep (Observation a) x)
-&gt; (forall x. Rep (Observation a) x -&gt; Observation a)
-&gt; Generic (Observation a)
forall x. Rep (Observation a) x -&gt; Observation a
forall x. Observation a -&gt; Rep (Observation a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Observation a) x -&gt; Observation a
forall a x. Observation a -&gt; Rep (Observation a) x
$cto :: forall a x. Rep (Observation a) x -&gt; Observation a
$cfrom :: forall a x. Observation a -&gt; Rep (Observation a) x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811674"><span id="local-6989586621680811676"><span id="local-6989586621680811678"><span class="annot"><span class="annottext">Int -&gt; Observation a -&gt; ShowS
[Observation a] -&gt; ShowS
Observation a -&gt; String
(Int -&gt; Observation a -&gt; ShowS)
-&gt; (Observation a -&gt; String)
-&gt; ([Observation a] -&gt; ShowS)
-&gt; Show (Observation a)
forall a. Show a =&gt; Int -&gt; Observation a -&gt; ShowS
forall a. Show a =&gt; [Observation a] -&gt; ShowS
forall a. Show a =&gt; Observation a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Observation a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Observation a] -&gt; ShowS
show :: Observation a -&gt; String
$cshow :: forall a. Show a =&gt; Observation a -&gt; String
showsPrec :: Int -&gt; Observation a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Observation a -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Haskell.Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811669"><span id="local-6989586621680811671"><span class="annot"><span class="annottext">Observation a -&gt; Observation a -&gt; Bool
(Observation a -&gt; Observation a -&gt; Bool)
-&gt; (Observation a -&gt; Observation a -&gt; Bool) -&gt; Eq (Observation a)
forall a. Eq a =&gt; Observation a -&gt; Observation a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Observation a -&gt; Observation a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Observation a -&gt; Observation a -&gt; Bool
== :: Observation a -&gt; Observation a -&gt; Bool
$c== :: forall a. Eq a =&gt; Observation a -&gt; Observation a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Haskell.Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621680811667"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811667"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-type">Observation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811667"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621680811664"><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811664"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680811663"><span class="annot"><span class="annottext">== :: Observation a -&gt; Observation a -&gt; Bool
</span><a href="#local-6989586621680811663"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621680811662"><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811662"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="annottext">Observation a -&gt; a
forall a. Observation a -&gt; a
</span><a href="Plutus.Contract.Oracle.html#obsValue"><span class="hs-identifier hs-var hs-var">obsValue</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811664"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a -&gt; a
forall a. Observation a -&gt; a
</span><a href="Plutus.Contract.Oracle.html#obsValue"><span class="hs-identifier hs-var hs-var">obsValue</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811662"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a -&gt; POSIXTime
forall a. Observation a -&gt; POSIXTime
</span><a href="Plutus.Contract.Oracle.html#obsTime"><span class="hs-identifier hs-var hs-var">obsTime</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811664"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a -&gt; POSIXTime
forall a. Observation a -&gt; POSIXTime
</span><a href="Plutus.Contract.Oracle.html#obsTime"><span class="hs-identifier hs-var hs-var">obsTime</span></a></span><span> </span><span class="annot"><span class="annottext">Observation a
</span><a href="#local-6989586621680811662"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | @SignedMessage a@ contains the signature of a hash of a 'Datum'.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--   The 'Datum' can be decoded to a value of type @a@.</span><span>
</span><span id="line-111"></span><span id="local-6989586621680811660"><span id="local-6989586621680811661"></span></span><span class="hs-keyword">data</span><span> </span><span id="SignedMessage"><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-var">SignedMessage</span></a></span></span><span> </span><span id="local-6989586621680811803"><span class="annot"><a href="#local-6989586621680811803"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SignedMessage"><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-var">SignedMessage</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="osmSignature"><span class="annot"><span class="annottext">SignedMessage a -&gt; Signature
</span><a href="Plutus.Contract.Oracle.html#osmSignature"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- ^ Signature of the message</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="osmMessageHash"><span class="annot"><span class="annottext">SignedMessage a -&gt; DatumHash
</span><a href="Plutus.Contract.Oracle.html#osmMessageHash"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- ^ Hash of the message</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="osmDatum"><span class="annot"><span class="annottext">SignedMessage a -&gt; Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var hs-var">osmDatum</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. SignedMessage a -&gt; Rep (SignedMessage a) x)
-&gt; (forall x. Rep (SignedMessage a) x -&gt; SignedMessage a)
-&gt; Generic (SignedMessage a)
forall x. Rep (SignedMessage a) x -&gt; SignedMessage a
forall x. SignedMessage a -&gt; Rep (SignedMessage a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (SignedMessage a) x -&gt; SignedMessage a
forall a x. SignedMessage a -&gt; Rep (SignedMessage a) x
$cto :: forall a x. Rep (SignedMessage a) x -&gt; SignedMessage a
$cfrom :: forall a x. SignedMessage a -&gt; Rep (SignedMessage a) x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811648"><span id="local-6989586621680811650"><span id="local-6989586621680811652"><span class="annot"><span class="annottext">Int -&gt; SignedMessage a -&gt; ShowS
[SignedMessage a] -&gt; ShowS
SignedMessage a -&gt; String
(Int -&gt; SignedMessage a -&gt; ShowS)
-&gt; (SignedMessage a -&gt; String)
-&gt; ([SignedMessage a] -&gt; ShowS)
-&gt; Show (SignedMessage a)
forall a. Int -&gt; SignedMessage a -&gt; ShowS
forall a. [SignedMessage a] -&gt; ShowS
forall a. SignedMessage a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SignedMessage a] -&gt; ShowS
$cshowList :: forall a. [SignedMessage a] -&gt; ShowS
show :: SignedMessage a -&gt; String
$cshow :: forall a. SignedMessage a -&gt; String
showsPrec :: Int -&gt; SignedMessage a -&gt; ShowS
$cshowsPrec :: forall a. Int -&gt; SignedMessage a -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Haskell.Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811644"><span id="local-6989586621680811646"><span class="annot"><span class="annottext">SignedMessage a -&gt; SignedMessage a -&gt; Bool
(SignedMessage a -&gt; SignedMessage a -&gt; Bool)
-&gt; (SignedMessage a -&gt; SignedMessage a -&gt; Bool)
-&gt; Eq (SignedMessage a)
forall a. SignedMessage a -&gt; SignedMessage a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SignedMessage a -&gt; SignedMessage a -&gt; Bool
$c/= :: forall a. SignedMessage a -&gt; SignedMessage a -&gt; Bool
== :: SignedMessage a -&gt; SignedMessage a -&gt; Bool
$c== :: forall a. SignedMessage a -&gt; SignedMessage a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Haskell.Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680811636"><span id="local-6989586621680811638"><span id="local-6989586621680811640"><span id="local-6989586621680811642"><span class="annot"><span class="annottext">[SignedMessage a] -&gt; Encoding
[SignedMessage a] -&gt; Value
SignedMessage a -&gt; Encoding
SignedMessage a -&gt; Value
(SignedMessage a -&gt; Value)
-&gt; (SignedMessage a -&gt; Encoding)
-&gt; ([SignedMessage a] -&gt; Value)
-&gt; ([SignedMessage a] -&gt; Encoding)
-&gt; ToJSON (SignedMessage a)
forall a. [SignedMessage a] -&gt; Encoding
forall a. [SignedMessage a] -&gt; Value
forall a. SignedMessage a -&gt; Encoding
forall a. SignedMessage a -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [SignedMessage a] -&gt; Encoding
$ctoEncodingList :: forall a. [SignedMessage a] -&gt; Encoding
toJSONList :: [SignedMessage a] -&gt; Value
$ctoJSONList :: forall a. [SignedMessage a] -&gt; Value
toEncoding :: SignedMessage a -&gt; Encoding
$ctoEncoding :: forall a. SignedMessage a -&gt; Encoding
toJSON :: SignedMessage a -&gt; Value
$ctoJSON :: forall a. SignedMessage a -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811631"><span id="local-6989586621680811633"><span class="annot"><span class="annottext">Value -&gt; Parser [SignedMessage a]
Value -&gt; Parser (SignedMessage a)
(Value -&gt; Parser (SignedMessage a))
-&gt; (Value -&gt; Parser [SignedMessage a])
-&gt; FromJSON (SignedMessage a)
forall a. Value -&gt; Parser [SignedMessage a]
forall a. Value -&gt; Parser (SignedMessage a)
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [SignedMessage a]
$cparseJSONList :: forall a. Value -&gt; Parser [SignedMessage a]
parseJSON :: Value -&gt; Parser (SignedMessage a)
$cparseJSON :: forall a. Value -&gt; Parser (SignedMessage a)
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621680811629"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811629"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621680811627"><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811627"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680811626"><span class="annot"><span class="annottext">== :: SignedMessage a -&gt; SignedMessage a -&gt; Bool
</span><a href="#local-6989586621680811626"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621680811625"><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811625"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">SignedMessage a -&gt; Signature
forall a. SignedMessage a -&gt; Signature
</span><a href="Plutus.Contract.Oracle.html#osmSignature"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811627"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Signature -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; Signature
forall a. SignedMessage a -&gt; Signature
</span><a href="Plutus.Contract.Oracle.html#osmSignature"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811625"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; DatumHash
forall a. SignedMessage a -&gt; DatumHash
</span><a href="Plutus.Contract.Oracle.html#osmMessageHash"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811627"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; DatumHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; DatumHash
forall a. SignedMessage a -&gt; DatumHash
</span><a href="Plutus.Contract.Oracle.html#osmMessageHash"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811625"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; Datum
forall a. SignedMessage a -&gt; Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var hs-var">osmDatum</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811627"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Datum -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; Datum
forall a. SignedMessage a -&gt; Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var hs-var">osmDatum</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811625"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621680811623"><span id="local-6989586621680811624"></span></span><span class="hs-keyword">data</span><span> </span><span id="SignedMessageCheckError"><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-var">SignedMessageCheckError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>    </span><span id="SignatureMismatch"><span class="annot"><a href="Plutus.Contract.Oracle.html#SignatureMismatch"><span class="hs-identifier hs-var">SignatureMismatch</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- ^ The signature did not match the public key</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DatumMissing"><span class="annot"><a href="Plutus.Contract.Oracle.html#DatumMissing"><span class="hs-identifier hs-var">DatumMissing</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">-- ^ The datum was missing from the pending transaction</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DecodingError"><span class="annot"><a href="Plutus.Contract.Oracle.html#DecodingError"><span class="hs-identifier hs-var">DecodingError</span></a></span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">-- ^ The datum had the wrong shape</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DatumNotEqualToExpected"><span class="annot"><a href="Plutus.Contract.Oracle.html#DatumNotEqualToExpected"><span class="hs-identifier hs-var">DatumNotEqualToExpected</span></a></span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- ^ The datum that corresponds to the hash is wrong</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x.
 SignedMessageCheckError -&gt; Rep SignedMessageCheckError x)
-&gt; (forall x.
    Rep SignedMessageCheckError x -&gt; SignedMessageCheckError)
-&gt; Generic SignedMessageCheckError
forall x. Rep SignedMessageCheckError x -&gt; SignedMessageCheckError
forall x. SignedMessageCheckError -&gt; Rep SignedMessageCheckError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SignedMessageCheckError x -&gt; SignedMessageCheckError
$cfrom :: forall x. SignedMessageCheckError -&gt; Rep SignedMessageCheckError x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811611"><span id="local-6989586621680811613"><span id="local-6989586621680811615"><span class="annot"><span class="annottext">Int -&gt; SignedMessageCheckError -&gt; ShowS
[SignedMessageCheckError] -&gt; ShowS
SignedMessageCheckError -&gt; String
(Int -&gt; SignedMessageCheckError -&gt; ShowS)
-&gt; (SignedMessageCheckError -&gt; String)
-&gt; ([SignedMessageCheckError] -&gt; ShowS)
-&gt; Show SignedMessageCheckError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SignedMessageCheckError] -&gt; ShowS
$cshowList :: [SignedMessageCheckError] -&gt; ShowS
show :: SignedMessageCheckError -&gt; String
$cshow :: SignedMessageCheckError -&gt; String
showsPrec :: Int -&gt; SignedMessageCheckError -&gt; ShowS
$cshowsPrec :: Int -&gt; SignedMessageCheckError -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Haskell.Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-pragma hs-type">checkSignature</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Verify the signature on a signed datum hash</span><span>
</span><span id="line-140"></span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier hs-type">checkSignature</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-comment">-- ^ The hash of the message</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-comment">-- ^ The public key of the signatory</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- ^ The signed message</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span id="checkSignature"><span class="annot"><span class="annottext">checkSignature :: DatumHash
-&gt; PaymentPubKey -&gt; Signature -&gt; Either SignedMessageCheckError ()
</span><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier hs-var hs-var">checkSignature</span></a></span></span><span> </span><span id="local-6989586621680811610"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811610"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span> </span><span id="local-6989586621680811609"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811609"><span class="hs-identifier hs-var">pubKey</span></a></span></span><span> </span><span id="local-6989586621680811608"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811608"><span class="hs-identifier hs-var">signature_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PubKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">LedgerBytes</span></a></span><span> </span><span id="local-6989586621680811606"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811606"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811609"><span class="hs-identifier hs-var">pubKey</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621680811604"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811604"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811608"><span class="hs-identifier hs-var">signature_</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621680811603"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811603"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811610"><span class="hs-identifier hs-var">datumHash</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; BuiltinByteString -&gt; BuiltinByteString -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">verifyEd25519Signature</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811606"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811603"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811604"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either SignedMessageCheckError ()
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SignedMessageCheckError -&gt; Either SignedMessageCheckError ()
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(SignedMessageCheckError -&gt; Either SignedMessageCheckError ())
-&gt; SignedMessageCheckError -&gt; Either SignedMessageCheckError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; PaymentPubKey -&gt; DatumHash -&gt; SignedMessageCheckError
</span><a href="Plutus.Contract.Oracle.html#SignatureMismatch"><span class="hs-identifier hs-var">SignatureMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811608"><span class="hs-identifier hs-var">signature_</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811609"><span class="hs-identifier hs-var">pubKey</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811610"><span class="hs-identifier hs-var">datumHash</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-pragma hs-type">checkHashConstraints</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Extract the contents of the message and produce a constraint that checks</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   that the hash is correct. In off-chain code, where we check the hash</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   straightforwardly, 'checkHashOffChain' can be used instead of this.</span><span>
</span><span id="line-160"></span><span id="local-6989586621680811767"><span id="local-6989586621680811768"><span id="local-6989586621680811769"><span class="annot"><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-identifier hs-type">checkHashConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811769"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- ^ The signed message</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680811769"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811768"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811767"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-165"></span><span id="checkHashConstraints"><span class="annot"><span class="annottext">checkHashConstraints :: SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
</span><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-identifier hs-var hs-var">checkHashConstraints</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span class="hs-special">{</span><span id="local-6989586621680811602"><span class="annot"><span class="annottext">DatumHash
osmMessageHash :: DatumHash
osmMessageHash :: forall a. SignedMessage a -&gt; DatumHash
</span><a href="#local-6989586621680811602"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmDatum :: forall a. SignedMessage a -&gt; Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var">osmDatum</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span id="local-6989586621680811601"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621680811601"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Either SignedMessageCheckError (a, TxConstraints i o)
-&gt; (a -&gt; Either SignedMessageCheckError (a, TxConstraints i o))
-&gt; Maybe a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinString
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall a. BuiltinString -&gt; a -&gt; a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;Li&quot;</span></span><span> </span><span class="hs-comment">{-&quot;DecodingError&quot;-}</span><span> </span><span class="annot"><span class="annottext">(Either SignedMessageCheckError (a, TxConstraints i o)
 -&gt; Either SignedMessageCheckError (a, TxConstraints i o))
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessageCheckError
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessageCheckError
</span><a href="Plutus.Contract.Oracle.html#DecodingError"><span class="hs-identifier hs-var">DecodingError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680811600"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811600"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, TxConstraints i o)
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811600"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Datum -&gt; TxConstraints i o
forall i o. DatumHash -&gt; Datum -&gt; TxConstraints i o
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">Constraints.mustIncludeDatumInTxWithHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811602"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621680811601"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">fromBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621680811601"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageConstraints"><span class="hs-pragma hs-type">verifySignedMessageConstraints</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Check the signature on a 'SignedMessage' and extract the contents of the</span><span>
</span><span id="line-173"></span><span class="hs-comment">--   message, producing a 'TxConstraint' value that ensures the hashes match</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   up.</span><span>
</span><span id="line-175"></span><span id="local-6989586621680811596"><span id="local-6989586621680811597"><span id="local-6989586621680811598"><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageConstraints"><span class="hs-identifier hs-type">verifySignedMessageConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811598"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680811598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811597"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811596"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-180"></span><span id="verifySignedMessageConstraints"><span class="annot"><span class="annottext">verifySignedMessageConstraints :: PaymentPubKey
-&gt; SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
</span><a href="Plutus.Contract.Oracle.html#verifySignedMessageConstraints"><span class="hs-identifier hs-var hs-var">verifySignedMessageConstraints</span></a></span></span><span> </span><span id="local-6989586621680811595"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811595"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621680811594"><span class="annot"><span class="annottext">s :: SignedMessage a
</span><a href="#local-6989586621680811594"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span class="hs-special">{</span><span id="local-6989586621680811593"><span class="annot"><span class="annottext">Signature
osmSignature :: Signature
osmSignature :: forall a. SignedMessage a -&gt; Signature
</span><a href="#local-6989586621680811593"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811592"><span class="annot"><span class="annottext">DatumHash
osmMessageHash :: DatumHash
osmMessageHash :: forall a. SignedMessage a -&gt; DatumHash
</span><a href="#local-6989586621680811592"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">DatumHash
-&gt; PaymentPubKey -&gt; Signature -&gt; Either SignedMessageCheckError ()
</span><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier hs-var">checkSignature</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811592"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811595"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811593"><span class="hs-identifier hs-var">osmSignature</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Either SignedMessageCheckError ()
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
forall a i o.
FromData a =&gt;
SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
</span><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-identifier hs-var">checkHashConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811594"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageOnChain"><span class="hs-pragma hs-type">verifySignedMessageOnChain</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Check the signature on a 'SignedMessage' and extract the contents of the</span><span>
</span><span id="line-186"></span><span class="hs-comment">--   message, using the pending transaction in lieu of a hash function. See</span><span>
</span><span id="line-187"></span><span class="hs-comment">--   'verifySignedMessageConstraints' for a version that does not require a</span><span>
</span><span id="line-188"></span><span class="hs-comment">--   'ScriptContext' value.</span><span>
</span><span id="line-189"></span><span id="local-6989586621680811591"><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageOnChain"><span class="hs-identifier hs-type">verifySignedMessageOnChain</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811591"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811591"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811591"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-195"></span><span id="verifySignedMessageOnChain"><span class="annot"><span class="annottext">verifySignedMessageOnChain :: ScriptContext
-&gt; PaymentPubKey
-&gt; SignedMessage a
-&gt; Either SignedMessageCheckError a
</span><a href="Plutus.Contract.Oracle.html#verifySignedMessageOnChain"><span class="hs-identifier hs-var hs-var">verifySignedMessageOnChain</span></a></span></span><span> </span><span id="local-6989586621680811590"><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621680811590"><span class="hs-identifier hs-var">ptx</span></a></span></span><span> </span><span id="local-6989586621680811589"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811589"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621680811588"><span class="annot"><span class="annottext">s :: SignedMessage a
</span><a href="#local-6989586621680811588"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span class="hs-special">{</span><span id="local-6989586621680811587"><span class="annot"><span class="annottext">Signature
osmSignature :: Signature
osmSignature :: forall a. SignedMessage a -&gt; Signature
</span><a href="#local-6989586621680811587"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811586"><span class="annot"><span class="annottext">DatumHash
osmMessageHash :: DatumHash
osmMessageHash :: forall a. SignedMessage a -&gt; DatumHash
</span><a href="#local-6989586621680811586"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">DatumHash
-&gt; PaymentPubKey -&gt; Signature -&gt; Either SignedMessageCheckError ()
</span><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier hs-var">checkSignature</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811586"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811589"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811587"><span class="hs-identifier hs-var">osmSignature</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680811585"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811585"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811584"><span class="annot"><span class="annottext">TxConstraints () ()
</span><a href="#local-6989586621680811584"><span class="hs-identifier hs-var">constraints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints () ())
forall a i o.
FromData a =&gt;
SignedMessage a
-&gt; Either SignedMessageCheckError (a, TxConstraints i o)
</span><a href="Plutus.Contract.Oracle.html#checkHashConstraints"><span class="hs-identifier hs-var">checkHashConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811588"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; Either SignedMessageCheckError ()
-&gt; Either SignedMessageCheckError ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxConstraints () () -&gt; ScriptContext -&gt; Bool
forall i o.
(ToData i, ToData o) =&gt;
TxConstraints i o -&gt; ScriptContext -&gt; Bool
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">Constraints.checkScriptContext</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxConstraints () ()
</span><a href="#local-6989586621680811584"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621680811590"><span class="hs-identifier hs-var">ptx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedMessageCheckError -&gt; Either SignedMessageCheckError ()
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(SignedMessageCheckError -&gt; Either SignedMessageCheckError ())
-&gt; SignedMessageCheckError -&gt; Either SignedMessageCheckError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; SignedMessageCheckError
</span><a href="Plutus.Contract.Oracle.html#DatumMissing"><span class="hs-identifier hs-var">DatumMissing</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811586"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Either SignedMessageCheckError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811585"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | The off-chain version of 'checkHashConstraints', using the hash function</span><span>
</span><span id="line-203"></span><span class="hs-comment">--   directly instead of obtaining the hash from a 'ScriptContext' value</span><span>
</span><span id="line-204"></span><span id="local-6989586621680811758"><span class="annot"><a href="Plutus.Contract.Oracle.html#checkHashOffChain"><span class="hs-identifier hs-type">checkHashOffChain</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811758"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811758"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-208"></span><span id="checkHashOffChain"><span class="annot"><span class="annottext">checkHashOffChain :: SignedMessage a -&gt; Either SignedMessageCheckError a
</span><a href="Plutus.Contract.Oracle.html#checkHashOffChain"><span class="hs-identifier hs-var hs-var">checkHashOffChain</span></a></span></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span class="hs-special">{</span><span id="local-6989586621680811582"><span class="annot"><span class="annottext">DatumHash
osmMessageHash :: DatumHash
osmMessageHash :: forall a. SignedMessage a -&gt; DatumHash
</span><a href="#local-6989586621680811582"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmDatum :: forall a. SignedMessage a -&gt; Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var">osmDatum</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621680811581"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811581"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; Either SignedMessageCheckError ()
-&gt; Either SignedMessageCheckError ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811582"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; DatumHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Scripts.datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811581"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedMessageCheckError -&gt; Either SignedMessageCheckError ()
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessageCheckError
</span><a href="Plutus.Contract.Oracle.html#DatumNotEqualToExpected"><span class="hs-identifier hs-var">DatumNotEqualToExpected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span id="local-6989586621680811579"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621680811579"><span class="hs-identifier hs-var">dv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811581"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Either SignedMessageCheckError a
-&gt; (a -&gt; Either SignedMessageCheckError a)
-&gt; Maybe a
-&gt; Either SignedMessageCheckError a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedMessageCheckError -&gt; Either SignedMessageCheckError a
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessageCheckError
</span><a href="Plutus.Contract.Oracle.html#DecodingError"><span class="hs-identifier hs-var">DecodingError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either SignedMessageCheckError a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">fromBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621680811579"><span class="hs-identifier hs-var">dv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Check the signature on a 'SignedMessage' and extract the contents of the</span><span>
</span><span id="line-214"></span><span class="hs-comment">--   message.</span><span>
</span><span id="line-215"></span><span id="local-6989586621680811578"><span class="annot"><a href="Plutus.Contract.Oracle.html#verifySignedMessageOffChain"><span class="hs-identifier hs-type">verifySignedMessageOffChain</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811578"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKey</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811578"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessageCheckError"><span class="hs-identifier hs-type">SignedMessageCheckError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811578"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-220"></span><span id="verifySignedMessageOffChain"><span class="annot"><span class="annottext">verifySignedMessageOffChain :: PaymentPubKey
-&gt; SignedMessage a -&gt; Either SignedMessageCheckError a
</span><a href="Plutus.Contract.Oracle.html#verifySignedMessageOffChain"><span class="hs-identifier hs-var hs-var">verifySignedMessageOffChain</span></a></span></span><span> </span><span id="local-6989586621680811577"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811577"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621680811576"><span class="annot"><span class="annottext">s :: SignedMessage a
</span><a href="#local-6989586621680811576"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span class="hs-special">{</span><span id="local-6989586621680811575"><span class="annot"><span class="annottext">Signature
osmSignature :: Signature
osmSignature :: forall a. SignedMessage a -&gt; Signature
</span><a href="#local-6989586621680811575"><span class="hs-identifier hs-var hs-var">osmSignature</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680811574"><span class="annot"><span class="annottext">DatumHash
osmMessageHash :: DatumHash
osmMessageHash :: forall a. SignedMessage a -&gt; DatumHash
</span><a href="#local-6989586621680811574"><span class="hs-identifier hs-var hs-var">osmMessageHash</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">DatumHash
-&gt; PaymentPubKey -&gt; Signature -&gt; Either SignedMessageCheckError ()
</span><a href="Plutus.Contract.Oracle.html#checkSignature"><span class="hs-identifier hs-var">checkSignature</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680811574"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621680811577"><span class="hs-identifier hs-var">pk</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811575"><span class="hs-identifier hs-var">osmSignature</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Either SignedMessageCheckError ()
-&gt; Either SignedMessageCheckError a
-&gt; Either SignedMessageCheckError a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a -&gt; Either SignedMessageCheckError a
forall a.
FromData a =&gt;
SignedMessage a -&gt; Either SignedMessageCheckError a
</span><a href="Plutus.Contract.Oracle.html#checkHashOffChain"><span class="hs-identifier hs-var">checkHashOffChain</span></a></span><span> </span><span class="annot"><span class="annottext">SignedMessage a
</span><a href="#local-6989586621680811576"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Encode a message of type @a@ as a @Data@ value and sign the</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   hash of the datum.</span><span>
</span><span id="line-226"></span><span id="local-6989586621680811749"><span class="annot"><a href="Plutus.Contract.Oracle.html#signMessage"><span class="hs-identifier hs-type">signMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811749"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPrivateKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811749"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-227"></span><span id="signMessage"><span class="annot"><span class="annottext">signMessage :: a -&gt; PaymentPrivateKey -&gt; Passphrase -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#signMessage"><span class="hs-identifier hs-var hs-var">signMessage</span></a></span></span><span> </span><span id="local-6989586621680811573"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811573"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621680811572"><span class="annot"><span class="annottext">PaymentPrivateKey
</span><a href="#local-6989586621680811572"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span id="local-6989586621680811571"><span class="annot"><span class="annottext">Passphrase
</span><a href="#local-6989586621680811571"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680811570"><span class="annot"><span class="annottext">dt :: Datum
</span><a href="#local-6989586621680811570"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811573"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621680811569"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811569"><span class="hs-identifier hs-var">msgHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Scripts.datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811570"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621680811568"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621680811568"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; XPrv -&gt; Passphrase -&gt; Signature
forall a. ByteArrayAccess a =&gt; a -&gt; XPrv -&gt; Passphrase -&gt; Signature
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Crypto.sign</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811569"><span class="hs-identifier hs-var">msgHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; XPrv
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var hs-var">unPaymentPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey
</span><a href="#local-6989586621680811572"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Passphrase
</span><a href="#local-6989586621680811571"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SignedMessage :: forall a. Signature -&gt; DatumHash -&gt; Datum -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">osmSignature :: Signature
</span><a href="Plutus.Contract.Oracle.html#osmSignature"><span class="hs-identifier hs-var">osmSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811568"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmMessageHash :: DatumHash
</span><a href="Plutus.Contract.Oracle.html#osmMessageHash"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">DatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811569"><span class="hs-identifier hs-var">msgHash</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmDatum :: Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var">osmDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811570"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Encode an observation of a value of type @a@ that was made at the given time</span><span>
</span><span id="line-238"></span><span id="local-6989586621680811566"><span class="annot"><a href="Plutus.Contract.Oracle.html#signObservation"><span class="hs-identifier hs-type">signObservation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPrivateKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-type">Observation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="signObservation"><span class="annot"><span class="annottext">signObservation :: POSIXTime
-&gt; a
-&gt; PaymentPrivateKey
-&gt; Passphrase
-&gt; SignedMessage (Observation a)
</span><a href="Plutus.Contract.Oracle.html#signObservation"><span class="hs-identifier hs-var hs-var">signObservation</span></a></span></span><span> </span><span id="local-6989586621680811565"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680811565"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span id="local-6989586621680811564"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811564"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Observation a
-&gt; PaymentPrivateKey -&gt; Passphrase -&gt; SignedMessage (Observation a)
forall a.
ToData a =&gt;
a -&gt; PaymentPrivateKey -&gt; Passphrase -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#signMessage"><span class="hs-identifier hs-var">signMessage</span></a></span><span> </span><span class="annot"><span class="annottext">Observation :: forall a. a -&gt; POSIXTime -&gt; Observation a
</span><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-type">Observation</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">obsValue :: a
</span><a href="Plutus.Contract.Oracle.html#obsValue"><span class="hs-identifier hs-var">obsValue</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811564"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">obsTime :: POSIXTime
</span><a href="Plutus.Contract.Oracle.html#obsTime"><span class="hs-identifier hs-var">obsTime</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680811565"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Encode a message of type @a@ as a @Data@ value and sign the</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   hash of the datum.</span><span>
</span><span id="line-243"></span><span id="local-6989586621680811745"><span class="annot"><a href="Plutus.Contract.Oracle.html#signMessage%27"><span class="hs-identifier hs-type">signMessage'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/ry2dz8v15w24fs3v0kp3gg27jfms22qc-cardano-crypto-lib-cardano-crypto-1.1.1-haddock-doc/share/doc/cardano-crypto/html/src"><span class="hs-identifier hs-type">Crypto.XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811745"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-244"></span><span id="signMessage%27"><span class="annot"><span class="annottext">signMessage' :: a -&gt; XPrv -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#signMessage%27"><span class="hs-identifier hs-var hs-var">signMessage'</span></a></span></span><span> </span><span id="local-6989586621680811563"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811563"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621680811562"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621680811562"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680811561"><span class="annot"><span class="annottext">dt :: Datum
</span><a href="#local-6989586621680811561"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811563"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621680811560"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811560"><span class="hs-identifier hs-var">msgHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Scripts.datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811561"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span id="local-6989586621680811559"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621680811559"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; XPrv -&gt; Signature
forall a. ByteArrayAccess a =&gt; a -&gt; XPrv -&gt; Signature
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Crypto.sign'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811560"><span class="hs-identifier hs-var">msgHash</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621680811562"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SignedMessage :: forall a. Signature -&gt; DatumHash -&gt; Datum -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span>
</span><span id="line-249"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">osmSignature :: Signature
</span><a href="Plutus.Contract.Oracle.html#osmSignature"><span class="hs-identifier hs-var">osmSignature</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621680811559"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmMessageHash :: DatumHash
</span><a href="Plutus.Contract.Oracle.html#osmMessageHash"><span class="hs-identifier hs-var">osmMessageHash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">DatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621680811560"><span class="hs-identifier hs-var">msgHash</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">osmDatum :: Datum
</span><a href="Plutus.Contract.Oracle.html#osmDatum"><span class="hs-identifier hs-var">osmDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621680811561"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Encode an observation of a value of type @a@ that was made at the given time</span><span>
</span><span id="line-255"></span><span id="local-6989586621680811557"><span class="annot"><a href="Plutus.Contract.Oracle.html#signObservation%27"><span class="hs-identifier hs-type">signObservation'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680811557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/ry2dz8v15w24fs3v0kp3gg27jfms22qc-cardano-crypto-lib-cardano-crypto-1.1.1-haddock-doc/share/doc/cardano-crypto/html/src"><span class="hs-identifier hs-type">Crypto.XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Oracle.html#SignedMessage"><span class="hs-identifier hs-type">SignedMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-type">Observation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680811557"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-256"></span><span id="signObservation%27"><span class="annot"><span class="annottext">signObservation' :: POSIXTime -&gt; a -&gt; XPrv -&gt; SignedMessage (Observation a)
</span><a href="Plutus.Contract.Oracle.html#signObservation%27"><span class="hs-identifier hs-var hs-var">signObservation'</span></a></span></span><span> </span><span id="local-6989586621680811556"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680811556"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span id="local-6989586621680811555"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811555"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Observation a -&gt; XPrv -&gt; SignedMessage (Observation a)
forall a. ToData a =&gt; a -&gt; XPrv -&gt; SignedMessage a
</span><a href="Plutus.Contract.Oracle.html#signMessage%27"><span class="hs-identifier hs-var">signMessage'</span></a></span><span> </span><span class="annot"><span class="annottext">Observation :: forall a. a -&gt; POSIXTime -&gt; Observation a
</span><a href="Plutus.Contract.Oracle.html#Observation"><span class="hs-identifier hs-type">Observation</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">obsValue :: a
</span><a href="Plutus.Contract.Oracle.html#obsValue"><span class="hs-identifier hs-var">obsValue</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680811555"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">obsTime :: POSIXTime
</span><a href="Plutus.Contract.Oracle.html#obsTime"><span class="hs-identifier hs-var">obsTime</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621680811556"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span id="local-6989586621680811551"><span id="local-6989586621680811553"><span id="local-6989586621680811803"><span class="hs-identifier">makeLift</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">SignedMessage</span></span></span></span><span>
</span><span id="line-259"></span><span id="local-6989586621680811541"><span id="local-6989586621680811543"><span id="local-6989586621680811545"><span id="local-6989586621680811803"><span class="hs-identifier">makeIsDataIndexed</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">SignedMessage</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">SignedMessage</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span id="local-6989586621680811533"><span id="local-6989586621680811535"><span id="local-6989586621680811826"><span class="hs-identifier">makeLift</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Observation</span></span></span></span><span>
</span><span id="line-262"></span><span id="local-6989586621680811527"><span id="local-6989586621680811529"><span id="local-6989586621680811531"><span id="local-6989586621680811826"><span class="hs-identifier">makeIsDataIndexed</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Observation</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="hs-identifier">Observation</span><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-263"></span></pre></body></html>
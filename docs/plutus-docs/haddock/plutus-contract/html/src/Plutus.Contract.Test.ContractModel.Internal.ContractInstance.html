<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes        #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds            #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia                #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances          #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs                      #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ImportQualifiedPost        #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses      #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores         #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms            #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds                  #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints      #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes                 #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell            #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TupleSections              #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications           #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances       #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns               #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.Contract.Test.ContractModel.Internal.ContractInstance</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html"><span class="hs-identifier">Plutus.Trace.Emulator.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractHandle"><span class="hs-identifier">ContractHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractInstanceTag"><span class="hs-identifier">ContractInstanceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Data</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/g8vgm61qs4g5v6yyv8hvi8bm9dvsf9sa-row-types-lib-row-types-1.0.1.2-haddock-doc/share/doc/row-types/html/src"><span class="hs-identifier">Data.Row</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/g8vgm61qs4g5v6yyv8hvi8bm9dvsf9sa-row-types-lib-row-types-1.0.1.2-haddock-doc/share/doc/row-types/html/src"><span class="hs-identifier">Row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">AssetId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.html"><span class="hs-identifier">Plutus.Contract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier">Contract</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.html"><span class="hs-identifier">Plutus.Contract.Test</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.html#not"><span class="hs-identifier">not</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.html"><span class="hs-identifier">Plutus.Trace.Emulator</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#walletInstanceTag"><span class="hs-identifier">walletInstanceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zib0vh71vw6nxy47a0l8mmbplm2mqnx6-contractmodel-lib-contractmodel-0.1.0.0-haddock-doc/share/doc/contractmodel/html/src"><span class="hs-identifier">Test.QuickCheck.ContractModel</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Key-value map where keys and values have three indices that can vary between different elements</span><span>
</span><span id="line-43"></span><span class="hs-comment">--   of the map. Used to store `ContractHandle`s, which are indexed over observable state, schema,</span><span>
</span><span id="line-44"></span><span class="hs-comment">--   and error type.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="IMap"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-var">IMap</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680834926"><span class="annot"><a href="#local-6989586621680834926"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621680834925"><span class="annot"><a href="#local-6989586621680834925"><span class="hs-identifier hs-type hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621680834924"><span class="annot"><a href="#local-6989586621680834924"><span class="hs-identifier hs-type hs-type">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621680834923"><span class="annot"><a href="#local-6989586621680834923"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621680834922"><span class="annot"><a href="#local-6989586621680834922"><span class="hs-identifier hs-type hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680834921"><span class="annot"><a href="#local-6989586621680834921"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680834925"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834924"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834923"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621680834966"><span id="local-6989586621680834967"><span id="IMNil"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMNil"><span class="hs-identifier hs-var">IMNil</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834967"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834966"><span class="hs-identifier hs-type">val</span></a></span></span></span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621680834916"><span id="local-6989586621680834917"><span id="local-6989586621680834918"><span id="local-6989586621680834919"><span id="local-6989586621680835021"><span id="local-6989586621680835022"><span id="IMCons"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-var">IMCons</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834919"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834918"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834917"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834916"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680835022"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834919"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834918"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834917"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834916"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-49"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680835021"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834919"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834918"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834917"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-50"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835022"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835021"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-51"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835022"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835021"><span class="hs-identifier hs-type">val</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- TODO: Should this make sure we don't duplicate keys?</span><span>
</span><span id="line-54"></span><span id="local-6989586621680835015"><span id="local-6989586621680835016"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imAppend"><span class="hs-identifier hs-type">imAppend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835016"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835015"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835016"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835015"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835016"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680835015"><span class="hs-identifier hs-type">val</span></a></span></span></span><span>
</span><span id="line-55"></span><span id="imAppend"><span class="annot"><span class="annottext">imAppend :: IMap key val -&gt; IMap key val -&gt; IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imAppend"><span class="hs-identifier hs-var hs-var">imAppend</span></a></span></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMNil"><span class="hs-identifier hs-var">IMNil</span></a></span><span> </span><span id="local-6989586621680834913"><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834913"><span class="hs-identifier hs-var">m</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834913"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imAppend"><span class="hs-identifier hs-var">imAppend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-type">IMCons</span></a></span><span> </span><span id="local-6989586621680834912"><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834912"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680834911"><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834911"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680834910"><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834910"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680834909"><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834909"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key i j k l -&gt; val i j k -&gt; IMap key val -&gt; IMap key val
forall i j k l (i :: i) (j :: j) (k :: k) (l :: l)
       (key :: i -&gt; j -&gt; k -&gt; l -&gt; *) (val :: i -&gt; j -&gt; k -&gt; *).
(Typeable i, Typeable j, Typeable k, Typeable l) =&gt;
key i j k l -&gt; val i j k -&gt; IMap key val -&gt; IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-var">IMCons</span></a></span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834911"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IMap key val -&gt; IMap key val -&gt; IMap key val
forall i j k l (key :: i -&gt; j -&gt; k -&gt; l -&gt; *)
       (val :: i -&gt; j -&gt; k -&gt; *).
IMap key val -&gt; IMap key val -&gt; IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imAppend"><span class="hs-identifier hs-var">imAppend</span></a></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834910"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834909"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Look up a value in an indexed map. First checks that the indices agree, using `cast`. Once the</span><span>
</span><span id="line-59"></span><span class="hs-comment">--   type checker is convinced that the indices match we can check the key for equality.</span><span>
</span><span id="line-60"></span><span id="local-6989586621680834987"><span id="local-6989586621680834988"><span id="local-6989586621680834989"><span id="local-6989586621680834990"><span id="local-6989586621680834991"><span id="local-6989586621680834992"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imLookup"><span class="hs-identifier hs-type">imLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834992"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834991"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834990"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834989"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834988"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834987"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680834988"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834992"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834991"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834990"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834989"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834988"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834992"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834991"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834990"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834989"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-62"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834988"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834987"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-63"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680834987"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834992"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834991"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834990"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-64"></span><span id="imLookup"><span class="annot"><span class="annottext">imLookup :: key i j k l -&gt; IMap key val -&gt; Maybe (val i j k)
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imLookup"><span class="hs-identifier hs-var hs-var">imLookup</span></a></span></span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMNil"><span class="hs-identifier hs-var">IMNil</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (val i j k)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imLookup"><span class="hs-identifier hs-var">imLookup</span></a></span><span> </span><span id="local-6989586621680834907"><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834907"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-type">IMCons</span></a></span><span> </span><span id="local-6989586621680834906"><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834906"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621680834905"><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834905"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621680834904"><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834904"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(key i j k l, val i j k) -&gt; Maybe (key i j k l, val i j k)
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834906"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834905"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680834902"><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834902"><span class="hs-identifier hs-var">key'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680834901"><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834901"><span class="hs-identifier hs-var">val'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834902"><span class="hs-identifier hs-var">key'</span></a></span><span> </span><span class="annot"><span class="annottext">key i j k l -&gt; key i j k l -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834907"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">val i j k -&gt; Maybe (val i j k)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834901"><span class="hs-identifier hs-var">val'</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><span class="annottext">Maybe (key i j k l, val i j k)
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key i j k l -&gt; IMap key val -&gt; Maybe (val i j k)
forall i j k l (i :: i) (j :: j) (k :: k) (l :: l)
       (key :: i -&gt; j -&gt; k -&gt; l -&gt; *) (val :: i -&gt; j -&gt; k -&gt; *).
(Typeable i, Typeable j, Typeable k, Typeable l, Typeable key,
 Typeable val, Eq (key i j k l)) =&gt;
key i j k l -&gt; IMap key val -&gt; Maybe (val i j k)
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imLookup"><span class="hs-identifier hs-var">imLookup</span></a></span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834907"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834904"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621680834954"><span id="local-6989586621680834955"><span id="local-6989586621680834956"><span id="local-6989586621680834957"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imMap"><span class="hs-identifier hs-type">imMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680834981"><span class="annot"><a href="#local-6989586621680834981"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621680834980"><span class="annot"><a href="#local-6989586621680834980"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621680834979"><span class="annot"><a href="#local-6989586621680834979"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621680834978"><span class="annot"><a href="#local-6989586621680834978"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680834957"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834981"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834980"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834979"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834978"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834956"><span class="hs-identifier hs-type">key'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834981"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834980"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834979"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834978"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680834975"><span class="annot"><a href="#local-6989586621680834975"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621680834974"><span class="annot"><a href="#local-6989586621680834974"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621680834973"><span class="annot"><a href="#local-6989586621680834973"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621680834955"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834975"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834974"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834973"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834954"><span class="hs-identifier hs-type">val'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834975"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834974"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834973"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834957"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834955"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834956"><span class="hs-identifier hs-type">key'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834954"><span class="hs-identifier hs-type">val'</span></a></span></span></span></span></span><span>
</span><span id="line-73"></span><span id="imMap"><span class="annot"><span class="annottext">imMap :: (forall (i :: i) (j :: j) (k :: k) (l :: l).
 key i j k l -&gt; key' i j k l)
-&gt; (forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k)
-&gt; IMap key val
-&gt; IMap key' val'
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imMap"><span class="hs-identifier hs-var hs-var">imMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k) (l :: l).
key i j k l -&gt; key' i j k l
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMNil"><span class="hs-identifier hs-var">IMNil</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IMap key' val'
forall i j k l (key :: i -&gt; j -&gt; k -&gt; l -&gt; *)
       (val :: i -&gt; j -&gt; k -&gt; *).
IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMNil"><span class="hs-identifier hs-var">IMNil</span></a></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imMap"><span class="hs-identifier hs-var">imMap</span></a></span><span> </span><span id="local-6989586621680834899"><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k) (l :: l).
key i j k l -&gt; key' i j k l
</span><a href="#local-6989586621680834899"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680834898"><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k
</span><a href="#local-6989586621680834898"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-type">IMCons</span></a></span><span> </span><span id="local-6989586621680834897"><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834897"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680834896"><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834896"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680834895"><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834895"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key' i j k l -&gt; val' i j k -&gt; IMap key' val' -&gt; IMap key' val'
forall i j k l (i :: i) (j :: j) (k :: k) (l :: l)
       (key :: i -&gt; j -&gt; k -&gt; l -&gt; *) (val :: i -&gt; j -&gt; k -&gt; *).
(Typeable i, Typeable j, Typeable k, Typeable l) =&gt;
key i j k l -&gt; val i j k -&gt; IMap key val -&gt; IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMCons"><span class="hs-identifier hs-var">IMCons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key i j k l -&gt; key' i j k l
forall (i :: i) (j :: j) (k :: k) (l :: l).
key i j k l -&gt; key' i j k l
</span><a href="#local-6989586621680834899"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">key i j k l
</span><a href="#local-6989586621680834897"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">val i j k -&gt; val' i j k
forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k
</span><a href="#local-6989586621680834898"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">val i j k
</span><a href="#local-6989586621680834896"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall (i :: i) (j :: j) (k :: k) (l :: l).
 key i j k l -&gt; key' i j k l)
-&gt; (forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k)
-&gt; IMap key val
-&gt; IMap key' val'
forall i j k l (key :: i -&gt; j -&gt; k -&gt; l -&gt; *)
       (key' :: i -&gt; j -&gt; k -&gt; l -&gt; *) (val :: i -&gt; j -&gt; k -&gt; *)
       (val' :: i -&gt; j -&gt; k -&gt; *).
(forall (i :: i) (j :: j) (k :: k) (l :: l).
 key i j k l -&gt; key' i j k l)
-&gt; (forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k)
-&gt; IMap key val
-&gt; IMap key' val'
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imMap"><span class="hs-identifier hs-var">imMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k) (l :: l).
key i j k l -&gt; key' i j k l
</span><a href="#local-6989586621680834899"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (i :: i) (j :: j) (k :: k). val i j k -&gt; val' i j k
</span><a href="#local-6989586621680834898"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IMap key val
</span><a href="#local-6989586621680834895"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- $walletHandles</span><span>
</span><span id="line-77"></span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- In order to call contract endpoints using `Plutus.Trace.Emulator.callEndpoint`, a `ContractHandle`</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- is required. Contract handles are managed behind the scenes by the `propRunActions` functions,</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- based on a given a list of associations of `ContractInstanceKey`s with `Wallet`s and</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- `Contract`s. Before testing starts, `activateContractWallet` is called for all entries in the</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- list and the mapping from `ContractInstanceKey` to `ContractHandle` is provided in the `HandleFun` argument</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- to `perform`.</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | The constraints required on contract schemas and error types to enable calling contract</span><span>
</span><span id="line-86"></span><span class="hs-comment">--   endpoints (`Plutus.Trace.Emulator.callEndpoint`).</span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span id="SchemaConstraints"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-var">SchemaConstraints</span></a></span></span><span> </span><span id="local-6989586621680834893"><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680834892"><span class="annot"><a href="#local-6989586621680834892"><span class="hs-identifier hs-type">schema</span></a></span></span><span> </span><span id="local-6989586621680834891"><span class="annot"><a href="#local-6989586621680834891"><span class="hs-identifier hs-type">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834892"><span class="hs-identifier hs-type">schema</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractConstraints"><span class="hs-identifier hs-type">ContractConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834892"><span class="hs-identifier hs-type">schema</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834891"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834891"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834891"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834891"><span class="hs-identifier hs-type">err</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834893"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="WalletContractHandle"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#WalletContractHandle"><span class="hs-identifier hs-var">WalletContractHandle</span></a></span></span><span> </span><span id="local-6989586621680834886"><span class="annot"><a href="#local-6989586621680834886"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680834885"><span class="annot"><a href="#local-6989586621680834885"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680834884"><span class="annot"><a href="#local-6989586621680834884"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WalletContractHandle"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#WalletContractHandle"><span class="hs-identifier hs-var">WalletContractHandle</span></a></span></span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractHandle"><span class="hs-identifier hs-type">ContractHandle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834886"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834885"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834884"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">type</span><span> </span><span id="Handles"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#Handles"><span class="hs-identifier hs-var">Handles</span></a></span></span><span> </span><span id="local-6989586621680834882"><span class="annot"><a href="#local-6989586621680834882"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#IMap"><span class="hs-identifier hs-type">IMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834882"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#WalletContractHandle"><span class="hs-identifier hs-type">WalletContractHandle</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621680834881"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#handlesAppend"><span class="hs-identifier hs-type">handlesAppend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#Handles"><span class="hs-identifier hs-type">Handles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834881"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#Handles"><span class="hs-identifier hs-type">Handles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834881"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#Handles"><span class="hs-identifier hs-type">Handles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834881"><span class="hs-identifier hs-type">state</span></a></span></span><span>
</span><span id="line-106"></span><span id="handlesAppend"><span class="annot"><span class="annottext">handlesAppend :: Handles state -&gt; Handles state -&gt; Handles state
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#handlesAppend"><span class="hs-identifier hs-var hs-var">handlesAppend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handles state -&gt; Handles state -&gt; Handles state
forall i j k l (key :: i -&gt; j -&gt; k -&gt; l -&gt; *)
       (val :: i -&gt; j -&gt; k -&gt; *).
IMap key val -&gt; IMap key val -&gt; IMap key val
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#imAppend"><span class="hs-identifier hs-var">imAppend</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="StartContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-var">StartContract</span></a></span></span><span> </span><span id="local-6989586621680834879"><span class="annot"><a href="#local-6989586621680834879"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621680834874"><span id="local-6989586621680834875"><span id="local-6989586621680834876"><span id="local-6989586621680834877"><span id="local-6989586621680834878"><span id="StartContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-var">StartContract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-type">SchemaConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834878"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834876"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834875"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834874"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834878"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834876"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834875"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834875"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834874"><span class="hs-identifier hs-type">state</span></a></span></span></span></span></span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/zib0vh71vw6nxy47a0l8mmbplm2mqnx6-contractmodel-lib-contractmodel-0.1.0.0-haddock-doc/share/doc/contractmodel/html/src"><span class="hs-identifier hs-type">ContractModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680834871"><span class="annot"><a href="#local-6989586621680834871"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680834870"><span class="annot"><a href="#local-6989586621680834870"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680834869"><span class="annot"><a href="#local-6989586621680834869"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680834868"><span class="annot"><a href="#local-6989586621680834868"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834871"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834870"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834869"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834868"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680834867"><span class="annot"><a href="#local-6989586621680834867"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680834866"><span class="annot"><a href="#local-6989586621680834866"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680834865"><span class="annot"><a href="#local-6989586621680834865"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680834864"><span class="annot"><a href="#local-6989586621680834864"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834867"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834866"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834865"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834864"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ContractInstanceModel"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceModel"><span class="hs-identifier hs-var">ContractInstanceModel</span></a></span></span><span> </span><span id="local-6989586621680834951"><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- | To be able to call a contract endpoint from a wallet a `ContractHandle` is required. These</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">--   are managed by the test framework and all the user needs to do is provide this contract</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">--   instance key type representing the different contract instances that a test needs to work</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">--   with, and when creating a property (see `propRunActions_`) provide a list of contract</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">--   instance keys together with their wallets and contracts.</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">--   Contract instance keys are indexed by the observable state, schema, and error type of the</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">--   contract and should be defined as a GADT. For example, a handle type for a contract with</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">--   one seller and multiple buyers could look like this.</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">--   &gt;  data ContractInstanceKey MyModel w s e where</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">--   &gt;      Buyer  :: Wallet -&gt; ContractInstanceKey MyModel MyObsState MySchema MyError MyParams</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">--   &gt;      Seller :: ContractInstanceKey MyModel MyObsState MySchema MyError MyParams</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">data</span><span> </span><span id="ContractInstanceKey"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-var">ContractInstanceKey</span></a></span></span><span> </span><span id="local-6989586621680834951"><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/g8vgm61qs4g5v6yyv8hvi8bm9dvsf9sa-row-types-lib-row-types-1.0.1.2-haddock-doc/share/doc/row-types/html/src"><span class="hs-identifier hs-type">Row</span></a></span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- | Get the wallet that the contract running at a specific `ContractInstanceKey` should run</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">-- in</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621680834935"><span id="local-6989586621680834936"><span id="local-6989586621680834937"><span id="local-6989586621680834938"><span id="instanceWallet"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceWallet"><span class="hs-identifier hs-type">instanceWallet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834938"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834937"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834936"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834935"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Wallet.Emulator.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span></span></span></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- | The 'ContractInstanceTag' of an instance key for a wallet. Defaults to 'walletInstanceTag'.</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">--   You must override this if you have multiple instances per wallet.</span><span>
</span><span id="line-136"></span><span>    </span><span id="instanceTag"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceTag"><span class="hs-identifier hs-type">instanceTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680834861"><span class="annot"><a href="#local-6989586621680834861"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621680834860"><span class="annot"><a href="#local-6989586621680834860"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680834859"><span class="annot"><a href="#local-6989586621680834859"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680834858"><span class="annot"><a href="#local-6989586621680834858"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#SchemaConstraints"><span class="hs-identifier hs-type">SchemaConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834861"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834860"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834859"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834861"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834860"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834859"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834858"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Trace.Emulator.Types.html#ContractInstanceTag"><span class="hs-identifier hs-type">ContractInstanceTag</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621680834857"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceTag"><span class="hs-identifier hs-var hs-var">instanceTag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; ContractInstanceTag
</span><a href="Plutus.Trace.Emulator.Types.html#walletInstanceTag"><span class="hs-identifier hs-var">walletInstanceTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; ContractInstanceTag)
-&gt; (ContractInstanceKey state w s e p -&gt; Wallet)
-&gt; ContractInstanceKey state w s e p
-&gt; ContractInstanceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceKey state w s e p -&gt; Wallet
forall state w (s :: Row *) e p.
ContractInstanceModel state =&gt;
ContractInstanceKey state w s e p -&gt; Wallet
</span><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceWallet"><span class="hs-identifier hs-var">instanceWallet</span></a></span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- | The initial handles</span><span>
</span><span id="line-140"></span><span>    </span><span id="initialInstances"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#initialInstances"><span class="hs-identifier hs-type">initialInstances</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621680834854"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#initialInstances"><span class="hs-identifier hs-var hs-var">initialInstances</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- | Start new contract instances</span><span>
</span><span id="line-144"></span><span>    </span><span id="startInstances"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#startInstances"><span class="hs-identifier hs-type">startInstances</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/zib0vh71vw6nxy47a0l8mmbplm2mqnx6-contractmodel-lib-contractmodel-0.1.0.0-haddock-doc/share/doc/contractmodel/html/src"><span class="hs-identifier hs-type">ModelState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-145"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/zib0vh71vw6nxy47a0l8mmbplm2mqnx6-contractmodel-lib-contractmodel-0.1.0.0-haddock-doc/share/doc/contractmodel/html/src"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span>
</span><span id="line-146"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#StartContract"><span class="hs-identifier hs-type">StartContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621680834852"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#startInstances"><span class="hs-identifier hs-var hs-var">startInstances</span></a></span><span> </span><span class="annot"><span class="annottext">ModelState state
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Action state
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-comment">-- | Map a `ContractInstanceKey` `k` to the `Contract` that is started when we start</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- `k` in a given `ModelState` with a given semantics of `SymToken`s</span></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621680834848"><span id="local-6989586621680834849"><span id="local-6989586621680834850"><span id="local-6989586621680834851"><span id="instanceContract"><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#instanceContract"><span class="hs-identifier hs-type">instanceContract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/zib0vh71vw6nxy47a0l8mmbplm2mqnx6-contractmodel-lib-contractmodel-0.1.0.0-haddock-doc/share/doc/contractmodel/html/src"><span class="hs-identifier hs-type">SymToken</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">AssetId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Test.ContractModel.Internal.ContractInstance.html#ContractInstanceKey"><span class="hs-identifier hs-type">ContractInstanceKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834951"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834851"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834850"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834849"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834848"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-153"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680834848"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-154"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.Contract.Types.html#Contract"><span class="hs-identifier hs-type">Contract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834851"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834850"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680834849"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-155"></span></pre></body></html>
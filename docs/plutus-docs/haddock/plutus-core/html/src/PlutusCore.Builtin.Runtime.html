<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds                #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs                    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase               #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies             #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators            #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StrictData               #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusCore.Builtin.Runtime</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html"><span class="hs-identifier">PlutusCore.Builtin.KnownType</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExBudget.html"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudget</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExMemory</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.Exception.html"><span class="hs-identifier">PlutusCore.Evaluation.Machine.Exception</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(^?)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/array-0.5.4.0/src"><span class="hs-identifier">Data.Array</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier">NoThunks.Class</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NoThunks</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | Peano numbers. Normally called @Nat@, but that is already reserved by @base@.</span><span>
</span><span id="line-27"></span><span class="hs-keyword">data</span><span> </span><span id="Peano"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Peano"><span class="hs-identifier hs-var">Peano</span></a></span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Z"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Z"><span class="hs-identifier hs-var">Z</span></a></span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="S"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Peano"><span class="hs-identifier hs-type">Peano</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Same as 'TypeScheme' except this one doesn't contain any evaluation-irrelevant types stuff.</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- @n@ represents the number of term-level arguments that a builtin takes.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">data</span><span> </span><span id="RuntimeScheme"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-var">RuntimeScheme</span></a></span></span><span> </span><span id="local-6989586621680956480"><span class="annot"><a href="#local-6989586621680956480"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>    </span><span id="RuntimeSchemeResult"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeResult"><span class="hs-identifier hs-var">RuntimeSchemeResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span id="local-6989586621680956478"><span id="RuntimeSchemeArrow"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeArrow"><span class="hs-identifier hs-var">RuntimeSchemeArrow</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956478"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956478"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-36"></span><span>    </span><span id="local-6989586621680956476"><span id="RuntimeSchemeAll"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeAll"><span class="hs-identifier hs-var">RuntimeSchemeAll</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956476"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956476"><span class="hs-identifier hs-type">n</span></a></span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span id="local-6989586621680956471"><span id="local-6989586621680956473"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680956469"><span class="annot"><a href="#local-6989586621680956469"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956469"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-39"></span><span id="local-6989586621680956463"><span id="local-6989586621680956465"><span id="local-6989586621680956467"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680956461"><span class="annot"><a href="#local-6989586621680956461"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956461"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- we use strictdata, so this is just for the purpose of completeness</span><span>
</span><span id="line-42"></span><span id="local-6989586621680956460"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956460"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621680956457"><span class="annot"><span class="annottext">rnf :: RuntimeScheme n -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621680956455"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956455"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956455"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeResult"><span class="hs-identifier hs-var">RuntimeSchemeResult</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n -&gt; ()
forall a. a -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rwhnf</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956455"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeArrow"><span class="hs-identifier hs-type">RuntimeSchemeArrow</span></a></span><span> </span><span id="local-6989586621680956453"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956453"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956453"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeAll"><span class="hs-identifier hs-type">RuntimeSchemeAll</span></a></span><span> </span><span id="local-6989586621680956452"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956452"><span class="hs-identifier hs-var">arg</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956452"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span id="local-6989586621680956451"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680956449"><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956451"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621680956445"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></a></span></span><span> </span><span id="local-6989586621680956443"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956443"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeResult"><span class="hs-identifier hs-var">RuntimeSchemeResult</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ThunkInfo -&gt; IO (Maybe ThunkInfo)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ThunkInfo
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeArrow"><span class="hs-identifier hs-type">RuntimeSchemeArrow</span></a></span><span> </span><span id="local-6989586621680956442"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956442"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956443"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956442"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeAll"><span class="hs-identifier hs-type">RuntimeSchemeAll</span></a></span><span> </span><span id="local-6989586621680956440"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956440"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956443"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956440"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621680956439"><span class="annot"><span class="annottext">showTypeOf :: Proxy (RuntimeScheme n) -&gt; String
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Proxy (RuntimeScheme n) -&gt; String
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PlutusCore.Builtin.Runtime.RuntimeScheme&quot;</span></span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Compute the runtime denotation type of a builtin given the type of values and the number of</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- arguments that the builtin takes. A \&quot;runtime denotation type\&quot; is different from a regular</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- denotation type in that a regular one can have any 'ReadKnownIn' type as an argument and can</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- return any 'MakeKnownIn' type, while in a runtime one only @val@ can appear as the type of an</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- argument, as well as in the result type. This is what we get by calling 'readKnown' over each</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- argument of the denotation and calling 'makeKnown' over its result.</span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Peano"><span class="hs-identifier hs-type">Peano</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ToRuntimeDenotationType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-var">ToRuntimeDenotationType</span></a></span></span><span> </span><span id="local-6989586621680956436"><span class="annot"><a href="#local-6989586621680956436"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span id="local-6989586621680956435"><span class="annot"><a href="#local-6989586621680956435"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="ToRuntimeDenotationType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-var">ToRuntimeDenotationType</span></a></span></span><span> </span><span id="local-6989586621680956434"><span class="annot"><a href="#local-6989586621680956434"><span class="hs-identifier hs-type hs-type">val</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#MakeKnownM"><span class="hs-identifier hs-type">MakeKnownM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680956434"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- 'ReadKnownM' is required here only for immediate unlifting, because deferred unlifting</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- doesn't need the ability to fail in the middle of a builtin application, but having a uniform</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- interface for both the ways of doing unlifting is way too convenient, hence we decided to pay</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- the price (about 1-2% of total evaluation time) for now.</span><span>
</span><span id="line-68"></span><span>    </span><span id="ToRuntimeDenotationType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-var">ToRuntimeDenotationType</span></a></span></span><span> </span><span id="local-6989586621680956432"><span class="annot"><a href="#local-6989586621680956432"><span class="hs-identifier hs-type hs-type">val</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680956431"><span class="annot"><a href="#local-6989586621680956431"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680956432"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.KnownType.html#ReadKnownM"><span class="hs-identifier hs-type">ReadKnownM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956432"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956431"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Compute the costing type for a builtin given the number of arguments that the builtin takes.</span><span>
</span><span id="line-71"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Peano"><span class="hs-identifier hs-type">Peano</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">GHC.Type</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="ToCostingType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-var">ToCostingType</span></a></span></span><span> </span><span id="local-6989586621680956429"><span class="annot"><a href="#local-6989586621680956429"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="ToCostingType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-var">ToCostingType</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExBudget.html#ExBudget"><span class="hs-identifier hs-type">ExBudget</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span id="ToCostingType"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-var">ToCostingType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621680956428"><span class="annot"><a href="#local-6989586621680956428"><span class="hs-identifier hs-type hs-type">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html#ExMemory"><span class="hs-identifier hs-type">ExMemory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956428"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- We tried instantiating 'BuiltinMeaning' on the fly and that was slower than precaching</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- 'BuiltinRuntime's.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | A 'BuiltinRuntime' represents a possibly partial builtin application.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- We get an initial 'BuiltinRuntime' representing an empty builtin application (i.e. just the</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- builtin with no arguments) by instantiating (via 'fromBuiltinRuntimeOptions') a</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- 'BuiltinRuntimeOptions'.</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- A 'BuiltinRuntime' contains info that is used during evaluation:</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- 1. the 'RuntimeScheme' of the uninstantiated part of the builtin. I.e. initially it's the runtime</span><span>
</span><span id="line-86"></span><span class="hs-comment">--      scheme of the whole builtin, but applying or type-instantiating the builtin peels off</span><span>
</span><span id="line-87"></span><span class="hs-comment">--      the corresponding constructor from the runtime scheme</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- 2. the (possibly partially instantiated) runtime denotation</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- 3. the (possibly partially instantiated) costing function</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- All the three are in sync in terms of partial instantiatedness due to 'RuntimeScheme' being a</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- GADT and 'ToRuntimeDenotationType' and 'ToCostingType' operating on the index of that GADT.</span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="BuiltinRuntime"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-var">BuiltinRuntime</span></a></span></span><span> </span><span id="local-6989586621680956533"><span class="annot"><a href="#local-6989586621680956533"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680956534"><span class="annot"><a href="#local-6989586621680956534"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span> </span><span id="BuiltinRuntime"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-var">BuiltinRuntime</span></a></span></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956533"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Must be lazy, because we don't want to compute the</span><span>
</span><span id="line-97"></span><span>                                          </span><span class="hs-comment">-- denotation when it's fully saturated before figuring</span><span>
</span><span id="line-98"></span><span>                                          </span><span class="hs-comment">-- out what it's going to cost.</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621680956426"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680956424"><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956426"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- Skipping `_denot` in `allNoThunks` check, since it is supposed to be lazy and</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- is allowed to contain thunks.</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621680956421"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; BuiltinRuntime val -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621680956421"><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></a></span></span><span> </span><span id="local-6989586621680956420"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956420"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span id="local-6989586621680956419"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956419"><span class="hs-identifier hs-var">sch</span></a></span></span><span> </span><span id="local-6989586621680956418"><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956418"><span class="hs-identifier hs-var">_denot</span></a></span></span><span> </span><span id="local-6989586621680956417"><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956417"><span class="hs-identifier hs-var">costing</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><span class="annottext">[IO (Maybe ThunkInfo)] -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">allNoThunks</span></a></span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- The order here is important: we must first check that `sch` doesn't have</span><span>
</span><span id="line-107"></span><span>              </span><span class="hs-comment">-- thunks, before inspecting it in `noThunksInCosting`.</span><span>
</span><span id="line-108"></span><span>              </span><span class="annot"><span class="annottext">Context -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956420"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956419"><span class="hs-identifier hs-var">sch</span></a></span><span>
</span><span id="line-109"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ToCostingType n -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
forall (n :: Peano).
Context
-&gt; ToCostingType n -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
</span><a href="PlutusCore.Builtin.Runtime.html#noThunksInCosting"><span class="hs-identifier hs-var">noThunksInCosting</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956420"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956417"><span class="hs-identifier hs-var">costing</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956419"><span class="hs-identifier hs-var">sch</span></a></span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621680956414"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BuiltinRuntime val) -&gt; String
</span><a href="#local-6989586621680956414"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Proxy (BuiltinRuntime val) -&gt; String
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PlutusCore.Builtin.Runtime.BuiltinRuntime&quot;</span></span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Check whether the given `ToCostingType n` contains thunks. The `RuntimeScheme n` is used to</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- refine `n`.</span><span>
</span><span id="line-116"></span><span id="local-6989586621680956556"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#noThunksInCosting"><span class="hs-identifier hs-type">noThunksInCosting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-type">NoThunks.Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956556"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956556"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-type">ThunkInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-117"></span><span id="noThunksInCosting"><span class="annot"><span class="annottext">noThunksInCosting :: Context
-&gt; ToCostingType n -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
</span><a href="PlutusCore.Builtin.Runtime.html#noThunksInCosting"><span class="hs-identifier hs-var hs-var">noThunksInCosting</span></a></span></span><span> </span><span id="local-6989586621680956413"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956413"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621680956412"><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956412"><span class="hs-identifier hs-var">costing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">-- @n ~ 'Z@, and @ToCostingType n ~ ExBudget@, which should not be a thunk or contain</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- nested thunks.</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeResult"><span class="hs-identifier hs-var">RuntimeSchemeResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">Context -&gt; ExBudget -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956413"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget
ToCostingType n
</span><a href="#local-6989586621680956412"><span class="hs-identifier hs-var">costing</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeArrow"><span class="hs-identifier hs-type">RuntimeSchemeArrow</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">Context -&gt; (ExMemory -&gt; ToCostingType n) -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956413"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ToCostingType n
ExMemory -&gt; ToCostingType n
</span><a href="#local-6989586621680956412"><span class="hs-identifier hs-var">costing</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeSchemeAll"><span class="hs-identifier hs-type">RuntimeSchemeAll</span></a></span><span> </span><span id="local-6989586621680956411"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956411"><span class="hs-identifier hs-var">sch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">Context
-&gt; ToCostingType n -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
forall (n :: Peano).
Context
-&gt; ToCostingType n -&gt; RuntimeScheme n -&gt; IO (Maybe ThunkInfo)
</span><a href="PlutusCore.Builtin.Runtime.html#noThunksInCosting"><span class="hs-identifier hs-var">noThunksInCosting</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956413"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956412"><span class="hs-identifier hs-var">costing</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956411"><span class="hs-identifier hs-var">sch</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Determines how to unlift arguments. The difference is that with 'UnliftingImmediate' unlifting</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- is performed immediately after a builtin gets the argument and so can fail immediately too, while</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- with deferred unlifting all arguments are unlifted upon full saturation, hence no failure can</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- occur until that. The former makes it much harder to specify the behaviour of builtins and</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- so 'UnliftingDeferred' is the preferred mode.</span><span>
</span><span id="line-132"></span><span class="hs-keyword">data</span><span> </span><span id="UnliftingMode"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingMode"><span class="hs-identifier hs-var">UnliftingMode</span></a></span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="UnliftingImmediate"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingImmediate"><span class="hs-identifier hs-var">UnliftingImmediate</span></a></span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UnliftingDeferred"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingDeferred"><span class="hs-identifier hs-var">UnliftingDeferred</span></a></span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | A 'BuiltinRuntimeOptions' is a precursor to 'BuiltinRuntime'. One gets the latter from the</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- former by choosing the runtime denotation of the builtin (either '_broImmediateF' for immediate</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- unlifting or '_broDeferredF' for deferred unlifting, see 'UnliftingMode' for details) and by</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- instantiating '_broToExF' with a cost model to get the costing function for the builtin.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">data</span><span> </span><span id="BuiltinRuntimeOptions"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-var">BuiltinRuntimeOptions</span></a></span></span><span> </span><span id="local-6989586621680956408"><span class="annot"><a href="#local-6989586621680956408"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621680956407"><span class="annot"><a href="#local-6989586621680956407"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span id="local-6989586621680956406"><span class="annot"><a href="#local-6989586621680956406"><span class="hs-identifier hs-type">cost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BuiltinRuntimeOptions"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-var">BuiltinRuntimeOptions</span></a></span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_broRuntimeScheme"><span class="annot"><span class="annottext">BuiltinRuntimeOptions n val cost -&gt; RuntimeScheme n
</span><a href="PlutusCore.Builtin.Runtime.html#_broRuntimeScheme"><span class="hs-identifier hs-var hs-var">_broRuntimeScheme</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#RuntimeScheme"><span class="hs-identifier hs-type">RuntimeScheme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956408"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_broImmediateF"><span class="annot"><span class="annottext">BuiltinRuntimeOptions n val cost -&gt; ToRuntimeDenotationType val n
</span><a href="PlutusCore.Builtin.Runtime.html#_broImmediateF"><span class="hs-identifier hs-var hs-var">_broImmediateF</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956407"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956408"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_broDeferredF"><span class="annot"><span class="annottext">BuiltinRuntimeOptions n val cost -&gt; ToRuntimeDenotationType val n
</span><a href="PlutusCore.Builtin.Runtime.html#_broDeferredF"><span class="hs-identifier hs-var hs-var">_broDeferredF</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToRuntimeDenotationType"><span class="hs-identifier hs-type">ToRuntimeDenotationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956407"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956408"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_broToExF"><span class="annot"><span class="annottext">BuiltinRuntimeOptions n val cost -&gt; cost -&gt; ToCostingType n
</span><a href="PlutusCore.Builtin.Runtime.html#_broToExF"><span class="hs-identifier hs-var hs-var">_broToExF</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680956406"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#ToCostingType"><span class="hs-identifier hs-type">ToCostingType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956408"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Convert a 'BuiltinRuntimeOptions' to a 'BuiltinRuntime' given an 'UnliftingMode' and a cost</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- model.</span><span>
</span><span id="line-149"></span><span id="local-6989586621680956398"><span id="local-6989586621680956399"><span id="local-6989586621680956400"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#fromBuiltinRuntimeOptions"><span class="hs-identifier hs-type">fromBuiltinRuntimeOptions</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#UnliftingMode"><span class="hs-identifier hs-type">UnliftingMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680956400"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-type">BuiltinRuntimeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956399"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956398"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956400"><span class="hs-identifier hs-type">cost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956398"><span class="hs-identifier hs-type">val</span></a></span></span></span></span><span>
</span><span id="line-151"></span><span id="fromBuiltinRuntimeOptions"><span class="annot"><span class="annottext">fromBuiltinRuntimeOptions :: UnliftingMode
-&gt; cost -&gt; BuiltinRuntimeOptions n val cost -&gt; BuiltinRuntime val
</span><a href="PlutusCore.Builtin.Runtime.html#fromBuiltinRuntimeOptions"><span class="hs-identifier hs-var hs-var">fromBuiltinRuntimeOptions</span></a></span></span><span> </span><span id="local-6989586621680956396"><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621680956396"><span class="hs-identifier hs-var">unlMode</span></a></span></span><span> </span><span id="local-6989586621680956395"><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621680956395"><span class="hs-identifier hs-var">cost</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntimeOptions"><span class="hs-identifier hs-type">BuiltinRuntimeOptions</span></a></span><span> </span><span id="local-6989586621680956394"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956394"><span class="hs-identifier hs-var">sch</span></a></span></span><span> </span><span id="local-6989586621680956393"><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956393"><span class="hs-identifier hs-var">immF</span></a></span></span><span> </span><span id="local-6989586621680956392"><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956392"><span class="hs-identifier hs-var">defF</span></a></span></span><span> </span><span id="local-6989586621680956391"><span class="annot"><span class="annottext">cost -&gt; ToCostingType n
</span><a href="#local-6989586621680956391"><span class="hs-identifier hs-var">toExF</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">RuntimeScheme n
-&gt; ToRuntimeDenotationType val n
-&gt; ToCostingType n
-&gt; BuiltinRuntime val
forall val (n :: Peano).
RuntimeScheme n
-&gt; ToRuntimeDenotationType val n
-&gt; ToCostingType n
-&gt; BuiltinRuntime val
</span><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-var">BuiltinRuntime</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956394"><span class="hs-identifier hs-var">sch</span></a></span><span> </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956390"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ToCostingType n -&gt; BuiltinRuntime val)
-&gt; ToCostingType n -&gt; BuiltinRuntime val
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">cost -&gt; ToCostingType n
</span><a href="#local-6989586621680956391"><span class="hs-identifier hs-var">toExF</span></a></span><span> </span><span class="annot"><span class="annottext">cost
</span><a href="#local-6989586621680956395"><span class="hs-identifier hs-var">cost</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621680956390"><span class="annot"><span class="annottext">f :: ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956390"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621680956396"><span class="hs-identifier hs-var">unlMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>                </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="PlutusCore.Builtin.Runtime.html#UnliftingImmediate"><span class="hs-identifier hs-var">UnliftingImmediate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956393"><span class="hs-identifier hs-var">immF</span></a></span><span>
</span><span id="line-155"></span><span>                </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="PlutusCore.Builtin.Runtime.html#UnliftingDeferred"><span class="hs-identifier hs-var">UnliftingDeferred</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956392"><span class="hs-identifier hs-var">defF</span></a></span><span>
</span><span id="line-156"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#fromBuiltinRuntimeOptions"><span class="hs-pragma hs-type">fromBuiltinRuntimeOptions</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621680956389"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956389"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621680956387"><span class="annot"><span class="annottext">rnf :: BuiltinRuntime val -&gt; ()
</span><a href="#local-6989586621680956387"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span id="local-6989586621680956386"><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956386"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621680956385"><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956385"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680956384"><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956384"><span class="hs-identifier hs-var">exF</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">RuntimeScheme n
</span><a href="#local-6989586621680956386"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val n
</span><a href="#local-6989586621680956385"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ToRuntimeDenotationType val n -&gt; () -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">ToCostingType n -&gt; ()
forall a. a -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rwhnf</span></a></span><span> </span><span class="annot"><span class="annottext">ToCostingType n
</span><a href="#local-6989586621680956384"><span class="hs-identifier hs-var">exF</span></a></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | A 'BuiltinRuntime' for each builtin from a set of builtins.</span><span>
</span><span id="line-162"></span><span class="hs-keyword">newtype</span><span> </span><span id="BuiltinsRuntime"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-var">BuiltinsRuntime</span></a></span></span><span> </span><span id="local-6989586621680956383"><span class="annot"><a href="#local-6989586621680956383"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621680956382"><span class="annot"><a href="#local-6989586621680956382"><span class="hs-identifier hs-type">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BuiltinsRuntime"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-var">BuiltinsRuntime</span></a></span></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="unBuiltinRuntime"><span class="annot"><span class="annottext">BuiltinsRuntime fun val -&gt; Array fun (BuiltinRuntime val)
</span><a href="PlutusCore.Builtin.Runtime.html#unBuiltinRuntime"><span class="hs-identifier hs-var hs-var">unBuiltinRuntime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956383"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956382"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621680956378"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680956376"><span id="local-6989586621680956377"><span class="annot"><a href="#local-6989586621680956376"><span class="hs-keyword hs-type hs-type">newtype</span></a></span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956377"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956377"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956376"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span id="local-6989586621680956374"><span id="local-6989586621680956375"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680956372"><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956375"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956374"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621680956369"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; BuiltinsRuntime fun val -&gt; IO (Maybe ThunkInfo)
</span><a href="#local-6989586621680956369"><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></a></span></span><span> </span><span id="local-6989586621680956368"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956368"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span id="local-6989586621680956367"><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val)
</span><a href="#local-6989586621680956367"><span class="hs-identifier hs-var">arr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IO (Maybe ThunkInfo)] -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">allNoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; BuiltinRuntime val -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var">noThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621680956368"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinRuntime val -&gt; IO (Maybe ThunkInfo))
-&gt; [BuiltinRuntime val] -&gt; [IO (Maybe ThunkInfo)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val) -&gt; [BuiltinRuntime val]
forall i e. Array i e -&gt; [e]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">elems</span></a></span><span> </span><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val)
</span><a href="#local-6989586621680956367"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621680956364"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BuiltinsRuntime fun val) -&gt; String
</span><a href="#local-6989586621680956364"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Proxy (BuiltinsRuntime fun val) -&gt; String
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PlutusCore.Builtin.Runtime.BuiltinsRuntime&quot;</span></span></span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Look up the runtime info of a built-in function during evaluation.</span><span>
</span><span id="line-173"></span><span id="local-6989586621680956359"><span id="local-6989586621680956360"><span id="local-6989586621680956361"><span id="local-6989586621680956362"><span id="local-6989586621680956363"><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#lookupBuiltin"><span class="hs-identifier hs-type">lookupBuiltin</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Evaluation.Machine.Exception.html#ErrorWithCause"><span class="hs-identifier hs-type">ErrorWithCause</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956363"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956362"><span class="hs-identifier hs-type">cause</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680956361"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.Exception.html#AsMachineError"><span class="hs-identifier hs-type">AsMachineError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956363"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956360"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956360"><span class="hs-identifier hs-type">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680956360"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956360"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956359"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680956361"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinRuntime"><span class="hs-identifier hs-type">BuiltinRuntime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680956359"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- @Data.Array@ doesn't seem to have a safe version of @(!)@, hence we use a prism.</span><span>
</span><span id="line-177"></span><span id="lookupBuiltin"><span class="annot"><span class="annottext">lookupBuiltin :: fun -&gt; BuiltinsRuntime fun val -&gt; m (BuiltinRuntime val)
</span><a href="PlutusCore.Builtin.Runtime.html#lookupBuiltin"><span class="hs-identifier hs-var hs-var">lookupBuiltin</span></a></span></span><span> </span><span id="local-6989586621680956357"><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621680956357"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Builtin.Runtime.html#BuiltinsRuntime"><span class="hs-identifier hs-type">BuiltinsRuntime</span></a></span><span> </span><span id="local-6989586621680956356"><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val)
</span><a href="#local-6989586621680956356"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val)
</span><a href="#local-6989586621680956356"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Array fun (BuiltinRuntime val)
-&gt; Getting
     (First (BuiltinRuntime val))
     (Array fun (BuiltinRuntime val))
     (BuiltinRuntime val)
-&gt; Maybe (BuiltinRuntime val)
forall s a. s -&gt; Getting (First a) s a -&gt; Maybe a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Array fun (BuiltinRuntime val))
-&gt; Traversal'
     (Array fun (BuiltinRuntime val))
     (IxValue (Array fun (BuiltinRuntime val)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">fun
Index (Array fun (BuiltinRuntime val))
</span><a href="#local-6989586621680956357"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">Maybe (BuiltinRuntime val)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AReview err (MachineError fun)
-&gt; MachineError fun -&gt; Maybe cause -&gt; m (BuiltinRuntime val)
forall exc e t term (m :: * -&gt; *) x.
(exc ~ ErrorWithCause e term, MonadError exc m) =&gt;
AReview e t -&gt; t -&gt; Maybe term -&gt; m x
</span><a href="PlutusCore.Evaluation.Machine.Exception.html#throwingWithCause"><span class="hs-identifier hs-var">throwingWithCause</span></a></span><span> </span><span class="annot"><span class="annottext">AReview err (MachineError fun)
forall r fun. AsMachineError r fun =&gt; Prism' r (MachineError fun)
</span><a href="PlutusCore.Evaluation.Machine.Exception.html#_MachineError"><span class="hs-identifier hs-var">_MachineError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">fun -&gt; MachineError fun
forall fun. fun -&gt; MachineError fun
</span><a href="PlutusCore.Evaluation.Machine.Exception.html#UnknownBuiltin"><span class="hs-identifier hs-var">UnknownBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621680956357"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe cause
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680956352"><span class="annot"><span class="annottext">BuiltinRuntime val
</span><a href="#local-6989586621680956352"><span class="hs-identifier hs-var">bri</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BuiltinRuntime val -&gt; m (BuiltinRuntime val)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinRuntime val
</span><a href="#local-6989586621680956352"><span class="hs-identifier hs-var">bri</span></a></span><span>
</span><span id="line-180"></span></pre></body></html>
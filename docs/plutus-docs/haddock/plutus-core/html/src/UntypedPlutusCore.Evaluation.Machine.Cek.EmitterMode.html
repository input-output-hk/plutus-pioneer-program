<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#noEmitter"><span class="hs-identifier">noEmitter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logEmitter"><span class="hs-identifier">logEmitter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithTimeEmitter"><span class="hs-identifier">logWithTimeEmitter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithBudgetEmitter"><span class="hs-identifier">logWithBudgetEmitter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html"><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek.Internal</span></a></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.ST.Unsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unsafeIOToST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier">Data.Csv</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CSV</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier">Data.Csv.Builder</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CSV</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier">Data.DList</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DList</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Fixed</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.STRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">modifySTRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">newSTRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">readSTRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier">Data.Time.Clock.POSIX</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExBudget.html"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudget</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExMemory</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | No emitter.</span><span>
</span><span id="line-25"></span><span id="local-6989586621680965577"><span id="local-6989586621680965578"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#noEmitter"><span class="hs-identifier hs-type">noEmitter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-type">EmitterMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965578"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965577"><span class="hs-identifier hs-type">fun</span></a></span></span></span><span>
</span><span id="line-26"></span><span id="noEmitter"><span class="annot"><span class="annottext">noEmitter :: EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#noEmitter"><span class="hs-identifier hs-var hs-var">noEmitter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall (uni :: * -&gt; *) fun.
(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-var">EmitterMode</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
 -&gt; EmitterMode uni fun)
-&gt; (forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ST s ExBudget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
forall (uni :: * -&gt; *) fun s.
CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekEmitterInfo"><span class="hs-identifier hs-var">CekEmitterInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">DList Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; CekM uni fun s ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; ST s [Text]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- | Emits log only.</span><span>
</span><span id="line-29"></span><span id="local-6989586621680965573"><span id="local-6989586621680965574"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logEmitter"><span class="hs-identifier hs-type">logEmitter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-type">EmitterMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965574"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965573"><span class="hs-identifier hs-type">fun</span></a></span></span></span><span>
</span><span id="line-30"></span><span id="logEmitter"><span class="annot"><span class="annottext">logEmitter :: EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logEmitter"><span class="hs-identifier hs-var hs-var">logEmitter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall (uni :: * -&gt; *) fun.
(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-var">EmitterMode</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
 -&gt; EmitterMode uni fun)
-&gt; (forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ST s ExBudget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-31"></span><span>    </span><span id="local-6989586621680965572"><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965572"><span class="hs-identifier hs-var">logsRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DList Text -&gt; ST s (STRef s (DList Text))
forall a s. a -&gt; ST s (STRef s a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">newSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
forall a. DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.empty</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965570"><span class="annot"><span class="annottext">emitter :: DList Text -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965570"><span class="hs-identifier hs-var hs-var">emitter</span></a></span></span><span> </span><span id="local-6989586621680965569"><span class="annot"><span class="annottext">DList Text
</span><a href="#local-6989586621680965569"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; CekM uni fun s ()
forall (uni :: * -&gt; *) fun s a. ST s a -&gt; CekM uni fun s a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekM"><span class="hs-identifier hs-var">CekM</span></a></span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; CekM uni fun s ()) -&gt; ST s () -&gt; CekM uni fun s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; (DList Text -&gt; DList Text) -&gt; ST s ()
forall s a. STRef s a -&gt; (a -&gt; a) -&gt; ST s ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">modifySTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965572"><span class="hs-identifier hs-var">logsRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; DList Text -&gt; DList Text
forall a. DList a -&gt; DList a -&gt; DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-operator hs-var">`DList.append`</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
</span><a href="#local-6989586621680965569"><span class="hs-identifier hs-var">logs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="annottext">CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
forall (uni :: * -&gt; *) fun s.
CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekEmitterInfo"><span class="hs-identifier hs-var">CekEmitterInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s
forall (uni :: * -&gt; *) fun. DList Text -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965570"><span class="hs-identifier hs-var">emitter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; [Text]
forall a. DList a -&gt; [a]
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(DList Text -&gt; [Text]) -&gt; ST s (DList Text) -&gt; ST s [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; ST s (DList Text)
forall s a. STRef s a -&gt; ST s a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">readSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965572"><span class="hs-identifier hs-var">logsRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- A wrapper around encoding a record. `cassava` insists on including a trailing newline, which is</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- annoying since we're recording the output line-by-line.</span><span>
</span><span id="line-37"></span><span id="local-6989586621680965599"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#encodeRecord"><span class="hs-identifier hs-type">encodeRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-type">CSV.ToRecord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965599"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680965599"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">T.Text</span></a></span></span><span>
</span><span id="line-38"></span><span id="encodeRecord"><span class="annot"><span class="annottext">encodeRecord :: a -&gt; Text
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#encodeRecord"><span class="hs-identifier hs-var hs-var">encodeRecord</span></a></span></span><span> </span><span id="local-6989586621680965563"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965563"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">T.stripEnd</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">T.decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BS.toLazyByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall a. ToRecord a =&gt; a -&gt; Builder
</span><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-var">CSV.encodeRecord</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965563"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Emits log with timestamp.</span><span>
</span><span id="line-41"></span><span id="local-6989586621680965556"><span id="local-6989586621680965557"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithTimeEmitter"><span class="hs-identifier hs-type">logWithTimeEmitter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-type">EmitterMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965557"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965556"><span class="hs-identifier hs-type">fun</span></a></span></span></span><span>
</span><span id="line-42"></span><span id="logWithTimeEmitter"><span class="annot"><span class="annottext">logWithTimeEmitter :: EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithTimeEmitter"><span class="hs-identifier hs-var hs-var">logWithTimeEmitter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall (uni :: * -&gt; *) fun.
(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-var">EmitterMode</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
 -&gt; EmitterMode uni fun)
-&gt; (forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ST s ExBudget
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621680965555"><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965555"><span class="hs-identifier hs-var">logsRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DList Text -&gt; ST s (STRef s (DList Text))
forall a s. a -&gt; ST s (STRef s a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">newSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
forall a. DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.empty</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965554"><span class="annot"><span class="annottext">emitter :: DList a -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965554"><span class="hs-identifier hs-var hs-var">emitter</span></a></span></span><span> </span><span id="local-6989586621680965553"><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621680965553"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; CekM uni fun s ()
forall (uni :: * -&gt; *) fun s a. ST s a -&gt; CekM uni fun s a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekM"><span class="hs-identifier hs-var">CekM</span></a></span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; CekM uni fun s ()) -&gt; ST s () -&gt; CekM uni fun s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-45"></span><span>            </span><span id="local-6989586621680965552"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680965552"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; ST s UTCTime
forall a s. IO a -&gt; ST s a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeIOToST</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-var">getCurrentTime</span></a></span><span>
</span><span id="line-46"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965550"><span class="annot"><span class="annottext">secs :: Integer
</span><a href="#local-6989586621680965550"><span class="hs-identifier hs-var hs-var">secs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MkFixed</span></a></span><span> </span><span id="local-6989586621680965548"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680965548"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Fixed E12
</span><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-var">nominalDiffTimeToSeconds</span></a></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Fixed E12) -&gt; NominalDiffTime -&gt; Fixed E12
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; NominalDiffTime
</span><a href="../file:///nix/store/4q522hwxk0mrklp2dqg3vhadkjnsyh9m-time-lib-time-1.9.3-haddock-doc/share/doc/time/html/src"><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680965552"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680965548"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-47"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965545"><span class="annot"><span class="annottext">withTime :: DList Text
</span><a href="#local-6989586621680965545"><span class="hs-identifier hs-var hs-var">withTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621680965553"><span class="hs-identifier hs-var">logs</span></a></span><span> </span><span class="annot"><span class="annottext">DList a -&gt; (a -&gt; Text) -&gt; DList Text
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680965543"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965543"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Integer) -&gt; Text
forall a. ToRecord a =&gt; a -&gt; Text
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#encodeRecord"><span class="hs-identifier hs-var">encodeRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965543"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680965550"><span class="hs-identifier hs-var">secs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>            </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; (DList Text -&gt; DList Text) -&gt; ST s ()
forall s a. STRef s a -&gt; (a -&gt; a) -&gt; ST s ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">modifySTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965555"><span class="hs-identifier hs-var">logsRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; DList Text -&gt; DList Text
forall a. DList a -&gt; DList a -&gt; DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-operator hs-var">`DList.append`</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
</span><a href="#local-6989586621680965545"><span class="hs-identifier hs-var">withTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
forall (uni :: * -&gt; *) fun s.
CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekEmitterInfo"><span class="hs-identifier hs-var">CekEmitterInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s
forall a (uni :: * -&gt; *) fun.
ToField a =&gt;
DList a -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965554"><span class="hs-identifier hs-var">emitter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; [Text]
forall a. DList a -&gt; [a]
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(DList Text -&gt; [Text]) -&gt; ST s (DList Text) -&gt; ST s [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; ST s (DList Text)
forall s a. STRef s a -&gt; ST s a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">readSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965555"><span class="hs-identifier hs-var">logsRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-type">CSV.ToField</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html#ExCPU"><span class="hs-identifier hs-type">ExCPU</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621680965540"><span class="annot"><span class="annottext">toField :: ExCPU -&gt; ByteString
</span><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html#ExCPU"><span class="hs-identifier hs-type">ExCPU</span></a></span><span> </span><span id="local-6989586621680965537"><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621680965537"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
forall a. ToField a =&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-var">CSV.toField</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ByteString) -&gt; Integer -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CostingInteger -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621680965537"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-type">CSV.ToField</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html#ExMemory"><span class="hs-identifier hs-type">ExMemory</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621680965535"><span class="annot"><span class="annottext">toField :: ExMemory -&gt; ByteString
</span><a href="#local-6989586621680965535"><span class="hs-identifier hs-var hs-var hs-var hs-var">toField</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExMemory.html#ExMemory"><span class="hs-identifier hs-type">ExMemory</span></a></span><span> </span><span id="local-6989586621680965533"><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621680965533"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
forall a. ToField a =&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/b9mliw6nns5zwr2fcksdazyg37dmnpsm-cassava-lib-cassava-0.5.3.0-haddock-doc/share/doc/cassava/html/src"><span class="hs-identifier hs-var">CSV.toField</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ByteString) -&gt; Integer -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CostingInteger -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621680965533"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Emits log with the budget.</span><span>
</span><span id="line-58"></span><span id="local-6989586621680965531"><span id="local-6989586621680965532"><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithBudgetEmitter"><span class="hs-identifier hs-type">logWithBudgetEmitter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-type">EmitterMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965532"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680965531"><span class="hs-identifier hs-type">fun</span></a></span></span></span><span>
</span><span id="line-59"></span><span id="logWithBudgetEmitter"><span class="annot"><span class="annottext">logWithBudgetEmitter :: EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#logWithBudgetEmitter"><span class="hs-identifier hs-var hs-var">logWithBudgetEmitter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall (uni :: * -&gt; *) fun.
(forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#EmitterMode"><span class="hs-identifier hs-var">EmitterMode</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
 -&gt; EmitterMode uni fun)
-&gt; (forall s. ST s ExBudget -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; EmitterMode uni fun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680965530"><span class="annot"><span class="annottext">ST s ExBudget
</span><a href="#local-6989586621680965530"><span class="hs-identifier hs-var">getBudget</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621680965529"><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965529"><span class="hs-identifier hs-var">logsRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DList Text -&gt; ST s (STRef s (DList Text))
forall a s. a -&gt; ST s (STRef s a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">newSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
forall a. DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.empty</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965528"><span class="annot"><span class="annottext">emitter :: DList a -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965528"><span class="hs-identifier hs-var hs-var">emitter</span></a></span></span><span> </span><span id="local-6989586621680965527"><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621680965527"><span class="hs-identifier hs-var">logs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; CekM uni fun s ()
forall (uni :: * -&gt; *) fun s a. ST s a -&gt; CekM uni fun s a
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekM"><span class="hs-identifier hs-var">CekM</span></a></span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; CekM uni fun s ()) -&gt; ST s () -&gt; CekM uni fun s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>            </span><span class="annot"><a href="PlutusCore.Evaluation.Machine.ExBudget.html#ExBudget"><span class="hs-identifier hs-type">ExBudget</span></a></span><span> </span><span id="local-6989586621680965525"><span class="annot"><span class="annottext">ExCPU
</span><a href="#local-6989586621680965525"><span class="hs-identifier hs-var">exCpu</span></a></span></span><span> </span><span id="local-6989586621680965524"><span class="annot"><span class="annottext">ExMemory
</span><a href="#local-6989586621680965524"><span class="hs-identifier hs-var">exMemory</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ST s ExBudget
</span><a href="#local-6989586621680965530"><span class="hs-identifier hs-var">getBudget</span></a></span><span>
</span><span id="line-63"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965523"><span class="annot"><span class="annottext">withBudget :: DList Text
</span><a href="#local-6989586621680965523"><span class="hs-identifier hs-var hs-var">withBudget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList a
</span><a href="#local-6989586621680965527"><span class="hs-identifier hs-var">logs</span></a></span><span> </span><span class="annot"><span class="annottext">DList a -&gt; (a -&gt; Text) -&gt; DList Text
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680965522"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965522"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, ExCPU, ExMemory) -&gt; Text
forall a. ToRecord a =&gt; a -&gt; Text
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.EmitterMode.html#encodeRecord"><span class="hs-identifier hs-var">encodeRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680965522"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExCPU
</span><a href="#local-6989586621680965525"><span class="hs-identifier hs-var">exCpu</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExMemory
</span><a href="#local-6989586621680965524"><span class="hs-identifier hs-var">exMemory</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; (DList Text -&gt; DList Text) -&gt; ST s ()
forall s a. STRef s a -&gt; (a -&gt; a) -&gt; ST s ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">modifySTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965529"><span class="hs-identifier hs-var">logsRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; DList Text -&gt; DList Text
forall a. DList a -&gt; DList a -&gt; DList a
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-operator hs-var">`DList.append`</span></a></span><span> </span><span class="annot"><span class="annottext">DList Text
</span><a href="#local-6989586621680965523"><span class="hs-identifier hs-var">withBudget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s))
-&gt; CekEmitterInfo uni fun s -&gt; ST s (CekEmitterInfo uni fun s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
forall (uni :: * -&gt; *) fun s.
CekEmitter uni fun s -&gt; ST s [Text] -&gt; CekEmitterInfo uni fun s
</span><a href="UntypedPlutusCore.Evaluation.Machine.Cek.Internal.html#CekEmitterInfo"><span class="hs-identifier hs-var">CekEmitterInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CekEmitter uni fun s
forall a (uni :: * -&gt; *) fun.
ToField a =&gt;
DList a -&gt; CekM uni fun s ()
</span><a href="#local-6989586621680965528"><span class="hs-identifier hs-var">emitter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList Text -&gt; [Text]
forall a. DList a -&gt; [a]
</span><a href="../file:///nix/store/sbbmrf25dnskrfwxibv93zyl8pzi0wqp-dlist-lib-dlist-1.0-haddock-doc/share/doc/dlist/html/src"><span class="hs-identifier hs-var">DList.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(DList Text -&gt; [Text]) -&gt; ST s (DList Text) -&gt; ST s [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text) -&gt; ST s (DList Text)
forall s a. STRef s a -&gt; ST s a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">readSTRef</span></a></span><span> </span><span class="annot"><span class="annottext">STRef s (DList Text)
</span><a href="#local-6989586621680965529"><span class="hs-identifier hs-var">logsRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span></pre></body></html>
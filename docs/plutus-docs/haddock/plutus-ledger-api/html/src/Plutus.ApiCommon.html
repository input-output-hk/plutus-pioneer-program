<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_A4p0ZiEg4mzCfIPKOUlv4J"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications  #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StrictData        #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">-- GHC is asked to do quite a lot of optimization in this module, so we're increasing the amount of</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- ticks for the simplifier not to run out of them.</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -fsimpl-tick-factor=200 #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Common types and functions used across all the ledger API modules.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.ApiCommon</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">Version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ScriptPlutus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">Version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.Data</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.Evaluation.Machine.CostModelInterface</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudget</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.Evaluation.Machine.MachineParameters</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Plutus</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.MkPlc</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">UntypedPlutusCore</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">UntypedPlutusCore.Check.Scope</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">UntypedPlutusCore.Evaluation.Machine.Cek</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UPLC</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier">Codec.CBOR.Decoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.CBOR.Extras.html"><span class="hs-identifier">Codec.CBOR.Extras</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier">Codec.CBOR.Read</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Writer</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">fromStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Either</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Tuple</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">inline</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier">NoThunks.Class</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusCore.Pretty</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">PlutusPrelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">through</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">{- Note [New builtins and protocol versions]
When we add a new builtin to the language, that is a *backwards-compatible* change.
Old scripts will still work (since they don't use the new builtins), we just make some more
scripts possible.

It would be nice, therefore, to get away with just having one definition of the set of builtin
functions. Then the new builtins will just &quot;work&quot;. However, this neglects the fact that
the new builtins will be added to the builtin universe in the *software update* that
brings a new version of Plutus, but they should only be usable after the corresponding
*hard fork*. So there is a period of time in which they must be present in the software but not
usable, so we need to decide this conditionally based on the protocol version.

To do this we need to:
- Know which protocol version a builtin was introduced in.
- Given the protocol version, check a program for builtins that should not be usable yet.

Note that this doesn't currently handle removals of builtins, although it fairly straighforwardly
could do, just by tracking when they were removed.
-}</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">{- Note [Size checking of constants in PLC programs]
We impose a 64-byte *on-the-wire* limit on the constants inside PLC programs. This prevents people from inserting
Mickey Mouse entire.

This is somewhat inconvenient for users, but they can always send multiple bytestrings and
concatenate them at runtime.

Unfortunately this check was broken in the ledger Plutus language version V1, and so for backwards compatibility
we only perform it in V2 and above.
-}</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">{- Note [Inlining meanings of builtins]
It's vitally important to inline the 'toBuiltinMeaning' method of a set of built-in functions as
that allows GHC to look under lambdas and completely optimize multiple abstractions away.

There are two ways of doing that: by relying on 'INLINE' pragmas all the way up from the
'ToBuiltinMeaning' instance for the default set of builtins or by ensuring that 'toBuiltinsRuntime'
is compiled efficient by turning it into a one-method class (see
https://github.com/input-output-hk/plutus/pull/4419 for how that looks like). We chose the former,
because it's simpler. Although it's also less reliable: machine parameters are computed in
multiple places and we need to make sure that benchmarking, cost model calculations and the actual
production path have builtins compiled in the same way, 'cause otherwise performance analysis and
cost predictions can be wrong by a big margin without us knowing. Because of this danger in addition
to putting @INLINE@ pragmas on every relevant definition, we also stick a call to 'inline' at the
call site. We also do not attempt to only compile things efficiently where we need that and instead
inline the meanins of builtins everywhere. Just to be sure.

Note that a combination of @INLINABLE@ + 'inline' does not result in proper inlining for whatever
reason. It has to be @INLINE@ (and we add 'inline' on top of that for some additional reliability
as we did have cases where sticking 'inline' on something that already had @INLINE@ would fix
inlining).
-}</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Scripts to the ledger are serialised bytestrings.</span><span>
</span><span id="line-102"></span><span class="hs-keyword">type</span><span> </span><span id="SerializedScript"><span class="annot"><a href="Plutus.ApiCommon.html#SerializedScript"><span class="hs-identifier hs-var">SerializedScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">ShortByteString</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | The plutus language version as seen from the ledger's side.</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Note: the ordering of constructors matters for deriving Ord</span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="LedgerPlutusVersion"><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-var">LedgerPlutusVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PlutusV1"><span class="annot"><a href="Plutus.ApiCommon.html#PlutusV1"><span class="hs-identifier hs-var">PlutusV1</span></a></span></span><span>
</span><span id="line-107"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span id="PlutusV2"><span class="annot"><a href="Plutus.ApiCommon.html#PlutusV2"><span class="hs-identifier hs-var">PlutusV2</span></a></span></span><span>
</span><span id="line-108"></span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745263"><span id="local-6989586621679745265"><span class="annot"><span class="annottext">LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
(LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; Eq LedgerPlutusVersion
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c/= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
== :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c== :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679745247"><span id="local-6989586621679745249"><span id="local-6989586621679745251"><span id="local-6989586621679745253"><span id="local-6989586621679745255"><span id="local-6989586621679745257"><span id="local-6989586621679745259"><span class="annot"><span class="annottext">Eq LedgerPlutusVersion
Eq LedgerPlutusVersion
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Ordering)
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; (LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool)
-&gt; (LedgerPlutusVersion
    -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion)
-&gt; (LedgerPlutusVersion
    -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion)
-&gt; Ord LedgerPlutusVersion
LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Ordering
LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion
$cmin :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion
max :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion
$cmax :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; LedgerPlutusVersion
&gt;= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c&gt;= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
&gt; :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c&gt; :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
&lt;= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c&lt;= :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
&lt; :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
$c&lt; :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
compare :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Ordering
$ccompare :: LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Ordering
$cp1Ord :: Eq LedgerPlutusVersion
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | This represents the Cardano protocol version, with its major and minor components.</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- This relies on careful understanding between us and the ledger as to what this means.</span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="ProtocolVersion"><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProtocolVersion"><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="pvMajor"><span class="annot"><span class="annottext">ProtocolVersion -&gt; Int
</span><a href="Plutus.ApiCommon.html#pvMajor"><span class="hs-identifier hs-var hs-var">pvMajor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span id="pvMinor"><span class="annot"><span class="annottext">ProtocolVersion -&gt; Int
</span><a href="Plutus.ApiCommon.html#pvMinor"><span class="hs-identifier hs-var hs-var">pvMinor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745237"><span id="local-6989586621679745239"><span id="local-6989586621679745241"><span class="annot"><span class="annottext">Int -&gt; ProtocolVersion -&gt; ShowS
[ProtocolVersion] -&gt; ShowS
ProtocolVersion -&gt; String
(Int -&gt; ProtocolVersion -&gt; ShowS)
-&gt; (ProtocolVersion -&gt; String)
-&gt; ([ProtocolVersion] -&gt; ShowS)
-&gt; Show ProtocolVersion
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProtocolVersion] -&gt; ShowS
$cshowList :: [ProtocolVersion] -&gt; ShowS
show :: ProtocolVersion -&gt; String
$cshow :: ProtocolVersion -&gt; String
showsPrec :: Int -&gt; ProtocolVersion -&gt; ShowS
$cshowsPrec :: Int -&gt; ProtocolVersion -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679745232"><span id="local-6989586621679745234"><span class="annot"><span class="annottext">ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
(ProtocolVersion -&gt; ProtocolVersion -&gt; Bool)
-&gt; (ProtocolVersion -&gt; ProtocolVersion -&gt; Bool)
-&gt; Eq ProtocolVersion
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
$c/= :: ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
== :: ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
$c== :: ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679745218"><span id="local-6989586621679745220"><span id="local-6989586621679745222"><span id="local-6989586621679745224"><span id="local-6989586621679745226"><span id="local-6989586621679745228"><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- same as deriving Ord, just for having it explicitly</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679745217"><span class="annot"><span class="annottext">compare :: ProtocolVersion -&gt; ProtocolVersion -&gt; Ordering
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span id="local-6989586621679745215"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745215"><span class="hs-identifier hs-var">major</span></a></span></span><span> </span><span id="local-6989586621679745214"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745214"><span class="hs-identifier hs-var">minor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span id="local-6989586621679745213"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745213"><span class="hs-identifier hs-var">major'</span></a></span></span><span> </span><span id="local-6989586621679745212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745212"><span class="hs-identifier hs-var">minor'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745215"><span class="hs-identifier hs-var">major</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745213"><span class="hs-identifier hs-var">major'</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745214"><span class="hs-identifier hs-var">minor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745212"><span class="hs-identifier hs-var">minor'</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679745209"><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679745207"><span class="annot"><span class="annottext">pretty :: ProtocolVersion -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span id="local-6989586621679745205"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745205"><span class="hs-identifier hs-var">major</span></a></span></span><span> </span><span id="local-6989586621679745204"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745204"><span class="hs-identifier hs-var">minor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745205"><span class="hs-identifier hs-var">major</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679745204"><span class="hs-identifier hs-var">minor</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">{-| A map indicating which builtin functions were introduced in which 'ProtocolVersion'. Each builtin function should appear at most once.

This *must* be updated when new builtins are added.
See Note [New builtins and protocol versions]
-}</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Plutus.ApiCommon.html#builtinsIntroducedIn"><span class="hs-identifier hs-type">builtinsIntroducedIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="builtinsIntroducedIn"><span class="annot"><span class="annottext">builtinsIntroducedIn :: Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
</span><a href="Plutus.ApiCommon.html#builtinsIntroducedIn"><span class="hs-identifier hs-var hs-var">builtinsIntroducedIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((LedgerPlutusVersion, ProtocolVersion), Set DefaultFun)]
-&gt; Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- 5.0 is Alonzo</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="Plutus.ApiCommon.html#PlutusV1"><span class="hs-identifier hs-var">PlutusV1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ProtocolVersion
</span><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DefaultFun] -&gt; Set DefaultFun
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-131"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">AddInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">SubtractInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MultiplyInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">DivideInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">QuotientInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">RemainderInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ModInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">EqualsInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">LessThanInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">LessThanEqualsInteger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">AppendByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ConsByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">SliceByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">LengthOfByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">IndexByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">EqualsByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">LessThanByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">LessThanEqualsByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Sha2_256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Sha3_256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Blake2b_256</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">VerifyEd25519Signature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">AppendString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">EqualsString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">EncodeUtf8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">DecodeUtf8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">IfThenElse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ChooseUnit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">FstPair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">SndPair</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ChooseList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MkCons</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">HeadList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">TailList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">NullList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ChooseData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ConstrData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MapData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ListData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">IData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">BData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnConstrData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnMapData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnListData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnIData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnBData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">EqualsData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MkPairData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MkNilData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">MkNilPairData</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="Plutus.ApiCommon.html#PlutusV2"><span class="hs-identifier hs-var">PlutusV2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ProtocolVersion
</span><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DefaultFun] -&gt; Set DefaultFun
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-144"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">SerialiseData</span></a></span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="Plutus.ApiCommon.html#PlutusV2"><span class="hs-identifier hs-var">PlutusV2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ProtocolVersion
</span><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DefaultFun] -&gt; Set DefaultFun
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-147"></span><span>          </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">VerifyEcdsaSecp256k1Signature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">VerifySchnorrSecp256k1Signature</span></a></span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">{-| Which builtin functions are available in the given 'ProtocolVersion'?

See Note [New builtins and protocol versions]
-}</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Plutus.ApiCommon.html#builtinsAvailableIn"><span class="hs-identifier hs-type">builtinsAvailableIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span>
</span><span id="line-156"></span><span id="builtinsAvailableIn"><span class="annot"><span class="annottext">builtinsAvailableIn :: LedgerPlutusVersion -&gt; ProtocolVersion -&gt; Set DefaultFun
</span><a href="Plutus.ApiCommon.html#builtinsAvailableIn"><span class="hs-identifier hs-var hs-var">builtinsAvailableIn</span></a></span></span><span> </span><span id="local-6989586621679745145"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745145"><span class="hs-identifier hs-var">thisLv</span></a></span></span><span> </span><span id="local-6989586621679745144"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745144"><span class="hs-identifier hs-var">thisPv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set DefaultFun] -&gt; Set DefaultFun
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">([Set DefaultFun] -&gt; Set DefaultFun)
-&gt; [Set DefaultFun] -&gt; Set DefaultFun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
-&gt; [Set DefaultFun]
forall k a. Map k a -&gt; [a]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.elems</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
 -&gt; [Set DefaultFun])
-&gt; Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
-&gt; [Set DefaultFun]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">((LedgerPlutusVersion, ProtocolVersion) -&gt; Bool)
-&gt; Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
-&gt; Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
forall k a. (k -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.takeWhileAntitone</span></a></span><span> </span><span class="annot"><span class="annottext">(LedgerPlutusVersion, ProtocolVersion) -&gt; Bool
</span><a href="#local-6989586621679745141"><span class="hs-identifier hs-var">builtinAvailableIn</span></a></span><span> </span><span class="annot"><span class="annottext">Map (LedgerPlutusVersion, ProtocolVersion) (Set DefaultFun)
</span><a href="Plutus.ApiCommon.html#builtinsIntroducedIn"><span class="hs-identifier hs-var">builtinsIntroducedIn</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><a href="#local-6989586621679745141"><span class="hs-identifier hs-type">builtinAvailableIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621679745141"><span class="annot"><span class="annottext">builtinAvailableIn :: (LedgerPlutusVersion, ProtocolVersion) -&gt; Bool
</span><a href="#local-6989586621679745141"><span class="hs-identifier hs-var hs-var">builtinAvailableIn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745140"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745140"><span class="hs-identifier hs-var">introducedInLv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679745139"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745139"><span class="hs-identifier hs-var">introducedInPv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-comment">-- both should be satisfied</span><span>
</span><span id="line-162"></span><span>          </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745140"><span class="hs-identifier hs-var">introducedInLv</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion -&gt; LedgerPlutusVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745145"><span class="hs-identifier hs-var">thisLv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745139"><span class="hs-identifier hs-var">introducedInPv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745144"><span class="hs-identifier hs-var">thisPv</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | A variant of `Script` with a specialized decoder.</span><span>
</span><span id="line-165"></span><span class="hs-keyword">newtype</span><span> </span><span id="ScriptForExecution"><span class="annot"><a href="Plutus.ApiCommon.html#ScriptForExecution"><span class="hs-identifier hs-var">ScriptForExecution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ScriptForExecution"><span class="annot"><a href="Plutus.ApiCommon.html#ScriptForExecution"><span class="hs-identifier hs-var">ScriptForExecution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.Program</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.NamedDeBruijn</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultUni</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">{-| This decoder decodes the names directly into `NamedDeBruijn`s rather than `DeBruijn`s.
This is needed because the CEK machine expects `NameDeBruijn`s, but there are obviously no names in the serialized form of a `Script`.
Rather than traversing the term and inserting fake names after deserializing, this lets us do at the same time as deserializing.
-}</span><span>
</span><span id="line-171"></span><span id="local-6989586621679745416"><span class="annot"><a href="Plutus.ApiCommon.html#scriptCBORDecoder"><span class="hs-identifier hs-type">scriptCBORDecoder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier hs-type">CBOR.Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679745416"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ScriptForExecution"><span class="hs-identifier hs-type">ScriptForExecution</span></a></span></span><span>
</span><span id="line-172"></span><span id="scriptCBORDecoder"><span class="annot"><span class="annottext">scriptCBORDecoder :: LedgerPlutusVersion
-&gt; ProtocolVersion -&gt; Decoder s ScriptForExecution
</span><a href="Plutus.ApiCommon.html#scriptCBORDecoder"><span class="hs-identifier hs-var hs-var">scriptCBORDecoder</span></a></span></span><span> </span><span id="local-6989586621679745134"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745134"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621679745133"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745133"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- See Note [New builtins and protocol versions]</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679745132"><span class="annot"><span class="annottext">availableBuiltins :: Set DefaultFun
</span><a href="#local-6989586621679745132"><span class="hs-identifier hs-var hs-var">availableBuiltins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion -&gt; ProtocolVersion -&gt; Set DefaultFun
</span><a href="Plutus.ApiCommon.html#builtinsAvailableIn"><span class="hs-identifier hs-var">builtinsAvailableIn</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745134"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745133"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-comment">-- TODO: optimize this by using a better datastructure e.g. 'IntSet'</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679745131"><span class="annot"><span class="annottext">flatDecoder :: Get (Program FakeNamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679745131"><span class="hs-identifier hs-var hs-var">flatDecoder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DefaultFun -&gt; Bool)
-&gt; Get (Program FakeNamedDeBruijn DefaultUni DefaultFun ())
forall name (uni :: * -&gt; *) fun ann.
(Closed uni, Everywhere uni Flat,
 PrettyPlc (Term name uni fun ann), Flat fun, Flat ann, Flat name,
 Flat (Binder name)) =&gt;
(fun -&gt; Bool) -&gt; Get (Program name uni fun ann)
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.decodeProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679745129"><span class="annot"><span class="annottext">DefaultFun
</span><a href="#local-6989586621679745129"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="#local-6989586621679745129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DefaultFun -&gt; Set DefaultFun -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set DefaultFun
</span><a href="#local-6989586621679745132"><span class="hs-identifier hs-var">availableBuiltins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-comment">-- Deserialize using 'FakeNamedDeBruijn' to get the fake names added</span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679745127"><span class="annot"><span class="annottext">Program FakeNamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745127"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.Program</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.FakeNamedDeBruijn</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultUni</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get (Program FakeNamedDeBruijn DefaultUni DefaultFun ())
-&gt; Decoder s (Program FakeNamedDeBruijn DefaultUni DefaultFun ())
forall a s. Get a -&gt; Decoder s a
</span><a href="Codec.CBOR.Extras.html#decodeViaFlat"><span class="hs-identifier hs-var">decodeViaFlat</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Program FakeNamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679745131"><span class="hs-identifier hs-var">flatDecoder</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">ScriptForExecution -&gt; Decoder s ScriptForExecution
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptForExecution -&gt; Decoder s ScriptForExecution)
-&gt; ScriptForExecution -&gt; Decoder s ScriptForExecution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Program FakeNamedDeBruijn DefaultUni DefaultFun ()
-&gt; ScriptForExecution
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">Program FakeNamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745127"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">{-| Check if a 'Script' is &quot;valid&quot; according to a protocol version. At the moment this means &quot;deserialises correctly&quot;, which in particular
implies that it is (almost certainly) an encoded script and the script does not mention any builtins unavailable in the given protocol version.

Note: Parameterized over the ledger-plutus-version since the builtins allowed (during decoding) differs.
-}</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Plutus.ApiCommon.html#isScriptWellFormed"><span class="hs-identifier hs-type">isScriptWellFormed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#SerializedScript"><span class="hs-identifier hs-type">SerializedScript</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-188"></span><span id="isScriptWellFormed"><span class="annot"><span class="annottext">isScriptWellFormed :: LedgerPlutusVersion -&gt; ProtocolVersion -&gt; SerializedScript -&gt; Bool
</span><a href="Plutus.ApiCommon.html#isScriptWellFormed"><span class="hs-identifier hs-var hs-var">isScriptWellFormed</span></a></span></span><span> </span><span id="local-6989586621679745124"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745124"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621679745123"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745123"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either DeserialiseFailure (ByteString, ScriptForExecution) -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DeserialiseFailure (ByteString, ScriptForExecution)
 -&gt; Bool)
-&gt; (SerializedScript
    -&gt; Either DeserialiseFailure (ByteString, ScriptForExecution))
-&gt; SerializedScript
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(forall s. Decoder s ScriptForExecution)
-&gt; ByteString
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
forall a.
(forall s. Decoder s a)
-&gt; ByteString -&gt; Either DeserialiseFailure (ByteString, a)
</span><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier hs-var">CBOR.deserialiseFromBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerPlutusVersion
-&gt; ProtocolVersion -&gt; Decoder s ScriptForExecution
forall s.
LedgerPlutusVersion
-&gt; ProtocolVersion -&gt; Decoder s ScriptForExecution
</span><a href="Plutus.ApiCommon.html#scriptCBORDecoder"><span class="hs-identifier hs-var">scriptCBORDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745124"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745123"><span class="hs-identifier hs-var">pv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; Either DeserialiseFailure (ByteString, ScriptForExecution))
-&gt; (SerializedScript -&gt; ByteString)
-&gt; SerializedScript
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (SerializedScript -&gt; ByteString)
-&gt; SerializedScript
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedScript -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">fromShort</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Errors that can be thrown when evaluating a Plutus script.</span><span>
</span><span id="line-191"></span><span class="hs-keyword">data</span><span> </span><span id="EvaluationError"><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationError"><span class="hs-identifier hs-var">EvaluationError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>    </span><span id="CekError"><span class="annot"><a href="Plutus.ApiCommon.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.CekEvaluationException</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">NamedDeBruijn</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultUni</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ An error from the evaluator itself</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeBruijnError"><span class="annot"><a href="Plutus.ApiCommon.html#DeBruijnError"><span class="hs-identifier hs-var">DeBruijnError</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">FreeVariableError</span></a></span><span> </span><span class="hs-comment">-- ^ An error in the pre-evaluation step of converting from de-Bruijn indices</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CodecError"><span class="annot"><a href="Plutus.ApiCommon.html#CodecError"><span class="hs-identifier hs-var">CodecError</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier hs-type">CBOR.DeserialiseFailure</span></a></span><span> </span><span class="hs-comment">-- ^ A serialisation error</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IncompatibleVersionError"><span class="annot"><a href="Plutus.ApiCommon.html#IncompatibleVersionError"><span class="hs-identifier hs-var">IncompatibleVersionError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">ScriptPlutus.Version</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ An error indicating a version tag that we don't support</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- TODO: make this error more informative when we have more information about what went wrong</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CostModelParameterMismatch"><span class="annot"><a href="Plutus.ApiCommon.html#CostModelParameterMismatch"><span class="hs-identifier hs-var">CostModelParameterMismatch</span></a></span></span><span> </span><span class="hs-comment">-- ^ An error indicating that the cost model parameters didn't match what we expected</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745108"><span id="local-6989586621679745110"><span id="local-6989586621679745112"><span class="annot"><span class="annottext">Int -&gt; EvaluationError -&gt; ShowS
[EvaluationError] -&gt; ShowS
EvaluationError -&gt; String
(Int -&gt; EvaluationError -&gt; ShowS)
-&gt; (EvaluationError -&gt; String)
-&gt; ([EvaluationError] -&gt; ShowS)
-&gt; Show EvaluationError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EvaluationError] -&gt; ShowS
$cshowList :: [EvaluationError] -&gt; ShowS
show :: EvaluationError -&gt; String
$cshow :: EvaluationError -&gt; String
showsPrec :: Int -&gt; EvaluationError -&gt; ShowS
$cshowsPrec :: Int -&gt; EvaluationError -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679745104"><span id="local-6989586621679745106"><span class="annot"><span class="annottext">EvaluationError -&gt; EvaluationError -&gt; Bool
(EvaluationError -&gt; EvaluationError -&gt; Bool)
-&gt; (EvaluationError -&gt; EvaluationError -&gt; Bool)
-&gt; Eq EvaluationError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EvaluationError -&gt; EvaluationError -&gt; Bool
$c/= :: EvaluationError -&gt; EvaluationError -&gt; Bool
== :: EvaluationError -&gt; EvaluationError -&gt; Bool
$c== :: EvaluationError -&gt; EvaluationError -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679745101"><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679745100"><span class="annot"><span class="annottext">pretty :: EvaluationError -&gt; Doc ann
</span><a href="#local-6989586621679745100"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#CekError"><span class="hs-identifier hs-type">CekError</span></a></span><span> </span><span id="local-6989586621679745099"><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621679745099"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; Doc ann
forall a ann. PrettyClassic a =&gt; a -&gt; Doc ann
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">prettyClassicDef</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621679745099"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#DeBruijnError"><span class="hs-identifier hs-type">DeBruijnError</span></a></span><span> </span><span id="local-6989586621679745097"><span class="annot"><span class="annottext">FreeVariableError
</span><a href="#local-6989586621679745097"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVariableError -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVariableError
</span><a href="#local-6989586621679745097"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#CodecError"><span class="hs-identifier hs-type">CodecError</span></a></span><span> </span><span id="local-6989586621679745096"><span class="annot"><span class="annottext">DeserialiseFailure
</span><a href="#local-6989586621679745096"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeserialiseFailure -&gt; Doc ann
forall a ann. Show a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">viaShow</span></a></span><span> </span><span class="annot"><span class="annottext">DeserialiseFailure
</span><a href="#local-6989586621679745096"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#IncompatibleVersionError"><span class="hs-identifier hs-type">IncompatibleVersionError</span></a></span><span> </span><span id="local-6989586621679745094"><span class="annot"><span class="annottext">Version ()
</span><a href="#local-6989586621679745094"><span class="hs-identifier hs-var">actual</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;This version of the Plutus Core interface does not support the version indicated by the AST:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Version () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Version ()
</span><a href="#local-6989586621679745094"><span class="hs-identifier hs-var">actual</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationError
</span><a href="Plutus.ApiCommon.html#CostModelParameterMismatch"><span class="hs-identifier hs-var">CostModelParameterMismatch</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Cost model parameters were not as we expected&quot;</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | The type of log output: just a list of 'Text'.</span><span>
</span><span id="line-208"></span><span class="hs-keyword">type</span><span> </span><span id="LogOutput"><span class="annot"><a href="Plutus.ApiCommon.html#LogOutput"><span class="hs-identifier hs-var">LogOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | A simple toggle indicating whether or not we should produce logs.</span><span>
</span><span id="line-211"></span><span class="hs-keyword">data</span><span> </span><span id="VerboseMode"><span class="annot"><a href="Plutus.ApiCommon.html#VerboseMode"><span class="hs-identifier hs-var">VerboseMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Verbose"><span class="annot"><a href="Plutus.ApiCommon.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Quiet"><span class="annot"><a href="Plutus.ApiCommon.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745086"><span id="local-6989586621679745088"><span class="annot"><span class="annottext">VerboseMode -&gt; VerboseMode -&gt; Bool
(VerboseMode -&gt; VerboseMode -&gt; Bool)
-&gt; (VerboseMode -&gt; VerboseMode -&gt; Bool) -&gt; Eq VerboseMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: VerboseMode -&gt; VerboseMode -&gt; Bool
$c/= :: VerboseMode -&gt; VerboseMode -&gt; Bool
== :: VerboseMode -&gt; VerboseMode -&gt; Bool
$c== :: VerboseMode -&gt; VerboseMode -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Shared helper for the evaluation functions, deserializes the 'SerializedScript' , applies it to its arguments, puts fakenamedebruijns, and scope-checks it.</span><span>
</span><span id="line-215"></span><span id="local-6989586621679745295"><span class="annot"><a href="Plutus.ApiCommon.html#mkTermToEvaluate"><span class="hs-identifier hs-type">mkTermToEvaluate</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679745295"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#SerializedScript"><span class="hs-identifier hs-type">SerializedScript</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.Data</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679745295"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.Term</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.NamedDeBruijn</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultUni</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-222"></span><span id="mkTermToEvaluate"><span class="annot"><span class="annottext">mkTermToEvaluate :: LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; SerializedScript
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="Plutus.ApiCommon.html#mkTermToEvaluate"><span class="hs-identifier hs-var hs-var">mkTermToEvaluate</span></a></span></span><span> </span><span id="local-6989586621679745084"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745084"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621679745083"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745083"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621679745082"><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745082"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679745081"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745081"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-comment">-- It decodes the program through the optimized ScriptForExecution. See `ScriptForExecution`.</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ScriptForExecution"><span class="hs-identifier hs-type">ScriptForExecution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.Program</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679745079"><span class="annot"><span class="annottext">Version ()
</span><a href="#local-6989586621679745079"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679745078"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745078"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either EvaluationError (ByteString, ScriptForExecution)
-&gt; m (ByteString, ScriptForExecution)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError (ByteString, ScriptForExecution)
 -&gt; m (ByteString, ScriptForExecution))
-&gt; Either EvaluationError (ByteString, ScriptForExecution)
-&gt; m (ByteString, ScriptForExecution)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DeserialiseFailure -&gt; EvaluationError)
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
-&gt; Either EvaluationError (ByteString, ScriptForExecution)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">DeserialiseFailure -&gt; EvaluationError
</span><a href="Plutus.ApiCommon.html#CodecError"><span class="hs-identifier hs-var">CodecError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either DeserialiseFailure (ByteString, ScriptForExecution)
 -&gt; Either EvaluationError (ByteString, ScriptForExecution))
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
-&gt; Either EvaluationError (ByteString, ScriptForExecution)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall s. Decoder s ScriptForExecution)
-&gt; ByteString
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
forall a.
(forall s. Decoder s a)
-&gt; ByteString -&gt; Either DeserialiseFailure (ByteString, a)
</span><a href="../file:///nix/store/ai4hhcpnapmxvprrsv7zi8v0f8zid4p9-cborg-lib-cborg-0.2.8.0-haddock-doc/share/doc/cborg/html/src"><span class="hs-identifier hs-var">CBOR.deserialiseFromBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LedgerPlutusVersion
-&gt; ProtocolVersion -&gt; Decoder s ScriptForExecution
forall s.
LedgerPlutusVersion
-&gt; ProtocolVersion -&gt; Decoder s ScriptForExecution
</span><a href="Plutus.ApiCommon.html#scriptCBORDecoder"><span class="hs-identifier hs-var">scriptCBORDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745084"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745083"><span class="hs-identifier hs-var">pv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; Either DeserialiseFailure (ByteString, ScriptForExecution))
-&gt; ByteString
-&gt; Either DeserialiseFailure (ByteString, ScriptForExecution)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedScript -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">fromShort</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745082"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version ()
</span><a href="#local-6989586621679745079"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Version () -&gt; Version () -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Version ()
forall ann. ann -&gt; Version ann
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.defaultVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationError -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(EvaluationError -&gt; m ()) -&gt; EvaluationError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Version () -&gt; EvaluationError
</span><a href="Plutus.ApiCommon.html#IncompatibleVersionError"><span class="hs-identifier hs-var">IncompatibleVersionError</span></a></span><span> </span><span class="annot"><span class="annottext">Version ()
</span><a href="#local-6989586621679745079"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679745072"><span class="annot"><span class="annottext">termArgs :: [Term NamedDeBruijn DefaultUni DefaultFun ()]
</span><a href="#local-6989586621679745072"><span class="hs-identifier hs-var hs-var">termArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; [Data] -&gt; [Term NamedDeBruijn DefaultUni DefaultFun ()]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Data -&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
forall a (uni :: * -&gt; *) fun (term :: * -&gt; *) tyname name ann.
(TermLike term tyname name uni fun, Includes uni a) =&gt;
ann -&gt; a -&gt; term ann
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.mkConstant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745081"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span id="local-6989586621679745070"><span class="annot"><span class="annottext">appliedT :: Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745070"><span class="hs-identifier hs-var hs-var">appliedT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">()
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; [Term NamedDeBruijn DefaultUni DefaultFun ()]
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
ann -&gt; term ann -&gt; [term ann] -&gt; term ann
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.mkIterApp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745078"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Term NamedDeBruijn DefaultUni DefaultFun ()]
</span><a href="#local-6989586621679745072"><span class="hs-identifier hs-var">termArgs</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- make sure that term is closed, i.e. well-scoped</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="annottext">(Term NamedDeBruijn DefaultUni DefaultFun () -&gt; m ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either EvaluationError () -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError () -&gt; m ())
-&gt; (Term NamedDeBruijn DefaultUni DefaultFun ()
    -&gt; Either EvaluationError ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(FreeVariableError -&gt; EvaluationError)
-&gt; Either FreeVariableError () -&gt; Either EvaluationError ()
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVariableError -&gt; EvaluationError
</span><a href="Plutus.ApiCommon.html#DeBruijnError"><span class="hs-identifier hs-var">DeBruijnError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either FreeVariableError () -&gt; Either EvaluationError ())
-&gt; (Term NamedDeBruijn DefaultUni DefaultFun ()
    -&gt; Either FreeVariableError ())
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; Either EvaluationError ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; Either FreeVariableError ()
forall e (m :: * -&gt; *) name (uni :: * -&gt; *) fun a.
(HasIndex name, MonadError e m, AsFreeVariableError e) =&gt;
Term name uni fun a -&gt; m ()
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.checkScope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745070"><span class="hs-identifier hs-var">appliedT</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Which unlifting mode should we use in the given 'ProtocolVersion'</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- so as to correctly construct the machine's parameters</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Plutus.ApiCommon.html#unliftingModeIn"><span class="hs-identifier hs-type">unliftingModeIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UnliftingMode</span></a></span><span>
</span><span id="line-235"></span><span id="unliftingModeIn"><span class="annot"><span class="annottext">unliftingModeIn :: ProtocolVersion -&gt; UnliftingMode
</span><a href="Plutus.ApiCommon.html#unliftingModeIn"><span class="hs-identifier hs-var hs-var">unliftingModeIn</span></a></span></span><span> </span><span id="local-6989586621679745066"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745066"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- This just changes once in version 7.0</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745066"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion -&gt; ProtocolVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ProtocolVersion
</span><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-var">ProtocolVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingDeferred</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingImmediate</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">type</span><span> </span><span id="DefaultMachineParameters"><span class="annot"><a href="Plutus.ApiCommon.html#DefaultMachineParameters"><span class="hs-identifier hs-var">DefaultMachineParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">MachineParameters</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">CekMachineCosts</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.CekValue</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultUni</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">DefaultFun</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Plutus.ApiCommon.html#toMachineParameters"><span class="hs-identifier hs-type">toMachineParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#DefaultMachineParameters"><span class="hs-identifier hs-type">DefaultMachineParameters</span></a></span><span>
</span><span id="line-242"></span><span id="toMachineParameters"><span class="annot"><span class="annottext">toMachineParameters :: ProtocolVersion -&gt; EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#toMachineParameters"><span class="hs-identifier hs-var hs-var">toMachineParameters</span></a></span></span><span> </span><span id="local-6989586621679745062"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745062"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProtocolVersion -&gt; UnliftingMode
</span><a href="Plutus.ApiCommon.html#unliftingModeIn"><span class="hs-identifier hs-var">unliftingModeIn</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745062"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingImmediate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#machineParametersImmediate"><span class="hs-identifier hs-var hs-var">machineParametersImmediate</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingDeferred</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#machineParametersDeferred"><span class="hs-identifier hs-var hs-var">machineParametersDeferred</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621679745314"><span class="annot"><a href="Plutus.ApiCommon.html#mkMachineParametersFor"><span class="hs-identifier hs-type">mkMachineParametersFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">CostModelApplyError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679745314"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UnliftingMode</span></a></span><span>
</span><span id="line-248"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.CostModelParams</span></a></span><span>
</span><span id="line-249"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679745314"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#DefaultMachineParameters"><span class="hs-identifier hs-type">DefaultMachineParameters</span></a></span></span><span>
</span><span id="line-250"></span><span id="mkMachineParametersFor"><span class="annot"><span class="annottext">mkMachineParametersFor :: UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#mkMachineParametersFor"><span class="hs-identifier hs-var hs-var">mkMachineParametersFor</span></a></span></span><span> </span><span id="local-6989586621679745058"><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621679745058"><span class="hs-identifier hs-var">unlMode</span></a></span></span><span> </span><span id="local-6989586621679745057"><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621679745057"><span class="hs-identifier hs-var">newCMP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">(UnliftingMode
 -&gt; CostModel CekMachineCosts BuiltinCostModel
 -&gt; DefaultMachineParameters)
-&gt; UnliftingMode
-&gt; CostModel CekMachineCosts BuiltinCostModel
-&gt; DefaultMachineParameters
forall a. a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
-&gt; CostModel CekMachineCosts BuiltinCostModel
-&gt; DefaultMachineParameters
forall (uni :: * -&gt; *) fun builtincosts (val :: (* -&gt; *) -&gt; * -&gt; *)
       machinecosts.
(CostingPart uni fun ~ builtincosts,
 HasConstantIn uni (val uni fun), ToBuiltinMeaning uni fun) =&gt;
UnliftingMode
-&gt; CostModel machinecosts builtincosts
-&gt; MachineParameters machinecosts val uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.mkMachineParameters</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="#local-6989586621679745058"><span class="hs-identifier hs-var">unlMode</span></a></span><span> </span><span class="annot"><span class="annottext">(CostModel CekMachineCosts BuiltinCostModel
 -&gt; DefaultMachineParameters)
-&gt; m (CostModel CekMachineCosts BuiltinCostModel)
-&gt; m DefaultMachineParameters
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">CostModel CekMachineCosts BuiltinCostModel
-&gt; CostModelParams
-&gt; m (CostModel CekMachineCosts BuiltinCostModel)
forall evaluatorcosts builtincosts (m :: * -&gt; *).
(FromJSON evaluatorcosts, FromJSON builtincosts,
 ToJSON evaluatorcosts, ToJSON builtincosts,
 MonadError CostModelApplyError m) =&gt;
CostModel evaluatorcosts builtincosts
-&gt; CostModelParams -&gt; m (CostModel evaluatorcosts builtincosts)
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.applyCostModelParams</span></a></span><span> </span><span class="annot"><span class="annottext">CostModel CekMachineCosts BuiltinCostModel
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.defaultCekCostModel</span></a></span><span> </span><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621679745057"><span class="hs-identifier hs-var">newCMP</span></a></span><span>
</span><span id="line-253"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#mkMachineParametersFor"><span class="hs-pragma hs-type">mkMachineParametersFor</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">{-| An opaque type that contains all the static parameters that the evaluator needs to evaluate a
script.  This is so that they can be computed once and cached, rather than recomputed on every
evaluation.

There are two sets of parameters: one is with immediate unlifting and the other one is with
deferred unlifting. We have to keep both of them, because depending on the language version
 either one has to be used or the other. We also compile them separately due to all the inlining
 and optimization that need to happen for things to be efficient.
-}</span><span>
</span><span id="line-265"></span><span id="local-6989586621679745051"><span id="local-6989586621679745052"></span></span><span class="hs-keyword">data</span><span> </span><span id="EvaluationContext"><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EvaluationContext"><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="machineParametersImmediate"><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#machineParametersImmediate"><span class="hs-identifier hs-var hs-var">machineParametersImmediate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#DefaultMachineParameters"><span class="hs-identifier hs-type">DefaultMachineParameters</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="machineParametersDeferred"><span class="annot"><span class="annottext">EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#machineParametersDeferred"><span class="hs-identifier hs-var hs-var">machineParametersDeferred</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#DefaultMachineParameters"><span class="hs-identifier hs-type">DefaultMachineParameters</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="annot"><span class="annottext">(forall x. EvaluationContext -&gt; Rep EvaluationContext x)
-&gt; (forall x. Rep EvaluationContext x -&gt; EvaluationContext)
-&gt; Generic EvaluationContext
forall x. Rep EvaluationContext x -&gt; EvaluationContext
forall x. EvaluationContext -&gt; Rep EvaluationContext x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep EvaluationContext x -&gt; EvaluationContext
$cfrom :: forall x. EvaluationContext -&gt; Rep EvaluationContext x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745045"><span class="annot"><span class="annottext">EvaluationContext -&gt; ()
(EvaluationContext -&gt; ()) -&gt; NFData EvaluationContext
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: EvaluationContext -&gt; ()
$crnf :: EvaluationContext -&gt; ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679745038"><span id="local-6989586621679745040"><span id="local-6989586621679745042"><span class="annot"><span class="annottext">Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
Proxy EvaluationContext -&gt; String
(Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy EvaluationContext -&gt; String)
-&gt; NoThunks EvaluationContext
forall a.
(Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Context -&gt; a -&gt; IO (Maybe ThunkInfo))
-&gt; (Proxy a -&gt; String)
-&gt; NoThunks a
showTypeOf :: Proxy EvaluationContext -&gt; String
$cshowTypeOf :: Proxy EvaluationContext -&gt; String
wNoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
$cwNoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
noThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
$cnoThunks :: Context -&gt; EvaluationContext -&gt; IO (Maybe ThunkInfo)
</span><a href="../file:///nix/store/zg4fsk708njvkh2s22wm1sc8m0qbg360-nothunks-lib-nothunks-0.1.3-haddock-doc/share/doc/nothunks/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">NoThunks</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">{-|  Build the 'EvaluationContext'.

The input is a `Map` of strings to cost integer values (aka `Plutus.CostModelParams`, `Alonzo.CostModel`)
See Note [Inlining meanings of builtins].
-}</span><span>
</span><span id="line-277"></span><span id="local-6989586621679745036"><span class="annot"><a href="Plutus.ApiCommon.html#mkEvaluationContext"><span class="hs-identifier hs-type">mkEvaluationContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">CostModelApplyError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679745036"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.CostModelParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679745036"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span></span><span>
</span><span id="line-278"></span><span id="mkEvaluationContext"><span class="annot"><span class="annottext">mkEvaluationContext :: CostModelParams -&gt; m EvaluationContext
</span><a href="Plutus.ApiCommon.html#mkEvaluationContext"><span class="hs-identifier hs-var hs-var">mkEvaluationContext</span></a></span></span><span> </span><span id="local-6989586621679745034"><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621679745034"><span class="hs-identifier hs-var">newCMP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">DefaultMachineParameters
-&gt; DefaultMachineParameters -&gt; EvaluationContext
</span><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-var">EvaluationContext</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="annottext">(DefaultMachineParameters
 -&gt; DefaultMachineParameters -&gt; EvaluationContext)
-&gt; m DefaultMachineParameters
-&gt; m (DefaultMachineParameters -&gt; EvaluationContext)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters)
-&gt; UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
forall a. a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
forall (m :: * -&gt; *).
MonadError CostModelApplyError m =&gt;
UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#mkMachineParametersFor"><span class="hs-identifier hs-var">mkMachineParametersFor</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingImmediate</span></a></span><span> </span><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621679745034"><span class="hs-identifier hs-var">newCMP</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">m (DefaultMachineParameters -&gt; EvaluationContext)
-&gt; m DefaultMachineParameters -&gt; m EvaluationContext
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters)
-&gt; UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
forall a. a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
forall (m :: * -&gt; *).
MonadError CostModelApplyError m =&gt;
UnliftingMode -&gt; CostModelParams -&gt; m DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#mkMachineParametersFor"><span class="hs-identifier hs-var">mkMachineParametersFor</span></a></span><span> </span><span class="annot"><span class="annottext">UnliftingMode
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UnliftingDeferred</span></a></span><span> </span><span class="annot"><span class="annottext">CostModelParams
</span><a href="#local-6989586621679745034"><span class="hs-identifier hs-var">newCMP</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Comparably expensive to `mkEvaluationContext`, so it should only be used sparingly.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679745033"><span class="annot"><a href="Plutus.ApiCommon.html#assertWellFormedCostModelParams"><span class="hs-identifier hs-type">assertWellFormedCostModelParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">CostModelApplyError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679745033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.CostModelParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679745033"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-285"></span><span id="assertWellFormedCostModelParams"><span class="annot"><span class="annottext">assertWellFormedCostModelParams :: CostModelParams -&gt; m ()
</span><a href="Plutus.ApiCommon.html#assertWellFormedCostModelParams"><span class="hs-identifier hs-var hs-var">assertWellFormedCostModelParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (CostModel CekMachineCosts BuiltinCostModel) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(m (CostModel CekMachineCosts BuiltinCostModel) -&gt; m ())
-&gt; (CostModelParams
    -&gt; m (CostModel CekMachineCosts BuiltinCostModel))
-&gt; CostModelParams
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CostModel CekMachineCosts BuiltinCostModel
-&gt; CostModelParams
-&gt; m (CostModel CekMachineCosts BuiltinCostModel)
forall evaluatorcosts builtincosts (m :: * -&gt; *).
(FromJSON evaluatorcosts, FromJSON builtincosts,
 ToJSON evaluatorcosts, ToJSON builtincosts,
 MonadError CostModelApplyError m) =&gt;
CostModel evaluatorcosts builtincosts
-&gt; CostModelParams -&gt; m (CostModel evaluatorcosts builtincosts)
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.applyCostModelParams</span></a></span><span> </span><span class="annot"><span class="annottext">CostModel CekMachineCosts BuiltinCostModel
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">Plutus.defaultCekCostModel</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">{-|
Evaluates a script, with a cost model and a budget that restricts how many
resources it can use according to the cost model. Also returns the budget that
was actually used.

Can be used to calculate budgets for scripts, but even in this case you must give
a limit to guard against scripts that run for a long time or loop.

Note: Parameterized over the ledger-plutus-version since the builtins allowed (during decoding) differs.
-}</span><span>
</span><span id="line-297"></span><span class="annot"><a href="Plutus.ApiCommon.html#evaluateScriptRestricting"><span class="hs-identifier hs-type">evaluateScriptRestricting</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#VerboseMode"><span class="hs-identifier hs-type">VerboseMode</span></a></span><span>     </span><span class="hs-comment">-- ^ Whether to produce log output</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span> </span><span class="hs-comment">-- ^ The cost model that should already be synced to the most recent cost-model-params coming from the current protocol</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">ExBudget</span></a></span><span>        </span><span class="hs-comment">-- ^ The resource budget which must not be exceeded during evaluation</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#SerializedScript"><span class="hs-identifier hs-type">SerializedScript</span></a></span><span>          </span><span class="hs-comment">-- ^ The script to evaluate</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.Data</span></a></span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- ^ The arguments to the script</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">ExBudget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span id="evaluateScriptRestricting"><span class="annot"><span class="annottext">evaluateScriptRestricting :: LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; ExBudget
-&gt; SerializedScript
-&gt; [Data]
-&gt; (LogOutput, Either EvaluationError ExBudget)
</span><a href="Plutus.ApiCommon.html#evaluateScriptRestricting"><span class="hs-identifier hs-var hs-var">evaluateScriptRestricting</span></a></span></span><span> </span><span id="local-6989586621679745029"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745029"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621679745028"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745028"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621679745027"><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621679745027"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span id="local-6989586621679745026"><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621679745026"><span class="hs-identifier hs-var">ectx</span></a></span></span><span> </span><span id="local-6989586621679745025"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679745025"><span class="hs-identifier hs-var">budget</span></a></span></span><span> </span><span id="local-6989586621679745024"><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745024"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679745023"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745023"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a, b) -&gt; (b, a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">((Either EvaluationError ExBudget, LogOutput)
 -&gt; (LogOutput, Either EvaluationError ExBudget))
-&gt; (Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Writer LogOutput a -&gt; (a, LogOutput)
forall w a. Writer w a -&gt; (a, w)
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ApiCommon.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer LogOutput (Either EvaluationError ExBudget)
 -&gt; (Either EvaluationError ExBudget, LogOutput))
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
-&gt; (Either EvaluationError ExBudget, LogOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
 -&gt; Writer LogOutput (Either EvaluationError ExBudget))
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679745019"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745019"><span class="hs-identifier hs-var">appliedTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; SerializedScript
-&gt; [Data]
-&gt; ExceptT
     EvaluationError
     (WriterT LogOutput Identity)
     (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (m :: * -&gt; *).
MonadError EvaluationError m =&gt;
LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; SerializedScript
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="Plutus.ApiCommon.html#mkTermToEvaluate"><span class="hs-identifier hs-var">mkTermToEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745029"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745028"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745024"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745023"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679745018"><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679745018"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.RestrictingSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">ExRestrictingBudget</span></a></span><span> </span><span id="local-6989586621679745015"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679745015"><span class="hs-identifier hs-var">final</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679745014"><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621679745014"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">DefaultMachineParameters
-&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun
-&gt; EmitterMode DefaultUni DefaultFun
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    RestrictingSt, LogOutput)
forall (uni :: * -&gt; *) fun cost.
(Everywhere uni ExMemoryUsage, Ix fun, PrettyUni uni fun) =&gt;
MachineParameters CekMachineCosts CekValue uni fun
-&gt; ExBudgetMode cost uni fun
-&gt; EmitterMode uni fun
-&gt; Term NamedDeBruijn uni fun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn uni fun)
      (Term NamedDeBruijn uni fun ()),
    cost, LogOutput)
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.runCekDeBruijn</span></a></span><span>
</span><span id="line-311"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolVersion -&gt; EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#toMachineParameters"><span class="hs-identifier hs-var">toMachineParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745028"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621679745026"><span class="hs-identifier hs-var">ectx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExRestrictingBudget
-&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun.
PrettyUni uni fun =&gt;
ExRestrictingBudget -&gt; ExBudgetMode RestrictingSt uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.restricting</span></a></span><span> </span><span class="annot"><span class="annottext">(ExRestrictingBudget
 -&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun)
-&gt; ExRestrictingBudget
-&gt; ExBudgetMode RestrictingSt DefaultUni DefaultFun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget -&gt; ExRestrictingBudget
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">ExRestrictingBudget</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679745025"><span class="hs-identifier hs-var">budget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621679745027"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode -&gt; VerboseMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="Plutus.ApiCommon.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.logEmitter</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.noEmitter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>                </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745019"><span class="hs-identifier hs-var">appliedTerm</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">LogOutput
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621679745014"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ()
 -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ())
-&gt; Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
 -&gt; EvaluationError)
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; EvaluationError
</span><a href="Plutus.ApiCommon.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
 -&gt; Either EvaluationError ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679745018"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="annottext">ExBudget
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679745025"><span class="hs-identifier hs-var">budget</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget -&gt; ExBudget -&gt; ExBudget
</span><a href="../../../../plutus-core/html/src"><span class="hs-operator hs-var">`minusExBudget`</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679745015"><span class="hs-identifier hs-var">final</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">{-|
Evaluates a script, returning the minimum budget that the script would need
to evaluate successfully. This will take as long as the script takes, if you need to
limit the execution time of the script also, you can use 'evaluateScriptRestricting', which
also returns the used budget.

Note: Parameterized over the ledger-plutus-version since the builtins allowed (during decoding) differs.
-}</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Plutus.ApiCommon.html#evaluateScriptCounting"><span class="hs-identifier hs-type">evaluateScriptCounting</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#LedgerPlutusVersion"><span class="hs-identifier hs-type">LedgerPlutusVersion</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#ProtocolVersion"><span class="hs-identifier hs-type">ProtocolVersion</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#VerboseMode"><span class="hs-identifier hs-type">VerboseMode</span></a></span><span>     </span><span class="hs-comment">-- ^ Whether to produce log output</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationContext"><span class="hs-identifier hs-type">EvaluationContext</span></a></span><span> </span><span class="hs-comment">-- ^ The cost model that should already be synced to the most recent cost-model-params coming from the current protocol</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#SerializedScript"><span class="hs-identifier hs-type">SerializedScript</span></a></span><span>          </span><span class="hs-comment">-- ^ The script to evaluate</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">Plutus.Data</span></a></span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- ^ The arguments to the script</span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.ApiCommon.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.ApiCommon.html#EvaluationError"><span class="hs-identifier hs-type">EvaluationError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">ExBudget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span id="evaluateScriptCounting"><span class="annot"><span class="annottext">evaluateScriptCounting :: LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; VerboseMode
-&gt; EvaluationContext
-&gt; SerializedScript
-&gt; [Data]
-&gt; (LogOutput, Either EvaluationError ExBudget)
</span><a href="Plutus.ApiCommon.html#evaluateScriptCounting"><span class="hs-identifier hs-var hs-var">evaluateScriptCounting</span></a></span></span><span> </span><span id="local-6989586621679745006"><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745006"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621679745005"><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745005"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span id="local-6989586621679745004"><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621679745004"><span class="hs-identifier hs-var">verbose</span></a></span></span><span> </span><span id="local-6989586621679745003"><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621679745003"><span class="hs-identifier hs-var">ectx</span></a></span></span><span> </span><span id="local-6989586621679745002"><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745002"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679745001"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745001"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a, b) -&gt; (b, a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">((Either EvaluationError ExBudget, LogOutput)
 -&gt; (LogOutput, Either EvaluationError ExBudget))
-&gt; (Either EvaluationError ExBudget, LogOutput)
-&gt; (LogOutput, Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Writer LogOutput a -&gt; (a, LogOutput)
forall w a. Writer w a -&gt; (a, w)
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.ApiCommon.html#LogOutput"><span class="hs-identifier hs-type">LogOutput</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer LogOutput (Either EvaluationError ExBudget)
 -&gt; (Either EvaluationError ExBudget, LogOutput))
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
-&gt; (Either EvaluationError ExBudget, LogOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
 -&gt; Writer LogOutput (Either EvaluationError ExBudget))
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
-&gt; Writer LogOutput (Either EvaluationError ExBudget)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679745000"><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745000"><span class="hs-identifier hs-var">appliedTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; SerializedScript
-&gt; [Data]
-&gt; ExceptT
     EvaluationError
     (WriterT LogOutput Identity)
     (Term NamedDeBruijn DefaultUni DefaultFun ())
forall (m :: * -&gt; *).
MonadError EvaluationError m =&gt;
LedgerPlutusVersion
-&gt; ProtocolVersion
-&gt; SerializedScript
-&gt; [Data]
-&gt; m (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="Plutus.ApiCommon.html#mkTermToEvaluate"><span class="hs-identifier hs-var">mkTermToEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerPlutusVersion
</span><a href="#local-6989586621679745006"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745005"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">SerializedScript
</span><a href="#local-6989586621679745002"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621679745001"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744999"><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679744999"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-type">UPLC.CountingSt</span></a></span><span> </span><span id="local-6989586621679744997"><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679744997"><span class="hs-identifier hs-var">final</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744996"><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621679744996"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>            </span><span class="annot"><span class="annottext">DefaultMachineParameters
-&gt; ExBudgetMode CountingSt DefaultUni DefaultFun
-&gt; EmitterMode DefaultUni DefaultFun
-&gt; Term NamedDeBruijn DefaultUni DefaultFun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      (Term NamedDeBruijn DefaultUni DefaultFun ()),
    CountingSt, LogOutput)
forall (uni :: * -&gt; *) fun cost.
(Everywhere uni ExMemoryUsage, Ix fun, PrettyUni uni fun) =&gt;
MachineParameters CekMachineCosts CekValue uni fun
-&gt; ExBudgetMode cost uni fun
-&gt; EmitterMode uni fun
-&gt; Term NamedDeBruijn uni fun ()
-&gt; (Either
      (CekEvaluationException NamedDeBruijn uni fun)
      (Term NamedDeBruijn uni fun ()),
    cost, LogOutput)
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.runCekDeBruijn</span></a></span><span>
</span><span id="line-341"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolVersion -&gt; EvaluationContext -&gt; DefaultMachineParameters
</span><a href="Plutus.ApiCommon.html#toMachineParameters"><span class="hs-identifier hs-var">toMachineParameters</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolVersion
</span><a href="#local-6989586621679745005"><span class="hs-identifier hs-var">pv</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationContext
</span><a href="#local-6989586621679745003"><span class="hs-identifier hs-var">ectx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>                </span><span class="annot"><span class="annottext">ExBudgetMode CountingSt DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. ExBudgetMode CountingSt uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.counting</span></a></span><span>
</span><span id="line-343"></span><span>                </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="#local-6989586621679745004"><span class="hs-identifier hs-var">verbose</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode -&gt; VerboseMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseMode
</span><a href="Plutus.ApiCommon.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.logEmitter</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EmitterMode DefaultUni DefaultFun
forall (uni :: * -&gt; *) fun. EmitterMode uni fun
</span><a href="../../../../plutus-core/html/src"><span class="hs-identifier hs-var">UPLC.noEmitter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                </span><span class="annot"><span class="annottext">Term NamedDeBruijn DefaultUni DefaultFun ()
</span><a href="#local-6989586621679745000"><span class="hs-identifier hs-var">appliedTerm</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">LogOutput
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">tell</span></a></span><span> </span><span class="annot"><span class="annottext">LogOutput
</span><a href="#local-6989586621679744996"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">liftEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either EvaluationError ()
 -&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ())
-&gt; Either EvaluationError ()
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
 -&gt; EvaluationError)
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; EvaluationError
</span><a href="Plutus.ApiCommon.html#CekError"><span class="hs-identifier hs-var">CekError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
 -&gt; Either EvaluationError ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
-&gt; Either EvaluationError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
-&gt; Either
     (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
  (Term NamedDeBruijn DefaultUni DefaultFun ())
</span><a href="#local-6989586621679744999"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">ExBudget
-&gt; ExceptT EvaluationError (WriterT LogOutput Identity) ExBudget
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><a href="#local-6989586621679744997"><span class="hs-identifier hs-var">final</span></a></span><span>
</span><span id="line-349"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase         #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns     #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns       #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-simplifiable-class-constraints #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-specialise #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-omit-interface-pragmas #-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ledger.Constraints.OnChain.V1</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkScriptContext"><span class="hs-identifier">checkScriptContext</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnInputConstraint"><span class="hs-identifier">checkOwnInputConstraint</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnOutputConstraint"><span class="hs-identifier">checkOwnOutputConstraint</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">toBuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Bool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">True</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(==)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">fmap</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Just</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">all</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">elem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>                         </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">snd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">traceIfFalse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">($)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(&amp;&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKeyHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">unPaymentPubKeyHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html"><span class="hs-identifier">Ledger.Constraints.TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptInputConstraint"><span class="hs-identifier">ScriptInputConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptInputConstraint"><span class="hs-identifier">ScriptInputConstraint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#icRedeemer"><span class="hs-identifier">icRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#icReferenceTxOutRef"><span class="hs-identifier">icReferenceTxOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#icTxOutRef"><span class="hs-identifier">icTxOutRef</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptOutputConstraint"><span class="hs-identifier">ScriptOutputConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptOutputConstraint"><span class="hs-identifier">ScriptOutputConstraint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ocDatum"><span class="hs-identifier">ocDatum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ocReferenceScriptHash"><span class="hs-identifier">ocReferenceScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ocValue"><span class="hs-identifier">ocValue</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraint"><span class="hs-identifier">TxConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustBeSignedBy"><span class="hs-identifier">MustBeSignedBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustIncludeDatumInTx"><span class="hs-identifier">MustIncludeDatumInTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustIncludeDatumInTxWithHash"><span class="hs-identifier">MustIncludeDatumInTxWithHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustMintValue"><span class="hs-identifier">MustMintValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustPayToAddress"><span class="hs-identifier">MustPayToAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustProduceAtLeast"><span class="hs-identifier">MustProduceAtLeast</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustReferenceOutput"><span class="hs-identifier">MustReferenceOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSatisfyAnyOf"><span class="hs-identifier">MustSatisfyAnyOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendAtLeast"><span class="hs-identifier">MustSpendAtLeast</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendPubKeyOutput"><span class="hs-identifier">MustSpendPubKeyOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendScriptOutput"><span class="hs-identifier">MustSpendScriptOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustUseOutputAsCollateral"><span class="hs-identifier">MustUseOutputAsCollateral</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustValidateInTimeRange"><span class="hs-identifier">MustValidateInTimeRange</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraintFun"><span class="hs-identifier">TxConstraintFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendScriptOutputWithMatchingDatumAndValue"><span class="hs-identifier">MustSpendScriptOutputWithMatchingDatumAndValue</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraintFuns"><span class="hs-identifier">TxConstraintFuns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraintFuns"><span class="hs-identifier">TxConstraintFuns</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraints"><span class="hs-identifier">TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraints"><span class="hs-identifier">TxConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#txConstraintFuns"><span class="hs-identifier">txConstraintFuns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#txConstraints"><span class="hs-identifier">txConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#txOwnInputs"><span class="hs-identifier">txOwnInputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#txOwnOutputs"><span class="hs-identifier">txOwnOutputs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                                         </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxOutDatum"><span class="hs-identifier">TxOutDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxOutDatumHash"><span class="hs-identifier">TxOutDatumHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxOutDatumInTx"><span class="hs-identifier">TxOutDatumInTx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Ledger.Constraints.ValidityInterval.html"><span class="hs-identifier">Ledger.Constraints.ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.ValidityInterval.html#toPlutusInterval"><span class="hs-identifier">toPlutusInterval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Credential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">ScriptCredential</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">leq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Plutus.Script.Utils.V1.Contexts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">ScriptContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">ScriptContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>                                        </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxInInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxInInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txInInfoResolved</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                                        </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txInfoData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txInfoInputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txInfoMint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txInfoValidRange</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                                        </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txOutAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">txOutDatumHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Plutus.Script.Utils.V1.Contexts</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Interval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">contains</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkScriptContext"><span class="hs-pragma hs-type">checkScriptContext</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Does the 'ScriptContext' satisfy the constraints?</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkScriptContext"><span class="hs-identifier hs-type">checkScriptContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679561813"><span class="annot"><a href="#local-6989586621679561813"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679561812"><span class="annot"><a href="#local-6989586621679561812"><span class="hs-identifier hs-type">o</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561813"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561812"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraints"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561813"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561812"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-45"></span><span id="checkScriptContext"><span class="annot"><span class="annottext">checkScriptContext :: TxConstraints i o -&gt; ScriptContext -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkScriptContext"><span class="hs-identifier hs-var hs-var">checkScriptContext</span></a></span></span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraints"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561811"><span class="annot"><span class="annottext">[TxConstraint]
txConstraints :: [TxConstraint]
txConstraints :: forall i o. TxConstraints i o -&gt; [TxConstraint]
</span><a href="#local-6989586621679561811"><span class="hs-identifier hs-var hs-var">txConstraints</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txConstraintFuns :: forall i o. TxConstraints i o -&gt; TxConstraintFuns
</span><a href="Ledger.Constraints.TxConstraints.html#txConstraintFuns"><span class="hs-identifier hs-var">txConstraintFuns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraintFuns"><span class="hs-identifier hs-type">TxConstraintFuns</span></a></span><span> </span><span id="local-6989586621679561810"><span class="annot"><span class="annottext">[TxConstraintFun]
</span><a href="#local-6989586621679561810"><span class="hs-identifier hs-var">txCnsFuns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561809"><span class="annot"><span class="annottext">[ScriptInputConstraint i]
txOwnInputs :: [ScriptInputConstraint i]
txOwnInputs :: forall i o. TxConstraints i o -&gt; [ScriptInputConstraint i]
</span><a href="#local-6989586621679561809"><span class="hs-identifier hs-var hs-var">txOwnInputs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561808"><span class="annot"><span class="annottext">[ScriptOutputConstraint o]
txOwnOutputs :: [ScriptOutputConstraint o]
txOwnOutputs :: forall i o. TxConstraints i o -&gt; [ScriptOutputConstraint o]
</span><a href="#local-6989586621679561808"><span class="hs-identifier hs-var hs-var">txOwnOutputs</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679561807"><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561807"><span class="hs-identifier hs-var">ptx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L!&quot;</span></span><span> </span><span class="hs-comment">-- &quot;checkScriptContext failed&quot;</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxConstraint -&gt; Bool) -&gt; [TxConstraint] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; TxConstraint -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-var">checkTxConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561807"><span class="hs-identifier hs-var">ptx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679561811"><span class="hs-identifier hs-var">txConstraints</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(TxConstraintFun -&gt; Bool) -&gt; [TxConstraintFun] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; TxConstraintFun -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraintFun"><span class="hs-identifier hs-var">checkTxConstraintFun</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561807"><span class="hs-identifier hs-var">ptx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxConstraintFun]
</span><a href="#local-6989586621679561810"><span class="hs-identifier hs-var">txCnsFuns</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptInputConstraint i -&gt; Bool)
-&gt; [ScriptInputConstraint i] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; ScriptInputConstraint i -&gt; Bool
forall i.
ToData i =&gt;
ScriptContext -&gt; ScriptInputConstraint i -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkOwnInputConstraint"><span class="hs-identifier hs-var">checkOwnInputConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561807"><span class="hs-identifier hs-var">ptx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ScriptInputConstraint i]
</span><a href="#local-6989586621679561809"><span class="hs-identifier hs-var">txOwnInputs</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptOutputConstraint o -&gt; Bool)
-&gt; [ScriptOutputConstraint o] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; ScriptOutputConstraint o -&gt; Bool
forall o.
ToData o =&gt;
ScriptContext -&gt; ScriptOutputConstraint o -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkOwnOutputConstraint"><span class="hs-identifier hs-var">checkOwnOutputConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561807"><span class="hs-identifier hs-var">ptx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ScriptOutputConstraint o]
</span><a href="#local-6989586621679561808"><span class="hs-identifier hs-var">txOwnOutputs</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnInputConstraint"><span class="hs-pragma hs-type">checkOwnInputConstraint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-53"></span><span id="local-6989586621679561927"><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnInputConstraint"><span class="hs-identifier hs-type">checkOwnInputConstraint</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561927"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptInputConstraint"><span class="hs-identifier hs-type">ScriptInputConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561927"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-58"></span><span id="checkOwnInputConstraint"><span class="annot"><span class="annottext">checkOwnInputConstraint :: ScriptContext -&gt; ScriptInputConstraint i -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkOwnInputConstraint"><span class="hs-identifier hs-var hs-var">checkOwnInputConstraint</span></a></span></span><span> </span><span id="local-6989586621679561804"><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561804"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptInputConstraint"><span class="hs-identifier hs-type">ScriptInputConstraint</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561803"><span class="annot"><span class="annottext">TxOutRef
icTxOutRef :: TxOutRef
icTxOutRef :: forall a. ScriptInputConstraint a -&gt; TxOutRef
</span><a href="#local-6989586621679561803"><span class="hs-identifier hs-var hs-var">icTxOutRef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561802"><span class="annot"><span class="annottext">i
icRedeemer :: i
icRedeemer :: forall a. ScriptInputConstraint a -&gt; a
</span><a href="#local-6989586621679561802"><span class="hs-identifier hs-var hs-var">icRedeemer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561801"><span class="annot"><span class="annottext">Maybe TxOutRef
icReferenceTxOutRef :: Maybe TxOutRef
icReferenceTxOutRef :: forall a. ScriptInputConstraint a -&gt; Maybe TxOutRef
</span><a href="#local-6989586621679561801"><span class="hs-identifier hs-var hs-var">icReferenceTxOutRef</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L0&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Input constraint&quot;</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext -&gt; TxConstraint -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-var">checkTxConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561804"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; Redeemer -&gt; Maybe TxOutRef -&gt; TxConstraint
</span><a href="Ledger.Constraints.TxConstraints.html#MustSpendScriptOutput"><span class="hs-identifier hs-var">MustSpendScriptOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679561803"><span class="hs-identifier hs-var">icTxOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Redeemer
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Ledger.Redeemer</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Redeemer) -&gt; BuiltinData -&gt; Redeemer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679561802"><span class="hs-identifier hs-var">icRedeemer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679561801"><span class="hs-identifier hs-var">icReferenceTxOutRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnOutputConstraint"><span class="hs-pragma hs-type">checkOwnOutputConstraint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-63"></span><span id="local-6989586621679561925"><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkOwnOutputConstraint"><span class="hs-identifier hs-type">checkOwnOutputConstraint</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561925"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptOutputConstraint"><span class="hs-identifier hs-type">ScriptOutputConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679561925"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-68"></span><span id="checkOwnOutputConstraint"><span class="annot"><span class="annottext">checkOwnOutputConstraint :: ScriptContext -&gt; ScriptOutputConstraint o -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkOwnOutputConstraint"><span class="hs-identifier hs-var hs-var">checkOwnOutputConstraint</span></a></span></span><span> </span><span id="local-6989586621679561799"><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561799"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#ScriptOutputConstraint"><span class="hs-identifier hs-type">ScriptOutputConstraint</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561798"><span class="annot"><span class="annottext">TxOutDatum o
ocDatum :: TxOutDatum o
ocDatum :: forall a. ScriptOutputConstraint a -&gt; TxOutDatum a
</span><a href="#local-6989586621679561798"><span class="hs-identifier hs-var hs-var">ocDatum</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561797"><span class="annot"><span class="annottext">Value
ocValue :: Value
ocValue :: forall a. ScriptOutputConstraint a -&gt; Value
</span><a href="#local-6989586621679561797"><span class="hs-identifier hs-var hs-var">ocValue</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679561796"><span class="annot"><span class="annottext">Maybe ScriptHash
ocReferenceScriptHash :: Maybe ScriptHash
ocReferenceScriptHash :: forall a. ScriptOutputConstraint a -&gt; Maybe ScriptHash
</span><a href="#local-6989586621679561796"><span class="hs-identifier hs-var hs-var">ocReferenceScriptHash</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679561795"><span class="annot"><span class="annottext">d :: TxOutDatum Datum
</span><a href="#local-6989586621679561795"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(o -&gt; Datum) -&gt; TxOutDatum o -&gt; TxOutDatum Datum
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Ledger.Datum</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; (o -&gt; BuiltinData) -&gt; o -&gt; Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOutDatum o
</span><a href="#local-6989586621679561798"><span class="hs-identifier hs-var">ocDatum</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L1&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Output constraint&quot;</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (TxInInfo -&gt; Bool) -&gt; Maybe TxInInfo -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxInInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txInInfoResolved :: TxInInfo -&gt; TxOut
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">txInInfoResolved</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561793"><span class="annot"><span class="annottext">Address
txOutAddress :: Address
txOutAddress :: TxOut -&gt; Address
</span><a href="#local-6989586621679561793"><span class="hs-identifier hs-var hs-var">txOutAddress</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>                        </span><span class="annot"><span class="annottext">ScriptContext -&gt; TxConstraint -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-var">checkTxConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561799"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address
-&gt; Maybe (TxOutDatum Datum)
-&gt; Maybe ScriptHash
-&gt; Value
-&gt; TxConstraint
</span><a href="Ledger.Constraints.TxConstraints.html#MustPayToAddress"><span class="hs-identifier hs-var">MustPayToAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679561793"><span class="hs-identifier hs-var">txOutAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutDatum Datum -&gt; Maybe (TxOutDatum Datum)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum Datum
</span><a href="#local-6989586621679561795"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679561796"><span class="hs-identifier hs-var">ocReferenceScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561797"><span class="hs-identifier hs-var">ocValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; Maybe TxInInfo
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findOwnInput</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561799"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-pragma hs-type">checkTxConstraint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-type">checkTxConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraint"><span class="hs-identifier hs-type">TxConstraint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-77"></span><span id="checkTxConstraint"><span class="annot"><span class="annottext">checkTxConstraint :: ScriptContext -&gt; TxConstraint -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-var hs-var">checkTxConstraint</span></a></span></span><span> </span><span id="local-6989586621679561791"><span class="annot"><span class="annottext">ctx :: ScriptContext
</span><a href="#local-6989586621679561791"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561790"><span class="annot"><span class="annottext">TxInfo
scriptContextTxInfo :: TxInfo
scriptContextTxInfo :: ScriptContext -&gt; TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var hs-var">scriptContextTxInfo</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustIncludeDatumInTx"><span class="hs-identifier hs-type">MustIncludeDatumInTx</span></a></span><span> </span><span id="local-6989586621679561789"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561789"><span class="hs-identifier hs-var">dv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L2&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Missing datum&quot;</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561789"><span class="hs-identifier hs-var">dv</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; [Datum] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">((DatumHash, Datum) -&gt; Datum) -&gt; [(DatumHash, Datum)] -&gt; [Datum]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHash, Datum) -&gt; Datum
forall a b. (a, b) -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxInfo -&gt; [(DatumHash, Datum)]
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInfoData</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustValidateInTimeRange"><span class="hs-identifier hs-type">MustValidateInTimeRange</span></a></span><span> </span><span id="local-6989586621679561788"><span class="annot"><span class="annottext">ValidityInterval POSIXTime
</span><a href="#local-6989586621679561788"><span class="hs-identifier hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L3&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Wrong validation interval&quot;</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval POSIXTime -&gt; Interval POSIXTime
forall a. ValidityInterval a -&gt; Interval a
</span><a href="Ledger.Constraints.ValidityInterval.html#toPlutusInterval"><span class="hs-identifier hs-var">toPlutusInterval</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval POSIXTime
</span><a href="#local-6989586621679561788"><span class="hs-identifier hs-var">interval</span></a></span><span> </span><span class="annot"><span class="annottext">Interval POSIXTime -&gt; Interval POSIXTime -&gt; Bool
forall a. Ord a =&gt; Interval a -&gt; Interval a -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-operator hs-var">`contains`</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; Interval POSIXTime
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInfoValidRange</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustBeSignedBy"><span class="hs-identifier hs-type">MustBeSignedBy</span></a></span><span> </span><span id="local-6989586621679561787"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621679561787"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L4&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Missing signature&quot;</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; PubKeyHash -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-operator hs-var">`V.txSignedBy`</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; PubKeyHash
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var hs-var">unPaymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621679561787"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendAtLeast"><span class="hs-identifier hs-type">MustSpendAtLeast</span></a></span><span> </span><span id="local-6989586621679561785"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561785"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L5&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Spent value not OK&quot;</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561785"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-operator hs-var">`leq`</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; Value
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.valueSpent</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustProduceAtLeast"><span class="hs-identifier hs-type">MustProduceAtLeast</span></a></span><span> </span><span id="local-6989586621679561783"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561783"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L6&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Produced value not OK&quot;</span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561783"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-operator hs-var">`leq`</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; Value
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.valueProduced</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendPubKeyOutput"><span class="hs-identifier hs-type">MustSpendPubKeyOutput</span></a></span><span> </span><span id="local-6989586621679561781"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679561781"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L7&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Public key output not spent&quot;</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (TxInInfo -&gt; Bool) -&gt; Maybe TxInInfo -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DatumHash -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DatumHash -&gt; Bool)
-&gt; (TxInInfo -&gt; Maybe DatumHash) -&gt; TxInInfo -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Maybe DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Maybe DatumHash)
-&gt; (TxInInfo -&gt; TxOut) -&gt; TxInInfo -&gt; Maybe DatumHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxInInfo -&gt; TxOut
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInInfoResolved</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; TxInfo -&gt; Maybe TxInInfo
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findTxInByTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679561781"><span class="hs-identifier hs-var">txOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendScriptOutput"><span class="hs-identifier hs-type">MustSpendScriptOutput</span></a></span><span> </span><span id="local-6989586621679561779"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679561779"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L8&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Script output not spent&quot;</span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-comment">-- Unfortunately we can't check the redeemer, because TxInfo only</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-comment">-- gives us the redeemer's hash, but 'MustSpendScriptOutput' gives</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-comment">-- us the full redeemer</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxInInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; TxInfo -&gt; Maybe TxInInfo
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findTxInByTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679561779"><span class="hs-identifier hs-var">txOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustMintValue"><span class="hs-identifier hs-type">MustMintValue</span></a></span><span> </span><span id="local-6989586621679561778"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679561778"><span class="hs-identifier hs-var">mps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679561777"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679561777"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span id="local-6989586621679561776"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679561776"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;L9&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Value minted not OK&quot;</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; CurrencySymbol -&gt; TokenName -&gt; Integer
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.valueOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxInfo -&gt; Value
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInfoMint</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; CurrencySymbol
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.mpsSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679561778"><span class="hs-identifier hs-var">mps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679561777"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679561776"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustPayToAddress"><span class="hs-identifier hs-type">MustPayToAddress</span></a></span><span> </span><span id="local-6989586621679561773"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679561773"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679561772"><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum)
</span><a href="#local-6989586621679561772"><span class="hs-identifier hs-var">mdv</span></a></span></span><span> </span><span id="local-6989586621679561771"><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679561771"><span class="hs-identifier hs-var">refScript</span></a></span></span><span> </span><span id="local-6989586621679561770"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561770"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679561769"><span class="annot"><span class="annottext">outs :: [TxOut]
</span><a href="#local-6989586621679561769"><span class="hs-identifier hs-var hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; [TxOut]
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">V.txInfoOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-107"></span><span>            </span><span id="local-6989586621679561767"><span class="annot"><span class="annottext">hsh :: Datum -&gt; Maybe DatumHash
</span><a href="#local-6989586621679561767"><span class="hs-identifier hs-var hs-var">hsh</span></a></span></span><span> </span><span id="local-6989586621679561766"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561766"><span class="hs-identifier hs-var">dv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; TxInfo -&gt; Maybe DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561766"><span class="hs-identifier hs-var">dv</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-108"></span><span>            </span><span id="local-6989586621679561764"><span class="annot"><span class="annottext">checkOutput :: TxOutDatum Datum -&gt; TxOut -&gt; Bool
</span><a href="#local-6989586621679561764"><span class="hs-identifier hs-var hs-var">checkOutput</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxOutDatumHash"><span class="hs-identifier hs-type">TxOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutDatumHash :: TxOut -&gt; Maybe DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">txOutDatumHash</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>                </span><span class="hs-comment">-- The datum is not added in the tx body with so we can't verify</span><span>
</span><span id="line-110"></span><span>                </span><span class="hs-comment">-- that the tx output's datum hash is the correct one w.r.t the</span><span>
</span><span id="line-111"></span><span>                </span><span class="hs-comment">-- provide datum.</span><span>
</span><span id="line-112"></span><span>                </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><a href="#local-6989586621679561764"><span class="hs-identifier hs-var">checkOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxOutDatumInTx"><span class="hs-identifier hs-type">TxOutDatumInTx</span></a></span><span> </span><span id="local-6989586621679561763"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561763"><span class="hs-identifier hs-var">dv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutDatumHash :: TxOut -&gt; Maybe DatumHash
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">txOutDatumHash</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679561762"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561762"><span class="hs-identifier hs-var">svh</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>                </span><span class="annot"><span class="annottext">Datum -&gt; Maybe DatumHash
</span><a href="#local-6989586621679561767"><span class="hs-identifier hs-var">hsh</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561763"><span class="hs-identifier hs-var">dv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash -&gt; Maybe DatumHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Maybe DatumHash
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561762"><span class="hs-identifier hs-var">svh</span></a></span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><a href="#local-6989586621679561764"><span class="hs-identifier hs-var">checkOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum Datum
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;La&quot;</span></span><span> </span><span class="hs-comment">-- &quot;MustPayToAddress&quot;</span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561770"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-operator hs-var">`leq`</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo -&gt; Address -&gt; Value
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">V.valuePaidTo</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679561773"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (TxOutDatum Datum -&gt; Bool) -&gt; Maybe (TxOutDatum Datum) -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679561760"><span class="annot"><span class="annottext">TxOutDatum Datum
</span><a href="#local-6989586621679561760"><span class="hs-identifier hs-var">dv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Bool) -&gt; [TxOut] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutDatum Datum -&gt; TxOut -&gt; Bool
</span><a href="#local-6989586621679561764"><span class="hs-identifier hs-var">checkOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum Datum
</span><a href="#local-6989586621679561760"><span class="hs-identifier hs-var">dv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679561769"><span class="hs-identifier hs-var">outs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum)
</span><a href="#local-6989586621679561772"><span class="hs-identifier hs-var">mdv</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679561771"><span class="hs-identifier hs-var">refScript</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustIncludeDatumInTxWithHash"><span class="hs-identifier hs-type">MustIncludeDatumInTxWithHash</span></a></span><span> </span><span id="local-6989586621679561759"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561759"><span class="hs-identifier hs-var">dvh</span></a></span></span><span> </span><span id="local-6989586621679561758"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561758"><span class="hs-identifier hs-var">dv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;Lc&quot;</span></span><span> </span><span class="hs-comment">-- &quot;missing datum&quot;</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; TxInfo -&gt; Maybe Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561759"><span class="hs-identifier hs-var">dvh</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561790"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; Maybe Datum -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561758"><span class="hs-identifier hs-var">dv</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSatisfyAnyOf"><span class="hs-identifier hs-type">MustSatisfyAnyOf</span></a></span><span> </span><span id="local-6989586621679561756"><span class="annot"><span class="annottext">[[TxConstraint]]
</span><a href="#local-6989586621679561756"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;Ld&quot;</span></span><span> </span><span class="hs-comment">-- &quot;MustSatisfyAnyOf&quot;</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([TxConstraint] -&gt; Bool) -&gt; [[TxConstraint]] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxConstraint -&gt; Bool) -&gt; [TxConstraint] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptContext -&gt; TxConstraint -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraint"><span class="hs-identifier hs-var">checkTxConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptContext
</span><a href="#local-6989586621679561791"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TxConstraint]]
</span><a href="#local-6989586621679561756"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustUseOutputAsCollateral"><span class="hs-identifier hs-type">MustUseOutputAsCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-comment">-- TxInfo does not have the collateral inputs</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustReferenceOutput"><span class="hs-identifier hs-type">MustReferenceOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;Lf&quot;</span></span><span> </span><span class="hs-comment">-- &quot;Cannot use reference inputs in PlutusV1.ScriptContext&quot;</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraintFun"><span class="hs-pragma hs-type">checkTxConstraintFun</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraintFun"><span class="hs-identifier hs-type">checkTxConstraintFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#TxConstraintFun"><span class="hs-identifier hs-type">TxConstraintFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-135"></span><span id="checkTxConstraintFun"><span class="annot"><span class="annottext">checkTxConstraintFun :: ScriptContext -&gt; TxConstraintFun -&gt; Bool
</span><a href="Ledger.Constraints.OnChain.V1.html#checkTxConstraintFun"><span class="hs-identifier hs-var hs-var">checkTxConstraintFun</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679561755"><span class="annot"><span class="annottext">TxInfo
scriptContextTxInfo :: TxInfo
scriptContextTxInfo :: ScriptContext -&gt; TxInfo
</span><a href="#local-6989586621679561755"><span class="hs-identifier hs-var hs-var">scriptContextTxInfo</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="Ledger.Constraints.TxConstraints.html#MustSpendScriptOutputWithMatchingDatumAndValue"><span class="hs-identifier hs-type">MustSpendScriptOutputWithMatchingDatumAndValue</span></a></span><span> </span><span id="local-6989586621679561754"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679561754"><span class="hs-identifier hs-var">vh</span></a></span></span><span> </span><span id="local-6989586621679561753"><span class="annot"><span class="annottext">Datum -&gt; Bool
</span><a href="#local-6989586621679561753"><span class="hs-identifier hs-var">datumPred</span></a></span></span><span> </span><span id="local-6989586621679561752"><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679561752"><span class="hs-identifier hs-var">valuePred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679561751"><span class="annot"><span class="annottext">findDatum :: Maybe DatumHash -&gt; Maybe Datum
</span><a href="#local-6989586621679561751"><span class="hs-identifier hs-var hs-var">findDatum</span></a></span></span><span> </span><span id="local-6989586621679561750"><span class="annot"><span class="annottext">Maybe DatumHash
</span><a href="#local-6989586621679561750"><span class="hs-identifier hs-var">mdh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>                </span><span id="local-6989586621679561749"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561749"><span class="hs-identifier hs-var">dh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
</span><a href="#local-6989586621679561750"><span class="hs-identifier hs-var">mdh</span></a></span><span>
</span><span id="line-139"></span><span>                </span><span class="annot"><span class="annottext">DatumHash -&gt; TxInfo -&gt; Maybe Datum
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">V.findDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679561749"><span class="hs-identifier hs-var">dh</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561755"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span>
</span><span id="line-140"></span><span>            </span><span id="local-6989586621679561748"><span class="annot"><span class="annottext">isMatch :: TxOut -&gt; Bool
</span><a href="#local-6989586621679561748"><span class="hs-identifier hs-var hs-var">isMatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptCredential</span></a></span><span> </span><span id="local-6989586621679561746"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679561746"><span class="hs-identifier hs-var">vh'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679561745"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561745"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DatumHash -&gt; Maybe Datum
</span><a href="#local-6989586621679561751"><span class="hs-identifier hs-var">findDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679561744"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561744"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>                </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679561754"><span class="hs-identifier hs-var">vh</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; ValidatorHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679561746"><span class="hs-identifier hs-var">vh'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679561752"><span class="hs-identifier hs-var">valuePred</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679561745"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Bool
</span><a href="#local-6989586621679561753"><span class="hs-identifier hs-var">datumPred</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679561744"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-142"></span><span>            </span><span class="annot"><a href="#local-6989586621679561748"><span class="hs-identifier hs-var">isMatch</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">BuiltinString -&gt; Bool -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">traceIfFalse</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinString
</span><span class="hs-string">&quot;Le&quot;</span></span><span> </span><span class="hs-comment">-- &quot;MustSpendScriptOutputWithMatchingDatumAndValue&quot;</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInInfo -&gt; Bool) -&gt; [TxInInfo] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Bool
</span><a href="#local-6989586621679561748"><span class="hs-identifier hs-var">isMatch</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Bool) -&gt; (TxInInfo -&gt; TxOut) -&gt; TxInInfo -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxInInfo -&gt; TxOut
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInInfoResolved</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxInfo -&gt; [TxInInfo]
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">txInfoInputs</span></a></span><span> </span><span class="annot"><span class="annottext">TxInfo
</span><a href="#local-6989586621679561755"><span class="hs-identifier hs-var">scriptContextTxInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Node.Mock</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">threadDelay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent.MVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">modifyMVar_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">putMVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">takeMVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">over</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">unto</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forever</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Eff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">LastMember</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">interpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">reinterpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">handleZoomedState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Reader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.State</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Writer</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier">Data.Time.Units</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier">Millisecond</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier">toMicroseconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Data.Time.Units.Extra</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">Servant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">NoContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier">NoContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Chain.html"><span class="hs-identifier">Cardano.Chain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Chain.html#handleChain"><span class="hs-identifier">handleChain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Chain.html#handleControlChain"><span class="hs-identifier">handleControlChain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Chain</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Chain</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Params</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.TimeSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">SlotConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">SlotConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">scSlotLength</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">currentSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html"><span class="hs-identifier">Cardano.Node.Types</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html"><span class="hs-identifier">Cardano.Protocol.Socket.Mock.Client</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Client</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Server.html"><span class="hs-identifier">Cardano.Protocol.Socket.Mock.Server</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Server</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Arbitrary.html"><span class="hs-identifier">Plutus.PAB.Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.Monitoring.html"><span class="hs-identifier">Plutus.PAB.Monitoring.Monitoring</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LM</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621680390325"><span class="annot"><a href="Cardano.Node.Mock.html#healthcheck"><span class="hs-identifier hs-type">healthcheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680390325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span></span><span>
</span><span id="line-42"></span><span id="healthcheck"><span class="annot"><span class="annottext">healthcheck :: m NoContent
</span><a href="Cardano.Node.Mock.html#healthcheck"><span class="hs-identifier hs-var hs-var">healthcheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NoContent -&gt; m NoContent
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">NoContent
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">NoContent</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621680390323"><span class="annot"><a href="Cardano.Node.Mock.html#consumeEventHistory"><span class="hs-identifier hs-type">consumeEventHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680390323"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-45"></span><span id="consumeEventHistory"><span class="annot"><span class="annottext">consumeEventHistory :: MVar AppState -&gt; m [LogMessage PABServerLogMsg]
</span><a href="Cardano.Node.Mock.html#consumeEventHistory"><span class="hs-identifier hs-var hs-var">consumeEventHistory</span></a></span></span><span> </span><span id="local-6989586621680390321"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390321"><span class="hs-identifier hs-var">stateVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="annottext">IO [LogMessage PABServerLogMsg] -&gt; m [LogMessage PABServerLogMsg]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [LogMessage PABServerLogMsg] -&gt; m [LogMessage PABServerLogMsg])
-&gt; IO [LogMessage PABServerLogMsg]
-&gt; m [LogMessage PABServerLogMsg]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-47"></span><span>        </span><span id="local-6989586621680390320"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390320"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar AppState -&gt; IO AppState
forall a. MVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390321"><span class="hs-identifier hs-var">stateVar</span></a></span><span>
</span><span id="line-48"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680390319"><span class="annot"><span class="annottext">events :: [LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390319"><span class="hs-identifier hs-var hs-var">events</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  [LogMessage PABServerLogMsg] AppState [LogMessage PABServerLogMsg]
-&gt; AppState -&gt; [LogMessage PABServerLogMsg]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  [LogMessage PABServerLogMsg] AppState [LogMessage PABServerLogMsg]
Lens' AppState [LogMessage PABServerLogMsg]
</span><a href="Cardano.Node.Types.html#eventHistory"><span class="hs-identifier hs-var">eventHistory</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390320"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-49"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680390317"><span class="annot"><span class="annottext">newState :: AppState
</span><a href="#local-6989586621680390317"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  AppState
  AppState
  [LogMessage PABServerLogMsg]
  [LogMessage PABServerLogMsg]
-&gt; [LogMessage PABServerLogMsg] -&gt; AppState -&gt; AppState
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter
  AppState
  AppState
  [LogMessage PABServerLogMsg]
  [LogMessage PABServerLogMsg]
Lens' AppState [LogMessage PABServerLogMsg]
</span><a href="Cardano.Node.Types.html#eventHistory"><span class="hs-identifier hs-var">eventHistory</span></a></span><span> </span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390320"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="annottext">MVar AppState -&gt; AppState -&gt; IO ()
forall a. MVar a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390321"><span class="hs-identifier hs-var">stateVar</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390317"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg] -&gt; IO [LogMessage PABServerLogMsg]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390319"><span class="hs-identifier hs-var">events</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span id="local-6989586621680390315"><span id="local-6989586621680390316"><span class="annot"><a href="Cardano.Node.Mock.html#addTx"><span class="hs-identifier hs-type">addTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680390316"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html#TxSendHandle"><span class="hs-identifier hs-type">Client.TxSendHandle</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680390316"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390315"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390315"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390316"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Tx</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390316"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-type">NoContent</span></a></span></span></span><span>
</span><span id="line-60"></span><span id="addTx"><span class="annot"><span class="annottext">addTx :: Tx BabbageEra -&gt; Eff effs NoContent
</span><a href="Cardano.Node.Mock.html#addTx"><span class="hs-identifier hs-var hs-var">addTx</span></a></span></span><span> </span><span id="local-6989586621680390313"><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621680390313"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">PABServerLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(PABServerLogMsg -&gt; Eff effs ()) -&gt; PABServerLogMsg -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockEvent -&gt; PABServerLogMsg
</span><a href="Cardano.Node.Types.html#BlockOperation"><span class="hs-identifier hs-var">BlockOperation</span></a></span><span> </span><span class="annot"><span class="annottext">(BlockEvent -&gt; PABServerLogMsg) -&gt; BlockEvent -&gt; PABServerLogMsg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; BlockEvent
</span><a href="Cardano.Node.Types.html#NewTransaction"><span class="hs-identifier hs-var">NewTransaction</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621680390313"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621680390309"><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390309"><span class="hs-identifier hs-var">clientHandler</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs (Maybe TxSendHandle)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Eff.ask</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390309"><span class="hs-identifier hs-var">clientHandler</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABServerLogMsg -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="annot"><span class="annottext">PABServerLogMsg
</span><a href="Cardano.Node.Types.html#TxSendCalledWithoutMock"><span class="hs-identifier hs-var">TxSendCalledWithoutMock</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680390305"><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680390305"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-66"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSendHandle -&gt; Tx BabbageEra -&gt; IO ()
</span><a href="Cardano.Protocol.Socket.Mock.Client.html#queueTx"><span class="hs-identifier hs-var">Client.queueTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680390305"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621680390313"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">NoContent -&gt; Eff effs NoContent
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">NoContent
</span><a href="../file:///nix/store/vyn800dwc7jzx9nlwjw9m6vsd46p5skc-servant-lib-servant-0.18.3-haddock-doc/share/doc/servant/html/src"><span class="hs-identifier hs-var">NoContent</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Run all chain effects in the IO Monad</span><span>
</span><span id="line-70"></span><span id="local-6989586621680390381"><span class="annot"><a href="Cardano.Node.Mock.html#runChainEffects"><span class="hs-identifier hs-type">runChainEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-71"></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span>
</span><span id="line-72"></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-73"></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html#TxSendHandle"><span class="hs-identifier hs-type">Client.TxSendHandle</span></a></span><span>
</span><span id="line-74"></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span>
</span><span id="line-75"></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#NodeServerEffects"><span class="hs-identifier hs-type">NodeServerEffects</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680390381"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-76"></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680390381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-77"></span><span id="runChainEffects"><span class="annot"><span class="annottext">runChainEffects :: Trace IO PABServerLogMsg
-&gt; Params
-&gt; Maybe TxSendHandle
-&gt; MVar AppState
-&gt; Eff (NodeServerEffects IO) a
-&gt; IO ([LogMessage PABServerLogMsg], a)
</span><a href="Cardano.Node.Mock.html#runChainEffects"><span class="hs-identifier hs-var hs-var">runChainEffects</span></a></span></span><span> </span><span id="local-6989586621680390302"><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
</span><a href="#local-6989586621680390302"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621680390301"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680390301"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680390300"><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390300"><span class="hs-identifier hs-var">clientHandler</span></a></span></span><span> </span><span id="local-6989586621680390299"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390299"><span class="hs-identifier hs-var">stateVar</span></a></span></span><span> </span><span id="local-6989586621680390298"><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
</span><a href="#local-6989586621680390298"><span class="hs-identifier hs-var">eff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621680390297"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390297"><span class="hs-identifier hs-var">oldAppState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO AppState -&gt; IO AppState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO AppState -&gt; IO AppState) -&gt; IO AppState -&gt; IO AppState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState -&gt; IO AppState
forall a. MVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390299"><span class="hs-identifier hs-var">stateVar</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680390296"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680390296"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680390295"><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390295"><span class="hs-identifier hs-var">events</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680390294"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390294"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ((a, [LogMessage PABServerLogMsg]), AppState)
-&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-80"></span><span>            </span><span class="annot"><span class="annottext">(IO ((a, [LogMessage PABServerLogMsg]), AppState)
 -&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState))
-&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState)
-&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a -&gt; Eff (NodeServerEffects IO) a
forall (effs :: [* -&gt; *]) b.
FindElem ChainControlEffect effs =&gt;
Eff effs b -&gt; Eff effs b
</span><a href="#local-6989586621680390293"><span class="hs-identifier hs-var">processBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
</span><a href="#local-6989586621680390298"><span class="hs-identifier hs-var">eff</span></a></span><span>
</span><span id="line-81"></span><span>            </span><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
-&gt; (Eff (NodeServerEffects IO) a
    -&gt; Eff
         '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
           Reader (Maybe TxSendHandle), State AppState,
           LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff
     '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
       Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
-&gt; Eff
     '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
       Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     a
</span><a href="#local-6989586621680390292"><span class="hs-identifier hs-var">runChain</span></a></span><span>
</span><span id="line-82"></span><span>            </span><span class="annot"><span class="annottext">Eff
  '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
    Reader (Maybe TxSendHandle), State AppState,
    LogMsg PABServerLogMsg, IO]
  a
-&gt; (Eff
      '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
        Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO]
      a
    -&gt; Eff
         '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
           State AppState, LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
    Reader (Maybe TxSendHandle), State AppState,
    LogMsg PABServerLogMsg, IO]
  a
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     a
forall x.
Eff
  '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
    Reader (Maybe TxSendHandle), State AppState,
    LogMsg PABServerLogMsg, IO]
  x
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     x
</span><a href="#local-6989586621680390291"><span class="hs-identifier hs-var">mergeState</span></a></span><span>
</span><span id="line-83"></span><span>            </span><span class="annot"><span class="annottext">Eff
  '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
    State AppState, LogMsg PABServerLogMsg, IO]
  a
-&gt; (Eff
      '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO]
      a
    -&gt; Eff
         '[Reader (Maybe TxSendHandle), State AppState,
           LogMsg PABServerLogMsg, IO]
         (a, [LogMessage PABServerLogMsg]))
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
    State AppState, LogMsg PABServerLogMsg, IO]
  a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
forall a.
Eff
  '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
    State AppState, LogMsg PABServerLogMsg, IO]
  a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
</span><a href="#local-6989586621680390290"><span class="hs-identifier hs-var">toWriter</span></a></span><span>
</span><span id="line-84"></span><span>            </span><span class="annot"><span class="annottext">Eff
  '[Reader (Maybe TxSendHandle), State AppState,
    LogMsg PABServerLogMsg, IO]
  (a, [LogMessage PABServerLogMsg])
-&gt; (Eff
      '[Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO]
      (a, [LogMessage PABServerLogMsg])
    -&gt; Eff
         '[LogMsg PABServerLogMsg, IO]
         ((a, [LogMessage PABServerLogMsg]), AppState))
-&gt; Eff
     '[LogMsg PABServerLogMsg, IO]
     ((a, [LogMessage PABServerLogMsg]), AppState)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
-&gt; Eff
     '[LogMsg PABServerLogMsg, IO]
     ((a, [LogMessage PABServerLogMsg]), AppState)
</span><a href="#local-6989586621680390289"><span class="hs-identifier hs-var">runReaders</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390297"><span class="hs-identifier hs-var">oldAppState</span></a></span><span>
</span><span id="line-85"></span><span>            </span><span class="annot"><span class="annottext">Eff
  '[LogMsg PABServerLogMsg, IO]
  ((a, [LogMessage PABServerLogMsg]), AppState)
-&gt; (Eff
      '[LogMsg PABServerLogMsg, IO]
      ((a, [LogMessage PABServerLogMsg]), AppState)
    -&gt; Eff '[IO] ((a, [LogMessage PABServerLogMsg]), AppState))
-&gt; Eff '[IO] ((a, [LogMessage PABServerLogMsg]), AppState)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg PABServerLogMsg ~&gt; Eff '[IO])
-&gt; Eff '[LogMsg PABServerLogMsg, IO] ~&gt; Eff '[IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg -&gt; LogMsg PABServerLogMsg ~&gt; Eff '[IO]
forall a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Trace m a -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">LM.handleLogMsgTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
</span><a href="#local-6989586621680390302"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>            </span><span class="annot"><span class="annottext">Eff '[IO] ((a, [LogMessage PABServerLogMsg]), AppState)
-&gt; (Eff '[IO] ((a, [LogMessage PABServerLogMsg]), AppState)
    -&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState))
-&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[IO] ((a, [LogMessage PABServerLogMsg]), AppState)
-&gt; IO ((a, [LogMessage PABServerLogMsg]), AppState)
forall (m :: * -&gt; *) a. Monad m =&gt; Eff '[m] a -&gt; m a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runM</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState -&gt; AppState -&gt; IO ()
forall a. MVar a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390299"><span class="hs-identifier hs-var">stateVar</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390294"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">([LogMessage PABServerLogMsg], a)
-&gt; IO ([LogMessage PABServerLogMsg], a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390295"><span class="hs-identifier hs-var">events</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680390296"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>            </span><span id="local-6989586621680390293"><span class="annot"><span class="annottext">processBlock :: Eff effs b -&gt; Eff effs b
</span><a href="#local-6989586621680390293"><span class="hs-identifier hs-var hs-var">processBlock</span></a></span></span><span> </span><span id="local-6989586621680390287"><span class="annot"><span class="annottext">Eff effs b
</span><a href="#local-6989586621680390287"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff effs b
</span><a href="#local-6989586621680390287"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs b -&gt; (b -&gt; Eff effs b) -&gt; Eff effs b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680390286"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680390286"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff effs Block
forall (effs :: [* -&gt; *]).
Member ChainControlEffect effs =&gt;
Eff effs Block
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.processBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Eff effs Block -&gt; Eff effs b -&gt; Eff effs b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Eff effs b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680390286"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>            </span><span id="local-6989586621680390292"><span class="annot"><span class="annottext">runChain :: Eff (NodeServerEffects IO) a
-&gt; Eff
     '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
       Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     a
</span><a href="#local-6989586621680390292"><span class="hs-identifier hs-var hs-var">runChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent
 ~&gt; Eff
      '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
        Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO])
-&gt; Eff
     '[LogMsg ChainEvent, State MockNodeServerChainState,
       LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
   ~&gt; Eff
        '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
          Reader (Maybe TxSendHandle), State AppState,
          LogMsg PABServerLogMsg, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainEvent -&gt; PABServerLogMsg)
-&gt; LogMsg ChainEvent
   ~&gt; Eff
        '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
          Reader (Maybe TxSendHandle), State AppState,
          LogMsg PABServerLogMsg, IO]
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; PABServerLogMsg
</span><a href="Cardano.Node.Types.html#ProcessingChainEvent"><span class="hs-identifier hs-var">ProcessingChainEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                     </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg ChainEvent, State MockNodeServerChainState,
     LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
     State AppState, LogMsg PABServerLogMsg, IO]
   a
 -&gt; Eff
      '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
        Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO]
      a)
-&gt; (Eff (NodeServerEffects IO) a
    -&gt; Eff
         '[LogMsg ChainEvent, State MockNodeServerChainState,
           LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
           State AppState, LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff (NodeServerEffects IO) a
-&gt; Eff
     '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
       Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainEffect
 ~&gt; Eff
      '[LogMsg ChainEvent, State MockNodeServerChainState,
        LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO])
-&gt; Eff
     '[ChainEffect, State MockNodeServerChainState,
       LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
   ~&gt; Eff
        '[LogMsg ChainEvent, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; ChainEffect
   ~&gt; Eff
        '[LogMsg ChainEvent, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (effs :: [* -&gt; *]).
Member (State MockNodeServerChainState) effs =&gt;
Params -&gt; ChainEffect ~&gt; Eff effs
</span><a href="Cardano.Chain.html#handleChain"><span class="hs-identifier hs-var">handleChain</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680390301"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                     </span><span class="annot"><span class="annottext">(Eff
   '[ChainEffect, State MockNodeServerChainState,
     LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
     State AppState, LogMsg PABServerLogMsg, IO]
   a
 -&gt; Eff
      '[LogMsg ChainEvent, State MockNodeServerChainState,
        LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO]
      a)
-&gt; (Eff (NodeServerEffects IO) a
    -&gt; Eff
         '[ChainEffect, State MockNodeServerChainState,
           LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
           State AppState, LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff (NodeServerEffects IO) a
-&gt; Eff
     '[LogMsg ChainEvent, State MockNodeServerChainState,
       LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent
 ~&gt; Eff
      '[ChainEffect, State MockNodeServerChainState,
        LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO])
-&gt; Eff
     '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
       LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
   ~&gt; Eff
        '[ChainEffect, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainEvent -&gt; PABServerLogMsg)
-&gt; LogMsg ChainEvent
   ~&gt; Eff
        '[ChainEffect, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; PABServerLogMsg
</span><a href="Cardano.Node.Types.html#ProcessingChainEvent"><span class="hs-identifier hs-var">ProcessingChainEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>                     </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
     LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
     State AppState, LogMsg PABServerLogMsg, IO]
   a
 -&gt; Eff
      '[ChainEffect, State MockNodeServerChainState,
        LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO]
      a)
-&gt; (Eff (NodeServerEffects IO) a
    -&gt; Eff
         '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
           LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
           State AppState, LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff (NodeServerEffects IO) a
-&gt; Eff
     '[ChainEffect, State MockNodeServerChainState,
       LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainControlEffect
 ~&gt; Eff
      '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
        LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO])
-&gt; Eff (NodeServerEffects IO)
   ~&gt; Eff
        '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; ChainControlEffect
   ~&gt; Eff
        '[LogMsg ChainEvent, ChainEffect, State MockNodeServerChainState,
          LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (effs :: [* -&gt; *]) (m :: * -&gt; *).
(Member (State MockNodeServerChainState) effs,
 Member (LogMsg ChainEvent) effs, LastMember m effs, MonadIO m) =&gt;
Params -&gt; ChainControlEffect ~&gt; Eff effs
</span><a href="Cardano.Chain.html#handleControlChain"><span class="hs-identifier hs-var">handleControlChain</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680390301"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>            </span><span id="local-6989586621680390291"><span class="annot"><span class="annottext">mergeState :: Eff
  '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
    Reader (Maybe TxSendHandle), State AppState,
    LogMsg PABServerLogMsg, IO]
  x
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     x
</span><a href="#local-6989586621680390291"><span class="hs-identifier hs-var hs-var">mergeState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State MockNodeServerChainState
 ~&gt; Eff
      '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO])
-&gt; forall x.
   Eff
     '[State MockNodeServerChainState, LogMsg PABServerLogMsg,
       Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     x
   -&gt; Eff
        '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
        x
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' AppState MockNodeServerChainState
-&gt; State MockNodeServerChainState
   ~&gt; Eff
        '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall s2 (effs :: [* -&gt; *]) s1.
Member (State s2) effs =&gt;
Lens' s2 s1 -&gt; State s1 ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">handleZoomedState</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' AppState MockNodeServerChainState
</span><a href="Cardano.Node.Types.html#chainState"><span class="hs-identifier hs-var">chainState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>            </span><span id="local-6989586621680390290"><span class="annot"><span class="annottext">toWriter :: Eff
  '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
    State AppState, LogMsg PABServerLogMsg, IO]
  a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
</span><a href="#local-6989586621680390290"><span class="hs-identifier hs-var hs-var">toWriter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff
  '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
    State AppState, LogMsg PABServerLogMsg, IO]
  a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
forall w (effs :: [* -&gt; *]) a.
Monoid w =&gt;
Eff (Writer w : effs) a -&gt; Eff effs (a, w)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Eff.runWriter</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
     State AppState, LogMsg PABServerLogMsg, IO]
   a
 -&gt; Eff
      '[Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO]
      (a, [LogMessage PABServerLogMsg]))
-&gt; (Eff
      '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO]
      a
    -&gt; Eff
         '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
           State AppState, LogMsg PABServerLogMsg, IO]
         a)
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
     a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg PABServerLogMsg
 ~&gt; Eff
      '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
        State AppState, LogMsg PABServerLogMsg, IO])
-&gt; Eff
     '[LogMsg PABServerLogMsg, Reader (Maybe TxSendHandle),
       State AppState, LogMsg PABServerLogMsg, IO]
   ~&gt; Eff
        '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview [LogMessage PABServerLogMsg] (LogMessage PABServerLogMsg)
-&gt; LogMsg PABServerLogMsg
   ~&gt; Eff
        '[Writer [LogMessage PABServerLogMsg], Reader (Maybe TxSendHandle),
          State AppState, LogMsg PABServerLogMsg, IO]
forall a w (effs :: [* -&gt; *]).
Member (Writer w) effs =&gt;
AReview w (LogMessage a) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">handleLogWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogMessage PABServerLogMsg -&gt; [LogMessage PABServerLogMsg])
-&gt; AReview
     [LogMessage PABServerLogMsg] (LogMessage PABServerLogMsg)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) b t s a.
(Profunctor p, Bifunctor p, Functor f) =&gt;
(b -&gt; t) -&gt; Optic p f s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">unto</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage PABServerLogMsg -&gt; [LogMessage PABServerLogMsg]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>            </span><span id="local-6989586621680390289"><span class="annot"><span class="annottext">runReaders :: AppState
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
-&gt; Eff
     '[LogMsg PABServerLogMsg, IO]
     ((a, [LogMessage PABServerLogMsg]), AppState)
</span><a href="#local-6989586621680390289"><span class="hs-identifier hs-var hs-var">runReaders</span></a></span></span><span> </span><span id="local-6989586621680390278"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390278"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppState
-&gt; Eff
     '[State AppState, LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
-&gt; Eff
     '[LogMsg PABServerLogMsg, IO]
     ((a, [LogMessage PABServerLogMsg]), AppState)
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs (a, s)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Eff.runState</span></a></span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390278"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[State AppState, LogMsg PABServerLogMsg, IO]
   (a, [LogMessage PABServerLogMsg])
 -&gt; Eff
      '[LogMsg PABServerLogMsg, IO]
      ((a, [LogMessage PABServerLogMsg]), AppState))
-&gt; (Eff
      '[Reader (Maybe TxSendHandle), State AppState,
        LogMsg PABServerLogMsg, IO]
      (a, [LogMessage PABServerLogMsg])
    -&gt; Eff
         '[State AppState, LogMsg PABServerLogMsg, IO]
         (a, [LogMessage PABServerLogMsg]))
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
-&gt; Eff
     '[LogMsg PABServerLogMsg, IO]
     ((a, [LogMessage PABServerLogMsg]), AppState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxSendHandle
-&gt; Eff
     '[Reader (Maybe TxSendHandle), State AppState,
       LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
-&gt; Eff
     '[State AppState, LogMsg PABServerLogMsg, IO]
     (a, [LogMessage PABServerLogMsg])
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Eff.runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390300"><span class="hs-identifier hs-var">clientHandler</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621680390275"><span class="annot"><a href="Cardano.Node.Mock.html#processChainEffects"><span class="hs-identifier hs-type">processChainEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#PABServerLogMsg"><span class="hs-identifier hs-type">PABServerLogMsg</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html#TxSendHandle"><span class="hs-identifier hs-type">Client.TxSendHandle</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#AppState"><span class="hs-identifier hs-type">AppState</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#NodeServerEffects"><span class="hs-identifier hs-type">NodeServerEffects</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680390275"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390275"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-110"></span><span id="processChainEffects"><span class="annot"><span class="annottext">processChainEffects :: Trace IO PABServerLogMsg
-&gt; Params
-&gt; Maybe TxSendHandle
-&gt; MVar AppState
-&gt; Eff (NodeServerEffects IO) a
-&gt; IO a
</span><a href="Cardano.Node.Mock.html#processChainEffects"><span class="hs-identifier hs-var hs-var">processChainEffects</span></a></span></span><span> </span><span id="local-6989586621680390273"><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
</span><a href="#local-6989586621680390273"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621680390272"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680390272"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680390271"><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390271"><span class="hs-identifier hs-var">clientHandler</span></a></span></span><span> </span><span id="local-6989586621680390270"><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390270"><span class="hs-identifier hs-var">stateVar</span></a></span></span><span> </span><span id="local-6989586621680390269"><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
</span><a href="#local-6989586621680390269"><span class="hs-identifier hs-var">eff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680390268"><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390268"><span class="hs-identifier hs-var">events</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680390267"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680390267"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ([LogMessage PABServerLogMsg], a)
-&gt; IO ([LogMessage PABServerLogMsg], a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ([LogMessage PABServerLogMsg], a)
 -&gt; IO ([LogMessage PABServerLogMsg], a))
-&gt; IO ([LogMessage PABServerLogMsg], a)
-&gt; IO ([LogMessage PABServerLogMsg], a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
-&gt; Params
-&gt; Maybe TxSendHandle
-&gt; MVar AppState
-&gt; Eff (NodeServerEffects IO) a
-&gt; IO ([LogMessage PABServerLogMsg], a)
forall a.
Trace IO PABServerLogMsg
-&gt; Params
-&gt; Maybe TxSendHandle
-&gt; MVar AppState
-&gt; Eff (NodeServerEffects IO) a
-&gt; IO ([LogMessage PABServerLogMsg], a)
</span><a href="Cardano.Node.Mock.html#runChainEffects"><span class="hs-identifier hs-var">runChainEffects</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
</span><a href="#local-6989586621680390273"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680390272"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxSendHandle
</span><a href="#local-6989586621680390271"><span class="hs-identifier hs-var">clientHandler</span></a></span><span> </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390270"><span class="hs-identifier hs-var">stateVar</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (NodeServerEffects IO) a
</span><a href="#local-6989586621680390269"><span class="hs-identifier hs-var">eff</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg -&gt; Eff '[LogMsg PABServerLogMsg, IO] ~&gt; IO
forall (m :: * -&gt; *) l.
MonadIO m =&gt;
Trace m l -&gt; Eff '[LogMsg l, m] ~&gt; m
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">LM.runLogEffects</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO PABServerLogMsg
</span><a href="#local-6989586621680390273"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[LogMsg PABServerLogMsg, IO] () -&gt; IO ())
-&gt; Eff '[LogMsg PABServerLogMsg, IO] () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMessage PABServerLogMsg
 -&gt; Eff '[LogMsg PABServerLogMsg, IO] ())
-&gt; [LogMessage PABServerLogMsg]
-&gt; Eff '[LogMsg PABServerLogMsg, IO] ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680390264"><span class="annot"><span class="annottext">PABServerLogMsg
</span><a href="#local-6989586621680390264"><span class="hs-identifier hs-var">chainEvent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABServerLogMsg -&gt; Eff '[LogMsg PABServerLogMsg, IO] ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">PABServerLogMsg
</span><a href="#local-6989586621680390264"><span class="hs-identifier hs-var">chainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390268"><span class="hs-identifier hs-var">events</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="annottext">MVar AppState -&gt; (AppState -&gt; IO AppState) -&gt; IO ()
forall a. MVar a -&gt; (a -&gt; IO a) -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">modifyMVar_</span></a></span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><span class="annottext">MVar AppState
</span><a href="#local-6989586621680390270"><span class="hs-identifier hs-var">stateVar</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680390262"><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390262"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AppState -&gt; IO AppState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(AppState -&gt; IO AppState) -&gt; AppState -&gt; IO AppState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter
  AppState
  AppState
  [LogMessage PABServerLogMsg]
  [LogMessage PABServerLogMsg]
-&gt; ([LogMessage PABServerLogMsg] -&gt; [LogMessage PABServerLogMsg])
-&gt; AppState
-&gt; AppState
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter
  AppState
  AppState
  [LogMessage PABServerLogMsg]
  [LogMessage PABServerLogMsg]
Lens' AppState [LogMessage PABServerLogMsg]
</span><a href="Cardano.Node.Types.html#eventHistory"><span class="hs-identifier hs-var">eventHistory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
-&gt; [LogMessage PABServerLogMsg] -&gt; [LogMessage PABServerLogMsg]
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">[LogMessage PABServerLogMsg]
</span><a href="#local-6989586621680390268"><span class="hs-identifier hs-var">events</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AppState
</span><a href="#local-6989586621680390262"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680390267"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Calls 'addBlock' at the start of every slot, causing pending transactions</span><span>
</span><span id="line-120"></span><span class="hs-comment">--   to be validated and added to the chain.</span><span>
</span><span id="line-121"></span><span id="local-6989586621680390261"><span class="annot"><a href="Cardano.Node.Mock.html#slotCoordinator"><span class="hs-identifier hs-type">slotCoordinator</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Server.html#ServerHandler"><span class="hs-identifier hs-type">Server.ServerHandler</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680390261"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-125"></span><span id="slotCoordinator"><span class="annot"><span class="annottext">slotCoordinator :: SlotConfig -&gt; ServerHandler -&gt; IO a
</span><a href="Cardano.Node.Mock.html#slotCoordinator"><span class="hs-identifier hs-var hs-var">slotCoordinator</span></a></span></span><span> </span><span id="local-6989586621680390259"><span class="annot"><span class="annottext">sc :: SlotConfig
</span><a href="#local-6989586621680390259"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621680390258"><span class="annot"><span class="annottext">Integer
scSlotLength :: Integer
scSlotLength :: SlotConfig -&gt; Integer
</span><a href="#local-6989586621680390258"><span class="hs-identifier hs-var hs-var">scSlotLength</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680390257"><span class="annot"><span class="annottext">ServerHandler
</span><a href="#local-6989586621680390257"><span class="hs-identifier hs-var">serverHandler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forever</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO a) -&gt; IO () -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">IO Block -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Block -&gt; IO ()) -&gt; IO Block -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ServerHandler -&gt; IO Block
forall (m :: * -&gt; *). MonadIO m =&gt; ServerHandler -&gt; m Block
</span><a href="Cardano.Protocol.Socket.Mock.Server.html#processBlock"><span class="hs-identifier hs-var">Server.processBlock</span></a></span><span> </span><span class="annot"><span class="annottext">ServerHandler
</span><a href="#local-6989586621680390257"><span class="hs-identifier hs-var">serverHandler</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621680390255"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680390255"><span class="hs-identifier hs-var">newSlot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; IO Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621680390259"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">IO Slot -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Slot -&gt; IO ()) -&gt; IO Slot -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Slot) -&gt; ServerHandler -&gt; IO Slot
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Slot -&gt; Slot) -&gt; ServerHandler -&gt; m Slot
</span><a href="Cardano.Protocol.Socket.Mock.Server.html#modifySlot"><span class="hs-identifier hs-var">Server.modifySlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a b. a -&gt; b -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680390255"><span class="hs-identifier hs-var">newSlot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ServerHandler
</span><a href="#local-6989586621680390257"><span class="hs-identifier hs-var">serverHandler</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">threadDelay</span></a></span><span>
</span><span id="line-131"></span><span>               </span><span class="annot"><span class="annottext">(Int -&gt; IO ()) -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-132"></span><span>               </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; Integer -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Millisecond -&gt; Integer
forall a. TimeUnit a =&gt; a -&gt; Integer
</span><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier hs-var">toMicroseconds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Millisecond
forall a. Num a =&gt; Integer -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680390258"><span class="hs-identifier hs-var">scSlotLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier hs-type">Millisecond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span></pre></body></html>
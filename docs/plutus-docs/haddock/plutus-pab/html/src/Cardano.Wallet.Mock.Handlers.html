<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds          #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs              #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase         #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes         #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications   #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators      #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-deprecations #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Mock.Handlers</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#processWalletEffects"><span class="hs-identifier">processWalletEffects</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#integer2ByteString32"><span class="hs-identifier">integer2ByteString32</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#byteString2Integer"><span class="hs-identifier">byteString2Integer</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#newWallet"><span class="hs-identifier">newWallet</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#distributeNewWalletFunds"><span class="hs-identifier">distributeNewWalletFunds</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Client.html"><span class="hs-identifier">Cardano.Node.Client</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NodeClient</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html"><span class="hs-identifier">Cardano.Node.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Types.html#ChainSyncHandle"><span class="hs-identifier">ChainSyncHandle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html"><span class="hs-identifier">Cardano.Protocol.Socket.Mock.Client</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MockClient</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html"><span class="hs-identifier">Cardano.Wallet.Mock.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#MultiWalletEffect"><span class="hs-identifier">MultiWalletEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletEffects"><span class="hs-identifier">WalletEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletInfo"><span class="hs-identifier">WalletInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier">WalletMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier">Wallets</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                                  </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#fromWalletState"><span class="hs-identifier">fromWalletState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/xfmzvsc0fi8mvrs6djd3qrivn48019vk-cardano-wallet-core-lib-cardano-wallet-core-2022.7.1-haddock-doc/share/doc/cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Primitive.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CWP</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent.MVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">putMVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">takeMVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">at</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(?~)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Error</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Error</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runReader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">State</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">evalState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">put</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/pchj3hflwsy0gf1d0czgsrs29s7m2q24-cryptonite-lib-cryptonite-0.27-haddock-doc/share/doc/cryptonite/html/src"><span class="hs-identifier">Crypto.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/pchj3hflwsy0gf1d0czgsrs29s7m2q24-cryptonite-lib-cryptonite-0.27-haddock-doc/share/doc/cryptonite/html/src"><span class="hs-identifier">getRandomBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">shiftL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier">ScrubbedBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier">unpack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL8</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Char8</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../file:///nix/store/3aiy4frl3rcp616byb1ik39mg6bkk5wy-hspec-core-lib-hspec-core-2.10.8-haddock-doc/share/doc/hspec-core/html/src"><span class="hs-identifier">NonEmpty</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">pack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">encodeUtf8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Ada</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.CardanoWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">MockWallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.CardanoWallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CW</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexQueryEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex.Client</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Arbitrary.html"><span class="hs-identifier">Plutus.PAB.Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.Monitoring.html"><span class="hs-identifier">Plutus.PAB.Monitoring.Monitoring</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LM</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier">PABError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">Servant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">ServerError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err400</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err401</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err404</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">Servant.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier">ClientEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">Servant.Server</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier">err500</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">WalletAPIError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WAPI</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">NodeClientEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.LogMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">RequestHandlerLogMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">TxBalanceMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">newtype</span><span> </span><span id="Seed"><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#Seed"><span class="hs-identifier hs-var">Seed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Seed"><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#Seed"><span class="hs-identifier hs-var">Seed</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier hs-type">ScrubbedBytes</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621680389995"><span id="local-6989586621680389996"><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#generateSeed"><span class="hs-identifier hs-type">generateSeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389996"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389995"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389996"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389995"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#Seed"><span class="hs-identifier hs-type">Seed</span></a></span></span></span><span>
</span><span id="line-74"></span><span id="generateSeed"><span class="annot"><span class="annottext">generateSeed :: Eff effs Seed
</span><a href="Cardano.Wallet.Mock.Handlers.html#generateSeed"><span class="hs-identifier hs-var hs-var">generateSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680389809"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621680389809"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier hs-type">ScrubbedBytes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m ScrubbedBytes -&gt; Eff effs ScrubbedBytes
forall (m :: * -&gt; *) (effs :: [* -&gt; *]) a.
(Monad m, LastMember m effs) =&gt;
m a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">sendM</span></a></span><span> </span><span class="annot"><span class="annottext">(m ScrubbedBytes -&gt; Eff effs ScrubbedBytes)
-&gt; m ScrubbedBytes -&gt; Eff effs ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO ScrubbedBytes -&gt; m ScrubbedBytes
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ScrubbedBytes -&gt; m ScrubbedBytes)
-&gt; IO ScrubbedBytes -&gt; m ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ScrubbedBytes
forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><a href="../file:///nix/store/pchj3hflwsy0gf1d0czgsrs29s7m2q24-cryptonite-lib-cryptonite-0.27-haddock-doc/share/doc/cryptonite/html/src"><span class="hs-identifier hs-var">getRandomBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Seed -&gt; Eff effs Seed
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Seed -&gt; Eff effs Seed) -&gt; Seed -&gt; Eff effs Seed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Seed
</span><a href="Cardano.Wallet.Mock.Handlers.html#Seed"><span class="hs-identifier hs-var">Seed</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621680389809"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#byteString2Integer"><span class="hs-pragma hs-type">byteString2Integer</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- |Helper function to convert bytestrings to integers</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#byteString2Integer"><span class="hs-identifier hs-type">byteString2Integer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-81"></span><span id="byteString2Integer"><span class="annot"><span class="annottext">byteString2Integer :: ByteString -&gt; Integer
</span><a href="Cardano.Wallet.Mock.Handlers.html#byteString2Integer"><span class="hs-identifier hs-var hs-var">byteString2Integer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Word8 -&gt; Integer) -&gt; Integer -&gt; ByteString -&gt; Integer
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BS.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680389806"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680389806"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680389805"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680389805"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680389806"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621680389805"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#integer2ByteString32"><span class="hs-pragma hs-type">integer2ByteString32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- |@i2bs bitLen i@ converts @i@ to a 'ByteString' of @bitLen@ bits (must be a multiple of 8).</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#integer2ByteString32"><span class="hs-identifier hs-type">integer2ByteString32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-86"></span><span id="integer2ByteString32"><span class="annot"><span class="annottext">integer2ByteString32 :: Integer -&gt; ByteString
</span><a href="Cardano.Wallet.Mock.Handlers.html#integer2ByteString32"><span class="hs-identifier hs-var hs-var">integer2ByteString32</span></a></span></span><span> </span><span id="local-6989586621680389803"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680389803"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe (Word8, Int)) -&gt; Int -&gt; ByteString
forall a. (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BS.unfoldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680389801"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680389801"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680389801"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Word8, Int)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Word8, Int) -&gt; Maybe (Word8, Int)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680389803"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680389801"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680389801"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#distributeNewWalletFunds"><span class="hs-identifier hs-type">distributeNewWalletFunds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680389924"><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WAPI.WalletEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WalletAPIError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Ada.Ada</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389924"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoTx</span></a></span><span>
</span><span id="line-98"></span><span id="distributeNewWalletFunds"><span class="annot"><span class="annottext">distributeNewWalletFunds :: Params -&gt; Maybe Ada -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
</span><a href="Cardano.Wallet.Mock.Handlers.html#distributeNewWalletFunds"><span class="hs-identifier hs-var hs-var">distributeNewWalletFunds</span></a></span></span><span> </span><span id="local-6989586621680389798"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389798"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680389797"><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680389797"><span class="hs-identifier hs-var">funds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; SlotRange -&gt; Value -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
forall (effs :: [* -&gt; *]).
(Member WalletEffect effs, Member (Error WalletAPIError) effs,
 Member (LogMsg Text) effs,
 Member (LogMsg RequestHandlerLogMsg) effs) =&gt;
Params
-&gt; SlotRange -&gt; Value -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.payToPaymentPublicKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389798"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.defaultSlotRange</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; (Ada -&gt; Value) -&gt; Maybe Ada -&gt; Value
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Micro -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Ada.adaValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Micro
</span><span class="hs-number">10_000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ada -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Ada.toValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680389797"><span class="hs-identifier hs-var">funds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#newWallet"><span class="hs-identifier hs-type">newWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680389937"><span class="annot"><a href="#local-6989586621680389937"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680389936"><span class="annot"><a href="#local-6989586621680389936"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389937"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389936"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389936"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">MockWallet</span></a></span><span>
</span><span id="line-102"></span><span id="newWallet"><span class="annot"><span class="annottext">newWallet :: Eff effs MockWallet
</span><a href="Cardano.Wallet.Mock.Handlers.html#newWallet"><span class="hs-identifier hs-var hs-var">newWallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#Seed"><span class="hs-identifier hs-type">Seed</span></a></span><span> </span><span id="local-6989586621680389791"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621680389791"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs Seed
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Eff effs Seed
</span><a href="Cardano.Wallet.Mock.Handlers.html#generateSeed"><span class="hs-identifier hs-var">generateSeed</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680389790"><span class="annot"><span class="annottext">secretKeyBytes :: ByteString
</span><a href="#local-6989586621680389790"><span class="hs-identifier hs-var hs-var">secretKeyBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BS.pack</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString)
-&gt; (ScrubbedBytes -&gt; [Word8]) -&gt; ScrubbedBytes -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; [Word8]
forall a. ByteArrayAccess a =&gt; a -&gt; [Word8]
</span><a href="../file:///nix/store/y47kmjs9zbm7p7pa9g0r679ncr6h73yd-memory-lib-memory-0.18.0-haddock-doc/share/doc/memory/html/src"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; ByteString) -&gt; ScrubbedBytes -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621680389791"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">MockWallet -&gt; Eff effs MockWallet
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(MockWallet -&gt; Eff effs MockWallet)
-&gt; MockWallet -&gt; Eff effs MockWallet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; MockWallet
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.fromSeed'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680389790"><span class="hs-identifier hs-var">secretKeyBytes</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Handle multiple wallets using existing @Wallet.handleWallet@ handler</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#handleMultiWallet"><span class="hs-identifier hs-type">handleMultiWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680389891"><span class="annot"><a href="#local-6989586621680389891"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680389892"><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389891"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389891"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#MultiWalletEffect"><span class="hs-identifier hs-type">MultiWalletEffect</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389892"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-119"></span><span id="handleMultiWallet"><span class="annot"><span class="annottext">handleMultiWallet :: Params -&gt; MultiWalletEffect ~&gt; Eff effs
</span><a href="Cardano.Wallet.Mock.Handlers.html#handleMultiWallet"><span class="hs-identifier hs-var hs-var">handleMultiWallet</span></a></span></span><span> </span><span id="local-6989586621680389785"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389785"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#MultiWallet"><span class="hs-identifier hs-type">MultiWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.Wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680389782"><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680389782"><span class="hs-identifier hs-var">walletId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680389781"><span class="annot"><span class="annottext">Eff '[WalletEffect] x
</span><a href="#local-6989586621680389781"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621680389780"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389780"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State Wallets) effs =&gt;
Eff effs Wallets
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WalletId -&gt; Wallets -&gt; Maybe WalletState
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680389782"><span class="hs-identifier hs-var">walletId</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389780"><span class="hs-identifier hs-var">wallets</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680389778"><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680389778"><span class="hs-identifier hs-var">walletState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680389777"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680389777"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680389776"><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680389776"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WalletState
-&gt; Eff (State WalletState : effs) x -&gt; Eff effs (x, WalletState)
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs (a, s)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680389778"><span class="hs-identifier hs-var">walletState</span></a></span><span>
</span><span id="line-125"></span><span>                    </span><span class="annot"><span class="annottext">(Eff (State WalletState : effs) x -&gt; Eff effs (x, WalletState))
-&gt; Eff (State WalletState : effs) x -&gt; Eff effs (x, WalletState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[WalletEffect] x
</span><a href="#local-6989586621680389781"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-126"></span><span>                        </span><span class="annot"><span class="annottext">Eff '[WalletEffect] x
-&gt; (Eff '[WalletEffect] x
    -&gt; Eff
         (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs) x)
-&gt; Eff
     (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs) x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[WalletEffect] x
-&gt; Eff
     (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs) x
forall (effs :: [* -&gt; *]) (as :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Eff as ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">raiseEnd</span></a></span><span>
</span><span id="line-127"></span><span>                        </span><span class="annot"><span class="annottext">Eff
  (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs) x
-&gt; (Eff
      (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs) x
    -&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs) x)
-&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs) x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletEffect
 ~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs))
-&gt; Eff
     (WalletEffect : LogMsg TxBalanceMsg : State WalletState : effs)
   ~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Error WalletAPIError) effs, Member NodeClientEffect effs,
 Member ChainIndexQueryEffect effs, Member (State WalletState) effs,
 Member (LogMsg TxBalanceMsg) effs) =&gt;
WalletEffect ~&gt; Eff effs
WalletEffect
~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.handleWallet</span></a></span><span>
</span><span id="line-128"></span><span>                        </span><span class="annot"><span class="annottext">Eff (LogMsg TxBalanceMsg : State WalletState : effs) x
-&gt; (Eff (LogMsg TxBalanceMsg : State WalletState : effs) x
    -&gt; Eff (State WalletState : effs) x)
-&gt; Eff (State WalletState : effs) x
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg ~&gt; Eff (State WalletState : effs))
-&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
   ~&gt; Eff (State WalletState : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxBalanceMsg -&gt; WalletMsg)
-&gt; LogMsg TxBalanceMsg ~&gt; Eff (State WalletState : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">TxBalanceMsg</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span> </span><span class="annot"><span class="annottext">TxBalanceMsg -&gt; WalletMsg
</span><a href="Cardano.Wallet.Mock.Types.html#Balancing"><span class="hs-identifier hs-var">Balancing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                </span><span class="annot"><span class="annottext">Wallets -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389780"><span class="hs-identifier hs-var">wallets</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets -&gt; (Wallets -&gt; Wallets) -&gt; Wallets
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Index Wallets -&gt; Lens' Wallets (Maybe (IxValue Wallets))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Index Wallets
WalletId
</span><a href="#local-6989586621680389782"><span class="hs-identifier hs-var">walletId</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe WalletState -&gt; Identity (Maybe WalletState))
 -&gt; Wallets -&gt; Identity Wallets)
-&gt; WalletState -&gt; Wallets -&gt; Wallets
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680389776"><span class="hs-identifier hs-var">newState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                </span><span class="annot"><span class="annottext">x -&gt; Eff effs x
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680389777"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="annot"><span class="annottext">Maybe WalletState
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletAPIError -&gt; Eff effs x) -&gt; WalletAPIError -&gt; Eff effs x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; WalletAPIError
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.OtherError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Wallet not found&quot;</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#CreateWallet"><span class="hs-identifier hs-type">CreateWallet</span></a></span><span> </span><span id="local-6989586621680389767"><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680389767"><span class="hs-identifier hs-var">funds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>        </span><span id="local-6989586621680389766"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389766"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State Wallets) effs =&gt;
Eff effs Wallets
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621680389765"><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs MockWallet
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Eff effs MockWallet
</span><a href="Cardano.Wallet.Mock.Handlers.html#newWallet"><span class="hs-identifier hs-var">newWallet</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680389764"><span class="annot"><span class="annottext">walletId :: WalletId
</span><a href="#local-6989586621680389764"><span class="hs-identifier hs-var hs-var">walletId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WalletId -&gt; WalletId
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.WalletId</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletId -&gt; WalletId)
-&gt; (Digest Blake2b_160 -&gt; WalletId)
-&gt; Digest Blake2b_160
-&gt; WalletId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Digest Blake2b_160 -&gt; WalletId
</span><a href="../file:///nix/store/xfmzvsc0fi8mvrs6djd3qrivn48019vk-cardano-wallet-core-lib-cardano-wallet-core-2022.7.1-haddock-doc/share/doc/cardano-wallet-core/html/src"><span class="hs-identifier hs-var">CWP.WalletId</span></a></span><span> </span><span class="annot"><span class="annottext">(Digest Blake2b_160 -&gt; WalletId) -&gt; Digest Blake2b_160 -&gt; WalletId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; Digest Blake2b_160
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var hs-var">CW.mwWalletId</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span id="local-6989586621680389760"><span class="annot"><span class="annottext">wallets' :: Wallets
</span><a href="#local-6989586621680389760"><span class="hs-identifier hs-var hs-var">wallets'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WalletId -&gt; WalletState -&gt; Wallets -&gt; Wallets
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680389764"><span class="hs-identifier hs-var">walletId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.fromMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389766"><span class="hs-identifier hs-var">wallets</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span id="local-6989586621680389757"><span class="annot"><span class="annottext">pkh :: PaymentPubKeyHash
</span><a href="#local-6989586621680389757"><span class="hs-identifier hs-var hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; PaymentPubKeyHash
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.paymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span><span>
</span><span id="line-138"></span><span>            </span><span id="local-6989586621680389755"><span class="annot"><span class="annottext">addr :: CardanoAddress
</span><a href="#local-6989586621680389755"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; CardanoAddress
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.mockWalletAddress</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Wallets -&gt; Eff effs ()
forall s (effs :: [* -&gt; *]).
Member (State s) effs =&gt;
s -&gt; Eff effs ()
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389760"><span class="hs-identifier hs-var">wallets'</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-comment">-- For some reason this doesn't work with (Wallet 1)/privateKey1,</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-comment">-- works just fine with (Wallet 2)/privateKey2</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-comment">-- &#175;\_(&#12484;)_/&#175;</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680389753"><span class="annot"><span class="annottext">sourceWallet :: WalletState
</span><a href="#local-6989586621680389753"><span class="hs-identifier hs-var hs-var">sourceWallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.fromMockWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; MockWallet
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.knownMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">CardanoTx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WalletState
-&gt; Eff (State WalletState : effs) CardanoTx -&gt; Eff effs CardanoTx
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">evalState</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680389753"><span class="hs-identifier hs-var">sourceWallet</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (State WalletState : effs) CardanoTx -&gt; Eff effs CardanoTx)
-&gt; Eff (State WalletState : effs) CardanoTx -&gt; Eff effs CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg ~&gt; Eff (State WalletState : effs))
-&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
   ~&gt; Eff (State WalletState : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxBalanceMsg -&gt; WalletMsg)
-&gt; LogMsg TxBalanceMsg ~&gt; Eff (State WalletState : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">TxBalanceMsg</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span> </span><span class="annot"><span class="annottext">TxBalanceMsg -&gt; WalletMsg
</span><a href="Cardano.Wallet.Mock.Types.html#Balancing"><span class="hs-identifier hs-var">Balancing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg TxBalanceMsg : State WalletState : effs) CardanoTx
 -&gt; Eff (State WalletState : effs) CardanoTx)
-&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs) CardanoTx
-&gt; Eff (State WalletState : effs) CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg RequestHandlerLogMsg
 ~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs))
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : State WalletState : effs)
   ~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; WalletMsg)
-&gt; LogMsg RequestHandlerLogMsg
   ~&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span> </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; WalletMsg
</span><a href="Cardano.Wallet.Mock.Types.html#RequestHandling"><span class="hs-identifier hs-var">RequestHandling</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   (LogMsg RequestHandlerLogMsg
      : LogMsg TxBalanceMsg : State WalletState : effs)
   CardanoTx
 -&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs) CardanoTx)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : State WalletState : effs)
     CardanoTx
-&gt; Eff (LogMsg TxBalanceMsg : State WalletState : effs) CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletEffect
 ~&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : State WalletState : effs))
-&gt; Eff
     (WalletEffect
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg
        : State WalletState : effs)
   ~&gt; Eff
        (LogMsg RequestHandlerLogMsg
           : LogMsg TxBalanceMsg : State WalletState : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Error WalletAPIError) effs, Member NodeClientEffect effs,
 Member ChainIndexQueryEffect effs, Member (State WalletState) effs,
 Member (LogMsg TxBalanceMsg) effs) =&gt;
WalletEffect ~&gt; Eff effs
WalletEffect
~&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : State WalletState : effs)
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.handleWallet</span></a></span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   (WalletEffect
      : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg
      : State WalletState : effs)
   CardanoTx
 -&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg TxBalanceMsg : State WalletState : effs)
      CardanoTx)
-&gt; Eff
     (WalletEffect
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg
        : State WalletState : effs)
     CardanoTx
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg TxBalanceMsg : State WalletState : effs)
     CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Maybe Ada
-&gt; PaymentPubKeyHash
-&gt; Eff
     (WalletEffect
        : LogMsg RequestHandlerLogMsg : LogMsg TxBalanceMsg
        : State WalletState : effs)
     CardanoTx
forall (effs :: [* -&gt; *]).
(Member WalletEffect effs, Member (Error WalletAPIError) effs,
 Member (LogMsg Text) effs,
 Member (LogMsg RequestHandlerLogMsg) effs) =&gt;
Params -&gt; Maybe Ada -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
</span><a href="Cardano.Wallet.Mock.Handlers.html#distributeNewWalletFunds"><span class="hs-identifier hs-var">distributeNewWalletFunds</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389785"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680389767"><span class="hs-identifier hs-var">funds</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680389757"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">WalletInfo -&gt; Eff effs WalletInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletInfo -&gt; Eff effs WalletInfo)
-&gt; WalletInfo -&gt; Eff effs WalletInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletInfo :: Wallet
-&gt; PaymentPubKeyHash -&gt; NonEmpty CardanoAddress -&gt; WalletInfo
</span><a href="Cardano.Wallet.Mock.Types.html#WalletInfo"><span class="hs-identifier hs-type">WalletInfo</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">wiWallet :: Wallet
</span><a href="Cardano.Wallet.Mock.Types.html#wiWallet"><span class="hs-identifier hs-var">wiWallet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.toMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680389765"><span class="hs-identifier hs-var">mockWallet</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wiPaymentPubKeyHash :: PaymentPubKeyHash
</span><a href="Cardano.Wallet.Mock.Types.html#wiPaymentPubKeyHash"><span class="hs-identifier hs-var">wiPaymentPubKeyHash</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680389757"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">wiAddresses :: NonEmpty CardanoAddress
</span><a href="Cardano.Wallet.Mock.Types.html#wiAddresses"><span class="hs-identifier hs-var">wiAddresses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CardanoAddress] -&gt; NonEmpty CardanoAddress
forall a. [a] -&gt; NonEmpty a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NonEmpty.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680389755"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#GetWalletInfo"><span class="hs-identifier hs-type">GetWalletInfo</span></a></span><span> </span><span id="local-6989586621680389743"><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680389743"><span class="hs-identifier hs-var">wllt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621680389742"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389742"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (State Wallets) effs =&gt;
Eff effs Wallets
forall s (effs :: [* -&gt; *]). Member (State s) effs =&gt; Eff effs s
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">Maybe WalletInfo -&gt; Eff effs (Maybe WalletInfo)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe WalletInfo -&gt; Eff effs (Maybe WalletInfo))
-&gt; Maybe WalletInfo -&gt; Eff effs (Maybe WalletInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletState -&gt; WalletInfo)
-&gt; Maybe WalletState -&gt; Maybe WalletInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; WalletInfo
</span><a href="Cardano.Wallet.Mock.Types.html#fromWalletState"><span class="hs-identifier hs-var">fromWalletState</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe WalletState -&gt; Maybe WalletInfo)
-&gt; Maybe WalletState -&gt; Maybe WalletInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId -&gt; Wallets -&gt; Maybe WalletState
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">WalletId
</span><a href="#local-6989586621680389743"><span class="hs-identifier hs-var">wllt</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389742"><span class="hs-identifier hs-var">wallets</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Process wallet effects. Retain state and yield HTTP400 on error</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   or set new state on success.</span><span>
</span><span id="line-160"></span><span id="local-6989586621680389740"><span id="local-6989586621680389741"><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#processWalletEffects"><span class="hs-identifier hs-type">processWalletEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389741"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389741"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span> </span><span class="hs-comment">-- ^ trace for logging</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html#TxSendHandle"><span class="hs-identifier hs-type">MockClient.TxSendHandle</span></a></span><span> </span><span class="hs-comment">-- ^ node client</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#ChainSyncHandle"><span class="hs-identifier hs-type">ChainSyncHandle</span></a></span><span> </span><span class="hs-comment">-- ^ node client</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier hs-type">ClientEnv</span></a></span><span>          </span><span class="hs-comment">-- ^ chain index client</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span>   </span><span class="hs-comment">-- ^ wallets state</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletEffects"><span class="hs-identifier hs-type">WalletEffects</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389740"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ wallet effect</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680389741"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680389740"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-170"></span><span id="processWalletEffects"><span class="annot"><span class="annottext">processWalletEffects :: Trace IO WalletMsg
-&gt; TxSendHandle
-&gt; ChainSyncHandle
-&gt; ClientEnv
-&gt; MVar Wallets
-&gt; Params
-&gt; Eff (WalletEffects IO) a
-&gt; m a
</span><a href="Cardano.Wallet.Mock.Handlers.html#processWalletEffects"><span class="hs-identifier hs-var hs-var">processWalletEffects</span></a></span></span><span> </span><span id="local-6989586621680389739"><span class="annot"><span class="annottext">Trace IO WalletMsg
</span><a href="#local-6989586621680389739"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621680389738"><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680389738"><span class="hs-identifier hs-var">txSendHandle</span></a></span></span><span> </span><span id="local-6989586621680389737"><span class="annot"><span class="annottext">ChainSyncHandle
</span><a href="#local-6989586621680389737"><span class="hs-identifier hs-var">chainSyncHandle</span></a></span></span><span> </span><span id="local-6989586621680389736"><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621680389736"><span class="hs-identifier hs-var">chainIndexEnv</span></a></span></span><span> </span><span id="local-6989586621680389735"><span class="annot"><span class="annottext">MVar Wallets
</span><a href="#local-6989586621680389735"><span class="hs-identifier hs-var">mVarState</span></a></span></span><span> </span><span id="local-6989586621680389734"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389734"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680389733"><span class="annot"><span class="annottext">Eff (WalletEffects IO) a
</span><a href="#local-6989586621680389733"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621680389732"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389732"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Wallets -&gt; m Wallets
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Wallets -&gt; m Wallets) -&gt; IO Wallets -&gt; m Wallets
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets -&gt; IO Wallets
forall a. MVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets
</span><a href="#local-6989586621680389735"><span class="hs-identifier hs-var">mVarState</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621680389731"><span class="annot"><span class="annottext">Either ServerError (a, Wallets)
</span><a href="#local-6989586621680389731"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either ServerError (a, Wallets))
-&gt; m (Either ServerError (a, Wallets))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either ServerError (a, Wallets))
 -&gt; m (Either ServerError (a, Wallets)))
-&gt; IO (Either ServerError (a, Wallets))
-&gt; m (Either ServerError (a, Wallets))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO WalletMsg
-&gt; TxSendHandle
-&gt; ChainSyncHandle
-&gt; ClientEnv
-&gt; Wallets
-&gt; Params
-&gt; Eff (WalletEffects IO) a
-&gt; IO (Either ServerError (a, Wallets))
forall a.
Trace IO WalletMsg
-&gt; TxSendHandle
-&gt; ChainSyncHandle
-&gt; ClientEnv
-&gt; Wallets
-&gt; Params
-&gt; Eff (WalletEffects IO) a
-&gt; IO (Either ServerError (a, Wallets))
</span><a href="Cardano.Wallet.Mock.Handlers.html#runWalletEffects"><span class="hs-identifier hs-var">runWalletEffects</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO WalletMsg
</span><a href="#local-6989586621680389739"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-173"></span><span>                                        </span><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680389738"><span class="hs-identifier hs-var">txSendHandle</span></a></span><span>
</span><span id="line-174"></span><span>                                        </span><span class="annot"><span class="annottext">ChainSyncHandle
</span><a href="#local-6989586621680389737"><span class="hs-identifier hs-var">chainSyncHandle</span></a></span><span>
</span><span id="line-175"></span><span>                                        </span><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621680389736"><span class="hs-identifier hs-var">chainIndexEnv</span></a></span><span>
</span><span id="line-176"></span><span>                                        </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389732"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-177"></span><span>                                        </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389734"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-178"></span><span>                                        </span><span class="annot"><span class="annottext">Eff (WalletEffects IO) a
</span><a href="#local-6989586621680389733"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ServerError (a, Wallets)
</span><a href="#local-6989586621680389731"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680389729"><span class="annot"><span class="annottext">ServerError
</span><a href="#local-6989586621680389729"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets -&gt; Wallets -&gt; IO ()
forall a. MVar a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets
</span><a href="#local-6989586621680389735"><span class="hs-identifier hs-var">mVarState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389732"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="annot"><span class="annottext">ServerError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">MonadError.throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerError -&gt; m a) -&gt; ServerError -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err400</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">Char8.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="#local-6989586621680389729"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680389724"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680389724"><span class="hs-identifier hs-var">result_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680389723"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389723"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets -&gt; Wallets -&gt; IO ()
forall a. MVar a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">putMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar Wallets
</span><a href="#local-6989586621680389735"><span class="hs-identifier hs-var">mVarState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389723"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680389724"><span class="hs-identifier hs-var">result_</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Interpret wallet effects</span><span>
</span><span id="line-188"></span><span id="local-6989586621680389907"><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#runWalletEffects"><span class="hs-identifier hs-type">runWalletEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletMsg"><span class="hs-identifier hs-type">WalletMsg</span></a></span><span> </span><span class="hs-comment">-- ^ trace for logging</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Protocol.Socket.Mock.Client.html#TxSendHandle"><span class="hs-identifier hs-type">MockClient.TxSendHandle</span></a></span><span> </span><span class="hs-comment">-- ^ node client</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Types.html#ChainSyncHandle"><span class="hs-identifier hs-type">ChainSyncHandle</span></a></span><span> </span><span class="hs-comment">-- ^ node client</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/1sck64pppkkmjhaxww80pwmibr51710s-servant-client-lib-servant-client-0.18.3-haddock-doc/share/doc/servant-client/html/src"><span class="hs-identifier hs-type">ClientEnv</span></a></span><span> </span><span class="hs-comment">-- ^ chain index client</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span> </span><span class="hs-comment">-- ^ current state</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#WalletEffects"><span class="hs-identifier hs-type">WalletEffects</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680389907"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ wallet effect</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680389907"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Types.html#Wallets"><span class="hs-identifier hs-type">Wallets</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span id="runWalletEffects"><span class="annot"><span class="annottext">runWalletEffects :: Trace IO WalletMsg
-&gt; TxSendHandle
-&gt; ChainSyncHandle
-&gt; ClientEnv
-&gt; Wallets
-&gt; Params
-&gt; Eff (WalletEffects IO) a
-&gt; IO (Either ServerError (a, Wallets))
</span><a href="Cardano.Wallet.Mock.Handlers.html#runWalletEffects"><span class="hs-identifier hs-var hs-var">runWalletEffects</span></a></span></span><span> </span><span id="local-6989586621680389722"><span class="annot"><span class="annottext">Trace IO WalletMsg
</span><a href="#local-6989586621680389722"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621680389721"><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680389721"><span class="hs-identifier hs-var">txSendHandle</span></a></span></span><span> </span><span id="local-6989586621680389720"><span class="annot"><span class="annottext">ChainSyncHandle
</span><a href="#local-6989586621680389720"><span class="hs-identifier hs-var">chainSyncHandle</span></a></span></span><span> </span><span id="local-6989586621680389719"><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621680389719"><span class="hs-identifier hs-var">chainIndexEnv</span></a></span></span><span> </span><span id="local-6989586621680389718"><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389718"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span id="local-6989586621680389717"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389717"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680389716"><span class="annot"><span class="annottext">Eff (WalletEffects IO) a
</span><a href="#local-6989586621680389716"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">(MultiWalletEffect
 ~&gt; Eff
      '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
        State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO])
-&gt; Eff (WalletEffects IO) a
-&gt; Eff
     '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
       State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; MultiWalletEffect
   ~&gt; Eff
        '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
          State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
          Error ClientError, Error ServerError, IO]
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member NodeClientEffect effs, Member ChainIndexQueryEffect effs,
 Member (State Wallets) effs, Member (Error WalletAPIError) effs,
 Member (LogMsg WalletMsg) effs, Member (LogMsg Text) effs,
 LastMember m effs, MonadIO m) =&gt;
Params -&gt; MultiWalletEffect ~&gt; Eff effs
</span><a href="Cardano.Wallet.Mock.Handlers.html#handleMultiWallet"><span class="hs-identifier hs-var">handleMultiWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389717"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (WalletEffects IO) a
</span><a href="#local-6989586621680389716"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
    State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
        State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
           Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         a)
-&gt; Eff
     '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
       Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletMsg
 ~&gt; Eff
      '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
        Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO])
-&gt; Eff
     '[LogMsg WalletMsg, NodeClientEffect, ChainIndexQueryEffect,
       State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
   ~&gt; Eff
        '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
          Error PABError, LogMsg Text, Error WalletAPIError,
          Error ClientError, Error ServerError, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace IO WalletMsg
-&gt; LogMsg WalletMsg
   ~&gt; Eff
        '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
          Error PABError, LogMsg Text, Error WalletAPIError,
          Error ClientError, Error ServerError, IO]
forall a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Trace m a -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">LM.handleLogMsgTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO WalletMsg
</span><a href="#local-6989586621680389722"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
    Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
        Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
           ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
           Error WalletAPIError, Error ClientError, Error ServerError, IO]
         a)
-&gt; Eff
     '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
       ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
       Error WalletAPIError, Error ClientError, Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeClientEffect
 ~&gt; Eff
      '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
        ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
        Error WalletAPIError, Error ClientError, Error ServerError, IO])
-&gt; Eff
     '[NodeClientEffect, ChainIndexQueryEffect, State Wallets,
       Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
   ~&gt; Eff
        '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
          ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
          Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *)
       (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : h : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : h : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; NodeClientEffect
   ~&gt; Eff
        '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
          ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
          Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m, Member (Error PABError) effs,
 Member (Reader (Maybe TxSendHandle)) effs,
 Member (Reader ChainSyncHandle) effs) =&gt;
Params -&gt; NodeClientEffect ~&gt; Eff effs
</span><a href="Cardano.Node.Client.html#handleNodeClientClient"><span class="hs-identifier hs-var">NodeClient.handleNodeClientClient</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680389717"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
    ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
    Error WalletAPIError, Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
        ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
        Error WalletAPIError, Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
           State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         a)
-&gt; Eff
     '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
       State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ChainSyncHandle
-&gt; Eff
     '[Reader ChainSyncHandle, Reader (Maybe TxSendHandle),
       ChainIndexQueryEffect, State Wallets, Error PABError, LogMsg Text,
       Error WalletAPIError, Error ClientError, Error ServerError, IO]
     a
-&gt; Eff
     '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
       State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">ChainSyncHandle
</span><a href="#local-6989586621680389720"><span class="hs-identifier hs-var">chainSyncHandle</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
    State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
        State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[ChainIndexQueryEffect, State Wallets, Error PABError,
           LogMsg Text, Error WalletAPIError, Error ClientError,
           Error ServerError, IO]
         a)
-&gt; Eff
     '[ChainIndexQueryEffect, State Wallets, Error PABError,
       LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxSendHandle
-&gt; Eff
     '[Reader (Maybe TxSendHandle), ChainIndexQueryEffect,
       State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
-&gt; Eff
     '[ChainIndexQueryEffect, State Wallets, Error PABError,
       LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSendHandle -&gt; Maybe TxSendHandle
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxSendHandle
</span><a href="#local-6989586621680389721"><span class="hs-identifier hs-var">txSendHandle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[ChainIndexQueryEffect, State Wallets, Error PABError,
    LogMsg Text, Error WalletAPIError, Error ClientError,
    Error ServerError, IO]
  a
-&gt; (Eff
      '[ChainIndexQueryEffect, State Wallets, Error PABError,
        LogMsg Text, Error WalletAPIError, Error ClientError,
        Error ServerError, IO]
      a
    -&gt; Eff
         '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
           Error WalletAPIError, Error ClientError, Error ServerError, IO]
         a)
-&gt; Eff
     '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
       Error WalletAPIError, Error ClientError, Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQueryEffect
 ~&gt; Eff
      '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
        Error WalletAPIError, Error ClientError, Error ServerError, IO])
-&gt; Eff
     '[ChainIndexQueryEffect, State Wallets, Error PABError,
       LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
   ~&gt; Eff
        '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
          Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexQueryEffect
~&gt; Eff
     '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
       Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, Member (Reader ClientEnv) effs, MonadIO m,
 Member (Error ClientError) effs) =&gt;
ChainIndexQueryEffect ~&gt; Eff effs
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.handleChainIndexClient</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
    Error WalletAPIError, Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
        Error WalletAPIError, Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         a)
-&gt; Eff
     '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ClientEnv
-&gt; Eff
     '[Reader ClientEnv, State Wallets, Error PABError, LogMsg Text,
       Error WalletAPIError, Error ClientError, Error ServerError, IO]
     a
-&gt; Eff
     '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">ClientEnv
</span><a href="#local-6989586621680389719"><span class="hs-identifier hs-var">chainIndexEnv</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; (Eff
      '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      a
    -&gt; Eff
         '[Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
-&gt; Eff
     '[State Wallets, Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs (a, s)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallets
</span><a href="#local-6989586621680389718"><span class="hs-identifier hs-var">wallets</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; (Eff
      '[Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      (a, Wallets)
    -&gt; Eff
         '[Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[Error PABError, LogMsg Text, Error WalletAPIError,
     Error ClientError, Error ServerError, IO]
   (a, Wallets)
 -&gt; (PABError
     -&gt; Eff
          '[Error PABError, LogMsg Text, Error WalletAPIError,
            Error ClientError, Error ServerError, IO]
          (a, Wallets))
 -&gt; Eff
      '[Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      (a, Wallets))
-&gt; (PABError
    -&gt; Eff
         '[Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; (PABError
    -&gt; Eff
         '[Error PABError, LogMsg Text, Error WalletAPIError,
           Error ClientError, Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
Eff effs a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">catchError</span></a></span><span> </span><span class="annot"><span class="annottext">PABError
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall (effs :: [* -&gt; *]) b.
(FindElem (LogMsg Text) effs, FindElem (Error PABError) effs) =&gt;
PABError -&gt; Eff effs b
</span><a href="#local-6989586621680389708"><span class="hs-identifier hs-var">logPabErrorAndRethrow</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; (Eff
      '[Error PABError, LogMsg Text, Error WalletAPIError,
        Error ClientError, Error ServerError, IO]
      (a, Wallets)
    -&gt; Eff
         '[LogMsg Text, Error WalletAPIError, Error ClientError,
           Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     (a, Wallets)
forall a.
Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
</span><a href="#local-6989586621680389707"><span class="hs-identifier hs-var">handlePrettyErrors</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[LogMsg Text, Error WalletAPIError, Error ClientError,
    Error ServerError, IO]
  (a, Wallets)
-&gt; (Eff
      '[LogMsg Text, Error WalletAPIError, Error ClientError,
        Error ServerError, IO]
      (a, Wallets)
    -&gt; Eff
         '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
         (a, Wallets))
-&gt; Eff
     '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
     (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg Text
 ~&gt; Eff
      '[Error WalletAPIError, Error ClientError, Error ServerError, IO])
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
   ~&gt; Eff
        '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace IO Text
-&gt; LogMsg Text
   ~&gt; Eff
        '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
forall a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Trace m a -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">LM.handleLogMsgTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace IO WalletMsg -&gt; Trace IO Text
forall (m :: * -&gt; *). Trace m WalletMsg -&gt; Trace m Text
</span><a href="#local-6989586621680389706"><span class="hs-identifier hs-var">toWalletMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO WalletMsg
</span><a href="#local-6989586621680389722"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Eff
  '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; (Eff
      '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
      (a, Wallets)
    -&gt; Eff '[Error ClientError, Error ServerError, IO] (a, Wallets))
-&gt; Eff '[Error ClientError, Error ServerError, IO] (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error WalletAPIError, Error ClientError, Error ServerError, IO]
  (a, Wallets)
-&gt; Eff '[Error ClientError, Error ServerError, IO] (a, Wallets)
forall a.
Eff
  '[Error WalletAPIError, Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
</span><a href="#local-6989586621680389705"><span class="hs-identifier hs-var">handleWalletApiErrors</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Eff '[Error ClientError, Error ServerError, IO] (a, Wallets)
-&gt; (Eff '[Error ClientError, Error ServerError, IO] (a, Wallets)
    -&gt; Eff '[Error ServerError, IO] (a, Wallets))
-&gt; Eff '[Error ServerError, IO] (a, Wallets)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error ClientError, Error ServerError, IO] (a, Wallets)
-&gt; Eff '[Error ServerError, IO] (a, Wallets)
forall a.
Eff '[Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ServerError, IO] a
</span><a href="#local-6989586621680389704"><span class="hs-identifier hs-var">handleClientErrors</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Eff '[Error ServerError, IO] (a, Wallets)
-&gt; (Eff '[Error ServerError, IO] (a, Wallets)
    -&gt; Eff '[IO] (Either ServerError (a, Wallets)))
-&gt; Eff '[IO] (Either ServerError (a, Wallets))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error ServerError, IO] (a, Wallets)
-&gt; Eff '[IO] (Either ServerError (a, Wallets))
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">Eff '[IO] (Either ServerError (a, Wallets))
-&gt; (Eff '[IO] (Either ServerError (a, Wallets))
    -&gt; IO (Either ServerError (a, Wallets)))
-&gt; IO (Either ServerError (a, Wallets))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[IO] (Either ServerError (a, Wallets))
-&gt; IO (Either ServerError (a, Wallets))
forall (m :: * -&gt; *) a. Monad m =&gt; Eff '[m] a -&gt; m a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runM</span></a></span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>            </span><span id="local-6989586621680389705"><span class="annot"><span class="annottext">handleWalletApiErrors :: Eff
  '[Error WalletAPIError, Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
</span><a href="#local-6989586621680389705"><span class="hs-identifier hs-var hs-var">handleWalletApiErrors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Eff
   '[Error WalletAPIError, Error ClientError, Error ServerError, IO] a
 -&gt; (WalletAPIError
     -&gt; Eff '[Error ClientError, Error ServerError, IO] a)
 -&gt; Eff '[Error ClientError, Error ServerError, IO] a)
-&gt; (WalletAPIError
    -&gt; Eff '[Error ClientError, Error ServerError, IO] a)
-&gt; Eff
     '[Error WalletAPIError, Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error WalletAPIError, Error ClientError, Error ServerError, IO] a
-&gt; (WalletAPIError
    -&gt; Eff '[Error ClientError, Error ServerError, IO] a)
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">handleError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Eff '[Error ClientError, Error ServerError, IO] a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerError -&gt; Eff '[Error ClientError, Error ServerError, IO] a)
-&gt; (WalletAPIError -&gt; ServerError)
-&gt; WalletAPIError
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; ServerError
</span><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>            </span><span id="local-6989586621680389704"><span class="annot"><span class="annottext">handleClientErrors :: Eff '[Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ServerError, IO] a
</span><a href="#local-6989586621680389704"><span class="hs-identifier hs-var hs-var">handleClientErrors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Eff '[Error ClientError, Error ServerError, IO] a
 -&gt; (ClientError -&gt; Eff '[Error ServerError, IO] a)
 -&gt; Eff '[Error ServerError, IO] a)
-&gt; (ClientError -&gt; Eff '[Error ServerError, IO] a)
-&gt; Eff '[Error ClientError, Error ServerError, IO] a
-&gt; Eff '[Error ServerError, IO] a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error ClientError, Error ServerError, IO] a
-&gt; (ClientError -&gt; Eff '[Error ServerError, IO] a)
-&gt; Eff '[Error ServerError, IO] a
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">handleError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680389699"><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621680389699"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Eff '[Error ServerError, IO] a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerError -&gt; Eff '[Error ServerError, IO] a)
-&gt; ServerError -&gt; Eff '[Error ServerError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">Char8.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClientError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ClientError
</span><a href="#local-6989586621680389699"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>            </span><span id="local-6989586621680389707"><span class="annot"><span class="annottext">handlePrettyErrors :: Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
</span><a href="#local-6989586621680389707"><span class="hs-identifier hs-var hs-var">handlePrettyErrors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Eff
   '[Error PABError, LogMsg Text, Error WalletAPIError,
     Error ClientError, Error ServerError, IO]
   a
 -&gt; (PABError
     -&gt; Eff
          '[LogMsg Text, Error WalletAPIError, Error ClientError,
            Error ServerError, IO]
          a)
 -&gt; Eff
      '[LogMsg Text, Error WalletAPIError, Error ClientError,
        Error ServerError, IO]
      a)
-&gt; (PABError
    -&gt; Eff
         '[LogMsg Text, Error WalletAPIError, Error ClientError,
           Error ServerError, IO]
         a)
-&gt; Eff
     '[Error PABError, LogMsg Text, Error WalletAPIError,
       Error ClientError, Error ServerError, IO]
     a
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error PABError, LogMsg Text, Error WalletAPIError,
    Error ClientError, Error ServerError, IO]
  a
-&gt; (PABError
    -&gt; Eff
         '[LogMsg Text, Error WalletAPIError, Error ClientError,
           Error ServerError, IO]
         a)
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">handleError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680389698"><span class="annot"><span class="annottext">PABError
</span><a href="#local-6989586621680389698"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerError
 -&gt; Eff
      '[LogMsg Text, Error WalletAPIError, Error ClientError,
        Error ServerError, IO]
      a)
-&gt; ServerError
-&gt; Eff
     '[LogMsg Text, Error WalletAPIError, Error ClientError,
       Error ServerError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">Char8.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PABError
</span><a href="#local-6989586621680389698"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>            </span><span id="local-6989586621680389706"><span class="annot"><span class="annottext">toWalletMsg :: Trace m WalletMsg -&gt; Trace m Text
</span><a href="#local-6989586621680389706"><span class="hs-identifier hs-var hs-var">toWalletMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; WalletMsg) -&gt; Trace m WalletMsg -&gt; Trace m Text
forall a b (m :: * -&gt; *). (a -&gt; b) -&gt; Trace m b -&gt; Trace m a
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">LM.convertLog</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; WalletMsg
</span><a href="Cardano.Wallet.Mock.Types.html#ChainClientMsg"><span class="hs-identifier hs-var">ChainClientMsg</span></a></span><span>
</span><span id="line-218"></span><span>            </span><span id="local-6989586621680389708"><span class="annot"><span class="annottext">logPabErrorAndRethrow :: PABError -&gt; Eff effs b
</span><a href="#local-6989586621680389708"><span class="hs-identifier hs-var hs-var">logPabErrorAndRethrow</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680389695"><span class="annot"><span class="annottext">PABError
</span><a href="#local-6989586621680389695"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PABError
</span><a href="#local-6989586621680389695"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>                </span><span class="annot"><span class="annottext">PABError -&gt; Eff effs b
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">PABError
</span><a href="#local-6989586621680389695"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Convert Wallet errors to Servant error responses</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-type">fromWalletAPIError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WalletAPIError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-type">ServerError</span></a></span><span>
</span><span id="line-224"></span><span id="fromWalletAPIError"><span class="annot"><span class="annottext">fromWalletAPIError :: WalletAPIError -&gt; ServerError
</span><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var hs-var">fromWalletAPIError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">InsufficientFunds</span></a></span><span> </span><span id="local-6989586621680389692"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680389692"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err401</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680389692"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389690"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389690"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">NoPaymentPubKeyHashError</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err404</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389690"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389688"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389688"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">PaymentPrivateKeyNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err404</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389688"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-230"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389686"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389686"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389686"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-232"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389684"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389684"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389684"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389682"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389682"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ChangeHasLessThanNAda</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389682"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389680"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389680"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">PaymentMkTxError</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389680"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span id="local-6989586621680389678"><span class="annot"><span class="annottext">e :: WalletAPIError
</span><a href="#local-6989586621680389678"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">RemoteClientFunctionNotYetSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String) -&gt; Doc Any -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError
</span><a href="#local-6989586621680389678"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html#fromWalletAPIError"><span class="hs-identifier hs-var">fromWalletAPIError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">OtherError</span></a></span><span> </span><span id="local-6989586621680389676"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680389676"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="annottext">ServerError
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">err500</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><a href="../file:///nix/store/b04nrk4i8h9kq5glikqcildam8xwyw84-servant-server-lib-servant-server-0.18.3-haddock-doc/share/doc/servant-server/html/src"><span class="hs-identifier hs-var">errBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../file:///nix/store/dy85hyx24kbdxbcbs19gvac43vbvvnjd-bytestring-lib-bytestring-0.10.12.0-haddock-doc/share/doc/bytestring/html/src"><span class="hs-identifier hs-var">BSL.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680389676"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-242"></span></pre></body></html>
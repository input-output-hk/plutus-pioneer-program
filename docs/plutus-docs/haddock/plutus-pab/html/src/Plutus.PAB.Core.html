<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns        #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications      #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-16"></span><span class="hs-comment">{-

The core of the PAB. Runs contract instances, handling their requests by
talking to external services (wallet backend, chain index) and forwarding
notifications from node and user endpoints to them.

The main entry point is 'runPAB'. It runs a 'PABAction t env' using the
@EffectHandlers@ provided. The @EffectHandlers@ makes it easy to customise
the handlers for external effects and for actually submitting requests
to compiled contracts. By choosing different @EffectHandlers@ we can use the
same @runPAB@ function for test and live environments.

A number @PABAction@s are defined in this module. The most important one is
@activateContract@, which starts a new contract instance.

Another important @PABAction@ is 'Plutus.PAB.Core.Server.startServer', which
starts a webserver that implements the API defined in
'Plutus.PAB.Webserver.API'.

-}</span><span>
</span><span id="line-36"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.PAB.Core</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEffects"><span class="hs-identifier">PABEffects</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier">PABAction</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier">EffectHandlers</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#runPAB"><span class="hs-identifier">runPAB</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#runPAB%27"><span class="hs-identifier">runPAB'</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier">PABEnvironment</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Contracts and instances</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#reportContractState"><span class="hs-identifier">reportContractState</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#activateContract"><span class="hs-identifier">activateContract</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#activateContract%27"><span class="hs-identifier">activateContract'</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#callEndpointOnInstance"><span class="hs-identifier">callEndpointOnInstance</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#callEndpointOnInstance%27"><span class="hs-identifier">callEndpointOnInstance'</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#payToAddress"><span class="hs-identifier">payToAddress</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#payToPaymentPublicKey"><span class="hs-identifier">payToPaymentPublicKey</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Agent threads</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier">ContractInstanceEffects</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier">handleAgentThread</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#stopInstance"><span class="hs-identifier">stopInstance</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#removeInstance"><span class="hs-identifier">removeInstance</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#instanceActivity"><span class="hs-identifier">instanceActivity</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Querying the state</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#instanceState"><span class="hs-identifier">instanceState</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier">instanceStateInternal</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#observableState"><span class="hs-identifier">observableState</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForState"><span class="hs-identifier">waitForState</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForInstanceState"><span class="hs-identifier">waitForInstanceState</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForInstanceStateWithResult"><span class="hs-identifier">waitForInstanceStateWithResult</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForTxStatusChange"><span class="hs-identifier">waitForTxStatusChange</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForTxOutStatusChange"><span class="hs-identifier">waitForTxOutStatusChange</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#activeEndpoints"><span class="hs-identifier">activeEndpoints</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitForEndpoint"><span class="hs-identifier">waitForEndpoint</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#yieldedExportTxs"><span class="hs-identifier">yieldedExportTxs</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier">currentSlot</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier">waitUntilSlot</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitNSlots"><span class="hs-identifier">waitNSlots</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#activeContracts"><span class="hs-identifier">activeContracts</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#finalResult"><span class="hs-identifier">finalResult</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#waitUntilFinished"><span class="hs-identifier">waitUntilFinished</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#valueAt"><span class="hs-identifier">valueAt</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier">askUserEnv</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#askBlockchainEnv"><span class="hs-identifier">askBlockchainEnv</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#askInstancesState"><span class="hs-identifier">askInstancesState</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#instancesWithStatuses"><span class="hs-identifier">instancesWithStatuses</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Run PAB effects in separate threads</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier">PABRunner</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier">pabRunner</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Effect handlers</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleMappedReader"><span class="hs-identifier">handleMappedReader</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier">handleUserEnvReader</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier">handleBlockchainEnvReader</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleInstancesStateReader"><span class="hs-identifier">handleInstancesStateReader</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier">timed</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">STM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STM</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Eff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">LastMember</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">interpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">reinterpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">send</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">subsume</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator">(~&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogObserve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">handleObserveLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">mapLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Modify</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Modify</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Ask</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">ask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">asks</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runReader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isJust</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOutRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">cardanoAddressCredential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">pubKeyHashAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">decoratedTxOutValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexQueryEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">RollbackState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Unknown</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">TxOutStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">TxStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Contract.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ActiveEndpoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ActiveEndpoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">aeDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">PABReq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Contract.Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ExportTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.RequestHandlers.html#ContractInstanceMsg"><span class="hs-identifier">ContractInstanceMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.html#ContractInstanceState"><span class="hs-identifier">ContractInstanceState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ContractInstance</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance.STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier">Activity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Active"><span class="hs-identifier">Active</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Done"><span class="hs-identifier">Done</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Stopped"><span class="hs-identifier">Stopped</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier">BlockchainEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier">InstancesState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>                                             </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#OpenEndpoint"><span class="hs-identifier">OpenEndpoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance.STM</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Instances</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier">ContractDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier">ContractEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier">ContractStore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier">PABContract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier">ContractDef</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>                                    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier">getState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Contract</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html"><span class="hs-identifier">Plutus.PAB.Effects.TimeEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier">TimeEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#SystemTime"><span class="hs-identifier">SystemTime</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#systemTime"><span class="hs-identifier">systemTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.UUID.html"><span class="hs-identifier">Plutus.PAB.Effects.UUID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.UUID.html#UUIDEffect"><span class="hs-identifier">UUIDEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.UUID.html#handleUUIDEffect"><span class="hs-identifier">handleUUIDEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html"><span class="hs-identifier">Plutus.PAB.Events.ContractInstanceState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#PartiallyDecodedResponse"><span class="hs-identifier">PartiallyDecodedResponse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier">fromResp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html"><span class="hs-identifier">Plutus.PAB.Monitoring.PABLogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier">PABMultiAgentMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#ContractInstanceLog"><span class="hs-identifier">ContractInstanceLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier">EmulatorMsg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Timeout.html"><span class="hs-identifier">Plutus.PAB.Timeout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Timeout.html#Timeout"><span class="hs-identifier">Timeout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Timeout.html"><span class="hs-identifier">Plutus.PAB.Timeout</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Timeout</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier">PABError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier">ContractInstanceNotFound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#InstanceAlreadyStopped"><span class="hs-identifier">InstanceAlreadyStopped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#OtherError"><span class="hs-identifier">OtherError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier">WalletError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html"><span class="hs-identifier">Plutus.PAB.Webserver.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#caID"><span class="hs-identifier">caID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#caWallet"><span class="hs-identifier">caWallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WAPI</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">NodeClientEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">WalletEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.LogMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">RequestHandlerLogMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">TxBalanceMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.MultiAgent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorEvent'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">WalletEvent</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorTimeEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorTimeEvent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">WalletEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">GenericLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">RequestHandlerLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">TxBalanceLog</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">mockWalletAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractActivityStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractInstanceId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EndpointDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EndpointDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>                     </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">NotificationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Effects that are available in 'PABAction's.</span><span>
</span><span id="line-147"></span><span class="hs-keyword">type</span><span> </span><span id="PABEffects"><span class="annot"><a href="Plutus.PAB.Core.html#PABEffects"><span class="hs-identifier hs-var">PABEffects</span></a></span></span><span> </span><span id="local-6989586621680392426"><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392425"><span class="annot"><a href="#local-6989586621680392425"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-149"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-150"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-151"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span>
</span><span id="line-153"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392426"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392425"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span>
</span><span id="line-155"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-156"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Actions that are run by the PAB.</span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span id="PABAction"><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-var">PABAction</span></a></span></span><span> </span><span id="local-6989586621680392424"><span class="annot"><a href="#local-6989586621680392424"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392423"><span class="annot"><a href="#local-6989586621680392423"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392422"><span class="annot"><a href="#local-6989586621680392422"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEffects"><span class="hs-identifier hs-type">PABEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392424"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392423"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392422"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | A handler for 'PABAction' types.</span><span>
</span><span id="line-162"></span><span class="hs-keyword">newtype</span><span> </span><span id="PABRunner"><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-var">PABRunner</span></a></span></span><span> </span><span id="local-6989586621680392937"><span class="annot"><a href="#local-6989586621680392937"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392936"><span class="annot"><a href="#local-6989586621680392936"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PABRunner"><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-var">PABRunner</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runPABAction"><span class="annot"><span class="annottext">PABRunner t env
-&gt; forall a. PABAction t env a -&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Core.html#runPABAction"><span class="hs-identifier hs-var hs-var">runPABAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392972"><span class="annot"><a href="#local-6989586621680392972"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392937"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392936"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Get a 'PABRunner' that uses the current environment.</span><span>
</span><span id="line-165"></span><span class="annot"><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier hs-type">pabRunner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392888"><span class="annot"><a href="#local-6989586621680392888"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392887"><span class="annot"><a href="#local-6989586621680392887"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392887"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-type">PABRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392887"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span id="pabRunner"><span class="annot"><span class="annottext">pabRunner :: PABAction t env (PABRunner t env)
</span><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier hs-var hs-var">pabRunner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621680392419"><span class="annot"><span class="annottext">h :: PABEnvironment t env
</span><a href="#local-6989586621680392419"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">effectHandlers :: forall t env. PABEnvironment t env -&gt; EffectHandlers t env
</span><a href="Plutus.PAB.Core.html#effectHandlers"><span class="hs-identifier hs-var">effectHandlers</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392415"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member TimeEffect effs, Member (Error PABError) effs,
    LastMember IO effs) =&gt;
   Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleLogMessages"><span class="hs-identifier hs-var hs-var">handleLogMessages</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392413"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractStoreEffect"><span class="hs-identifier hs-var hs-var">handleContractStoreEffect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392411"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractEffect"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392409"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractDefinitionEffect"><span class="hs-identifier hs-var hs-var">handleContractDefinitionEffect</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs (PABEnvironment t env)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392887"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">PABRunner t env -&gt; PABAction t env (PABRunner t env)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PABRunner t env -&gt; PABAction t env (PABRunner t env))
-&gt; PABRunner t env -&gt; PABAction t env (PABRunner t env)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall a. PABAction t env a -&gt; IO (Either PABError a))
-&gt; PABRunner t env
forall t env.
(forall a. PABAction t env a -&gt; IO (Either PABError a))
-&gt; PABRunner t env
</span><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-var">PABRunner</span></a></span><span> </span><span class="annot"><span class="annottext">((forall a. PABAction t env a -&gt; IO (Either PABError a))
 -&gt; PABRunner t env)
-&gt; (forall a. PABAction t env a -&gt; IO (Either PABError a))
-&gt; PABRunner t env
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680392407"><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392407"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall (m :: * -&gt; *) a. Monad m =&gt; Eff '[m] a -&gt; m a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runM</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">(Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a))
-&gt; Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">(Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a))
-&gt; Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env
</span><a href="#local-6989586621680392419"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">(Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Error PABError, IO] a)
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeEffect
 ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO])
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO]
   ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t env (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-var">handleTimeEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392887"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392415"><span class="hs-identifier hs-var">handleLogMessages</span></a></span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392409"><span class="hs-identifier hs-var">handleContractDefinitionEffect</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractEffect t, ContractDefinition t,
    LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392411"><span class="hs-identifier hs-var">handleContractEffect</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   '[ContractEffect t, ContractDefinition t,
     LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env a
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392413"><span class="hs-identifier hs-var">handleContractStoreEffect</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392407"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Shared data that is needed by all PAB threads.</span><span>
</span><span id="line-179"></span><span class="hs-keyword">data</span><span> </span><span id="PABEnvironment"><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-var">PABEnvironment</span></a></span></span><span> </span><span id="local-6989586621680392966"><span class="annot"><a href="#local-6989586621680392966"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392965"><span class="annot"><a href="#local-6989586621680392965"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>    </span><span id="PABEnvironment"><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-var">PABEnvironment</span></a></span></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="instancesState"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">InstancesState</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-comment">-- | How long to wait for an endpoint to become active before throwing the</span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-comment">--   'EndpointNotAvailable' error.</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="endpointTimeout"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; Timeout
</span><a href="Plutus.PAB.Core.html#endpointTimeout"><span class="hs-identifier hs-var hs-var">endpointTimeout</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Timeout.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-comment">-- | How long to wait when querying the status for an invoked endpoint before throwing the</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-comment">--   a timeout error.</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="waitStatusTimeout"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; Timeout
</span><a href="Plutus.PAB.Core.html#waitStatusTimeout"><span class="hs-identifier hs-var hs-var">waitStatusTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Timeout.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="blockchainEnv"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="appEnv"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; env
</span><a href="Plutus.PAB.Core.html#appEnv"><span class="hs-identifier hs-var hs-var">appEnv</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680392965"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="effectHandlers"><span class="annot"><span class="annottext">PABEnvironment t env -&gt; EffectHandlers t env
</span><a href="Plutus.PAB.Core.html#effectHandlers"><span class="hs-identifier hs-var hs-var">effectHandlers</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392966"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392965"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Top-level entry point. Run a 'PABAction', using the 'EffectHandlers' to</span><span>
</span><span id="line-194"></span><span class="hs-comment">--   deal with logs, startup and shutdown, contract requests and communication</span><span>
</span><span id="line-195"></span><span class="hs-comment">--   with external services.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Plutus.PAB.Core.html#runPAB"><span class="hs-identifier hs-type">runPAB</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392400"><span class="annot"><a href="#local-6989586621680392400"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392399"><span class="annot"><a href="#local-6989586621680392399"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392398"><span class="annot"><a href="#local-6989586621680392398"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Timeout.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Timeout.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392400"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392399"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392400"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392399"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392398"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span id="runPAB"><span class="annot"><span class="annottext">runPAB :: Timeout
-&gt; Timeout
-&gt; EffectHandlers t env
-&gt; PABAction t env a
-&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Core.html#runPAB"><span class="hs-identifier hs-var hs-var">runPAB</span></a></span></span><span> </span><span id="local-6989586621680392397"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392397"><span class="hs-identifier hs-var">endpointTimeout</span></a></span></span><span> </span><span id="local-6989586621680392396"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392396"><span class="hs-identifier hs-var">waitStatusTimeout</span></a></span></span><span> </span><span id="local-6989586621680392395"><span class="annot"><span class="annottext">EffectHandlers t env
</span><a href="#local-6989586621680392395"><span class="hs-identifier hs-var">effectHandlers</span></a></span></span><span> </span><span id="local-6989586621680392394"><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392394"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall (m :: * -&gt; *) a. Monad m =&gt; Eff '[m] a -&gt; m a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runM</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a))
-&gt; Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a))
-&gt; Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680392393"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Error PABError) effs, LastMember IO effs) =&gt;
Eff effs (InstancesState, BlockchainEnv, env)
initialiseEnvironment :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Error PABError) effs, LastMember IO effs) =&gt;
   Eff effs (InstancesState, BlockchainEnv, env)
initialiseEnvironment :: forall (effs :: [* -&gt; *]).
(Member (Error PABError) effs, LastMember IO effs) =&gt;
Eff effs (InstancesState, BlockchainEnv, env)
</span><a href="Plutus.PAB.Core.html#initialiseEnvironment"><span class="hs-identifier hs-var hs-var">initialiseEnvironment</span></a></span></span><span>
</span><span id="line-205"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392391"><span class="annot"><span class="annottext">PABAction t env ()
onStartup :: forall t env. EffectHandlers t env -&gt; PABAction t env ()
onStartup :: PABAction t env ()
</span><a href="Plutus.PAB.Core.html#onStartup"><span class="hs-identifier hs-var hs-var">onStartup</span></a></span></span><span>
</span><span id="line-206"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392389"><span class="annot"><span class="annottext">PABAction t env ()
onShutdown :: forall t env. EffectHandlers t env -&gt; PABAction t env ()
onShutdown :: PABAction t env ()
</span><a href="Plutus.PAB.Core.html#onShutdown"><span class="hs-identifier hs-var hs-var">onShutdown</span></a></span></span><span>
</span><span id="line-207"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392387"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member TimeEffect effs, Member (Error PABError) effs,
    LastMember IO effs) =&gt;
   Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392387"><span class="hs-identifier hs-var hs-var">handleLogMessages</span></a></span></span><span>
</span><span id="line-208"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392386"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392386"><span class="hs-identifier hs-var hs-var">handleContractStoreEffect</span></a></span></span><span>
</span><span id="line-209"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392385"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392385"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span></span><span>
</span><span id="line-210"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392384"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392384"><span class="hs-identifier hs-var hs-var">handleContractDefinitionEffect</span></a></span></span><span>
</span><span id="line-211"></span><span>                       </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EffectHandlers t env
</span><a href="#local-6989586621680392395"><span class="hs-identifier hs-var">effectHandlers</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680392383"><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392383"><span class="hs-identifier hs-var">instancesState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392382"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392382"><span class="hs-identifier hs-var">blockchainEnv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392381"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621680392381"><span class="hs-identifier hs-var">appEnv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff '[Error PABError, IO] (InstancesState, BlockchainEnv, env)
forall (effs :: [* -&gt; *]).
(Member (Error PABError) effs, LastMember IO effs) =&gt;
Eff effs (InstancesState, BlockchainEnv, env)
</span><a href="#local-6989586621680392393"><span class="hs-identifier hs-var">initialiseEnvironment</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680392380"><span class="annot"><span class="annottext">env :: PABEnvironment t env
</span><a href="#local-6989586621680392380"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PABEnvironment :: forall t env.
InstancesState
-&gt; Timeout
-&gt; Timeout
-&gt; BlockchainEnv
-&gt; env
-&gt; EffectHandlers t env
-&gt; PABEnvironment t env
</span><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">InstancesState
instancesState :: InstancesState
instancesState :: InstancesState
</span><a href="#local-6989586621680392383"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
blockchainEnv :: BlockchainEnv
blockchainEnv :: BlockchainEnv
</span><a href="#local-6989586621680392382"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env
appEnv :: env
appEnv :: env
</span><a href="#local-6989586621680392381"><span class="hs-identifier hs-var hs-var">appEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EffectHandlers t env
effectHandlers :: EffectHandlers t env
effectHandlers :: EffectHandlers t env
</span><a href="#local-6989586621680392395"><span class="hs-identifier hs-var hs-var">effectHandlers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timeout
endpointTimeout :: Timeout
endpointTimeout :: Timeout
</span><a href="#local-6989586621680392397"><span class="hs-identifier hs-var hs-var">endpointTimeout</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timeout
waitStatusTimeout :: Timeout
waitStatusTimeout :: Timeout
</span><a href="#local-6989586621680392396"><span class="hs-identifier hs-var hs-var">waitStatusTimeout</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">PABEnvironment t env
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env
</span><a href="#local-6989586621680392380"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Error PABError, IO] a)
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeEffect
 ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO])
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO]
   ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t env (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-var">handleTimeEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392400"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392399"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392387"><span class="hs-identifier hs-var">handleLogMessages</span></a></span><span>
</span><span id="line-217"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392384"><span class="hs-identifier hs-var">handleContractDefinitionEffect</span></a></span><span>
</span><span id="line-218"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractEffect t, ContractDefinition t,
    LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392385"><span class="hs-identifier hs-var">handleContractEffect</span></a></span><span>
</span><span id="line-219"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[ContractEffect t, ContractDefinition t,
     LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env a
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392386"><span class="hs-identifier hs-var">handleContractStoreEffect</span></a></span><span>
</span><span id="line-220"></span><span>                  </span><span class="annot"><span class="annottext">(PABAction t env a
 -&gt; Eff
      '[ContractEffect t, ContractDefinition t,
        LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; PABAction t env a
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">PABAction t env ()
</span><a href="#local-6989586621680392391"><span class="hs-identifier hs-var">onStartup</span></a></span><span>
</span><span id="line-221"></span><span>                       </span><span id="local-6989586621680392379"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392379"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392394"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-222"></span><span>                       </span><span class="annot"><span class="annottext">PABAction t env ()
</span><a href="#local-6989586621680392389"><span class="hs-identifier hs-var">onShutdown</span></a></span><span>
</span><span id="line-223"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; PABAction t env a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392379"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Run a PABAction in the context of the given environment.</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- TODO: Clean it up so there is less duplication of the above.</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Plutus.PAB.Core.html#runPAB%27"><span class="hs-identifier hs-type">runPAB'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392378"><span class="annot"><a href="#local-6989586621680392378"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392377"><span class="annot"><a href="#local-6989586621680392377"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392376"><span class="annot"><a href="#local-6989586621680392376"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392378"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392377"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392378"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392377"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392376"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span id="runPAB%27"><span class="annot"><span class="annottext">runPAB' :: PABEnvironment t env -&gt; PABAction t env a -&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Core.html#runPAB%27"><span class="hs-identifier hs-var hs-var">runPAB'</span></a></span></span><span> </span><span id="local-6989586621680392375"><span class="annot"><span class="annottext">env :: PABEnvironment t env
</span><a href="#local-6989586621680392375"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392374"><span class="annot"><span class="annottext">EffectHandlers t env
effectHandlers :: EffectHandlers t env
effectHandlers :: forall t env. PABEnvironment t env -&gt; EffectHandlers t env
</span><a href="#local-6989586621680392374"><span class="hs-identifier hs-var hs-var">effectHandlers</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680392373"><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392373"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall (m :: * -&gt; *) a. Monad m =&gt; Eff '[m] a -&gt; m a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runM</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a))
-&gt; Eff '[IO] (Either PABError a) -&gt; IO (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a))
-&gt; Eff '[Error PABError, IO] a -&gt; Eff '[IO] (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680392372"><span class="annot"><span class="annottext">PABAction t env ()
onStartup :: PABAction t env ()
onStartup :: forall t env. EffectHandlers t env -&gt; PABAction t env ()
</span><a href="#local-6989586621680392372"><span class="hs-identifier hs-var hs-var">onStartup</span></a></span></span><span>
</span><span id="line-234"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392371"><span class="annot"><span class="annottext">PABAction t env ()
onShutdown :: PABAction t env ()
onShutdown :: forall t env. EffectHandlers t env -&gt; PABAction t env ()
</span><a href="#local-6989586621680392371"><span class="hs-identifier hs-var hs-var">onShutdown</span></a></span></span><span>
</span><span id="line-235"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392370"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
handleLogMessages :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member TimeEffect effs, Member (Error PABError) effs,
    LastMember IO effs) =&gt;
   Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392370"><span class="hs-identifier hs-var hs-var">handleLogMessages</span></a></span></span><span>
</span><span id="line-236"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392369"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392369"><span class="hs-identifier hs-var hs-var">handleContractStoreEffect</span></a></span></span><span>
</span><span id="line-237"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392368"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392368"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span></span><span>
</span><span id="line-238"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392367"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
handleContractDefinitionEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392367"><span class="hs-identifier hs-var hs-var">handleContractDefinitionEffect</span></a></span></span><span>
</span><span id="line-239"></span><span>                       </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EffectHandlers t env
</span><a href="#local-6989586621680392374"><span class="hs-identifier hs-var">effectHandlers</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="annottext">PABEnvironment t env
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env
</span><a href="#local-6989586621680392375"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Error PABError, IO] a)
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeEffect
 ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO])
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO]
   ~&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t env (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-var">handleTimeEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392378"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392377"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
 -&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
-&gt; Eff '[Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392370"><span class="hs-identifier hs-var">handleLogMessages</span></a></span><span>
</span><span id="line-243"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a)
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[TimeEffect, Reader (PABEnvironment t env), Error PABError, IO] a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392367"><span class="hs-identifier hs-var">handleContractDefinitionEffect</span></a></span><span>
</span><span id="line-244"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ContractEffect t, ContractDefinition t,
    LogMsg (PABMultiAgentMsg t), TimeEffect,
    Reader (PABEnvironment t env), Error PABError, IO]
  a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392368"><span class="hs-identifier hs-var">handleContractEffect</span></a></span><span>
</span><span id="line-245"></span><span>                  </span><span class="annot"><span class="annottext">(Eff
   '[ContractEffect t, ContractDefinition t,
     LogMsg (PABMultiAgentMsg t), TimeEffect,
     Reader (PABEnvironment t env), Error PABError, IO]
   a
 -&gt; Eff
      '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
-&gt; Eff
     '[ContractDefinition t, LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env a
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392369"><span class="hs-identifier hs-var">handleContractStoreEffect</span></a></span><span>
</span><span id="line-246"></span><span>                  </span><span class="annot"><span class="annottext">(PABAction t env a
 -&gt; Eff
      '[ContractEffect t, ContractDefinition t,
        LogMsg (PABMultiAgentMsg t), TimeEffect,
        Reader (PABEnvironment t env), Error PABError, IO]
      a)
-&gt; PABAction t env a
-&gt; Eff
     '[ContractEffect t, ContractDefinition t,
       LogMsg (PABMultiAgentMsg t), TimeEffect,
       Reader (PABEnvironment t env), Error PABError, IO]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>                    </span><span class="annot"><span class="annottext">PABAction t env ()
</span><a href="#local-6989586621680392372"><span class="hs-identifier hs-var">onStartup</span></a></span><span>
</span><span id="line-248"></span><span>                    </span><span id="local-6989586621680392366"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392366"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env a
</span><a href="#local-6989586621680392373"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-249"></span><span>                    </span><span class="annot"><span class="annottext">PABAction t env ()
</span><a href="#local-6989586621680392371"><span class="hs-identifier hs-var">onShutdown</span></a></span><span>
</span><span id="line-250"></span><span>                    </span><span class="annot"><span class="annottext">a -&gt; PABAction t env a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392366"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Start a new instance of a contract, with a given state. Note that we skip</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- running the effects that push the state into the contract store, because we</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- assume that if you're providing the state, it's already present in the</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- store.</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Plutus.PAB.Core.html#activateContract%27"><span class="hs-identifier hs-type">activateContract'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392365"><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392364"><span class="annot"><a href="#local-6989586621680392364"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.html#ContractInstanceState"><span class="hs-identifier hs-type">ContractInstanceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392364"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-265"></span><span id="activateContract%27"><span class="annot"><span class="annottext">activateContract' :: ContractInstanceState t
-&gt; ContractInstanceId
-&gt; Wallet
-&gt; ContractDef t
-&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Core.html#activateContract%27"><span class="hs-identifier hs-var hs-var">activateContract'</span></a></span></span><span> </span><span id="local-6989586621680392363"><span class="annot"><span class="annottext">ContractInstanceState t
</span><a href="#local-6989586621680392363"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621680392362"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392362"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621680392361"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392361"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680392360"><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680392360"><span class="hs-identifier hs-var">contractDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-type">PABRunner</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392359"><span class="annot"><span class="annottext">forall a. PABAction t env a -&gt; IO (Either PABError a)
runPABAction :: forall a. PABAction t env a -&gt; IO (Either PABError a)
runPABAction :: forall t env.
PABRunner t env
-&gt; forall a. PABAction t env a -&gt; IO (Either PABError a)
</span><a href="#local-6989586621680392359"><span class="hs-identifier hs-var hs-var">runPABAction</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env (PABRunner t env)
forall t env. PABAction t env (PABRunner t env)
</span><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier hs-var">pabRunner</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680392358"><span class="hs-identifier hs-type">handler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392858"><span class="annot"><a href="#local-6989586621680392858"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392364"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392858"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621680392358"><span class="annot"><span class="annottext">handler :: ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a -&gt; IO a
</span><a href="#local-6989586621680392358"><span class="hs-identifier hs-var hs-var">handler</span></a></span></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680392357"><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392357"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either PABError a -&gt; a) -&gt; IO (Either PABError a) -&gt; IO a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PABError -&gt; a) -&gt; (a -&gt; a) -&gt; Either PABError a -&gt; a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; (PABError -&gt; [Char]) -&gt; PABError -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PABError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PABAction t env a -&gt; IO (Either PABError a)
forall a. PABAction t env a -&gt; IO (Either PABError a)
</span><a href="#local-6989586621680392359"><span class="hs-identifier hs-var">runPABAction</span></a></span><span> </span><span class="annot"><span class="annottext">(PABAction t env a -&gt; IO (Either PABError a))
-&gt; PABAction t env a -&gt; IO (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392361"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Maybe ContractInstanceId
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392362"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392357"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><a href="#local-6989586621680392351"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621680392351"><span class="annot"><span class="annottext">args :: ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680392351"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs :: forall t. t -&gt; Maybe Wallet -&gt; ContractActivationArgs t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">caWallet :: Maybe Wallet
</span><a href="Plutus.PAB.Webserver.Types.html#caWallet"><span class="hs-identifier hs-var">caWallet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe Wallet
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392361"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">caID :: ContractDef t
</span><a href="Plutus.PAB.Webserver.Types.html#caID"><span class="hs-identifier hs-var">caID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680392360"><span class="hs-identifier hs-var">contractDef</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
-&gt; PABAction t env ContractInstanceId
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392361"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Maybe ContractInstanceId
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392362"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
 -&gt; PABAction t env ContractInstanceId)
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
-&gt; PABAction t env ContractInstanceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceState t
-&gt; ContractInstanceId
-&gt; (ContractInstanceId
    -&gt; Eff (ContractInstanceEffects t env '[IO]) ~&gt; IO)
-&gt; ContractActivationArgs (ContractDef t)
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
forall t (m :: * -&gt; *) (appBackend :: [* -&gt; *]) (effs :: [* -&gt; *]).
(Member (Reader InstancesState) effs, PABContract t,
 AppBackendConstraints t m appBackend,
 LastMember m (Reader ContractInstanceId : appBackend),
 LastMember m effs) =&gt;
ContractInstanceState t
-&gt; ContractInstanceId
-&gt; (ContractInstanceId -&gt; Eff appBackend ~&gt; IO)
-&gt; ContractActivationArgs (ContractDef t)
-&gt; Eff effs ContractInstanceId
</span><a href="Plutus.PAB.Core.ContractInstance.html#startContractInstanceThread%27"><span class="hs-identifier hs-var">ContractInstance.startContractInstanceThread'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392365"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392364"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ContractInstanceState t
</span><a href="#local-6989586621680392363"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392362"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) ~&gt; IO
forall a.
ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a -&gt; IO a
</span><a href="#local-6989586621680392358"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680392351"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Start a new instance of a contract</span><span>
</span><span id="line-276"></span><span class="annot"><a href="Plutus.PAB.Core.html#activateContract"><span class="hs-identifier hs-type">activateContract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392349"><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392348"><span class="annot"><a href="#local-6989586621680392348"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392348"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-277"></span><span id="activateContract"><span class="annot"><span class="annottext">activateContract :: Wallet -&gt; ContractDef t -&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Core.html#activateContract"><span class="hs-identifier hs-var hs-var">activateContract</span></a></span></span><span> </span><span id="local-6989586621680392347"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392347"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621680392346"><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680392346"><span class="hs-identifier hs-var">contractDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-type">PABRunner</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392345"><span class="annot"><span class="annottext">forall a. PABAction t env a -&gt; IO (Either PABError a)
runPABAction :: forall a. PABAction t env a -&gt; IO (Either PABError a)
runPABAction :: forall t env.
PABRunner t env
-&gt; forall a. PABAction t env a -&gt; IO (Either PABError a)
</span><a href="#local-6989586621680392345"><span class="hs-identifier hs-var hs-var">runPABAction</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env (PABRunner t env)
forall t env. PABAction t env (PABRunner t env)
</span><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier hs-var">pabRunner</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680392344"><span class="hs-identifier hs-type">handler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392848"><span class="annot"><a href="#local-6989586621680392848"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392348"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392848"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621680392344"><span class="annot"><span class="annottext">handler :: ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a -&gt; IO a
</span><a href="#local-6989586621680392344"><span class="hs-identifier hs-var hs-var">handler</span></a></span></span><span> </span><span id="local-6989586621680392343"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392343"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621680392342"><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392342"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either PABError a -&gt; a) -&gt; IO (Either PABError a) -&gt; IO a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PABError -&gt; a) -&gt; (a -&gt; a) -&gt; Either PABError a -&gt; a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; (PABError -&gt; [Char]) -&gt; PABError -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PABError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PABAction t env a -&gt; IO (Either PABError a)
forall a. PABAction t env a -&gt; IO (Either PABError a)
</span><a href="#local-6989586621680392345"><span class="hs-identifier hs-var">runPABAction</span></a></span><span> </span><span class="annot"><span class="annottext">(PABAction t env a -&gt; IO (Either PABError a))
-&gt; PABAction t env a -&gt; IO (Either PABError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392347"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Maybe ContractInstanceId
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392343"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392342"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><a href="#local-6989586621680392341"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621680392341"><span class="annot"><span class="annottext">args :: ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680392341"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs :: forall t. t -&gt; Maybe Wallet -&gt; ContractActivationArgs t
</span><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">caWallet :: Maybe Wallet
</span><a href="Plutus.PAB.Webserver.Types.html#caWallet"><span class="hs-identifier hs-var">caWallet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe Wallet
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392347"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">caID :: ContractDef t
</span><a href="Plutus.PAB.Webserver.Types.html#caID"><span class="hs-identifier hs-var">caID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractDef t
</span><a href="#local-6989586621680392346"><span class="hs-identifier hs-var">contractDef</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
-&gt; PABAction t env ContractInstanceId
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392347"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
 -&gt; PABAction t env ContractInstanceId)
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
-&gt; PABAction t env ContractInstanceId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractInstanceId
 -&gt; Eff (ContractInstanceEffects t env '[IO]) ~&gt; IO)
-&gt; ContractActivationArgs (ContractDef t)
-&gt; Eff (ContractInstanceEffects t env '[IO]) ContractInstanceId
forall t (m :: * -&gt; *) (appBackend :: [* -&gt; *]) (effs :: [* -&gt; *]).
(Member (LogMsg (ContractInstanceMsg t)) effs,
 Member UUIDEffect effs, Member (ContractEffect t) effs,
 Member (ContractStore t) effs, Member (Reader InstancesState) effs,
 PABContract t, AppBackendConstraints t m appBackend,
 LastMember m (Reader ContractInstanceId : appBackend),
 LastMember m effs) =&gt;
(ContractInstanceId -&gt; Eff appBackend ~&gt; IO)
-&gt; ContractActivationArgs (ContractDef t)
-&gt; Eff effs ContractInstanceId
</span><a href="Plutus.PAB.Core.ContractInstance.html#activateContractSTM"><span class="hs-identifier hs-var">ContractInstance.activateContractSTM</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392349"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392348"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) ~&gt; IO
forall a.
ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a -&gt; IO a
</span><a href="#local-6989586621680392344"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680392341"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Call a named endpoint on a contract instance. Waits if the endpoint is not</span><span>
</span><span id="line-288"></span><span class="hs-comment">--   available.</span><span>
</span><span id="line-289"></span><span class="annot"><a href="Plutus.PAB.Core.html#callEndpointOnInstance"><span class="hs-identifier hs-type">callEndpointOnInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392339"><span class="annot"><a href="#local-6989586621680392339"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392338"><span class="annot"><a href="#local-6989586621680392338"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392337"><span class="annot"><a href="#local-6989586621680392337"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392337"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680392337"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392339"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392338"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NotificationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span id="callEndpointOnInstance"><span class="annot"><span class="annottext">callEndpointOnInstance :: ContractInstanceId
-&gt; [Char] -&gt; a -&gt; PABAction t env (Maybe NotificationError)
</span><a href="Plutus.PAB.Core.html#callEndpointOnInstance"><span class="hs-identifier hs-var hs-var">callEndpointOnInstance</span></a></span></span><span> </span><span id="local-6989586621680392335"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392335"><span class="hs-identifier hs-var">instanceID</span></a></span></span><span> </span><span id="local-6989586621680392334"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392334"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621680392333"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392333"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621680392332"><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392332"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState)
-&gt; Eff (PABEffects t env) InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392339"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392338"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621680392331"><span class="annot"><span class="annottext">TMVar ()
</span><a href="#local-6989586621680392331"><span class="hs-identifier hs-var">timeoutVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; Timeout) -&gt; Eff (PABEffects t env) Timeout
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392339"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392338"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; Timeout
forall t env. PABEnvironment t env -&gt; Timeout
</span><a href="Plutus.PAB.Core.html#endpointTimeout"><span class="hs-identifier hs-var hs-var">endpointTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t env) Timeout
-&gt; (Timeout -&gt; Eff (PABEffects t env) (TMVar ()))
-&gt; Eff (PABEffects t env) (TMVar ())
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680392330"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392330"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (TMVar ()) -&gt; Eff (PABEffects t env) (TMVar ())
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (TMVar ()) -&gt; Eff (PABEffects t env) (TMVar ()))
-&gt; IO (TMVar ()) -&gt; Eff (PABEffects t env) (TMVar ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Second -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Second -&gt; Bool) -&gt; Maybe Second -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout -&gt; Maybe Second
</span><a href="Plutus.PAB.Timeout.html#unTimeout"><span class="hs-identifier hs-var hs-var">unTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392330"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Timeout -&gt; IO (TMVar ())
</span><a href="Plutus.PAB.Timeout.html#startTimeout"><span class="hs-identifier hs-var">Timeout.startTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392330"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO (TMVar ())
forall a. a -&gt; IO (TMVar a)
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.newTMVarIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">IO (Maybe NotificationError)
-&gt; PABAction t env (Maybe NotificationError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe NotificationError)
 -&gt; PABAction t env (Maybe NotificationError))
-&gt; IO (Maybe NotificationError)
-&gt; PABAction t env (Maybe NotificationError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">TMVar ()
-&gt; InstancesState
-&gt; EndpointDescription
-&gt; Value
-&gt; ContractInstanceId
-&gt; IO (STM (Maybe NotificationError))
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#callEndpointOnInstanceTimeout"><span class="hs-identifier hs-var">Instances.callEndpointOnInstanceTimeout</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">TMVar ()
</span><a href="#local-6989586621680392331"><span class="hs-identifier hs-var">timeoutVar</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392332"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; EndpointDescription
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392334"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">JSON.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392333"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392335"><span class="hs-identifier hs-var">instanceID</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">IO (STM (Maybe NotificationError))
-&gt; (STM (Maybe NotificationError) -&gt; IO (Maybe NotificationError))
-&gt; IO (Maybe NotificationError)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe NotificationError) -&gt; IO (Maybe NotificationError)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | The 'InstanceState' for the instance. Throws a 'ContractInstanceNotFound' error if the instance does not exist.</span><span>
</span><span id="line-312"></span><span class="annot"><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-type">instanceStateInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392809"><span class="annot"><a href="#local-6989586621680392809"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392808"><span class="annot"><a href="#local-6989586621680392808"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392809"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392808"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span>
</span><span id="line-313"></span><span id="instanceStateInternal"><span class="annot"><span class="annottext">instanceStateInternal :: ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var hs-var">instanceStateInternal</span></a></span></span><span> </span><span id="local-6989586621680392323"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392323"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState)
-&gt; Eff (PABEffects t env) InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392809"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392808"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">Eff (PABEffects t env) InstancesState
-&gt; (InstancesState -&gt; Eff (PABEffects t env) (Maybe InstanceState))
-&gt; Eff (PABEffects t env) (Maybe InstanceState)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe InstanceState)
-&gt; Eff (PABEffects t env) (Maybe InstanceState)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe InstanceState)
 -&gt; Eff (PABEffects t env) (Maybe InstanceState))
-&gt; (InstancesState -&gt; IO (Maybe InstanceState))
-&gt; InstancesState
-&gt; Eff (PABEffects t env) (Maybe InstanceState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; InstancesState -&gt; IO (Maybe InstanceState)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#instanceState"><span class="hs-identifier hs-var">Instances.instanceState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392323"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><span class="annottext">Eff (PABEffects t env) (Maybe InstanceState)
-&gt; (Maybe InstanceState -&gt; PABAction t env InstanceState)
-&gt; PABAction t env InstanceState
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env InstanceState
-&gt; (InstanceState -&gt; PABAction t env InstanceState)
-&gt; Maybe InstanceState
-&gt; PABAction t env InstanceState
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PABError -&gt; PABAction t env InstanceState
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError -&gt; PABAction t env InstanceState)
-&gt; PABError -&gt; PABAction t env InstanceState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABError
</span><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier hs-var">ContractInstanceNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392323"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; PABAction t env InstanceState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Delete the instance from the 'InstancesState' of the @PABEnvironment@ and from `InMemInstances` / Beam db.</span><span>
</span><span id="line-319"></span><span class="annot"><a href="Plutus.PAB.Core.html#removeInstance"><span class="hs-identifier hs-type">removeInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392320"><span class="annot"><a href="#local-6989586621680392320"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392319"><span class="annot"><a href="#local-6989586621680392319"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392320"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392319"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span id="removeInstance"><span class="annot"><span class="annottext">removeInstance :: ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#removeInstance"><span class="hs-identifier hs-var hs-var">removeInstance</span></a></span></span><span> </span><span id="local-6989586621680392318"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392318"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState)
-&gt; Eff (PABEffects t env) InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392320"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392319"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t env) InstancesState
-&gt; (InstancesState -&gt; PABAction t env ()) -&gt; PABAction t env ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; PABAction t env ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PABAction t env ())
-&gt; (InstancesState -&gt; IO ())
-&gt; InstancesState
-&gt; PABAction t env ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; InstancesState -&gt; IO ()
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#removeInstance"><span class="hs-identifier hs-var">Instances.removeInstance</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392318"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env ()
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs ()
</span><a href="Plutus.PAB.Effects.Contract.html#deleteState"><span class="hs-identifier hs-var">Contract.deleteState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392320"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392318"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Stop the instance.</span><span>
</span><span id="line-325"></span><span class="annot"><a href="Plutus.PAB.Core.html#stopInstance"><span class="hs-identifier hs-type">stopInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392315"><span class="annot"><a href="#local-6989586621680392315"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392314"><span class="annot"><a href="#local-6989586621680392314"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392314"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="stopInstance"><span class="annot"><span class="annottext">stopInstance :: ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#stopInstance"><span class="hs-identifier hs-var hs-var">stopInstance</span></a></span></span><span> </span><span id="local-6989586621680392313"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392313"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392311"><span class="annot"><span class="annottext">TVar Activity
issStatus :: InstanceState -&gt; TVar Activity
issStatus :: TVar Activity
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#issStatus"><span class="hs-identifier hs-var hs-var">Instances.issStatus</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392309"><span class="annot"><span class="annottext">TMVar ()
issStop :: InstanceState -&gt; TMVar ()
issStop :: TMVar ()
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#issStop"><span class="hs-identifier hs-var hs-var">Instances.issStop</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392313"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621680392307"><span class="annot"><span class="annottext">Maybe PABError
</span><a href="#local-6989586621680392307"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe PABError) -&gt; Eff (PABEffects t env) (Maybe PABError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe PABError) -&gt; Eff (PABEffects t env) (Maybe PABError))
-&gt; IO (Maybe PABError) -&gt; Eff (PABEffects t env) (Maybe PABError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe PABError) -&gt; IO (Maybe PABError)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (Maybe PABError) -&gt; IO (Maybe PABError))
-&gt; STM (Maybe PABError) -&gt; IO (Maybe PABError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>            </span><span id="local-6989586621680392306"><span class="annot"><span class="annottext">Activity
</span><a href="#local-6989586621680392306"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Activity -&gt; STM Activity
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Activity
</span><a href="#local-6989586621680392311"><span class="hs-identifier hs-var">issStatus</span></a></span><span>
</span><span id="line-330"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Activity
</span><a href="#local-6989586621680392306"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">Activity
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TMVar () -&gt; () -&gt; STM ()
forall a. TMVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.putTMVar</span></a></span><span> </span><span class="annot"><span class="annottext">TMVar ()
</span><a href="#local-6989586621680392309"><span class="hs-identifier hs-var">issStop</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">STM () -&gt; STM (Maybe PABError) -&gt; STM (Maybe PABError)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PABError -&gt; STM (Maybe PABError)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PABError
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-332"></span><span>                </span><span class="annot"><span class="annottext">Activity
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PABError -&gt; STM (Maybe PABError)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PABError -&gt; Maybe PABError
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError -&gt; Maybe PABError) -&gt; PABError -&gt; Maybe PABError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABError
</span><a href="Plutus.PAB.Types.html#InstanceAlreadyStopped"><span class="hs-identifier hs-var">InstanceAlreadyStopped</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392313"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">(PABError -&gt; Eff (PABEffects t env) Any)
-&gt; Maybe PABError -&gt; PABAction t env ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Eff (PABEffects t env) Any
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PABError
</span><a href="#local-6989586621680392307"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | The 'Activity' of the instance.</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Plutus.PAB.Core.html#instanceActivity"><span class="hs-identifier hs-type">instanceActivity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392303"><span class="annot"><a href="#local-6989586621680392303"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392302"><span class="annot"><a href="#local-6989586621680392302"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392302"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier hs-type">Activity</span></a></span><span>
</span><span id="line-337"></span><span id="instanceActivity"><span class="annot"><span class="annottext">instanceActivity :: ContractInstanceId -&gt; PABAction t env Activity
</span><a href="Plutus.PAB.Core.html#instanceActivity"><span class="hs-identifier hs-var hs-var">instanceActivity</span></a></span></span><span> </span><span id="local-6989586621680392301"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392301"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392300"><span class="annot"><span class="annottext">TVar Activity
issStatus :: TVar Activity
issStatus :: InstanceState -&gt; TVar Activity
</span><a href="#local-6989586621680392300"><span class="hs-identifier hs-var hs-var">Instances.issStatus</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392301"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">IO Activity -&gt; PABAction t env Activity
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Activity -&gt; PABAction t env Activity)
-&gt; IO Activity -&gt; PABAction t env Activity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Activity -&gt; IO Activity
forall a. TVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Activity
</span><a href="#local-6989586621680392300"><span class="hs-identifier hs-var">issStatus</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Call a named endpoint on a contract instance. Fails immediately if the</span><span>
</span><span id="line-342"></span><span class="hs-comment">--   endpoint is not available.</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Plutus.PAB.Core.html#callEndpointOnInstance%27"><span class="hs-identifier hs-type">callEndpointOnInstance'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392298"><span class="annot"><a href="#local-6989586621680392298"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392297"><span class="annot"><a href="#local-6989586621680392297"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392296"><span class="annot"><a href="#local-6989586621680392296"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392296"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680392296"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392298"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392297"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NotificationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span id="callEndpointOnInstance%27"><span class="annot"><span class="annottext">callEndpointOnInstance' :: ContractInstanceId
-&gt; [Char] -&gt; a -&gt; PABAction t env (Maybe NotificationError)
</span><a href="Plutus.PAB.Core.html#callEndpointOnInstance%27"><span class="hs-identifier hs-var hs-var">callEndpointOnInstance'</span></a></span></span><span> </span><span id="local-6989586621680392295"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392295"><span class="hs-identifier hs-var">instanceID</span></a></span></span><span> </span><span id="local-6989586621680392294"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392294"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621680392293"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392293"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621680392292"><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392292"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState)
-&gt; Eff (PABEffects t env) InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392298"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392297"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">IO (Maybe NotificationError)
-&gt; PABAction t env (Maybe NotificationError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstancesState
-&gt; EndpointDescription
-&gt; Value
-&gt; ContractInstanceId
-&gt; IO (STM (Maybe NotificationError))
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#callEndpointOnInstance"><span class="hs-identifier hs-var">Instances.callEndpointOnInstance</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392292"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; EndpointDescription
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EndpointDescription</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392294"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">JSON.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680392293"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392295"><span class="hs-identifier hs-var">instanceID</span></a></span><span> </span><span class="annot"><span class="annottext">IO (STM (Maybe NotificationError))
-&gt; (STM (Maybe NotificationError) -&gt; IO (Maybe NotificationError))
-&gt; IO (Maybe NotificationError)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe NotificationError) -&gt; IO (Maybe NotificationError)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Make a payment.</span><span>
</span><span id="line-357"></span><span id="local-6989586621680392774"><span id="local-6989586621680392775"><span class="annot"><a href="Plutus.PAB.Core.html#payToAddress"><span class="hs-identifier hs-type">payToAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392775"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392774"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoTx</span></a></span></span></span><span>
</span><span id="line-358"></span><span id="payToAddress"><span class="annot"><span class="annottext">payToAddress :: Params
-&gt; ContractInstanceId
-&gt; Wallet
-&gt; Address
-&gt; Value
-&gt; PABAction t env CardanoTx
</span><a href="Plutus.PAB.Core.html#payToAddress"><span class="hs-identifier hs-var hs-var">payToAddress</span></a></span></span><span> </span><span id="local-6989586621680392290"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680392290"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680392289"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392289"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621680392288"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392288"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span id="local-6989586621680392287"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621680392287"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621680392286"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680392286"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) CardanoTx
-&gt; PABAction t env CardanoTx
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392288"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Maybe ContractInstanceId
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392289"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t env '[IO]) CardanoTx
 -&gt; PABAction t env CardanoTx)
-&gt; Eff (ContractInstanceEffects t env '[IO]) CardanoTx
-&gt; PABAction t env CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletAPIError -&gt; PABError)
-&gt; Eff (Error WalletAPIError : ContractInstanceEffects t env '[IO])
   ~&gt; Eff (ContractInstanceEffects t env '[IO])
forall e f (effs :: [* -&gt; *]).
Member (Error f) effs =&gt;
(e -&gt; f) -&gt; Eff (Error e : effs) ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Modify.wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier hs-var">WalletError</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError : ContractInstanceEffects t env '[IO])
   CardanoTx
 -&gt; Eff (ContractInstanceEffects t env '[IO]) CardanoTx)
-&gt; Eff
     (Error WalletAPIError : ContractInstanceEffects t env '[IO])
     CardanoTx
-&gt; Eff (ContractInstanceEffects t env '[IO]) CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params
-&gt; SlotRange
-&gt; Value
-&gt; Address
-&gt; Eff
     (Error WalletAPIError : ContractInstanceEffects t env '[IO])
     CardanoTx
forall (effs :: [* -&gt; *]).
(Member WalletEffect effs, Member (Error WalletAPIError) effs,
 Member (LogMsg Text) effs,
 Member (LogMsg RequestHandlerLogMsg) effs) =&gt;
Params -&gt; SlotRange -&gt; Value -&gt; Address -&gt; Eff effs CardanoTx
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.payToAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680392290"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.defaultSlotRange</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680392286"><span class="hs-identifier hs-var">amount</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621680392287"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Make a payment to a payment public key.</span><span>
</span><span id="line-364"></span><span id="local-6989586621680392281"><span id="local-6989586621680392282"><span class="annot"><a href="Plutus.PAB.Core.html#payToPaymentPublicKey"><span class="hs-identifier hs-type">payToPaymentPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392282"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392281"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoTx</span></a></span></span></span><span>
</span><span id="line-365"></span><span id="payToPaymentPublicKey"><span class="annot"><span class="annottext">payToPaymentPublicKey :: Params
-&gt; ContractInstanceId
-&gt; Wallet
-&gt; PaymentPubKeyHash
-&gt; Value
-&gt; PABAction t env CardanoTx
</span><a href="Plutus.PAB.Core.html#payToPaymentPublicKey"><span class="hs-identifier hs-var hs-var">payToPaymentPublicKey</span></a></span></span><span> </span><span id="local-6989586621680392280"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680392280"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680392279"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392279"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621680392278"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392278"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span id="local-6989586621680392277"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680392277"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">Params
-&gt; ContractInstanceId
-&gt; Wallet
-&gt; Address
-&gt; Value
-&gt; PABAction t env CardanoTx
forall t env.
Params
-&gt; ContractInstanceId
-&gt; Wallet
-&gt; Address
-&gt; Value
-&gt; PABAction t env CardanoTx
</span><a href="Plutus.PAB.Core.html#payToAddress"><span class="hs-identifier hs-var">payToAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680392280"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392279"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392278"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Maybe StakingCredential -&gt; Address
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">pubKeyHashAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680392277"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Effects available to contract instances with access to external services.</span><span>
</span><span id="line-369"></span><span class="hs-keyword">type</span><span> </span><span id="ContractInstanceEffects"><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-var">ContractInstanceEffects</span></a></span></span><span> </span><span id="local-6989586621680392276"><span class="annot"><a href="#local-6989586621680392276"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392275"><span class="annot"><a href="#local-6989586621680392275"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392274"><span class="annot"><a href="#local-6989586621680392274"><span class="hs-identifier hs-type">effs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392276"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392276"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.UUID.html#UUIDEffect"><span class="hs-identifier hs-type">UUIDEffect</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">TxBalanceMsg</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">RequestHandlerLogMsg</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.RequestHandlers.html#ContractInstanceMsg"><span class="hs-identifier hs-type">ContractInstanceMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392276"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogObserve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">InstancesState</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392276"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392275"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392274"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | Handle an action with 'ContractInstanceEffects' in the context of a wallet.</span><span>
</span><span id="line-390"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-type">handleAgentThread</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392870"><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392869"><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392868"><span class="annot"><a href="#local-6989586621680392868"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392868"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392868"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-396"></span><span id="handleAgentThread"><span class="annot"><span class="annottext">handleAgentThread :: Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var hs-var">handleAgentThread</span></a></span></span><span> </span><span id="local-6989586621680392273"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680392272"><span class="annot"><span class="annottext">Maybe ContractInstanceId
</span><a href="#local-6989586621680392272"><span class="hs-identifier hs-var">cidM</span></a></span></span><span> </span><span id="local-6989586621680392271"><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392271"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392270"><span class="annot"><span class="annottext">EffectHandlers t env
effectHandlers :: EffectHandlers t env
effectHandlers :: forall t env. PABEnvironment t env -&gt; EffectHandlers t env
</span><a href="#local-6989586621680392270"><span class="hs-identifier hs-var hs-var">effectHandlers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392269"><span class="annot"><span class="annottext">BlockchainEnv
blockchainEnv :: BlockchainEnv
blockchainEnv :: forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="#local-6989586621680392269"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392268"><span class="annot"><span class="annottext">InstancesState
instancesState :: InstancesState
instancesState :: forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="#local-6989586621680392268"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs (PABEnvironment t env)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392267"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
handleContractStoreEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392267"><span class="hs-identifier hs-var hs-var">handleContractStoreEffect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392266"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
handleContractEffect :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392266"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392265"><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
handleServicesEffects :: forall t env.
EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Wallet
   -&gt; Maybe ContractInstanceId
   -&gt; Eff
        (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
      ~&gt; Eff effs
handleServicesEffects :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleServicesEffects"><span class="hs-identifier hs-var hs-var">handleServicesEffects</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EffectHandlers t env
</span><a href="#local-6989586621680392270"><span class="hs-identifier hs-var">effectHandlers</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680392263"><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env (IO : PABEffects t env)) a
</span><a href="#local-6989586621680392263"><span class="hs-identifier hs-var">action'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEffects"><span class="hs-identifier hs-type">PABEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392868"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
-&gt; Eff (ContractInstanceEffects t env (IO : PABEffects t env)) a
forall (effs :: [* -&gt; *]) (as :: [* -&gt; *]).
CanWeakenEnd as effs =&gt;
Eff as ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Modify.raiseEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env '[IO]) a
</span><a href="#local-6989586621680392271"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member IO effs =&gt;
Eff (IO : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
Member eff effs =&gt;
Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">subsume</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">(Eff (IO : PABEffects t env) a -&gt; PABAction t env a)
-&gt; Eff (IO : PABEffects t env) a -&gt; PABAction t env a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Eff (Reader Wallet : IO : PABEffects t env) a
-&gt; Eff (IO : PABEffects t env) a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="annottext">(Eff (Reader Wallet : IO : PABEffects t env) a
 -&gt; Eff (IO : PABEffects t env) a)
-&gt; Eff (Reader Wallet : IO : PABEffects t env) a
-&gt; Eff (IO : PABEffects t env) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff (Reader (PABEnvironment t env) : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
Member eff effs =&gt;
Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">subsume</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff (Reader Wallet : IO : PABEffects t env) a)
-&gt; Eff
     (Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff (Reader Wallet : IO : PABEffects t env) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState
-&gt; Eff
     (Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392268"><span class="hs-identifier hs-var">instancesState</span></a></span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
-&gt; Eff
     (Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall r (effs :: [* -&gt; *]) a.
r -&gt; Eff (Reader r : effs) a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runReader</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392269"><span class="hs-identifier hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; Eff
     (Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeEffect
 ~&gt; Eff
      (Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (TimeEffect
        : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember IO effs,
 MonadIO IO) =&gt;
TimeEffect ~&gt; Eff effs
forall t env (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs, LastMember m effs,
 MonadIO m) =&gt;
TimeEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-var">handleTimeEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392869"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (TimeEffect
      : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (TimeEffect
        : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Error PABError) effs =&gt;
Eff (Error PABError : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
Member eff effs =&gt;
Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">subsume</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (TimeEffect
         : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; Eff
     (Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (TimeEffect
        : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent
 ~&gt; Eff
      (Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent
   ~&gt; Eff
        (Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent
      : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg Text
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent
            : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent'
 ~&gt; Eff
      (LogMsg EmulatorEvent
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent'
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent
           : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent'
      : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg Text
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent'
            : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletEvent
 ~&gt; Eff
      (LogMsg EmulatorEvent'
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg WalletEvent
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; LogMsg WalletEvent
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; WalletEvent -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WalletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg WalletEvent
      : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent'
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg Text
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg WalletEvent
            : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent'
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg Text
 ~&gt; Eff
      (LogMsg WalletEvent
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg WalletEvent
           : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; WalletEvent)
-&gt; LogMsg Text
   ~&gt; Eff
        (LogMsg WalletEvent
           : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; WalletEvent
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">GenericLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg Text
      : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (LogObserve (LogMessage Text)
     : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
     : Reader InstancesState : Reader (PABEnvironment t env)
     : Reader Wallet : IO : PABEffects t env)
  a
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall (effs :: [* -&gt; *]).
Member (LogMsg Text) effs =&gt;
Eff (LogObserve (LogMessage Text) : effs) ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">handleObserveLog</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg Text
         : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg Text
        : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg (ContractInstanceMsg t)
 ~&gt; Eff
      (LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ContractInstanceMsg t -&gt; PABMultiAgentMsg t)
-&gt; LogMsg (ContractInstanceMsg t)
   ~&gt; Eff
        (LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceMsg t -&gt; PABMultiAgentMsg t
forall t. ContractInstanceMsg t -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#ContractInstanceLog"><span class="hs-identifier hs-var">ContractInstanceLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg (ContractInstanceMsg t)
      : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent
 ~&gt; Eff
      (LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent
   ~&gt; Eff
        (LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent
            : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
            : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent'
 ~&gt; Eff
      (LogMsg EmulatorEvent
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent'
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent'
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent'
            : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
            : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletEvent
 ~&gt; Eff
      (LogMsg EmulatorEvent'
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg WalletEvent
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; LogMsg WalletEvent
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; WalletEvent -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WalletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg WalletEvent
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent'
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg WalletEvent
            : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
            : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
            : Reader InstancesState : Reader (PABEnvironment t env)
            : Reader Wallet : IO : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent'
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg RequestHandlerLogMsg
 ~&gt; Eff
      (LogMsg WalletEvent
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (LogMsg WalletEvent
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RequestHandlerLogMsg -&gt; WalletEvent)
-&gt; LogMsg RequestHandlerLogMsg
   ~&gt; Eff
        (LogMsg WalletEvent
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">RequestHandlerLogMsg -&gt; WalletEvent
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">RequestHandlerLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg RequestHandlerLogMsg
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent
 ~&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (LogMsg RequestHandlerLogMsg
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent
   ~&gt; Eff
        (LogMsg RequestHandlerLogMsg
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392870"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent
      : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
      : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg TxBalanceMsg
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent
            : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
            : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
            : TimeEffect : Reader BlockchainEnv : Reader InstancesState
            : Reader (PABEnvironment t env) : Reader Wallet : IO
            : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent'
 ~&gt; Eff
      (LogMsg EmulatorEvent
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env))
-&gt; Eff
     (LogMsg EmulatorEvent'
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent
           : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg EmulatorEvent'
      : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
      : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg TxBalanceMsg
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg EmulatorEvent'
            : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
            : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
            : TimeEffect : Reader BlockchainEnv : Reader InstancesState
            : Reader (PABEnvironment t env) : Reader Wallet : IO
            : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg WalletEvent
 ~&gt; Eff
      (LogMsg EmulatorEvent'
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env))
-&gt; Eff
     (LogMsg WalletEvent
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WalletEvent -&gt; EmulatorEvent')
-&gt; LogMsg WalletEvent
   ~&gt; Eff
        (LogMsg EmulatorEvent'
           : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; WalletEvent -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WalletEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (LogMsg WalletEvent
      : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
      : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg EmulatorEvent'
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; (Eff
      (LogMsg TxBalanceMsg
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a
    -&gt; Eff
         (LogMsg WalletEvent
            : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
            : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
            : TimeEffect : Reader BlockchainEnv : Reader InstancesState
            : Reader (PABEnvironment t env) : Reader Wallet : IO
            : PABEffects t env)
         a)
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (LogMsg EmulatorEvent'
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg
 ~&gt; Eff
      (LogMsg WalletEvent
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env))
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
   ~&gt; Eff
        (LogMsg WalletEvent
           : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxBalanceMsg -&gt; WalletEvent)
-&gt; LogMsg TxBalanceMsg
   ~&gt; Eff
        (LogMsg WalletEvent
           : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
           : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
           : TimeEffect : Reader BlockchainEnv : Reader InstancesState
           : Reader (PABEnvironment t env) : Reader Wallet : IO
           : PABEffects t env)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">TxBalanceMsg -&gt; WalletEvent
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">TxBalanceLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg TxBalanceMsg
      : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
      : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
      : TimeEffect : Reader BlockchainEnv : Reader InstancesState
      : Reader (PABEnvironment t env) : Reader Wallet : IO
      : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
-&gt; Eff
     (LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (UUIDEffect
     : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
     : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
     : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
     : Reader InstancesState : Reader (PABEnvironment t env)
     : Reader Wallet : IO : PABEffects t env)
  a
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Eff (UUIDEffect : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Effects.UUID.html#handleUUIDEffect"><span class="hs-identifier hs-var">handleUUIDEffect</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (UUIDEffect
      : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (LogMsg TxBalanceMsg
         : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
         : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
         : TimeEffect : Reader BlockchainEnv : Reader InstancesState
         : Reader (PABEnvironment t env) : Reader Wallet : IO
         : PABEffects t env)
      a)
-&gt; Eff
     (UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (LogMsg TxBalanceMsg
        : LogMsg RequestHandlerLogMsg : LogMsg (ContractInstanceMsg t)
        : LogObserve (LogMessage Text) : LogMsg Text : Error PABError
        : TimeEffect : Reader BlockchainEnv : Reader InstancesState
        : Reader (PABEnvironment t env) : Reader Wallet : IO
        : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect
        : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
   ~&gt; Eff
        (UUIDEffect
           : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
           : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
           : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
           : Reader InstancesState : Reader (PABEnvironment t env)
           : Reader Wallet : IO : PABEffects t env)
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
</span><a href="#local-6989586621680392265"><span class="hs-identifier hs-var">handleServicesEffects</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392273"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
</span><a href="#local-6989586621680392272"><span class="hs-identifier hs-var">cidM</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (WalletEffect
      : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
      : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (UUIDEffect
         : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (WalletEffect
        : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (ContractStore t
     : WalletEffect : ChainIndexQueryEffect : NodeClientEffect
     : UUIDEffect : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
     : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
     : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
     : Reader InstancesState : Reader (PABEnvironment t env)
     : Reader Wallet : IO : PABEffects t env)
  a
-&gt; Eff
     (WalletEffect
        : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392267"><span class="hs-identifier hs-var">handleContractStoreEffect</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (ContractStore t
      : WalletEffect : ChainIndexQueryEffect : NodeClientEffect
      : UUIDEffect : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
      : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
      : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
      : Reader InstancesState : Reader (PABEnvironment t env)
      : Reader Wallet : IO : PABEffects t env)
   a
 -&gt; Eff
      (WalletEffect
         : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
         : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
         : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
         : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
         : Reader InstancesState : Reader (PABEnvironment t env)
         : Reader Wallet : IO : PABEffects t env)
      a)
-&gt; Eff
     (ContractStore t
        : WalletEffect : ChainIndexQueryEffect : NodeClientEffect
        : UUIDEffect : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
-&gt; Eff
     (WalletEffect
        : ChainIndexQueryEffect : NodeClientEffect : UUIDEffect
        : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env (IO : PABEffects t env)) a
-&gt; Eff
     (ContractStore t
        : WalletEffect : ChainIndexQueryEffect : NodeClientEffect
        : UUIDEffect : LogMsg TxBalanceMsg : LogMsg RequestHandlerLogMsg
        : LogMsg (ContractInstanceMsg t) : LogObserve (LogMessage Text)
        : LogMsg Text : Error PABError : TimeEffect : Reader BlockchainEnv
        : Reader InstancesState : Reader (PABEnvironment t env)
        : Reader Wallet : IO : PABEffects t env)
     a
forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t env)) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="#local-6989586621680392266"><span class="hs-identifier hs-var">handleContractEffect</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ContractInstanceEffects t env (IO : PABEffects t env)) a
</span><a href="#local-6989586621680392263"><span class="hs-identifier hs-var">action'</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Effect handlers for running the PAB.</span><span>
</span><span id="line-419"></span><span class="hs-keyword">data</span><span> </span><span id="EffectHandlers"><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-var">EffectHandlers</span></a></span></span><span> </span><span id="local-6989586621680392953"><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392952"><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>    </span><span id="EffectHandlers"><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-var">EffectHandlers</span></a></span></span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Create the initial environment. This value is shared between all threads</span><span>
</span><span id="line-422"></span><span>          </span><span class="hs-comment">--   started by the PAB.</span><span>
</span><span id="line-423"></span><span>          </span><span id="initialiseEnvironment"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Error PABError) effs, LastMember IO effs) =&gt;
   Eff effs (InstancesState, BlockchainEnv, env)
</span><a href="Plutus.PAB.Core.html#initialiseEnvironment"><span class="hs-identifier hs-var hs-var">initialiseEnvironment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392900"><span class="annot"><a href="#local-6989586621680392900"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-424"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392900"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-425"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392900"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-426"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392900"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">InstancesState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>        </span><span class="hs-comment">-- | Handle log messages</span><span>
</span><span id="line-430"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="handleLogMessages"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member TimeEffect effs, Member (Error PABError) effs,
    LastMember IO effs) =&gt;
   Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleLogMessages"><span class="hs-identifier hs-var hs-var">handleLogMessages</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392962"><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-431"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-434"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>            </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392962"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-comment">-- | Handle the 'ContractStore' effect</span><span>
</span><span id="line-440"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="handleContractStoreEffect"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractStoreEffect"><span class="hs-identifier hs-var hs-var">handleContractStoreEffect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392951"><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-441"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-442"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-443"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-444"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>            </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392951"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-comment">-- | Handle the 'ContractEffect'</span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="handleContractEffect"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractEffect t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractEffect"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392949"><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-452"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-454"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-455"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-456"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>            </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392949"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>        </span><span class="hs-comment">-- | Handle the 'ContractDefinition' effect</span><span>
</span><span id="line-462"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="handleContractDefinitionEffect"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractDefinitionEffect"><span class="hs-identifier hs-var hs-var">handleContractDefinitionEffect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392947"><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-463"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-464"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-465"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-466"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-467"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-468"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDefinition"><span class="hs-identifier hs-type">ContractDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392947"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>        </span><span class="hs-comment">-- | Handle effects that serve requests to external services managed by the PAB</span><span>
</span><span id="line-473"></span><span>        </span><span class="hs-comment">--   Runs in the context of a particular wallet.</span><span>
</span><span id="line-474"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="handleServicesEffects"><span class="annot"><span class="annottext">EffectHandlers t env
-&gt; forall (effs :: [* -&gt; *]).
   (Member (Reader (PABEnvironment t env)) effs,
    Member (Error PABError) effs, Member TimeEffect effs,
    Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
   Wallet
   -&gt; Maybe ContractInstanceId
   -&gt; Eff
        (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
      ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleServicesEffects"><span class="hs-identifier hs-var hs-var">handleServicesEffects</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392769"><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-475"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-476"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-477"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-478"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-480"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-482"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-483"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>            </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392769"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-comment">-- | Action to run on startup.</span><span>
</span><span id="line-487"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="onStartup"><span class="annot"><span class="annottext">EffectHandlers t env -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#onStartup"><span class="hs-identifier hs-var hs-var">onStartup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span>        </span><span class="hs-comment">-- | Action to run on shutdown</span><span>
</span><span id="line-490"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="onShutdown"><span class="annot"><span class="annottext">EffectHandlers t env -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#onShutdown"><span class="hs-identifier hs-var hs-var">onShutdown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392953"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392952"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | Report the state of a running contract.</span><span>
</span><span id="line-494"></span><span class="annot"><a href="Plutus.PAB.Core.html#reportContractState"><span class="hs-identifier hs-type">reportContractState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392261"><span class="annot"><a href="#local-6989586621680392261"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392260"><span class="annot"><a href="#local-6989586621680392260"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392261"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392260"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392261"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392260"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Events.ContractInstanceState.html#PartiallyDecodedResponse"><span class="hs-identifier hs-type">PartiallyDecodedResponse</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">PABReq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span id="reportContractState"><span class="annot"><span class="annottext">reportContractState :: ContractInstanceId -&gt; Eff effs (PartiallyDecodedResponse PABReq)
</span><a href="Plutus.PAB.Core.html#reportContractState"><span class="hs-identifier hs-var hs-var">reportContractState</span></a></span></span><span> </span><span id="local-6989586621680392259"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392259"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractResponse Value Value PABResp PABReq
-&gt; PartiallyDecodedResponse PABReq
forall s v.
ContractResponse Value Value s v -&gt; PartiallyDecodedResponse v
</span><a href="Plutus.PAB.Events.ContractInstanceState.html#fromResp"><span class="hs-identifier hs-var">fromResp</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractResponse Value Value PABResp PABReq
 -&gt; PartiallyDecodedResponse PABReq)
-&gt; (State t -&gt; ContractResponse Value Value PABResp PABReq)
-&gt; State t
-&gt; PartiallyDecodedResponse PABReq
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy t -&gt; State t -&gt; ContractResponse Value Value PABResp PABReq
forall contract.
PABContract contract =&gt;
Proxy contract
-&gt; State contract -&gt; ContractResponse Value Value PABResp PABReq
</span><a href="Plutus.PAB.Effects.Contract.html#serialisableState"><span class="hs-identifier hs-var">Contract.serialisableState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy t
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392261"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(State t -&gt; PartiallyDecodedResponse PABReq)
-&gt; Eff effs (State t) -&gt; Eff effs (PartiallyDecodedResponse PABReq)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff effs (State t)
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var">getState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392261"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392259"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- | Annotate log messages with the current slot number.</span><span>
</span><span id="line-504"></span><span class="annot"><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-type">timed</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392748"><span class="annot"><a href="#local-6989586621680392748"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621680392749"><span class="annot"><a href="#local-6989586621680392749"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392748"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392749"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392749"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392748"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392749"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-511"></span><span id="timed"><span class="annot"><span class="annottext">timed :: LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var hs-var">timed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LMessage</span></a></span><span> </span><span id="local-6989586621680392256"><span class="annot"><span class="annottext">LogMessage e
</span><a href="#local-6989586621680392256"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-513"></span><span>        </span><span id="local-6989586621680392255"><span class="annot"><span class="annottext">LogMessage (EmulatorTimeEvent e)
</span><a href="#local-6989586621680392255"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LogMessage e
-&gt; (e -&gt; Eff effs (EmulatorTimeEvent e))
-&gt; Eff effs (LogMessage (EmulatorTimeEvent e))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage e
</span><a href="#local-6989586621680392256"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">((e -&gt; Eff effs (EmulatorTimeEvent e))
 -&gt; Eff effs (LogMessage (EmulatorTimeEvent e)))
-&gt; (e -&gt; Eff effs (EmulatorTimeEvent e))
-&gt; Eff effs (LogMessage (EmulatorTimeEvent e))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680392254"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680392254"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>            </span><span id="local-6989586621680392253"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392253"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff effs Slot
forall (effs :: [* -&gt; *]). Member TimeEffect effs =&gt; Eff effs Slot
</span><a href="Plutus.PAB.Effects.TimeEffect.html#systemTime"><span class="hs-identifier hs-var">systemTime</span></a></span><span>
</span><span id="line-515"></span><span>            </span><span class="annot"><span class="annottext">EmulatorTimeEvent e -&gt; Eff effs (EmulatorTimeEvent e)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; e -&gt; EmulatorTimeEvent e
forall e. Slot -&gt; e -&gt; EmulatorTimeEvent e
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">EmulatorTimeEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392253"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680392254"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="annottext">LogMsg (EmulatorTimeEvent e) () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogMessage (EmulatorTimeEvent e) -&gt; LogMsg (EmulatorTimeEvent e) ()
forall a. LogMessage a -&gt; LogMsg a ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">LMessage</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage (EmulatorTimeEvent e)
</span><a href="#local-6989586621680392255"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | Get the current state of the contract instance.</span><span>
</span><span id="line-519"></span><span class="annot"><a href="Plutus.PAB.Core.html#instanceState"><span class="hs-identifier hs-type">instanceState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392252"><span class="annot"><a href="#local-6989586621680392252"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392251"><span class="annot"><a href="#local-6989586621680392251"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392252"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392251"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">Contract.State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392252"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span id="instanceState"><span class="annot"><span class="annottext">instanceState :: Wallet -&gt; ContractInstanceId -&gt; PABAction t env (State t)
</span><a href="Plutus.PAB.Core.html#instanceState"><span class="hs-identifier hs-var hs-var">instanceState</span></a></span></span><span> </span><span id="local-6989586621680392250"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392250"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621680392249"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392249"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) (State t)
-&gt; PABAction t env (State t)
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392250"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Maybe ContractInstanceId
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392249"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) (State t)
forall t (effs :: [* -&gt; *]).
Member (ContractStore t) effs =&gt;
ContractInstanceId -&gt; Eff effs (State t)
</span><a href="Plutus.PAB.Effects.Contract.html#getState"><span class="hs-identifier hs-var">Contract.getState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392252"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392249"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- | An STM transaction that returns the observable state of the contract instance.</span><span>
</span><span id="line-523"></span><span class="annot"><a href="Plutus.PAB.Core.html#observableState"><span class="hs-identifier hs-type">observableState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392673"><span class="annot"><a href="#local-6989586621680392673"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392672"><span class="annot"><a href="#local-6989586621680392672"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392673"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392672"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span id="observableState"><span class="annot"><span class="annottext">observableState :: ContractInstanceId -&gt; PABAction t env (STM Value)
</span><a href="Plutus.PAB.Core.html#observableState"><span class="hs-identifier hs-var hs-var">observableState</span></a></span></span><span> </span><span id="local-6989586621680392248"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392248"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">InstanceState -&gt; STM Value
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#observableContractState"><span class="hs-identifier hs-var">Instances.observableContractState</span></a></span><span> </span><span class="annot"><span class="annottext">(InstanceState -&gt; STM Value)
-&gt; Eff (PABEffects t env) InstanceState
-&gt; PABAction t env (STM Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff (PABEffects t env) InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392673"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392672"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392248"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | Wait until the observable state of the instance matches a predicate.</span><span>
</span><span id="line-528"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForState"><span class="hs-identifier hs-type">waitForState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392246"><span class="annot"><a href="#local-6989586621680392246"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392245"><span class="annot"><a href="#local-6989586621680392245"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392244"><span class="annot"><a href="#local-6989586621680392244"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392244"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392246"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392245"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392244"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-529"></span><span id="waitForState"><span class="annot"><span class="annottext">waitForState :: (Value -&gt; Maybe a) -&gt; ContractInstanceId -&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#waitForState"><span class="hs-identifier hs-var hs-var">waitForState</span></a></span></span><span> </span><span id="local-6989586621680392243"><span class="annot"><span class="annottext">Value -&gt; Maybe a
</span><a href="#local-6989586621680392243"><span class="hs-identifier hs-var">extract</span></a></span></span><span> </span><span id="local-6989586621680392242"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392242"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621680392241"><span class="annot"><span class="annottext">STM Value
</span><a href="#local-6989586621680392241"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env (STM Value)
forall t env. ContractInstanceId -&gt; PABAction t env (STM Value)
</span><a href="Plutus.PAB.Core.html#observableState"><span class="hs-identifier hs-var">observableState</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392242"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><span class="annottext">IO a -&gt; PABAction t env a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; PABAction t env a) -&gt; IO a -&gt; PABAction t env a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM a -&gt; IO a
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM a -&gt; IO a) -&gt; STM a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621680392240"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680392240"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Value
</span><a href="#local-6989586621680392241"><span class="hs-identifier hs-var">stm</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="annottext">STM a -&gt; (a -&gt; STM a) -&gt; Maybe a -&gt; STM a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">STM a
forall a. STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.retry</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; STM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe a
</span><a href="#local-6989586621680392243"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680392240"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | Wait until the instance state of the instance satisfies a predicate and returns the activity status</span><span>
</span><span id="line-537"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForInstanceState"><span class="hs-identifier hs-type">waitForInstanceState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392652"><span class="annot"><a href="#local-6989586621680392652"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392651"><span class="annot"><a href="#local-6989586621680392651"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392652"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392651"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span>
</span><span id="line-542"></span><span id="waitForInstanceState"><span class="annot"><span class="annottext">waitForInstanceState :: (InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceState"><span class="hs-identifier hs-var hs-var">waitForInstanceState</span></a></span></span><span> </span><span id="local-6989586621680392238"><span class="annot"><span class="annottext">InstanceState -&gt; STM (Maybe ContractActivityStatus)
</span><a href="#local-6989586621680392238"><span class="hs-identifier hs-var">extract</span></a></span></span><span> </span><span id="local-6989586621680392237"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392237"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621680392236"><span class="annot"><span class="annottext">InstanceState
</span><a href="#local-6989586621680392236"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392237"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392235"><span class="annot"><span class="annottext">Timeout
waitStatusTimeout :: Timeout
waitStatusTimeout :: forall t env. PABEnvironment t env -&gt; Timeout
</span><a href="#local-6989586621680392235"><span class="hs-identifier hs-var hs-var">waitStatusTimeout</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs (PABEnvironment t env)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392652"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392651"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621680392234"><span class="annot"><span class="annottext">TMVar ()
</span><a href="#local-6989586621680392234"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (TMVar ()) -&gt; Eff (PABEffects t env) (TMVar ())
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timeout -&gt; IO (TMVar ())
</span><a href="Plutus.PAB.Timeout.html#startTimeout"><span class="hs-identifier hs-var">Timeout.startTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621680392235"><span class="hs-identifier hs-var">waitStatusTimeout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680392233"><span class="annot"><span class="annottext">waitAction :: STM ContractActivityStatus
</span><a href="#local-6989586621680392233"><span class="hs-identifier hs-var hs-var">waitAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; STM (Maybe ContractActivityStatus)
</span><a href="#local-6989586621680392238"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceState
</span><a href="#local-6989586621680392236"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe ContractActivityStatus)
-&gt; (Maybe ContractActivityStatus -&gt; STM ContractActivityStatus)
-&gt; STM ContractActivityStatus
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">STM ContractActivityStatus
-&gt; (ContractActivityStatus -&gt; STM ContractActivityStatus)
-&gt; Maybe ContractActivityStatus
-&gt; STM ContractActivityStatus
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">STM ContractActivityStatus
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; STM ContractActivityStatus
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span id="local-6989586621680392232"><span class="annot"><span class="annottext">Either () ContractActivityStatus
</span><a href="#local-6989586621680392232"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either () ContractActivityStatus)
-&gt; Eff (PABEffects t env) (Either () ContractActivityStatus)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STM (Either () ContractActivityStatus)
-&gt; IO (Either () ContractActivityStatus)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ContractActivityStatus
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; Either () ContractActivityStatus)
-&gt; STM () -&gt; STM (Either () ContractActivityStatus)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TMVar () -&gt; STM ()
forall a. TMVar a -&gt; STM a
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.takeTMVar</span></a></span><span> </span><span class="annot"><span class="annottext">TMVar ()
</span><a href="#local-6989586621680392234"><span class="hs-identifier hs-var">timeout</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">STM (Either () ContractActivityStatus)
-&gt; STM (Either () ContractActivityStatus)
-&gt; STM (Either () ContractActivityStatus)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; Either () ContractActivityStatus
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractActivityStatus -&gt; Either () ContractActivityStatus)
-&gt; STM ContractActivityStatus
-&gt; STM (Either () ContractActivityStatus)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">STM ContractActivityStatus
</span><a href="#local-6989586621680392233"><span class="hs-identifier hs-var">waitAction</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either () ContractActivityStatus
</span><a href="#local-6989586621680392232"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError -&gt; PABAction t env ContractActivityStatus
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; PABError
</span><a href="Plutus.PAB.Types.html#OtherError"><span class="hs-identifier hs-var">OtherError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;waitForInstanceState: Timeout&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680392230"><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680392230"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; PABAction t env ContractActivityStatus
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="#local-6989586621680392230"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- | Wait until the instance state is updated with a response form an invoked endpoint.</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- Note that the waiting is performed only when a contract is expected to end with a Done status, i.e.,</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- no open endpoints available after invocation.</span><span>
</span><span id="line-555"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-type">waitForInstanceStateWithResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392229"><span class="annot"><a href="#local-6989586621680392229"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392228"><span class="annot"><a href="#local-6989586621680392228"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392229"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392228"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span>
</span><span id="line-556"></span><span id="waitForInstanceStateWithResult"><span class="annot"><span class="annottext">waitForInstanceStateWithResult :: ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-var hs-var">waitForInstanceStateWithResult</span></a></span></span><span> </span><span id="local-6989586621680392227"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392227"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-comment">-- retry query when waiting for a response from an invoked endpoint s.t.</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-comment">-- contract is supposed to end with status Done</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680392226"><span class="hs-identifier hs-type">parseStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier hs-type">Activity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span>
</span><span id="line-560"></span><span>      </span><span id="local-6989586621680392226"><span class="annot"><span class="annottext">parseStatus :: Activity -&gt; ContractActivityStatus
</span><a href="#local-6989586621680392226"><span class="hs-identifier hs-var hs-var">parseStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-561"></span><span>        </span><span class="annot"><span class="annottext">Activity
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.Active</span></a></span><span>
</span><span id="line-562"></span><span>        </span><span class="annot"><span class="annottext">Activity
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#Stopped"><span class="hs-identifier hs-var">Stopped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.Stopped</span></a></span><span>
</span><span id="line-563"></span><span>        </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.Done</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680392222"><span class="hs-identifier hs-type">r_check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>      </span><span id="local-6989586621680392222"><span class="annot"><span class="annottext">r_check :: InstanceState -&gt; STM (Maybe ContractActivityStatus)
</span><a href="#local-6989586621680392222"><span class="hs-identifier hs-var hs-var">r_check</span></a></span></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680392221"><span class="annot"><span class="annottext">TVar (Map (RequestID, IterationID) OpenEndpoint)
issEndpoints :: InstanceState -&gt; TVar (Map (RequestID, IterationID) OpenEndpoint)
issEndpoints :: TVar (Map (RequestID, IterationID) OpenEndpoint)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#issEndpoints"><span class="hs-identifier hs-var hs-var">Instances.issEndpoints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392219"><span class="annot"><span class="annottext">TVar Activity
issStatus :: TVar Activity
issStatus :: InstanceState -&gt; TVar Activity
</span><a href="#local-6989586621680392219"><span class="hs-identifier hs-var hs-var">Instances.issStatus</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680392218"><span class="annot"><span class="annottext">TVar (Maybe Value)
issObservableState :: InstanceState -&gt; TVar (Maybe Value)
issObservableState :: TVar (Maybe Value)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#issObservableState"><span class="hs-identifier hs-var hs-var">Instances.issObservableState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-566"></span><span>        </span><span id="local-6989586621680392216"><span class="annot"><span class="annottext">Activity
</span><a href="#local-6989586621680392216"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Activity -&gt; STM Activity
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Activity
</span><a href="#local-6989586621680392219"><span class="hs-identifier hs-var">issStatus</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621680392215"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621680392215"><span class="hs-identifier hs-var">ostate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Maybe Value) -&gt; STM (Maybe Value)
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Maybe Value)
</span><a href="#local-6989586621680392218"><span class="hs-identifier hs-var">issObservableState</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span id="local-6989586621680392214"><span class="annot"><span class="annottext">Map (RequestID, IterationID) OpenEndpoint
</span><a href="#local-6989586621680392214"><span class="hs-identifier hs-var">currentEndpoints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map (RequestID, IterationID) OpenEndpoint)
-&gt; STM (Map (RequestID, IterationID) OpenEndpoint)
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map (RequestID, IterationID) OpenEndpoint)
</span><a href="#local-6989586621680392221"><span class="hs-identifier hs-var">issEndpoints</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity
</span><a href="#local-6989586621680392216"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621680392215"><span class="hs-identifier hs-var">ostate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-570"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var">JSON.Null</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map (RequestID, IterationID) OpenEndpoint -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map (RequestID, IterationID) OpenEndpoint
</span><a href="#local-6989586621680392214"><span class="hs-identifier hs-var">currentEndpoints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-571"></span><span>                                     </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus -&gt; STM (Maybe ContractActivityStatus)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-572"></span><span>          </span><span class="annot"><span class="annottext">(Activity, Maybe Value)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus -&gt; STM (Maybe ContractActivityStatus)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ContractActivityStatus
 -&gt; STM (Maybe ContractActivityStatus))
-&gt; Maybe ContractActivityStatus
-&gt; STM (Maybe ContractActivityStatus)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ContractActivityStatus -&gt; Maybe ContractActivityStatus
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ContractActivityStatus -&gt; Maybe ContractActivityStatus)
-&gt; ContractActivityStatus -&gt; Maybe ContractActivityStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Activity -&gt; ContractActivityStatus
</span><a href="#local-6989586621680392226"><span class="hs-identifier hs-var">parseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Activity
</span><a href="#local-6989586621680392216"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><span class="annottext">(InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; PABAction t env ContractActivityStatus
forall t env.
(InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceState"><span class="hs-identifier hs-var">waitForInstanceState</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; STM (Maybe ContractActivityStatus)
</span><a href="#local-6989586621680392222"><span class="hs-identifier hs-var">r_check</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392227"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | Wait for the transaction to be confirmed on the blockchain.</span><span>
</span><span id="line-576"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForTxStatusChange"><span class="hs-identifier hs-type">waitForTxStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392211"><span class="annot"><a href="#local-6989586621680392211"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392210"><span class="annot"><a href="#local-6989586621680392210"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392211"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392210"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxStatus</span></a></span><span>
</span><span id="line-577"></span><span id="waitForTxStatusChange"><span class="annot"><span class="annottext">waitForTxStatusChange :: TxId -&gt; PABAction t env TxStatus
</span><a href="Plutus.PAB.Core.html#waitForTxStatusChange"><span class="hs-identifier hs-var hs-var">waitForTxStatusChange</span></a></span></span><span> </span><span id="local-6989586621680392209"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680392209"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621680392208"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392208"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; BlockchainEnv)
-&gt; Eff (PABEffects t env) BlockchainEnv
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392211"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392210"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><span class="annottext">IO TxStatus -&gt; PABAction t env TxStatus
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO TxStatus -&gt; PABAction t env TxStatus)
-&gt; IO TxStatus -&gt; PABAction t env TxStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM TxStatus -&gt; IO TxStatus
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM TxStatus -&gt; IO TxStatus) -&gt; STM TxStatus -&gt; IO TxStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxStatus -&gt; TxId -&gt; BlockchainEnv -&gt; STM TxStatus
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#waitForTxStatusChange"><span class="hs-identifier hs-var">Instances.waitForTxStatusChange</span></a></span><span> </span><span class="annot"><span class="annottext">TxStatus
forall a. RollbackState a
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">Unknown</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680392209"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392208"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-comment">-- | Wait for the transaction output to be confirmed on the blockchain.</span><span>
</span><span id="line-582"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForTxOutStatusChange"><span class="hs-identifier hs-type">waitForTxOutStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392206"><span class="annot"><a href="#local-6989586621680392206"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392205"><span class="annot"><a href="#local-6989586621680392205"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392206"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392205"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxOutStatus</span></a></span><span>
</span><span id="line-583"></span><span id="waitForTxOutStatusChange"><span class="annot"><span class="annottext">waitForTxOutStatusChange :: TxOutRef -&gt; PABAction t env TxOutStatus
</span><a href="Plutus.PAB.Core.html#waitForTxOutStatusChange"><span class="hs-identifier hs-var hs-var">waitForTxOutStatusChange</span></a></span></span><span> </span><span id="local-6989586621680392204"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680392204"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621680392203"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392203"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; BlockchainEnv)
-&gt; Eff (PABEffects t env) BlockchainEnv
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392206"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392205"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><span class="annottext">IO TxOutStatus -&gt; PABAction t env TxOutStatus
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO TxOutStatus -&gt; PABAction t env TxOutStatus)
-&gt; IO TxOutStatus -&gt; PABAction t env TxOutStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM TxOutStatus -&gt; IO TxOutStatus
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM TxOutStatus -&gt; IO TxOutStatus)
-&gt; STM TxOutStatus -&gt; IO TxOutStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutStatus -&gt; TxOutRef -&gt; BlockchainEnv -&gt; STM TxOutStatus
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#waitForTxOutStatusChange"><span class="hs-identifier hs-var">Instances.waitForTxOutStatusChange</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutStatus
forall a. RollbackState a
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">Unknown</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680392204"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392203"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | The list of endpoints that are currently open</span><span>
</span><span id="line-588"></span><span class="annot"><a href="Plutus.PAB.Core.html#activeEndpoints"><span class="hs-identifier hs-type">activeEndpoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392632"><span class="annot"><a href="#local-6989586621680392632"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392631"><span class="annot"><a href="#local-6989586621680392631"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392632"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392631"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#OpenEndpoint"><span class="hs-identifier hs-type">OpenEndpoint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span id="activeEndpoints"><span class="annot"><span class="annottext">activeEndpoints :: ContractInstanceId -&gt; PABAction t env (STM [OpenEndpoint])
</span><a href="Plutus.PAB.Core.html#activeEndpoints"><span class="hs-identifier hs-var hs-var">activeEndpoints</span></a></span></span><span> </span><span id="local-6989586621680392201"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392201"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621680392200"><span class="annot"><span class="annottext">InstanceState
</span><a href="#local-6989586621680392200"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392201"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><span class="annottext">STM [OpenEndpoint] -&gt; PABAction t env (STM [OpenEndpoint])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(STM [OpenEndpoint] -&gt; PABAction t env (STM [OpenEndpoint]))
-&gt; STM [OpenEndpoint] -&gt; PABAction t env (STM [OpenEndpoint])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><span class="annottext">(((RequestID, IterationID), OpenEndpoint) -&gt; OpenEndpoint)
-&gt; [((RequestID, IterationID), OpenEndpoint)] -&gt; [OpenEndpoint]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">((RequestID, IterationID), OpenEndpoint) -&gt; OpenEndpoint
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([((RequestID, IterationID), OpenEndpoint)] -&gt; [OpenEndpoint])
-&gt; (Map (RequestID, IterationID) OpenEndpoint
    -&gt; [((RequestID, IterationID), OpenEndpoint)])
-&gt; Map (RequestID, IterationID) OpenEndpoint
-&gt; [OpenEndpoint]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map (RequestID, IterationID) OpenEndpoint
-&gt; [((RequestID, IterationID), OpenEndpoint)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (RequestID, IterationID) OpenEndpoint -&gt; [OpenEndpoint])
-&gt; STM (Map (RequestID, IterationID) OpenEndpoint)
-&gt; STM [OpenEndpoint]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; STM (Map (RequestID, IterationID) OpenEndpoint)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#openEndpoints"><span class="hs-identifier hs-var">Instances.openEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceState
</span><a href="#local-6989586621680392200"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">-- | Wait until the endpoint becomes active.</span><span>
</span><span id="line-595"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitForEndpoint"><span class="hs-identifier hs-type">waitForEndpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392197"><span class="annot"><a href="#local-6989586621680392197"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392196"><span class="annot"><a href="#local-6989586621680392196"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392197"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392196"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span id="waitForEndpoint"><span class="annot"><span class="annottext">waitForEndpoint :: ContractInstanceId -&gt; [Char] -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitForEndpoint"><span class="hs-identifier hs-var hs-var">waitForEndpoint</span></a></span></span><span> </span><span id="local-6989586621680392195"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392195"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span id="local-6989586621680392194"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392194"><span class="hs-identifier hs-var">endpointName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-597"></span><span>    </span><span id="local-6989586621680392193"><span class="annot"><span class="annottext">STM [OpenEndpoint]
</span><a href="#local-6989586621680392193"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env (STM [OpenEndpoint])
forall t env.
ContractInstanceId -&gt; PABAction t env (STM [OpenEndpoint])
</span><a href="Plutus.PAB.Core.html#activeEndpoints"><span class="hs-identifier hs-var">activeEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392195"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-598"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; PABAction t env ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PABAction t env ()) -&gt; IO () -&gt; PABAction t env ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>        </span><span id="local-6989586621680392192"><span class="annot"><span class="annottext">[OpenEndpoint]
</span><a href="#local-6989586621680392192"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM [OpenEndpoint]
</span><a href="#local-6989586621680392193"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-600"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; STM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; STM ()) -&gt; Bool -&gt; STM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenEndpoint -&gt; Bool) -&gt; [OpenEndpoint] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#OpenEndpoint"><span class="hs-identifier hs-type">Instances.OpenEndpoint</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">oepName :: OpenEndpoint -&gt; ActiveEndpoint
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#oepName"><span class="hs-identifier hs-var">Instances.oepName</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ActiveEndpoint</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">aeDescription :: ActiveEndpoint -&gt; EndpointDescription
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">aeDescription</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EndpointDescription</span></a></span><span> </span><span id="local-6989586621680392188"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392188"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392188"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680392194"><span class="hs-identifier hs-var">endpointName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[OpenEndpoint]
</span><a href="#local-6989586621680392192"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">-- | Get exported transactions waiting to be balanced, signed and submitted by</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- an external client.</span><span>
</span><span id="line-604"></span><span class="annot"><a href="Plutus.PAB.Core.html#yieldedExportTxs"><span class="hs-identifier hs-type">yieldedExportTxs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392187"><span class="annot"><a href="#local-6989586621680392187"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392186"><span class="annot"><a href="#local-6989586621680392186"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392187"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392186"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ExportTx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-605"></span><span id="yieldedExportTxs"><span class="annot"><span class="annottext">yieldedExportTxs :: ContractInstanceId -&gt; PABAction t env [ExportTx]
</span><a href="Plutus.PAB.Core.html#yieldedExportTxs"><span class="hs-identifier hs-var hs-var">yieldedExportTxs</span></a></span></span><span> </span><span id="local-6989586621680392185"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392185"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392185"><span class="hs-identifier hs-var">instanceId</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env InstanceState
-&gt; (InstanceState -&gt; PABAction t env [ExportTx])
-&gt; PABAction t env [ExportTx]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO [ExportTx] -&gt; PABAction t env [ExportTx]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [ExportTx] -&gt; PABAction t env [ExportTx])
-&gt; (InstanceState -&gt; IO [ExportTx])
-&gt; InstanceState
-&gt; PABAction t env [ExportTx]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM [ExportTx] -&gt; IO [ExportTx]
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM [ExportTx] -&gt; IO [ExportTx])
-&gt; (InstanceState -&gt; STM [ExportTx])
-&gt; InstanceState
-&gt; IO [ExportTx]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; STM [ExportTx]
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#yieldedExportTxs"><span class="hs-identifier hs-var">Instances.yieldedExportTxs</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392618"><span class="annot"><a href="#local-6989586621680392618"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392617"><span class="annot"><a href="#local-6989586621680392617"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392617"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span id="currentSlot"><span class="annot"><span class="annottext">currentSlot :: PABAction t env (STM Slot)
</span><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>    </span><span id="local-6989586621680392183"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392183"><span class="hs-identifier hs-var">be</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; BlockchainEnv)
-&gt; Eff (PABEffects t env) BlockchainEnv
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392618"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392617"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><span class="annottext">STM Slot -&gt; PABAction t env (STM Slot)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Slot -&gt; PABAction t env (STM Slot))
-&gt; STM Slot -&gt; PABAction t env (STM Slot)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv -&gt; STM Slot
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#currentSlot"><span class="hs-identifier hs-var">Instances.currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392183"><span class="hs-identifier hs-var">be</span></a></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | Wait until the target slot number has been reached relative to the current</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- slot.</span><span>
</span><span id="line-615"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier hs-type">waitUntilSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392611"><span class="annot"><a href="#local-6989586621680392611"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392610"><span class="annot"><a href="#local-6989586621680392610"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Slot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392611"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392610"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span id="waitUntilSlot"><span class="annot"><span class="annottext">waitUntilSlot :: Slot -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier hs-var hs-var">waitUntilSlot</span></a></span></span><span> </span><span id="local-6989586621680392181"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392181"><span class="hs-identifier hs-var">targetSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-617"></span><span>    </span><span id="local-6989586621680392180"><span class="annot"><span class="annottext">STM Slot
</span><a href="#local-6989586621680392180"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env (STM Slot)
forall t env. PABAction t env (STM Slot)
</span><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><span class="annottext">PABAction t env () -&gt; PABAction t env ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(PABAction t env () -&gt; PABAction t env ())
-&gt; PABAction t env () -&gt; PABAction t env ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; PABAction t env ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; PABAction t env ()) -&gt; IO () -&gt; PABAction t env ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>        </span><span id="local-6989586621680392179"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392179"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Slot
</span><a href="#local-6989586621680392180"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-620"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; STM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392179"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392181"><span class="hs-identifier hs-var">targetSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- | Wait for a certain number of slots relative to the current slot.</span><span>
</span><span id="line-623"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392178"><span class="annot"><a href="#local-6989586621680392178"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392177"><span class="annot"><a href="#local-6989586621680392177"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392178"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392177"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span id="waitNSlots"><span class="annot"><span class="annottext">waitNSlots :: Int -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitNSlots"><span class="hs-identifier hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span id="local-6989586621680392176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680392176"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>    </span><span id="local-6989586621680392175"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392175"><span class="hs-identifier hs-var">current</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t env (STM Slot)
forall t env. PABAction t env (STM Slot)
</span><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env (STM Slot)
-&gt; (STM Slot -&gt; Eff (PABEffects t env) Slot)
-&gt; Eff (PABEffects t env) Slot
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO Slot -&gt; Eff (PABEffects t env) Slot
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Slot -&gt; Eff (PABEffects t env) Slot)
-&gt; (STM Slot -&gt; IO Slot) -&gt; STM Slot -&gt; Eff (PABEffects t env) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM Slot -&gt; IO Slot
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span>
</span><span id="line-626"></span><span>    </span><span class="annot"><span class="annottext">Slot -&gt; PABAction t env ()
forall t env. Slot -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier hs-var">waitUntilSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680392175"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Slot
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680392176"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | The set of all active contracts.</span><span>
</span><span id="line-629"></span><span class="annot"><a href="Plutus.PAB.Core.html#activeContracts"><span class="hs-identifier hs-type">activeContracts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392173"><span class="annot"><a href="#local-6989586621680392173"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392172"><span class="annot"><a href="#local-6989586621680392172"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392173"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392172"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span id="activeContracts"><span class="annot"><span class="annottext">activeContracts :: PABAction t env (Set ContractInstanceId)
</span><a href="Plutus.PAB.Core.html#activeContracts"><span class="hs-identifier hs-var hs-var">activeContracts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState)
-&gt; Eff (PABEffects t env) InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392173"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392172"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t env) InstancesState
-&gt; (InstancesState -&gt; PABAction t env (Set ContractInstanceId))
-&gt; PABAction t env (Set ContractInstanceId)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Set ContractInstanceId)
-&gt; PABAction t env (Set ContractInstanceId)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Set ContractInstanceId)
 -&gt; PABAction t env (Set ContractInstanceId))
-&gt; (InstancesState -&gt; IO (Set ContractInstanceId))
-&gt; InstancesState
-&gt; PABAction t env (Set ContractInstanceId)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState -&gt; IO (Set ContractInstanceId)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#instanceIDs"><span class="hs-identifier hs-var">Instances.instanceIDs</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- | The final result of the instance (waits until it is available)</span><span>
</span><span id="line-634"></span><span class="annot"><a href="Plutus.PAB.Core.html#finalResult"><span class="hs-identifier hs-type">finalResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392569"><span class="annot"><a href="#local-6989586621680392569"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392568"><span class="annot"><a href="#local-6989586621680392568"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392569"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392568"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span id="finalResult"><span class="annot"><span class="annottext">finalResult :: ContractInstanceId -&gt; PABAction t env (STM (Maybe Value))
</span><a href="Plutus.PAB.Core.html#finalResult"><span class="hs-identifier hs-var hs-var">finalResult</span></a></span></span><span> </span><span id="local-6989586621680392170"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392170"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceState -&gt; STM (Maybe Value)
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#finalResult"><span class="hs-identifier hs-var">Instances.finalResult</span></a></span><span> </span><span class="annot"><span class="annottext">(InstanceState -&gt; STM (Maybe Value))
-&gt; Eff (PABEffects t env) InstanceState
-&gt; PABAction t env (STM (Maybe Value))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Eff (PABEffects t env) InstanceState
forall t env. ContractInstanceId -&gt; PABAction t env InstanceState
</span><a href="Plutus.PAB.Core.html#instanceStateInternal"><span class="hs-identifier hs-var">instanceStateInternal</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392170"><span class="hs-identifier hs-var">instanceId</span></a></span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | The value in a wallet.</span><span>
</span><span id="line-638"></span><span class="hs-comment">--</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- TODO: Change from 'Wallet' to 'Address' (see SCP-2208).</span><span>
</span><span id="line-640"></span><span id="local-6989586621680392167"><span id="local-6989586621680392168"><span class="annot"><a href="Plutus.PAB.Core.html#valueAt"><span class="hs-identifier hs-type">valueAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392168"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392167"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span></span></span><span>
</span><span id="line-641"></span><span id="valueAt"><span class="annot"><span class="annottext">valueAt :: Wallet -&gt; PABAction t env Value
</span><a href="Plutus.PAB.Core.html#valueAt"><span class="hs-identifier hs-var hs-var">valueAt</span></a></span></span><span> </span><span id="local-6989586621680392166"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392166"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-642"></span><span>  </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) Value
-&gt; PABAction t env Value
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392166"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t env '[IO]) Value
 -&gt; PABAction t env Value)
-&gt; Eff (ContractInstanceEffects t env '[IO]) Value
-&gt; PABAction t env Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621680392165"><span class="annot"><span class="annottext">[[(TxOutRef, DecoratedTxOut)]]
</span><a href="#local-6989586621680392165"><span class="hs-identifier hs-var">txOutsM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PageQuery TxOutRef
 -&gt; Eff
      (ContractInstanceEffects t env '[IO])
      (QueryResponse [(TxOutRef, DecoratedTxOut)]))
-&gt; Eff
     (ContractInstanceEffects t env '[IO])
     [[(TxOutRef, DecoratedTxOut)]]
forall (m :: * -&gt; *) a.
Monad m =&gt;
(PageQuery TxOutRef -&gt; m (QueryResponse a)) -&gt; m [a]
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.collectQueryResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680392163"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680392163"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff
     (ContractInstanceEffects t env '[IO])
     (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef
-&gt; Credential
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.unspentTxOutSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680392163"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680392161"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="annottext">Value -&gt; Eff (ContractInstanceEffects t env '[IO]) Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Eff (ContractInstanceEffects t env '[IO]) Value)
-&gt; Value -&gt; Eff (ContractInstanceEffects t env '[IO]) Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, DecoratedTxOut) -&gt; Value)
-&gt; [(TxOutRef, DecoratedTxOut)] -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Value (TxOutRef, DecoratedTxOut) Value
-&gt; (TxOutRef, DecoratedTxOut) -&gt; Value
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">(Getting Value (TxOutRef, DecoratedTxOut) Value
 -&gt; (TxOutRef, DecoratedTxOut) -&gt; Value)
-&gt; Getting Value (TxOutRef, DecoratedTxOut) Value
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DecoratedTxOut -&gt; Const Value DecoratedTxOut)
-&gt; (TxOutRef, DecoratedTxOut)
-&gt; Const Value (TxOutRef, DecoratedTxOut)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((DecoratedTxOut -&gt; Const Value DecoratedTxOut)
 -&gt; (TxOutRef, DecoratedTxOut)
 -&gt; Const Value (TxOutRef, DecoratedTxOut))
-&gt; ((Value -&gt; Const Value Value)
    -&gt; DecoratedTxOut -&gt; Const Value DecoratedTxOut)
-&gt; Getting Value (TxOutRef, DecoratedTxOut) Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Const Value Value)
-&gt; DecoratedTxOut -&gt; Const Value DecoratedTxOut
Lens' DecoratedTxOut Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">decoratedTxOutValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, DecoratedTxOut)] -&gt; Value)
-&gt; [(TxOutRef, DecoratedTxOut)] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[(TxOutRef, DecoratedTxOut)]] -&gt; [(TxOutRef, DecoratedTxOut)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(TxOutRef, DecoratedTxOut)]]
</span><a href="#local-6989586621680392165"><span class="hs-identifier hs-var">txOutsM</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621680392161"><span class="annot"><span class="annottext">cred :: Credential
</span><a href="#local-6989586621680392161"><span class="hs-identifier hs-var hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddressInEra BabbageEra -&gt; Credential
forall era. AddressInEra era -&gt; Credential
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">cardanoAddressCredential</span></a></span><span> </span><span class="annot"><span class="annottext">(AddressInEra BabbageEra -&gt; Credential)
-&gt; AddressInEra BabbageEra -&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; AddressInEra BabbageEra
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">mockWalletAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680392166"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | Wait until the contract is done, then return</span><span>
</span><span id="line-649"></span><span class="hs-comment">--   the error (if any)</span><span>
</span><span id="line-650"></span><span class="annot"><a href="Plutus.PAB.Core.html#waitUntilFinished"><span class="hs-identifier hs-type">waitUntilFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392158"><span class="annot"><a href="#local-6989586621680392158"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392157"><span class="annot"><a href="#local-6989586621680392157"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392158"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392157"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span id="waitUntilFinished"><span class="annot"><span class="annottext">waitUntilFinished :: ContractInstanceId -&gt; PABAction t env (Maybe Value)
</span><a href="Plutus.PAB.Core.html#waitUntilFinished"><span class="hs-identifier hs-var hs-var">waitUntilFinished</span></a></span></span><span> </span><span id="local-6989586621680392156"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392156"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABAction t env (STM (Maybe Value))
forall t env.
ContractInstanceId -&gt; PABAction t env (STM (Maybe Value))
</span><a href="Plutus.PAB.Core.html#finalResult"><span class="hs-identifier hs-var">finalResult</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680392156"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t env (STM (Maybe Value))
-&gt; (STM (Maybe Value) -&gt; PABAction t env (Maybe Value))
-&gt; PABAction t env (Maybe Value)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Value) -&gt; PABAction t env (Maybe Value)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Value) -&gt; PABAction t env (Maybe Value))
-&gt; (STM (Maybe Value) -&gt; IO (Maybe Value))
-&gt; STM (Maybe Value)
-&gt; PABAction t env (Maybe Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe Value) -&gt; IO (Maybe Value)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="annot"><a href="Plutus.PAB.Core.html#instancesWithStatuses"><span class="hs-identifier hs-type">instancesWithStatuses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392155"><span class="annot"><a href="#local-6989586621680392155"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392154"><span class="annot"><a href="#local-6989586621680392154"><span class="hs-identifier hs-type">env</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392155"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392154"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span id="instancesWithStatuses"><span class="annot"><span class="annottext">instancesWithStatuses :: PABAction t env (Map ContractInstanceId ContractActivityStatus)
</span><a href="Plutus.PAB.Core.html#instancesWithStatuses"><span class="hs-identifier hs-var hs-var">instancesWithStatuses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621680392153"><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392153"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs InstancesState
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs InstancesState
</span><a href="Plutus.PAB.Core.html#askInstancesState"><span class="hs-identifier hs-var">askInstancesState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392155"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392154"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">IO (Map ContractInstanceId ContractActivityStatus)
-&gt; PABAction t env (Map ContractInstanceId ContractActivityStatus)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstancesState
-&gt; IO (STM (Map ContractInstanceId ContractActivityStatus))
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#instancesWithStatuses"><span class="hs-identifier hs-var">Instances.instancesWithStatuses</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680392153"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">IO (STM (Map ContractInstanceId ContractActivityStatus))
-&gt; (STM (Map ContractInstanceId ContractActivityStatus)
    -&gt; IO (Map ContractInstanceId ContractActivityStatus))
-&gt; IO (Map ContractInstanceId ContractActivityStatus)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Map ContractInstanceId ContractActivityStatus)
-&gt; IO (Map ContractInstanceId ContractActivityStatus)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | Read the 'env' from the environment</span><span>
</span><span id="line-659"></span><span class="annot"><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-type">askUserEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392151"><span class="annot"><a href="#local-6989586621680392151"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392150"><span class="annot"><a href="#local-6989586621680392150"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392149"><span class="annot"><a href="#local-6989586621680392149"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392151"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392150"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392149"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392149"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392150"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-660"></span><span id="askUserEnv"><span class="annot"><span class="annottext">askUserEnv :: Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var hs-var">askUserEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reader env ~&gt; Eff effs)
-&gt; Eff (Reader env : effs) env -&gt; Eff effs env
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392151"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392150"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (Reader env : effs) env
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-comment">-- | Read the 'BlockchainEnv' from the environment</span><span>
</span><span id="line-663"></span><span class="annot"><a href="Plutus.PAB.Core.html#askBlockchainEnv"><span class="hs-identifier hs-type">askBlockchainEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392148"><span class="annot"><a href="#local-6989586621680392148"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392147"><span class="annot"><a href="#local-6989586621680392147"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392146"><span class="annot"><a href="#local-6989586621680392146"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392148"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392147"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392146"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392146"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-664"></span><span id="askBlockchainEnv"><span class="annot"><span class="annottext">askBlockchainEnv :: Eff effs BlockchainEnv
</span><a href="Plutus.PAB.Core.html#askBlockchainEnv"><span class="hs-identifier hs-var hs-var">askBlockchainEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reader BlockchainEnv ~&gt; Eff effs)
-&gt; Eff (Reader BlockchainEnv : effs) BlockchainEnv
-&gt; Eff effs BlockchainEnv
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier hs-var">handleBlockchainEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392148"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392147"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (Reader BlockchainEnv : effs) BlockchainEnv
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Read the 'InstancesState' from the environment</span><span>
</span><span id="line-667"></span><span class="annot"><a href="Plutus.PAB.Core.html#askInstancesState"><span class="hs-identifier hs-type">askInstancesState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392564"><span class="annot"><a href="#local-6989586621680392564"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392563"><span class="annot"><a href="#local-6989586621680392563"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392565"><span class="annot"><a href="#local-6989586621680392565"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392564"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392563"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392565"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392565"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">InstancesState</span></a></span><span>
</span><span id="line-668"></span><span id="askInstancesState"><span class="annot"><span class="annottext">askInstancesState :: Eff effs InstancesState
</span><a href="Plutus.PAB.Core.html#askInstancesState"><span class="hs-identifier hs-var hs-var">askInstancesState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Reader InstancesState ~&gt; Eff effs)
-&gt; Eff (Reader InstancesState : effs) InstancesState
-&gt; Eff effs InstancesState
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader InstancesState ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader InstancesState ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleInstancesStateReader"><span class="hs-identifier hs-var">handleInstancesStateReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392564"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392563"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (Reader InstancesState : effs) InstancesState
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleMappedReader"><span class="hs-identifier hs-type">handleMappedReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392145"><span class="annot"><a href="#local-6989586621680392145"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621680392144"><span class="annot"><a href="#local-6989586621680392144"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621680392143"><span class="annot"><a href="#local-6989586621680392143"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392145"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392143"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680392145"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680392144"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392144"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392143"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-675"></span><span id="handleMappedReader"><span class="annot"><span class="annottext">handleMappedReader :: (f -&gt; g) -&gt; Reader g ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleMappedReader"><span class="hs-identifier hs-var hs-var">handleMappedReader</span></a></span></span><span> </span><span id="local-6989586621680392142"><span class="annot"><span class="annottext">f -&gt; g
</span><a href="#local-6989586621680392142"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><span class="annottext">Reader g x
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Ask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(f -&gt; g) -&gt; Eff effs g
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680392145"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; g
</span><a href="#local-6989586621680392142"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-type">handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392557"><span class="annot"><a href="#local-6989586621680392557"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392556"><span class="annot"><a href="#local-6989586621680392556"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392558"><span class="annot"><a href="#local-6989586621680392558"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-679"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392557"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392556"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392558"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392556"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392558"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-682"></span><span id="handleUserEnvReader"><span class="annot"><span class="annottext">handleUserEnvReader :: Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var hs-var">handleUserEnvReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><span class="annottext">Reader env x
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Ask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; env) -&gt; Eff effs env
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392557"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392556"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; env
forall t env. PABEnvironment t env -&gt; env
</span><a href="Plutus.PAB.Core.html#appEnv"><span class="hs-identifier hs-var hs-var">appEnv</span></a></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier hs-type">handleBlockchainEnvReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392550"><span class="annot"><a href="#local-6989586621680392550"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392549"><span class="annot"><a href="#local-6989586621680392549"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392551"><span class="annot"><a href="#local-6989586621680392551"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-686"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392550"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392549"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392551"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392551"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-689"></span><span id="handleBlockchainEnvReader"><span class="annot"><span class="annottext">handleBlockchainEnvReader :: Reader BlockchainEnv ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier hs-var hs-var">handleBlockchainEnvReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><span class="annottext">Reader BlockchainEnv x
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Ask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; BlockchainEnv) -&gt; Eff effs BlockchainEnv
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392550"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392549"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleInstancesStateReader"><span class="hs-identifier hs-type">handleInstancesStateReader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392543"><span class="annot"><a href="#local-6989586621680392543"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392542"><span class="annot"><a href="#local-6989586621680392542"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392544"><span class="annot"><a href="#local-6989586621680392544"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392543"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392542"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392544"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-694"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">InstancesState</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392544"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-696"></span><span id="handleInstancesStateReader"><span class="annot"><span class="annottext">handleInstancesStateReader :: Reader InstancesState ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleInstancesStateReader"><span class="hs-identifier hs-var hs-var">handleInstancesStateReader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><span class="annottext">Reader InstancesState x
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Ask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; InstancesState) -&gt; Eff effs InstancesState
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392543"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392542"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; InstancesState
forall t env. PABEnvironment t env -&gt; InstancesState
</span><a href="Plutus.PAB.Core.html#instancesState"><span class="hs-identifier hs-var hs-var">instancesState</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- | Handle the 'TimeEffect' by reading the current slot number from</span><span>
</span><span id="line-700"></span><span class="hs-comment">-- the blockchain env.</span><span>
</span><span id="line-701"></span><span class="annot"><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-type">handleTimeEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680392923"><span class="annot"><a href="#local-6989586621680392923"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680392922"><span class="annot"><a href="#local-6989586621680392922"><span class="hs-identifier hs-type">env</span></a></span></span><span> </span><span id="local-6989586621680392920"><span class="annot"><a href="#local-6989586621680392920"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680392921"><span class="annot"><a href="#local-6989586621680392921"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392923"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392922"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680392921"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392921"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392920"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392921"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-709"></span><span id="handleTimeEffect"><span class="annot"><span class="annottext">handleTimeEffect :: TimeEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleTimeEffect"><span class="hs-identifier hs-var hs-var">handleTimeEffect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-710"></span><span>    </span><span class="annot"><span class="annottext">TimeEffect x
</span><a href="Plutus.PAB.Effects.TimeEffect.html#SystemTime"><span class="hs-identifier hs-var">SystemTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-711"></span><span>        </span><span id="local-6989586621680392141"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392141"><span class="hs-identifier hs-var">be</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PABEnvironment t env -&gt; BlockchainEnv) -&gt; Eff effs BlockchainEnv
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392923"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680392922"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PABEnvironment t env -&gt; BlockchainEnv
forall t env. PABEnvironment t env -&gt; BlockchainEnv
</span><a href="Plutus.PAB.Core.html#blockchainEnv"><span class="hs-identifier hs-var hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-712"></span><span>        </span><span class="annot"><span class="annottext">IO Slot -&gt; Eff effs Slot
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Slot -&gt; Eff effs Slot) -&gt; IO Slot -&gt; Eff effs Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM Slot -&gt; IO Slot
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Slot -&gt; IO Slot) -&gt; STM Slot -&gt; IO Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv -&gt; STM Slot
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#currentSlot"><span class="hs-identifier hs-var">Instances.currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680392141"><span class="hs-identifier hs-var">be</span></a></span><span>
</span><span id="line-713"></span></pre></body></html>
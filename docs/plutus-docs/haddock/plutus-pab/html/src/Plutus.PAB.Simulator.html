<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">{-

A live, multi-threaded PAB simulator with agent-specific states and actions
on them. Agents are represented by the 'Wallet' type. Each agent corresponds
to one PAB, with its own view of the world, all acting on the same blockchain.

-}</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutus.PAB.Simulator</span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier">Simulation</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier">SimulatorState</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Run with user-defined contracts</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractHandler"><span class="hs-identifier">SimulatorContractHandler</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#runSimulationWith"><span class="hs-identifier">runSimulationWith</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorEffectHandlers"><span class="hs-identifier">SimulatorEffectHandlers</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#mkSimulatorHandlers"><span class="hs-identifier">mkSimulatorHandlers</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#addWallet"><span class="hs-identifier">addWallet</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#addWalletWith"><span class="hs-identifier">addWalletWith</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Logging</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#logString"><span class="hs-identifier">logString</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Agent actions</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#payToWallet"><span class="hs-identifier">payToWallet</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#payToPaymentPublicKeyHash"><span class="hs-identifier">payToPaymentPublicKeyHash</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#activateContract"><span class="hs-identifier">activateContract</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#callEndpointOnInstance"><span class="hs-identifier">callEndpointOnInstance</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleAgentThread"><span class="hs-identifier">handleAgentThread</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier">Activity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#stopInstance"><span class="hs-identifier">stopInstance</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#instanceActivity"><span class="hs-identifier">instanceActivity</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Control actions</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#makeBlock"><span class="hs-identifier">makeBlock</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Querying the state</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#instanceState"><span class="hs-identifier">instanceState</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#observableState"><span class="hs-identifier">observableState</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForState"><span class="hs-identifier">waitForState</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForInstanceState"><span class="hs-identifier">waitForInstanceState</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForInstanceStateWithResult"><span class="hs-identifier">waitForInstanceStateWithResult</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#activeEndpoints"><span class="hs-identifier">activeEndpoints</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForEndpoint"><span class="hs-identifier">waitForEndpoint</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForTxStatusChange"><span class="hs-identifier">waitForTxStatusChange</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForTxOutStatusChange"><span class="hs-identifier">waitForTxOutStatusChange</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#currentSlot"><span class="hs-identifier">currentSlot</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitUntilSlot"><span class="hs-identifier">waitUntilSlot</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitNSlots"><span class="hs-identifier">waitNSlots</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#activeContracts"><span class="hs-identifier">activeContracts</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#finalResult"><span class="hs-identifier">finalResult</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitUntilFinished"><span class="hs-identifier">waitUntilFinished</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#valueAt"><span class="hs-identifier">valueAt</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#valueAtSTM"><span class="hs-identifier">valueAtSTM</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#walletFees"><span class="hs-identifier">walletFees</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#blockchain"><span class="hs-identifier">blockchain</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#currentBalances"><span class="hs-identifier">currentBalances</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#logBalances"><span class="hs-identifier">logBalances</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Transaction counts</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier">TxCounts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#txCounts"><span class="hs-identifier">txCounts</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#txCountsSTM"><span class="hs-identifier">txCountsSTM</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#txValidated"><span class="hs-identifier">txValidated</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#txMemPool"><span class="hs-identifier">txMemPool</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForValidatedTxCount"><span class="hs-identifier">waitForValidatedTxCount</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Chain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">ChainControlEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">ChainState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Chain</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Chain</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Params</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.TimeSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">SlotConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">SlotConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">scSlotLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Mock.Handlers.html"><span class="hs-identifier">Cardano.Wallet.Mock.Handlers</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MockWallet</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Concurrent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forkIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">STM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier">TQueue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">TVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier">Control.Concurrent.STM</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STM</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_Just</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">at</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">makeLenses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">makeLensesFor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">preview</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(.~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(?~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forM_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forever</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Eff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">LastMember</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Member</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">interpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">reinterpret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">reinterpret2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">reinterpretN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">run</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">send</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>                            </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator">(~&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Delay.html"><span class="hs-identifier">Control.Monad.Freer.Delay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Freer.Delay.html#DelayEffect"><span class="hs-identifier">DelayEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Delay.html#delayThread"><span class="hs-identifier">delayThread</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Freer.Delay.html#handleDelayEffect"><span class="hs-identifier">handleDelayEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">handleError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Modify</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Control.Monad.Freer.Extras.Log</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">Info</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogMessage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">LMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">handleLogWriter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">logInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>                                       </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">logLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier">mapLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Reader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">ask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">asks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Put</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Control.Monad.Freer.Writer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">Writer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier">runWriter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JSON</span></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/snd5q6v3qrq7cdxpn9nlwg98vvy50j53-data-default-lib-data-default-0.7.1.1-haddock-doc/share/doc/data-default/html/src"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier">Data.Text.IO</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier">Data.Time.Units</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier">Millisecond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Blockchain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">PaymentPubKeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">getCardanoTxFee</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">getCardanoTxId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>               </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">txOutAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">txOutValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">unOnChain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Ada</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.CardanoWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">MockWallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.CardanoWallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CW</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Index</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UtxoIndex</span></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">flattenValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex.Emulator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexControlEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexEmulatorState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>                                   </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">ChainIndexQueryEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">TxOutStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">TxStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">getTip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier">Plutus.ChainIndex.Emulator</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ChainIndex</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html"><span class="hs-identifier">Plutus.PAB.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier">EffectHandlers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier">EffectHandlers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleContractDefinitionEffect"><span class="hs-identifier">handleContractDefinitionEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleContractEffect"><span class="hs-identifier">handleContractEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleContractStoreEffect"><span class="hs-identifier">handleContractStoreEffect</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleLogMessages"><span class="hs-identifier">handleLogMessages</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#handleServicesEffects"><span class="hs-identifier">handleServicesEffects</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#initialiseEnvironment"><span class="hs-identifier">initialiseEnvironment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#onShutdown"><span class="hs-identifier">onShutdown</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#onStartup"><span class="hs-identifier">onStartup</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html"><span class="hs-identifier">Plutus.PAB.Core</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.BlockchainEnv.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance.BlockchainEnv</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BlockchainEnv</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance.STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier">Activity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier">BlockchainEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#beParams"><span class="hs-identifier">beParams</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#OpenEndpoint"><span class="hs-identifier">OpenEndpoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html"><span class="hs-identifier">Plutus.PAB.Core.ContractInstance.STM</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Instances</span></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier">ContractStore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Contract</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html"><span class="hs-identifier">Plutus.PAB.Effects.Contract.Builtin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier">HasDefinitions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#getDefinitions"><span class="hs-identifier">getDefinitions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html"><span class="hs-identifier">Plutus.PAB.Effects.TimeEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier">TimeEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html"><span class="hs-identifier">Plutus.PAB.Monitoring.PABLogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier">PABMultiAgentMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier">EmulatorMsg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#UserLog"><span class="hs-identifier">UserLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#WalletBalancingMsg"><span class="hs-identifier">WalletBalancingMsg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html"><span class="hs-identifier">Plutus.PAB.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier">PABError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier">ContractInstanceNotFound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier">WalletError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#WalletNotFound"><span class="hs-identifier">WalletNotFound</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html"><span class="hs-identifier">Plutus.PAB.Webserver.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier">ContractActivationArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Plutus.Trace.Emulator.System</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">appendNewTipBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOutRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">defaultLayoutOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">layoutPretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter.Render.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Render</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.API</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WAPI</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">NodeClientEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">GetClientParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">GetClientSlot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">PublishTx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">WalletEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.LogMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">TxBalanceMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.MultiAgent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">EmulatorEvent'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ChainEvent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ChainIndexEvent</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">_singleton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Stream</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">knownWallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">knownWallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Emulator.Wallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet</span></a></span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">Wallet.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractActivityStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">ContractInstanceId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier">NotificationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | The current state of a contract instance</span><span>
</span><span id="line-145"></span><span class="hs-keyword">data</span><span> </span><span id="SimulatorContractInstanceState"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractInstanceState"><span class="hs-identifier hs-var">SimulatorContractInstanceState</span></a></span></span><span> </span><span id="local-6989586621680393935"><span class="annot"><a href="#local-6989586621680393935"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>    </span><span id="SimulatorContractInstanceState"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractInstanceState"><span class="hs-identifier hs-var">SimulatorContractInstanceState</span></a></span></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_contractDef"><span class="annot"><span class="annottext">SimulatorContractInstanceState t
-&gt; ContractActivationArgs (ContractDef t)
</span><a href="Plutus.PAB.Simulator.html#_contractDef"><span class="hs-identifier hs-var hs-var">_contractDef</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Webserver.Types.html#ContractActivationArgs"><span class="hs-identifier hs-type">ContractActivationArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393935"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_contractState"><span class="annot"><span class="annottext">SimulatorContractInstanceState t -&gt; State t
</span><a href="Plutus.PAB.Simulator.html#_contractState"><span class="hs-identifier hs-var hs-var">_contractState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">Contract.State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393935"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="contractState"><span id="local-6989586621680393935"><span class="hs-identifier">makeLensesFor</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;_contractState&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;contractState&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">SimulatorContractInstanceState</span></span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">data</span><span> </span><span id="AgentState"><span class="annot"><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-var">AgentState</span></a></span></span><span> </span><span id="local-6989586621680394424"><span class="annot"><a href="#local-6989586621680394424"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>    </span><span id="AgentState"><span class="annot"><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-var">AgentState</span></a></span></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_walletState"><span class="annot"><span class="annottext">AgentState t -&gt; WalletState
</span><a href="Plutus.PAB.Simulator.html#_walletState"><span class="hs-identifier hs-var hs-var">_walletState</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.WalletState</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_submittedFees"><span class="annot"><span class="annottext">AgentState t -&gt; Map TxId Value
</span><a href="Plutus.PAB.Simulator.html#_submittedFees"><span class="hs-identifier hs-var hs-var">_submittedFees</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="walletState"><span id="submittedFees"><span id="local-6989586621680394002"><span id="local-6989586621680394173"><span id="local-6989586621680394424"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">AgentState</span></span></span></span></span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#initialAgentState"><span class="hs-identifier hs-type">initialAgentState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394377"><span class="annot"><a href="#local-6989586621680394377"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">MockWallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-type">AgentState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394377"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-162"></span><span id="initialAgentState"><span class="annot"><span class="annottext">initialAgentState :: MockWallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialAgentState"><span class="hs-identifier hs-var hs-var">initialAgentState</span></a></span></span><span> </span><span id="local-6989586621680393690"><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393690"><span class="hs-identifier hs-var">mw</span></a></span></span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">AgentState :: forall t. WalletState -&gt; Map TxId Value -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-type">AgentState</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_walletState :: WalletState
</span><a href="Plutus.PAB.Simulator.html#_walletState"><span class="hs-identifier hs-var">_walletState</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.fromMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393690"><span class="hs-identifier hs-var">mw</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_submittedFees :: Map TxId Value
</span><a href="Plutus.PAB.Simulator.html#_submittedFees"><span class="hs-identifier hs-var">_submittedFees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxId Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="SimulatorState"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-var">SimulatorState</span></a></span></span><span> </span><span id="local-6989586621680394374"><span class="annot"><a href="#local-6989586621680394374"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span id="SimulatorState"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-var">SimulatorState</span></a></span></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_logMessages"><span class="annot"><span class="annottext">SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
</span><a href="Plutus.PAB.Simulator.html#_logMessages"><span class="hs-identifier hs-var hs-var">_logMessages</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-type">TQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394374"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_chainState"><span class="annot"><span class="annottext">SimulatorState t -&gt; TVar ChainState
</span><a href="Plutus.PAB.Simulator.html#_chainState"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">ChainState</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_agentStates"><span class="annot"><span class="annottext">SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="Plutus.PAB.Simulator.html#_agentStates"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-type">AgentState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394374"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_chainIndex"><span class="annot"><span class="annottext">SimulatorState t -&gt; TVar ChainIndexEmulatorState
</span><a href="Plutus.PAB.Simulator.html#_chainIndex"><span class="hs-identifier hs-var hs-var">_chainIndex</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexEmulatorState</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_instances"><span class="annot"><span class="annottext">SimulatorState t
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="Plutus.PAB.Simulator.html#_instances"><span class="hs-identifier hs-var hs-var">_instances</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractInstanceState"><span class="hs-identifier hs-type">SimulatorContractInstanceState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394374"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="logMessages"><span id="instances"><span id="local-6989586621680394374"><span class="hs-identifier">makeLensesFor</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-string">&quot;_logMessages&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;logMessages&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;_instances&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;instances&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">SimulatorState</span></span></span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#initialState"><span class="hs-identifier hs-type">initialState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394326"><span class="annot"><a href="#local-6989586621680394326"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394326"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span id="initialState"><span class="annot"><span class="annottext">initialState :: IO (SimulatorState t)
</span><a href="Plutus.PAB.Simulator.html#initialState"><span class="hs-identifier hs-var hs-var">initialState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393679"><span class="annot"><span class="annottext">initialDistribution :: Map Wallet Value
</span><a href="#local-6989586621680393679"><span class="hs-identifier hs-var hs-var">initialDistribution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Wallet, Value)] -&gt; Map Wallet Value
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Wallet, Value)] -&gt; Map Wallet Value)
-&gt; [(Wallet, Value)] -&gt; Map Wallet Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; (Wallet, Value)) -&gt; [Wallet] -&gt; [(Wallet, Value)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Micro -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Ada.adaValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Micro
</span><span class="hs-number">100_000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">knownWallets</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Emulator.EmulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393675"><span class="annot"><span class="annottext">ChainState
_chainState :: EmulatorState -&gt; ChainState
_chainState :: ChainState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var hs-var">Emulator._chainState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EmulatorConfig -&gt; EmulatorState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Emulator.initialState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EmulatorConfig
forall a. Default a =&gt; a
</span><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">EmulatorConfig
-&gt; (EmulatorConfig -&gt; EmulatorConfig) -&gt; EmulatorConfig
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(InitialChainState -&gt; Identity InitialChainState)
-&gt; EmulatorConfig -&gt; Identity EmulatorConfig
Lens' EmulatorConfig InitialChainState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Emulator.initialChainState</span></a></span><span> </span><span class="annot"><span class="annottext">((InitialChainState -&gt; Identity InitialChainState)
 -&gt; EmulatorConfig -&gt; Identity EmulatorConfig)
-&gt; InitialChainState -&gt; EmulatorConfig -&gt; EmulatorConfig
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet Value -&gt; InitialChainState
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet Value
</span><a href="#local-6989586621680393679"><span class="hs-identifier hs-var">initialDistribution</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>        </span><span id="local-6989586621680393671"><span class="annot"><span class="annottext">initialWallets :: Map Wallet (AgentState t)
</span><a href="#local-6989586621680393671"><span class="hs-identifier hs-var hs-var">initialWallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Wallet, AgentState t)] -&gt; Map Wallet (AgentState t)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Wallet, AgentState t)] -&gt; Map Wallet (AgentState t))
-&gt; [(Wallet, AgentState t)] -&gt; Map Wallet (AgentState t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(MockWallet -&gt; (Wallet, AgentState t))
-&gt; [MockWallet] -&gt; [(Wallet, AgentState t)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680393670"><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393670"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.toMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393670"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; AgentState t
forall t. MockWallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialAgentState"><span class="hs-identifier hs-var">initialAgentState</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393670"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MockWallet]
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.knownMockWallets</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">STM (SimulatorState t) -&gt; IO (SimulatorState t)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (SimulatorState t) -&gt; IO (SimulatorState t))
-&gt; STM (SimulatorState t) -&gt; IO (SimulatorState t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">TQueue (LogMessage (PABMultiAgentMsg t))
-&gt; TVar ChainState
-&gt; TVar (Map Wallet (AgentState t))
-&gt; TVar ChainIndexEmulatorState
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; SimulatorState t
forall t.
TQueue (LogMessage (PABMultiAgentMsg t))
-&gt; TVar ChainState
-&gt; TVar (Map Wallet (AgentState t))
-&gt; TVar ChainIndexEmulatorState
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; SimulatorState t
</span><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-var">SimulatorState</span></a></span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><span class="annottext">(TQueue (LogMessage (PABMultiAgentMsg t))
 -&gt; TVar ChainState
 -&gt; TVar (Map Wallet (AgentState t))
 -&gt; TVar ChainIndexEmulatorState
 -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
 -&gt; SimulatorState t)
-&gt; STM (TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; STM
     (TVar ChainState
      -&gt; TVar (Map Wallet (AgentState t))
      -&gt; TVar ChainIndexEmulatorState
      -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
      -&gt; SimulatorState t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">STM (TQueue (LogMessage (PABMultiAgentMsg t)))
forall a. STM (TQueue a)
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.newTQueue</span></a></span><span>
</span><span id="line-187"></span><span>            </span><span class="annot"><span class="annottext">STM
  (TVar ChainState
   -&gt; TVar (Map Wallet (AgentState t))
   -&gt; TVar ChainIndexEmulatorState
   -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
   -&gt; SimulatorState t)
-&gt; STM (TVar ChainState)
-&gt; STM
     (TVar (Map Wallet (AgentState t))
      -&gt; TVar ChainIndexEmulatorState
      -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
      -&gt; SimulatorState t)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState -&gt; STM (TVar ChainState)
forall a. a -&gt; STM (TVar a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.newTVar</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393675"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><span class="annottext">STM
  (TVar (Map Wallet (AgentState t))
   -&gt; TVar ChainIndexEmulatorState
   -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
   -&gt; SimulatorState t)
-&gt; STM (TVar (Map Wallet (AgentState t)))
-&gt; STM
     (TVar ChainIndexEmulatorState
      -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
      -&gt; SimulatorState t)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t) -&gt; STM (TVar (Map Wallet (AgentState t)))
forall a. a -&gt; STM (TVar a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.newTVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
forall t. Map Wallet (AgentState t)
</span><a href="#local-6989586621680393671"><span class="hs-identifier hs-var">initialWallets</span></a></span><span>
</span><span id="line-189"></span><span>            </span><span class="annot"><span class="annottext">STM
  (TVar ChainIndexEmulatorState
   -&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
   -&gt; SimulatorState t)
-&gt; STM (TVar ChainIndexEmulatorState)
-&gt; STM
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
      -&gt; SimulatorState t)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexEmulatorState -&gt; STM (TVar ChainIndexEmulatorState)
forall a. a -&gt; STM (TVar a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.newTVar</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexEmulatorState
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="annottext">STM
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
   -&gt; SimulatorState t)
-&gt; STM
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; STM (SimulatorState t)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId (SimulatorContractInstanceState t)
-&gt; STM
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall a. a -&gt; STM (TVar a)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.newTVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map ContractInstanceId (SimulatorContractInstanceState t)
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | A handler for the 'ContractEffect' of @t@ that can run contracts in a</span><span>
</span><span id="line-193"></span><span class="hs-comment">--   simulated environment.</span><span>
</span><span id="line-194"></span><span class="hs-keyword">type</span><span> </span><span id="SimulatorContractHandler"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractHandler"><span class="hs-identifier hs-var">SimulatorContractHandler</span></a></span></span><span> </span><span id="local-6989586621680393663"><span class="annot"><a href="#local-6989586621680393663"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393662"><span class="annot"><a href="#local-6989586621680393662"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393662"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393663"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393662"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractEffect"><span class="hs-identifier hs-type">Contract.ContractEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393663"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680393662"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393662"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">type</span><span> </span><span id="SimulatorEffectHandlers"><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorEffectHandlers"><span class="hs-identifier hs-var">SimulatorEffectHandlers</span></a></span></span><span> </span><span id="local-6989586621680393661"><span class="annot"><a href="#local-6989586621680393661"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393661"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393661"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Build 'EffectHandlers' for running a contract in the simulator.</span><span>
</span><span id="line-205"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#mkSimulatorHandlers"><span class="hs-identifier hs-type">mkSimulatorHandlers</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393660"><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.Builtin.html#HasDefinitions"><span class="hs-identifier hs-type">HasDefinitions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorContractHandler"><span class="hs-identifier hs-type">SimulatorContractHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-comment">-- ^ Making calls to the contract (see 'Plutus.PAB.Effects.Contract.ContractTest.handleContractTest' for an example)</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorEffectHandlers"><span class="hs-identifier hs-type">SimulatorEffectHandlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-213"></span><span id="mkSimulatorHandlers"><span class="annot"><span class="annottext">mkSimulatorHandlers :: Params -&gt; SimulatorContractHandler t -&gt; SimulatorEffectHandlers t
</span><a href="Plutus.PAB.Simulator.html#mkSimulatorHandlers"><span class="hs-identifier hs-var hs-var">mkSimulatorHandlers</span></a></span></span><span> </span><span id="local-6989586621680393659"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393659"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680393658"><span class="annot"><span class="annottext">SimulatorContractHandler t
</span><a href="#local-6989586621680393658"><span class="hs-identifier hs-var">handleContractEffect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">EffectHandlers :: forall t env.
(forall (effs :: [* -&gt; *]).
 (Member (Error PABError) effs, LastMember IO effs) =&gt;
 Eff effs (InstancesState, BlockchainEnv, env))
-&gt; (forall (effs :: [* -&gt; *]).
    (Member (Reader (PABEnvironment t env)) effs,
     Member TimeEffect effs, Member (Error PABError) effs,
     LastMember IO effs) =&gt;
    Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs)
-&gt; (forall (effs :: [* -&gt; *]).
    (Member (Reader (PABEnvironment t env)) effs,
     Member (Error PABError) effs, Member TimeEffect effs,
     Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
    Eff (ContractStore t : effs) ~&gt; Eff effs)
-&gt; (forall (effs :: [* -&gt; *]).
    (Member (Reader (PABEnvironment t env)) effs,
     Member (Error PABError) effs, Member TimeEffect effs,
     Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
    Eff (ContractEffect t : effs) ~&gt; Eff effs)
-&gt; (forall (effs :: [* -&gt; *]).
    (Member (Reader (PABEnvironment t env)) effs,
     Member (Error PABError) effs, Member TimeEffect effs,
     Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
    Eff (ContractDefinition t : effs) ~&gt; Eff effs)
-&gt; (forall (effs :: [* -&gt; *]).
    (Member (Reader (PABEnvironment t env)) effs,
     Member (Error PABError) effs, Member TimeEffect effs,
     Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
    Wallet
    -&gt; Maybe ContractInstanceId
    -&gt; Eff
         (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
       ~&gt; Eff effs)
-&gt; PABAction t env ()
-&gt; PABAction t env ()
-&gt; EffectHandlers t env
</span><a href="Plutus.PAB.Core.html#EffectHandlers"><span class="hs-identifier hs-type">EffectHandlers</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">initialiseEnvironment :: forall (effs :: [* -&gt; *]).
(Member (Error PABError) effs, LastMember IO effs) =&gt;
Eff effs (InstancesState, BlockchainEnv, SimulatorState t)
</span><a href="Plutus.PAB.Core.html#initialiseEnvironment"><span class="hs-identifier hs-var">initialiseEnvironment</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                </span><span class="annot"><span class="annottext">(InstancesState
 -&gt; BlockchainEnv
 -&gt; SimulatorState t
 -&gt; (InstancesState, BlockchainEnv, SimulatorState t))
-&gt; Eff effs InstancesState
-&gt; Eff
     effs
     (BlockchainEnv
      -&gt; SimulatorState t
      -&gt; (InstancesState, BlockchainEnv, SimulatorState t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO InstancesState -&gt; Eff effs InstancesState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO InstancesState
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#emptyInstancesState"><span class="hs-identifier hs-var">Instances.emptyInstancesState</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                </span><span class="annot"><span class="annottext">Eff
  effs
  (BlockchainEnv
   -&gt; SimulatorState t
   -&gt; (InstancesState, BlockchainEnv, SimulatorState t))
-&gt; Eff effs BlockchainEnv
-&gt; Eff
     effs
     (SimulatorState t
      -&gt; (InstancesState, BlockchainEnv, SimulatorState t))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO BlockchainEnv -&gt; Eff effs BlockchainEnv
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STM BlockchainEnv -&gt; IO BlockchainEnv
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM BlockchainEnv -&gt; IO BlockchainEnv)
-&gt; STM BlockchainEnv -&gt; IO BlockchainEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Params -&gt; STM BlockchainEnv
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#emptyBlockchainEnv"><span class="hs-identifier hs-var">Instances.emptyBlockchainEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393659"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>                </span><span class="annot"><span class="annottext">Eff
  effs
  (SimulatorState t
   -&gt; (InstancesState, BlockchainEnv, SimulatorState t))
-&gt; Eff effs (SimulatorState t)
-&gt; Eff effs (InstancesState, BlockchainEnv, SimulatorState t)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO (SimulatorState t) -&gt; Eff effs (SimulatorState t)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (SimulatorState t)
forall t. IO (SimulatorState t)
</span><a href="Plutus.PAB.Simulator.html#initialState"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handleContractStoreEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractStore t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractStoreEffect"><span class="hs-identifier hs-var">handleContractStoreEffect</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>            </span><span class="annot"><span class="annottext">(ContractStore t ~&gt; Eff effs)
-&gt; Eff (ContractStore t : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">ContractStore t ~&gt; Eff effs
forall t (effs :: [* -&gt; *]).
(LastMember IO effs,
 Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs) =&gt;
ContractStore t ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleContractStore"><span class="hs-identifier hs-var">handleContractStore</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) x.
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) x -&gt; Eff effs x
SimulatorContractHandler t
handleContractEffect :: SimulatorContractHandler t
handleContractEffect :: forall (effs :: [* -&gt; *]) x.
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractEffect t : effs) x -&gt; Eff effs x
</span><a href="#local-6989586621680393658"><span class="hs-identifier hs-var hs-var">handleContractEffect</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handleLogMessages :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member TimeEffect effs, Member (Error PABError) effs,
 LastMember IO effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleLogMessages"><span class="hs-identifier hs-var">handleLogMessages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(LastMember IO effs,
 Member (Reader (PABEnvironment t (SimulatorState t))) effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
forall t (effs :: [* -&gt; *]).
(LastMember IO effs,
 Member (Reader (PABEnvironment t (SimulatorState t))) effs) =&gt;
Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleLogSimulator"><span class="hs-identifier hs-var">handleLogSimulator</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handleServicesEffects :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleServicesEffects"><span class="hs-identifier hs-var">handleServicesEffects</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
forall t (effs :: [* -&gt; *]).
(Member (LogMsg (PABMultiAgentMsg t)) effs,
 Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member TimeEffect effs, LastMember IO effs,
 Member (Error PABError) effs) =&gt;
Params
-&gt; Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleServicesSimulator"><span class="hs-identifier hs-var">handleServicesSimulator</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393659"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handleContractDefinitionEffect :: forall (effs :: [* -&gt; *]).
(Member (Reader (PABEnvironment t (SimulatorState t))) effs,
 Member (Error PABError) effs, Member TimeEffect effs,
 Member (LogMsg (PABMultiAgentMsg t)) effs, LastMember IO effs) =&gt;
Eff (ContractDefinition t : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleContractDefinitionEffect"><span class="hs-identifier hs-var">handleContractDefinitionEffect</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>            </span><span class="annot"><span class="annottext">(ContractDefinition t ~&gt; Eff effs)
-&gt; Eff (ContractDefinition t : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">((ContractDefinition t ~&gt; Eff effs)
 -&gt; Eff (ContractDefinition t : effs) ~&gt; Eff effs)
-&gt; (ContractDefinition t ~&gt; Eff effs)
-&gt; Eff (ContractDefinition t : effs) ~&gt; Eff effs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-227"></span><span>                </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#AddDefinition"><span class="hs-identifier hs-type">Contract.AddDefinition</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- not supported</span><span>
</span><span id="line-228"></span><span>                </span><span class="annot"><span class="annottext">ContractDefinition t x
</span><a href="Plutus.PAB.Effects.Contract.html#GetDefinitions"><span class="hs-identifier hs-var">Contract.GetDefinitions</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ContractDef t] -&gt; Eff effs [ContractDef t]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[ContractDef t]
forall a. HasDefinitions a =&gt; [a]
</span><a href="Plutus.PAB.Effects.Contract.Builtin.html#getDefinitions"><span class="hs-identifier hs-var">getDefinitions</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">onStartup :: PABAction t (SimulatorState t) ()
</span><a href="Plutus.PAB.Core.html#onStartup"><span class="hs-identifier hs-var">onStartup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>            </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393650"><span class="annot"><span class="annottext">TQueue (LogMessage (PABMultiAgentMsg t))
_logMessages :: TQueue (LogMessage (PABMultiAgentMsg t))
_logMessages :: forall t.
SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
</span><a href="#local-6989586621680393650"><span class="hs-identifier hs-var hs-var">_logMessages</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>            </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) ThreadId
-&gt; PABAction t (SimulatorState t) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (PABEffects t (SimulatorState t)) ThreadId
 -&gt; PABAction t (SimulatorState t) ())
-&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
-&gt; PABAction t (SimulatorState t) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId)
-&gt; IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forkIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TQueue (LogMessage (PABMultiAgentMsg t)) -&gt; IO ()
forall t. Pretty t =&gt; TQueue (LogMessage t) -&gt; IO ()
</span><a href="Plutus.PAB.Simulator.html#printLogMessages"><span class="hs-identifier hs-var">printLogMessages</span></a></span><span> </span><span class="annot"><span class="annottext">TQueue (LogMessage (PABMultiAgentMsg t))
</span><a href="#local-6989586621680393650"><span class="hs-identifier hs-var">_logMessages</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><a href="Plutus.PAB.Core.html#PABRunner"><span class="hs-identifier hs-type">Core.PABRunner</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393646"><span class="annot"><span class="annottext">forall a.
PABAction t (SimulatorState t) a -&gt; IO (Either PABError a)
runPABAction :: forall t env.
PABRunner t env
-&gt; forall a. PABAction t env a -&gt; IO (Either PABError a)
runPABAction :: forall a.
PABAction t (SimulatorState t) a -&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Core.html#runPABAction"><span class="hs-identifier hs-var hs-var">Core.runPABAction</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PABAction t (SimulatorState t) (PABRunner t (SimulatorState t))
forall t env. PABAction t env (PABRunner t env)
</span><a href="Plutus.PAB.Core.html#pabRunner"><span class="hs-identifier hs-var">Core.pabRunner</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) ThreadId
-&gt; PABAction t (SimulatorState t) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span>
</span><span id="line-234"></span><span>                </span><span class="annot"><span class="annottext">(Eff (PABEffects t (SimulatorState t)) ThreadId
 -&gt; PABAction t (SimulatorState t) ())
-&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
-&gt; PABAction t (SimulatorState t) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-235"></span><span>                </span><span class="annot"><span class="annottext">(IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId)
-&gt; IO ThreadId -&gt; Eff (PABEffects t (SimulatorState t)) ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forkIO</span></a></span><span>
</span><span id="line-236"></span><span>                </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either PABError ()) -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span>
</span><span id="line-237"></span><span>                </span><span class="annot"><span class="annottext">(IO (Either PABError ()) -&gt; IO ())
-&gt; IO (Either PABError ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PABAction t (SimulatorState t) () -&gt; IO (Either PABError ())
forall a.
PABAction t (SimulatorState t) a -&gt; IO (Either PABError a)
</span><a href="#local-6989586621680393646"><span class="hs-identifier hs-var">runPABAction</span></a></span><span>
</span><span id="line-238"></span><span>                </span><span class="annot"><span class="annottext">(PABAction t (SimulatorState t) () -&gt; IO (Either PABError ()))
-&gt; PABAction t (SimulatorState t) () -&gt; IO (Either PABError ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
-&gt; PABAction t (SimulatorState t) ()
forall (effs :: [* -&gt; *]) (m :: * -&gt; *).
(LastMember m effs, MonadIO m) =&gt;
Eff (DelayEffect : effs) ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Delay.html#handleDelayEffect"><span class="hs-identifier hs-var">handleDelayEffect</span></a></span><span>
</span><span id="line-239"></span><span>                </span><span class="annot"><span class="annottext">(Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
 -&gt; PABAction t (SimulatorState t) ())
-&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
-&gt; PABAction t (SimulatorState t) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (SimulatorState t)
 ~&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)))
-&gt; Eff
     (Reader (SimulatorState t)
        : DelayEffect : PABEffects t (SimulatorState t))
   ~&gt; Eff (DelayEffect : PABEffects t (SimulatorState t))
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader (SimulatorState t) ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">Core.handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>                </span><span class="annot"><span class="annottext">(Eff
   (Reader (SimulatorState t)
      : DelayEffect : PABEffects t (SimulatorState t))
   ()
 -&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)) ())
-&gt; Eff
     (Reader (SimulatorState t)
        : DelayEffect : PABEffects t (SimulatorState t))
     ()
-&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader InstancesState
 ~&gt; Eff
      (Reader (SimulatorState t)
         : DelayEffect : PABEffects t (SimulatorState t)))
-&gt; Eff
     (Reader InstancesState
        : Reader (SimulatorState t) : DelayEffect
        : PABEffects t (SimulatorState t))
   ~&gt; Eff
        (Reader (SimulatorState t)
           : DelayEffect : PABEffects t (SimulatorState t))
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader InstancesState ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader InstancesState ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleInstancesStateReader"><span class="hs-identifier hs-var">Core.handleInstancesStateReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><span class="annottext">(Eff
   (Reader InstancesState
      : Reader (SimulatorState t) : DelayEffect
      : PABEffects t (SimulatorState t))
   ()
 -&gt; Eff
      (Reader (SimulatorState t)
         : DelayEffect : PABEffects t (SimulatorState t))
      ())
-&gt; Eff
     (Reader InstancesState
        : Reader (SimulatorState t) : DelayEffect
        : PABEffects t (SimulatorState t))
     ()
-&gt; Eff
     (Reader (SimulatorState t)
        : DelayEffect : PABEffects t (SimulatorState t))
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader BlockchainEnv
 ~&gt; Eff
      (Reader InstancesState
         : Reader (SimulatorState t) : DelayEffect
         : PABEffects t (SimulatorState t)))
-&gt; Eff
     (Reader BlockchainEnv
        : Reader InstancesState : Reader (SimulatorState t) : DelayEffect
        : PABEffects t (SimulatorState t))
   ~&gt; Eff
        (Reader InstancesState
           : Reader (SimulatorState t) : DelayEffect
           : PABEffects t (SimulatorState t))
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier hs-var">Core.handleBlockchainEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                </span><span class="annot"><span class="annottext">(Eff
   (Reader BlockchainEnv
      : Reader InstancesState : Reader (SimulatorState t) : DelayEffect
      : PABEffects t (SimulatorState t))
   ()
 -&gt; Eff
      (Reader InstancesState
         : Reader (SimulatorState t) : DelayEffect
         : PABEffects t (SimulatorState t))
      ())
-&gt; Eff
     (Reader BlockchainEnv
        : Reader InstancesState : Reader (SimulatorState t) : DelayEffect
        : PABEffects t (SimulatorState t))
     ()
-&gt; Eff
     (Reader InstancesState
        : Reader (SimulatorState t) : DelayEffect
        : PABEffects t (SimulatorState t))
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs, Member DelayEffect effs,
 Member TimeEffect effs) =&gt;
Eff effs ()
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs, Member DelayEffect effs,
 Member TimeEffect effs) =&gt;
Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#advanceClock"><span class="hs-identifier hs-var">advanceClock</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393660"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="annot"><span class="annottext">Slot -&gt; PABAction t (SimulatorState t) ()
forall t env. Slot -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier hs-var">Core.waitUntilSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">onShutdown :: PABAction t (SimulatorState t) ()
</span><a href="Plutus.PAB.Core.html#onShutdown"><span class="hs-identifier hs-var">onShutdown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
-&gt; PABAction t (SimulatorState t) ()
forall (effs :: [* -&gt; *]) (m :: * -&gt; *).
(LastMember m effs, MonadIO m) =&gt;
Eff (DelayEffect : effs) ~&gt; Eff effs
</span><a href="Control.Monad.Freer.Delay.html#handleDelayEffect"><span class="hs-identifier hs-var">handleDelayEffect</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
 -&gt; PABAction t (SimulatorState t) ())
-&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
-&gt; PABAction t (SimulatorState t) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Millisecond
-&gt; Eff (DelayEffect : PABEffects t (SimulatorState t)) ()
forall a (effs :: [* -&gt; *]).
(TimeUnit a, Member DelayEffect effs) =&gt;
a -&gt; Eff effs ()
</span><a href="Control.Monad.Freer.Delay.html#delayThread"><span class="hs-identifier hs-var">delayThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Millisecond
</span><span class="hs-number">500</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier hs-type">Millisecond</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- need to wait a little to avoid garbled terminal output in GHCi.</span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleLogSimulator"><span class="hs-identifier hs-type">handleLogSimulator</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394317"><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394318"><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">Core.PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-254"></span><span id="handleLogSimulator"><span class="annot"><span class="annottext">handleLogSimulator :: Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleLogSimulator"><span class="hs-identifier hs-var hs-var">handleLogSimulator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">(LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs)
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PABEnvironment t (SimulatorState t)
 -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs
forall s1 s2 (effs :: [* -&gt; *]).
(Member (Reader s2) effs, LastMember IO effs) =&gt;
(s2 -&gt; TQueue (LogMessage s1)) -&gt; LogMsg s1 ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-var">logIntoTQueue</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">Core.PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394317"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394318"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
forall t.
Lens' (SimulatorState t) (TQueue (LogMessage (PABMultiAgentMsg t)))
</span><a href="Plutus.PAB.Simulator.html#logMessages"><span class="hs-identifier hs-var">logMessages</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; (PABEnvironment t (SimulatorState t) -&gt; SimulatorState t)
-&gt; PABEnvironment t (SimulatorState t)
-&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t (SimulatorState t) -&gt; SimulatorState t
forall t env. PABEnvironment t env -&gt; env
</span><a href="Plutus.PAB.Core.html#appEnv"><span class="hs-identifier hs-var hs-var">Core.appEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleServicesSimulator"><span class="hs-identifier hs-type">handleServicesSimulator</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394315"><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394314"><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">Core.PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WalletEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-270"></span><span id="handleServicesSimulator"><span class="annot"><span class="annottext">handleServicesSimulator :: Params
-&gt; Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleServicesSimulator"><span class="hs-identifier hs-var hs-var">handleServicesSimulator</span></a></span></span><span> </span><span id="local-6989586621680393635"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393635"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680393634"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393634"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393633"><span class="annot"><span class="annottext">makeTimedChainIndexEvent :: Wallet
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
-&gt; Eff (NodeClientEffect : effs) x
</span><a href="#local-6989586621680393633"><span class="hs-identifier hs-var hs-var">makeTimedChainIndexEvent</span></a></span></span><span> </span><span id="local-6989586621680393632"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393632"><span class="hs-identifier hs-var">wllt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>            </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent ~&gt; Eff (NodeClientEffect : effs))
-&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs)
   ~&gt; Eff (NodeClientEffect : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent ~&gt; Eff (NodeClientEffect : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent : NodeClientEffect : effs) x
 -&gt; Eff (NodeClientEffect : effs) x)
-&gt; (Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
    -&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs) x)
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
-&gt; Eff (NodeClientEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent'
 ~&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs))
-&gt; Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs)
   ~&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">Core.timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs) x
 -&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs) x)
-&gt; (Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
    -&gt; Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs) x)
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
-&gt; Eff (LogMsg EmulatorEvent : NodeClientEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog
 ~&gt; Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs))
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs)
   ~&gt; Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; EmulatorEvent')
-&gt; LogMsg ChainIndexLog
   ~&gt; Eff (LogMsg EmulatorEvent' : NodeClientEffect : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; ChainIndexLog -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">ChainIndexEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393632"><span class="hs-identifier hs-var">wllt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621680393630"><span class="annot"><span class="annottext">makeTimedChainEvent :: Eff (LogMsg ChainEvent : effs) x -&gt; Eff effs x
</span><a href="#local-6989586621680393630"><span class="hs-identifier hs-var hs-var">makeTimedChainEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">(LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs)
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PABEnvironment t (SimulatorState t)
 -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs
forall s1 s2 (effs :: [* -&gt; *]).
(Member (Reader s2) effs, LastMember IO effs) =&gt;
(s2 -&gt; TQueue (LogMessage s1)) -&gt; LogMsg s1 ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-var">logIntoTQueue</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">Core.PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
forall t.
Lens' (SimulatorState t) (TQueue (LogMessage (PABMultiAgentMsg t)))
</span><a href="Plutus.PAB.Simulator.html#logMessages"><span class="hs-identifier hs-var">logMessages</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; (PABEnvironment t (SimulatorState t) -&gt; SimulatorState t)
-&gt; PABEnvironment t (SimulatorState t)
-&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PABEnvironment t (SimulatorState t) -&gt; SimulatorState t
forall t env. PABEnvironment t env -&gt; env
</span><a href="Plutus.PAB.Core.html#appEnv"><span class="hs-identifier hs-var hs-var">Core.appEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg (PABMultiAgentMsg t) : effs) x -&gt; Eff effs x)
-&gt; (Eff (LogMsg ChainEvent : effs) x
    -&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) x)
-&gt; Eff (LogMsg ChainEvent : effs) x
-&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs))
-&gt; Eff (LogMsg EmulatorEvent : effs)
   ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent : effs) x
 -&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) x)
-&gt; (Eff (LogMsg ChainEvent : effs) x
    -&gt; Eff (LogMsg EmulatorEvent : effs) x)
-&gt; Eff (LogMsg ChainEvent : effs) x
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent' ~&gt; Eff (LogMsg EmulatorEvent : effs))
-&gt; Eff (LogMsg EmulatorEvent' : effs)
   ~&gt; Eff (LogMsg EmulatorEvent : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Member (LogMsg EmulatorEvent) (LogMsg EmulatorEvent : effs),
 Member TimeEffect (LogMsg EmulatorEvent : effs)) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff (LogMsg EmulatorEvent : effs)
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">Core.timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Emulator.EmulatorEvent</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680394314"><span class="hs-identifier hs-type">effs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent' : effs) x
 -&gt; Eff (LogMsg EmulatorEvent : effs) x)
-&gt; (Eff (LogMsg ChainEvent : effs) x
    -&gt; Eff (LogMsg EmulatorEvent' : effs) x)
-&gt; Eff (LogMsg ChainEvent : effs) x
-&gt; Eff (LogMsg EmulatorEvent : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent ~&gt; Eff (LogMsg EmulatorEvent' : effs))
-&gt; Eff (LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg EmulatorEvent' : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainEvent -&gt; EmulatorEvent')
-&gt; LogMsg ChainEvent ~&gt; Eff (LogMsg EmulatorEvent' : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">ChainEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-comment">-- handle 'NodeClientEffect'</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Eff (LogMsg ChainEvent : effs) x -&gt; Eff effs x
</span><a href="#local-6989586621680393630"><span class="hs-identifier hs-var">makeTimedChainEvent</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg ChainEvent : effs) x -&gt; Eff effs x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (LogMsg ChainEvent : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader BlockchainEnv ~&gt; Eff (LogMsg ChainEvent : effs))
-&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg ChainEvent : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader BlockchainEnv ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleBlockchainEnvReader"><span class="hs-identifier hs-var">Core.handleBlockchainEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">(Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs) x
 -&gt; Eff (LogMsg ChainEvent : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (LogMsg ChainEvent : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (SimulatorState t)
 ~&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs))
-&gt; Eff
     (Reader (SimulatorState t)
        : Reader BlockchainEnv : LogMsg ChainEvent : effs)
   ~&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader (SimulatorState t) ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">Core.handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader (SimulatorState t)
      : Reader BlockchainEnv : LogMsg ChainEvent : effs)
   x
 -&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (Reader (SimulatorState t)
            : Reader BlockchainEnv : LogMsg ChainEvent : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (Reader BlockchainEnv : LogMsg ChainEvent : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainEffect
 ~&gt; Eff
      ('[Reader (SimulatorState t), Reader BlockchainEnv,
         LogMsg ChainEvent]
       :++: effs))
-&gt; Eff (ChainEffect : effs)
   ~&gt; Eff
        ('[Reader (SimulatorState t), Reader BlockchainEnv,
           LogMsg ChainEvent]
         :++: effs)
forall (gs :: [* -&gt; *]) (f :: * -&gt; *) (effs :: [* -&gt; *]).
Weakens gs =&gt;
(f ~&gt; Eff (gs :++: effs)) -&gt; Eff (f : effs) ~&gt; Eff (gs :++: effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpretN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; ChainEffect
   ~&gt; Eff
        (Reader (SimulatorState t)
           : Reader BlockchainEnv : LogMsg ChainEvent : effs)
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainEvent) effs) =&gt;
Params -&gt; ChainEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainEffect"><span class="hs-identifier hs-var">handleChainEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ChainEffect : effs) x
 -&gt; Eff
      (Reader (SimulatorState t)
         : Reader BlockchainEnv : LogMsg ChainEvent : effs)
      x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (ChainEffect : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff
     (Reader (SimulatorState t)
        : Reader BlockchainEnv : LogMsg ChainEvent : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (SimulatorState t) ~&gt; Eff (ChainEffect : effs))
-&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs)
   ~&gt; Eff (ChainEffect : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader (SimulatorState t) ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">Core.handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">(Eff (Reader (SimulatorState t) : ChainEffect : effs) x
 -&gt; Eff (ChainEffect : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (ChainEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeClientEffect
 ~&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs))
-&gt; Eff (NodeClientEffect : effs)
   ~&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (h :: * -&gt; *)
       (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : h : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : h : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; Wallet
-&gt; NodeClientEffect
   ~&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs)
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member ChainEffect effs,
 Member (Reader (SimulatorState t)) effs) =&gt;
Params -&gt; Wallet -&gt; NodeClientEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleNodeClient"><span class="hs-identifier hs-var">handleNodeClient</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393635"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393634"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-comment">-- handle 'ChainIndexQueryEffect'</span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">(Eff (NodeClientEffect : effs) x
 -&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (NodeClientEffect : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (Reader (SimulatorState t) : ChainEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
-&gt; Eff (NodeClientEffect : effs) x
</span><a href="#local-6989586621680393633"><span class="hs-identifier hs-var">makeTimedChainIndexEvent</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393634"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
 -&gt; Eff (NodeClientEffect : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (NodeClientEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (SimulatorState t)
 ~&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs))
-&gt; Eff
     (Reader (SimulatorState t)
        : LogMsg ChainIndexLog : NodeClientEffect : effs)
   ~&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader (SimulatorState t) ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">Core.handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader (SimulatorState t)
      : LogMsg ChainIndexLog : NodeClientEffect : effs)
   x
 -&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (Reader (SimulatorState t)
            : LogMsg ChainIndexLog : NodeClientEffect : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (LogMsg ChainIndexLog : NodeClientEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQueryEffect
 ~&gt; Eff
      ('[Reader (SimulatorState t), LogMsg ChainIndexLog]
       :++: (NodeClientEffect : effs)))
-&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff
        ('[Reader (SimulatorState t), LogMsg ChainIndexLog]
         :++: (NodeClientEffect : effs))
forall (gs :: [* -&gt; *]) (f :: * -&gt; *) (effs :: [* -&gt; *]).
Weakens gs =&gt;
(f ~&gt; Eff (gs :++: effs)) -&gt; Eff (f : effs) ~&gt; Eff (gs :++: effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpretN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexQueryEffect ~&gt; Eff effs
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexQueryEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainIndexEffect"><span class="hs-identifier hs-var">handleChainIndexEffect</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-comment">-- handle 'WalletEffect'</span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ChainIndexQueryEffect : NodeClientEffect : effs) x
 -&gt; Eff
      (Reader (SimulatorState t)
         : LogMsg ChainIndexLog : NodeClientEffect : effs)
      x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs) x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff
     (Reader (SimulatorState t)
        : LogMsg ChainIndexLog : NodeClientEffect : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg TxBalanceMsg
 ~&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs))
-&gt; Eff
     (LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxBalanceMsg -&gt; PABMultiAgentMsg t)
-&gt; LogMsg TxBalanceMsg
   ~&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; TxBalanceMsg -&gt; PABMultiAgentMsg t
forall t. Wallet -&gt; TxBalanceMsg -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#WalletBalancingMsg"><span class="hs-identifier hs-var">WalletBalancingMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393634"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (LogMsg TxBalanceMsg
      : ChainIndexQueryEffect : NodeClientEffect : effs)
   x
 -&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs) x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (LogMsg TxBalanceMsg
            : ChainIndexQueryEffect : NodeClientEffect : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff (ChainIndexQueryEffect : NodeClientEffect : effs) x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
      : effs)
   x
 -&gt; (WalletAPIError
     -&gt; Eff
          (LogMsg TxBalanceMsg
             : ChainIndexQueryEffect : NodeClientEffect : effs)
          x)
 -&gt; Eff
      (LogMsg TxBalanceMsg
         : ChainIndexQueryEffect : NodeClientEffect : effs)
      x)
-&gt; (WalletAPIError
    -&gt; Eff
         (LogMsg TxBalanceMsg
            : ChainIndexQueryEffect : NodeClientEffect : effs)
         x)
-&gt; Eff
     (Error WalletAPIError
        : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
        : effs)
     x
-&gt; Eff
     (LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
     x
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Eff (Error WalletAPIError : effs) a
-&gt; (WalletAPIError -&gt; Eff effs a) -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">handleError</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Member (Error PABError) effs =&gt;
PABError -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError
 -&gt; Eff
      (LogMsg TxBalanceMsg
         : ChainIndexQueryEffect : NodeClientEffect : effs)
      x)
-&gt; (WalletAPIError -&gt; PABError)
-&gt; WalletAPIError
-&gt; Eff
     (LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier hs-var">WalletError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
      : effs)
   x
 -&gt; Eff
      (LogMsg TxBalanceMsg
         : ChainIndexQueryEffect : NodeClientEffect : effs)
      x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (Error WalletAPIError
            : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
            : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff
     (LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (SimulatorState t)
 ~&gt; Eff
      (Error WalletAPIError
         : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
         : effs))
-&gt; Eff
     (Reader (SimulatorState t)
        : Error WalletAPIError : LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff
        (Error WalletAPIError
           : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
           : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Reader (SimulatorState t) ~&gt; Eff effs
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Reader env ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#handleUserEnvReader"><span class="hs-identifier hs-var">Core.handleUserEnvReader</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Reader (SimulatorState t)
      : Error WalletAPIError : LogMsg TxBalanceMsg
      : ChainIndexQueryEffect : NodeClientEffect : effs)
   x
 -&gt; Eff
      (Error WalletAPIError
         : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
         : effs)
      x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (Reader (SimulatorState t)
            : Error WalletAPIError : LogMsg TxBalanceMsg
            : ChainIndexQueryEffect : NodeClientEffect : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff
     (Error WalletAPIError
        : LogMsg TxBalanceMsg : ChainIndexQueryEffect : NodeClientEffect
        : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(State WalletState
 ~&gt; Eff
      (Reader (SimulatorState t)
         : Error WalletAPIError : LogMsg TxBalanceMsg
         : ChainIndexQueryEffect : NodeClientEffect : effs))
-&gt; Eff
     (State WalletState
        : Error WalletAPIError : LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff
        (Reader (SimulatorState t)
           : Error WalletAPIError : LogMsg TxBalanceMsg
           : ChainIndexQueryEffect : NodeClientEffect : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; State WalletState
   ~&gt; Eff
        (Reader (SimulatorState t)
           : Error WalletAPIError : LogMsg TxBalanceMsg
           : ChainIndexQueryEffect : NodeClientEffect : effs)
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Error PABError) effs,
 Member (Reader (SimulatorState t)) effs) =&gt;
Wallet -&gt; State WalletState ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#runWalletState"><span class="hs-identifier hs-var">runWalletState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394315"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393634"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (State WalletState
      : Error WalletAPIError : LogMsg TxBalanceMsg
      : ChainIndexQueryEffect : NodeClientEffect : effs)
   x
 -&gt; Eff
      (Reader (SimulatorState t)
         : Error WalletAPIError : LogMsg TxBalanceMsg
         : ChainIndexQueryEffect : NodeClientEffect : effs)
      x)
-&gt; (Eff
      (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
    -&gt; Eff
         (State WalletState
            : Error WalletAPIError : LogMsg TxBalanceMsg
            : ChainIndexQueryEffect : NodeClientEffect : effs)
         x)
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs) x
-&gt; Eff
     (Reader (SimulatorState t)
        : Error WalletAPIError : LogMsg TxBalanceMsg
        : ChainIndexQueryEffect : NodeClientEffect : effs)
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletEffect
 ~&gt; Eff
      ('[State WalletState, Error WalletAPIError, LogMsg TxBalanceMsg]
       :++: (ChainIndexQueryEffect : NodeClientEffect : effs)))
-&gt; Eff
     (WalletEffect : ChainIndexQueryEffect : NodeClientEffect : effs)
   ~&gt; Eff
        ('[State WalletState, Error WalletAPIError, LogMsg TxBalanceMsg]
         :++: (ChainIndexQueryEffect : NodeClientEffect : effs))
forall (gs :: [* -&gt; *]) (f :: * -&gt; *) (effs :: [* -&gt; *]).
Weakens gs =&gt;
(f ~&gt; Eff (gs :++: effs)) -&gt; Eff (f : effs) ~&gt; Eff (gs :++: effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpretN</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.WalletState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">TxBalanceMsg</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (Error WalletAPIError) effs, Member NodeClientEffect effs,
 Member ChainIndexQueryEffect effs, Member (State WalletState) effs,
 Member (LogMsg TxBalanceMsg) effs) =&gt;
WalletEffect ~&gt; Eff effs
WalletEffect
~&gt; Eff
     ('[State WalletState, Error WalletAPIError, LogMsg TxBalanceMsg]
      :++: (ChainIndexQueryEffect : NodeClientEffect : effs))
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.handleWallet</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621680394003"><span class="annot"><a href="Plutus.PAB.Simulator.html#initialStateFromWallet"><span class="hs-identifier hs-type">initialStateFromWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-type">AgentState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394003"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-303"></span><span id="initialStateFromWallet"><span class="annot"><span class="annottext">initialStateFromWallet :: Wallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialStateFromWallet"><span class="hs-identifier hs-var hs-var">initialStateFromWallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AgentState t
-&gt; (WalletState -&gt; AgentState t)
-&gt; Maybe WalletState
-&gt; AgentState t
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AgentState t
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;runWalletState&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; AgentState t
forall t. MockWallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialAgentState"><span class="hs-identifier hs-var">initialAgentState</span></a></span><span> </span><span class="annot"><span class="annottext">(MockWallet -&gt; AgentState t)
-&gt; (WalletState -&gt; MockWallet) -&gt; WalletState -&gt; AgentState t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; MockWallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var hs-var">Wallet._mockWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe WalletState -&gt; AgentState t)
-&gt; (Wallet -&gt; Maybe WalletState) -&gt; Wallet -&gt; AgentState t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.emptyWalletState</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Handle the 'State WalletState' effect by reading from and writing</span><span>
</span><span id="line-306"></span><span class="hs-comment">--   to a TVar in the 'SimulatorState'</span><span>
</span><span id="line-307"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#runWalletState"><span class="hs-identifier hs-type">runWalletState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394189"><span class="annot"><a href="#local-6989586621680394189"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394190"><span class="annot"><a href="#local-6989586621680394190"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394190"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394190"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394189"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394190"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.WalletState</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394190"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-316"></span><span id="runWalletState"><span class="annot"><span class="annottext">runWalletState :: Wallet -&gt; State WalletState ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#runWalletState"><span class="hs-identifier hs-var hs-var">runWalletState</span></a></span></span><span> </span><span id="local-6989586621680393618"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">State WalletState x
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">Get</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393617"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393617"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (SimulatorState t)) effs =&gt;
Eff effs (SimulatorState t)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394189"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621680393616"><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="#local-6989586621680393616"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (AgentState t)) -&gt; Eff effs (Maybe (AgentState t))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe (AgentState t)) -&gt; Eff effs (Maybe (AgentState t)))
-&gt; IO (Maybe (AgentState t)) -&gt; Eff effs (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t))
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t)))
-&gt; STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>            </span><span id="local-6989586621680393615"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393615"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393617"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-321"></span><span>            </span><span class="annot"><span class="annottext">Maybe (AgentState t) -&gt; STM (Maybe (AgentState t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AgentState t) -&gt; STM (Maybe (AgentState t)))
-&gt; Maybe (AgentState t) -&gt; STM (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Map Wallet (AgentState t) -&gt; Maybe (AgentState t)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393615"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="#local-6989586621680393616"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>            </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError -&gt; Eff effs x) -&gt; PABError -&gt; Eff effs x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletNotFound"><span class="hs-identifier hs-var">WalletNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680393612"><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393612"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; Eff effs WalletState
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgentState t -&gt; WalletState
forall t. AgentState t -&gt; WalletState
</span><a href="Plutus.PAB.Simulator.html#_walletState"><span class="hs-identifier hs-var hs-var">_walletState</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393612"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Put</span></a></span><span> </span><span id="local-6989586621680393611"><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680393611"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393610"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393610"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (SimulatorState t)) effs =&gt;
Eff effs (SimulatorState t)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394189"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>            </span><span id="local-6989586621680393609"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393609"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393610"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Map Wallet (AgentState t) -&gt; Maybe (AgentState t)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393609"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>                </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393608"><span class="annot"><span class="annottext">ws :: AgentState Any
</span><a href="#local-6989586621680393608"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AgentState Any
-&gt; (WalletState -&gt; AgentState Any)
-&gt; Maybe WalletState
-&gt; AgentState Any
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AgentState Any
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;runWalletState&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; AgentState Any
forall t. MockWallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialAgentState"><span class="hs-identifier hs-var">initialAgentState</span></a></span><span> </span><span class="annot"><span class="annottext">(MockWallet -&gt; AgentState Any)
-&gt; (WalletState -&gt; MockWallet) -&gt; WalletState -&gt; AgentState Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; MockWallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var hs-var">Wallet._mockWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; Maybe WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.emptyWalletState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                        </span><span id="local-6989586621680393607"><span class="annot"><span class="annottext">newState :: AgentState t
</span><a href="#local-6989586621680393607"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AgentState Any
</span><a href="#local-6989586621680393608"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState Any -&gt; (AgentState Any -&gt; AgentState t) -&gt; AgentState t
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletState -&gt; Identity WalletState)
-&gt; AgentState Any -&gt; Identity (AgentState t)
forall t t.
Lens (AgentState t) (AgentState t) WalletState WalletState
</span><a href="Plutus.PAB.Simulator.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; Identity WalletState)
 -&gt; AgentState Any -&gt; Identity (AgentState t))
-&gt; WalletState -&gt; AgentState Any -&gt; AgentState t
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680393611"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-333"></span><span>                    </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t) -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393610"><span class="hs-identifier hs-var">_agentStates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; AgentState t
-&gt; Map Wallet (AgentState t)
-&gt; Map Wallet (AgentState t)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393607"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393609"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680393604"><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393604"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393603"><span class="annot"><span class="annottext">newState :: AgentState t
</span><a href="#local-6989586621680393603"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393604"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t -&gt; (AgentState t -&gt; AgentState t) -&gt; AgentState t
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletState -&gt; Identity WalletState)
-&gt; AgentState t -&gt; Identity (AgentState t)
forall t t.
Lens (AgentState t) (AgentState t) WalletState WalletState
</span><a href="Plutus.PAB.Simulator.html#walletState"><span class="hs-identifier hs-var">walletState</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletState -&gt; Identity WalletState)
 -&gt; AgentState t -&gt; Identity (AgentState t))
-&gt; WalletState -&gt; AgentState t -&gt; AgentState t
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState
</span><a href="#local-6989586621680393611"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-336"></span><span>                    </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t) -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393610"><span class="hs-identifier hs-var">_agentStates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; AgentState t
-&gt; Map Wallet (AgentState t)
-&gt; Map Wallet (AgentState t)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393618"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393603"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393609"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- | Start a new instance of a contract</span><span>
</span><span id="line-339"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#activateContract"><span class="hs-identifier hs-type">activateContract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393602"><span class="annot"><a href="#local-6989586621680393602"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PABContract"><span class="hs-identifier hs-type">Contract.PABContract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393602"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractDef"><span class="hs-identifier hs-type">Contract.ContractDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393602"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393602"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-340"></span><span id="activateContract"><span class="annot"><span class="annottext">activateContract :: Wallet -&gt; ContractDef t -&gt; Simulation t ContractInstanceId
</span><a href="Plutus.PAB.Simulator.html#activateContract"><span class="hs-identifier hs-var hs-var">activateContract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; ContractDef t -&gt; Simulation t ContractInstanceId
forall t env.
PABContract t =&gt;
Wallet -&gt; ContractDef t -&gt; PABAction t env ContractInstanceId
</span><a href="Plutus.PAB.Core.html#activateContract"><span class="hs-identifier hs-var">Core.activateContract</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Call a named endpoint on a contract instance</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#callEndpointOnInstance"><span class="hs-identifier hs-type">callEndpointOnInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393600"><span class="annot"><a href="#local-6989586621680393600"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680393599"><span class="annot"><a href="#local-6989586621680393599"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393600"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680393600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393599"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NotificationError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span id="callEndpointOnInstance"><span class="annot"><span class="annottext">callEndpointOnInstance :: ContractInstanceId
-&gt; [Char] -&gt; a -&gt; Simulation t (Maybe NotificationError)
</span><a href="Plutus.PAB.Simulator.html#callEndpointOnInstance"><span class="hs-identifier hs-var hs-var">callEndpointOnInstance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; [Char] -&gt; a -&gt; Simulation t (Maybe NotificationError)
forall t env a.
ToJSON a =&gt;
ContractInstanceId
-&gt; [Char] -&gt; a -&gt; PABAction t env (Maybe NotificationError)
</span><a href="Plutus.PAB.Core.html#callEndpointOnInstance%27"><span class="hs-identifier hs-var">Core.callEndpointOnInstance'</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Wait 1 slot length, then add a new block.</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#makeBlock"><span class="hs-identifier hs-type">makeBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393596"><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393940"><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">Instances.InstancesState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Control.Monad.Freer.Delay.html#DelayEffect"><span class="hs-identifier hs-type">DelayEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393940"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span id="makeBlock"><span class="annot"><span class="annottext">makeBlock :: Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#makeBlock"><span class="hs-identifier hs-var hs-var">makeBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621680393595"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680393595"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader BlockchainEnv) effs =&gt;
Eff effs BlockchainEnv
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pSlotConfig :: Params -&gt; SlotConfig
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621680393592"><span class="annot"><span class="annottext">Integer
scSlotLength :: Integer
scSlotLength :: SlotConfig -&gt; Integer
</span><a href="#local-6989586621680393592"><span class="hs-identifier hs-var hs-var">scSlotLength</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockchainEnv -&gt; Params
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#beParams"><span class="hs-identifier hs-var hs-var">beParams</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680393595"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621680393591"><span class="annot"><span class="annottext">makeTimedChainEvent :: Eff (LogMsg ChainEvent : effs) Slot -&gt; Eff effs Slot
</span><a href="#local-6989586621680393591"><span class="hs-identifier hs-var hs-var">makeTimedChainEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="annottext">(LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs)
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) ~&gt; Eff effs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; LogMsg (PABMultiAgentMsg t) ~&gt; Eff effs
forall s1 s2 (effs :: [* -&gt; *]).
(Member (Reader s2) effs, LastMember IO effs) =&gt;
(s2 -&gt; TQueue (LogMessage s1)) -&gt; LogMsg s1 ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-var">logIntoTQueue</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
forall t.
Lens' (SimulatorState t) (TQueue (LogMessage (PABMultiAgentMsg t)))
</span><a href="Plutus.PAB.Simulator.html#logMessages"><span class="hs-identifier hs-var">logMessages</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg (PABMultiAgentMsg t) : effs) Slot -&gt; Eff effs Slot)
-&gt; (Eff (LogMsg ChainEvent : effs) Slot
    -&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) Slot)
-&gt; Eff (LogMsg ChainEvent : effs) Slot
-&gt; Eff effs Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs))
-&gt; Eff (LogMsg EmulatorEvent : effs)
   ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent : effs) Slot
 -&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) Slot)
-&gt; (Eff (LogMsg ChainEvent : effs) Slot
    -&gt; Eff (LogMsg EmulatorEvent : effs) Slot)
-&gt; Eff (LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : effs) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent' ~&gt; Eff (LogMsg EmulatorEvent : effs))
-&gt; Eff (LogMsg EmulatorEvent' : effs)
   ~&gt; Eff (LogMsg EmulatorEvent : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">Core.timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent' : effs) Slot
 -&gt; Eff (LogMsg EmulatorEvent : effs) Slot)
-&gt; (Eff (LogMsg ChainEvent : effs) Slot
    -&gt; Eff (LogMsg EmulatorEvent' : effs) Slot)
-&gt; Eff (LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg EmulatorEvent : effs) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent ~&gt; Eff (LogMsg EmulatorEvent' : effs))
-&gt; Eff (LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg EmulatorEvent' : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainEvent -&gt; EmulatorEvent')
-&gt; LogMsg ChainEvent ~&gt; Eff (LogMsg EmulatorEvent' : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="annot"><span class="annottext">ChainEvent -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">ChainEvent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>        </span><span id="local-6989586621680393590"><span class="annot"><span class="annottext">makeTimedChainIndexEvent :: Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg ChainEvent : effs) Slot
</span><a href="#local-6989586621680393590"><span class="hs-identifier hs-var hs-var">makeTimedChainIndexEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>            </span><span class="annot"><span class="annottext">(LogMsg (PABMultiAgentMsg t) ~&gt; Eff (LogMsg ChainEvent : effs))
-&gt; Eff (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg ChainEvent : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; LogMsg (PABMultiAgentMsg t) ~&gt; Eff (LogMsg ChainEvent : effs)
forall s1 s2 (effs :: [* -&gt; *]).
(Member (Reader s2) effs, LastMember IO effs) =&gt;
(s2 -&gt; TQueue (LogMessage s1)) -&gt; LogMsg s1 ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-var">logIntoTQueue</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
-&gt; SimulatorState t -&gt; TQueue (LogMessage (PABMultiAgentMsg t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TQueue (LogMessage (PABMultiAgentMsg t)))
  (SimulatorState t)
  (TQueue (LogMessage (PABMultiAgentMsg t)))
forall t.
Lens' (SimulatorState t) (TQueue (LogMessage (PABMultiAgentMsg t)))
</span><a href="Plutus.PAB.Simulator.html#logMessages"><span class="hs-identifier hs-var">logMessages</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs) Slot
 -&gt; Eff (LogMsg ChainEvent : effs) Slot)
-&gt; (Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
    -&gt; Eff
         (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs) Slot)
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg ChainEvent : effs) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent
 ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs))
-&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EmulatorEvent -&gt; PABMultiAgentMsg t)
-&gt; LogMsg EmulatorEvent
   ~&gt; Eff (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EmulatorEvent -&gt; PABMultiAgentMsg t
forall t. EmulatorEvent -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#EmulatorMsg"><span class="hs-identifier hs-var">EmulatorMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs) Slot
 -&gt; Eff
      (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs) Slot)
-&gt; (Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
    -&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs) Slot)
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff
     (LogMsg (PABMultiAgentMsg t) : LogMsg ChainEvent : effs) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg EmulatorEvent'
 ~&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs))
-&gt; Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (LogMsg EmulatorEvent) effs, Member TimeEffect effs) =&gt;
LogMsg EmulatorEvent' ~&gt; Eff effs
forall e (effs :: [* -&gt; *]).
(Member (LogMsg (EmulatorTimeEvent e)) effs,
 Member TimeEffect effs) =&gt;
LogMsg e ~&gt; Eff effs
</span><a href="Plutus.PAB.Core.html#timed"><span class="hs-identifier hs-var">Core.timed</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">EmulatorEvent'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>            </span><span class="annot"><span class="annottext">(Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs) Slot
 -&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs) Slot)
-&gt; (Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
    -&gt; Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs) Slot)
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg EmulatorEvent : LogMsg ChainEvent : effs) Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog
 ~&gt; Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs))
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs)
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainIndexLog -&gt; EmulatorEvent')
-&gt; LogMsg ChainIndexLog
   ~&gt; Eff (LogMsg EmulatorEvent' : LogMsg ChainEvent : effs)
forall a b (effs :: [* -&gt; *]).
Member (LogMsg b) effs =&gt;
(a -&gt; b) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">mapLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; ChainIndexLog -&gt; EmulatorEvent'
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">ChainIndexEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">knownWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">Millisecond -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
(TimeUnit a, Member DelayEffect effs) =&gt;
a -&gt; Eff effs ()
</span><a href="Control.Monad.Freer.Delay.html#delayThread"><span class="hs-identifier hs-var">delayThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Millisecond
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680393592"><span class="hs-identifier hs-var">scSlotLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/kl898zkdm5m32sjwzs943dbppi7c8pg6-time-units-lib-time-units-1.0.0-haddock-doc/share/doc/time-units/html/src"><span class="hs-identifier hs-type">Millisecond</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">Eff effs Slot -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">(Eff effs Slot -&gt; Eff effs ()) -&gt; Eff effs Slot -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (LogMsg ChainEvent : effs) Slot -&gt; Eff effs Slot
</span><a href="#local-6989586621680393591"><span class="hs-identifier hs-var">makeTimedChainEvent</span></a></span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg ChainEvent : effs) Slot -&gt; Eff effs Slot)
-&gt; Eff (LogMsg ChainEvent : effs) Slot -&gt; Eff effs Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg ChainEvent : effs) Slot
</span><a href="#local-6989586621680393590"><span class="hs-identifier hs-var">makeTimedChainIndexEvent</span></a></span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="annottext">(Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
 -&gt; Eff (LogMsg ChainEvent : effs) Slot)
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
-&gt; Eff (LogMsg ChainEvent : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainControlEffect
 ~&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs))
-&gt; Eff
     (ChainControlEffect
        : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
   ~&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs,
 Member (LogMsg ChainEvent) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainControlEffect ~&gt; Eff effs
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs,
 Member (LogMsg ChainEvent) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainControlEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainControl"><span class="hs-identifier hs-var">handleChainControl</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393596"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (ChainControlEffect
      : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
   Slot
 -&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot)
-&gt; Eff
     (ChainControlEffect
        : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
     Slot
-&gt; Eff (LogMsg ChainIndexLog : LogMsg ChainEvent : effs) Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (ChainControlEffect
     : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
  Block
forall (effs :: [* -&gt; *]).
Member ChainControlEffect effs =&gt;
Eff effs Block
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.processBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (ChainControlEffect
     : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
  Block
-&gt; Eff
     (ChainControlEffect
        : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
     Slot
-&gt; Eff
     (ChainControlEffect
        : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
     Slot
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Slot)
-&gt; Eff
     (ChainControlEffect
        : LogMsg ChainIndexLog : LogMsg ChainEvent : effs)
     Slot
forall (effs :: [* -&gt; *]).
Member ChainControlEffect effs =&gt;
(Slot -&gt; Slot) -&gt; Eff effs Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.modifySlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot
forall a. Enum a =&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">succ</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Get the current state of the contract instance.</span><span>
</span><span id="line-378"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#instanceState"><span class="hs-identifier hs-type">instanceState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393585"><span class="annot"><a href="#local-6989586621680393585"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393585"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#State"><span class="hs-identifier hs-type">Contract.State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393585"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span id="instanceState"><span class="annot"><span class="annottext">instanceState :: Wallet -&gt; ContractInstanceId -&gt; Simulation t (State t)
</span><a href="Plutus.PAB.Simulator.html#instanceState"><span class="hs-identifier hs-var hs-var">instanceState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; ContractInstanceId -&gt; Simulation t (State t)
forall t env.
Wallet -&gt; ContractInstanceId -&gt; PABAction t env (State t)
</span><a href="Plutus.PAB.Core.html#instanceState"><span class="hs-identifier hs-var">Core.instanceState</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | An STM transaction that returns the observable state of the contract instance.</span><span>
</span><span id="line-382"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#observableState"><span class="hs-identifier hs-type">observableState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393583"><span class="annot"><a href="#local-6989586621680393583"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393583"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span id="observableState"><span class="annot"><span class="annottext">observableState :: ContractInstanceId -&gt; Simulation t (STM Value)
</span><a href="Plutus.PAB.Simulator.html#observableState"><span class="hs-identifier hs-var hs-var">observableState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t (STM Value)
forall t env. ContractInstanceId -&gt; PABAction t env (STM Value)
</span><a href="Plutus.PAB.Core.html#observableState"><span class="hs-identifier hs-var">Core.observableState</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | Wait until the observable state of the instance matches a predicate.</span><span>
</span><span id="line-386"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForState"><span class="hs-identifier hs-type">waitForState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393581"><span class="annot"><a href="#local-6989586621680393581"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393580"><span class="annot"><a href="#local-6989586621680393580"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393581"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393580"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-387"></span><span id="waitForState"><span class="annot"><span class="annottext">waitForState :: (Value -&gt; Maybe a) -&gt; ContractInstanceId -&gt; Simulation t a
</span><a href="Plutus.PAB.Simulator.html#waitForState"><span class="hs-identifier hs-var hs-var">waitForState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe a) -&gt; ContractInstanceId -&gt; Simulation t a
forall t env a.
(Value -&gt; Maybe a) -&gt; ContractInstanceId -&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#waitForState"><span class="hs-identifier hs-var">Core.waitForState</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForInstanceState"><span class="hs-identifier hs-type">waitForInstanceState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393578"><span class="annot"><a href="#local-6989586621680393578"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstanceState"><span class="hs-identifier hs-type">Instances.InstanceState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393578"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span>
</span><span id="line-394"></span><span id="waitForInstanceState"><span class="annot"><span class="annottext">waitForInstanceState :: (InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; Simulation t ContractActivityStatus
</span><a href="Plutus.PAB.Simulator.html#waitForInstanceState"><span class="hs-identifier hs-var hs-var">waitForInstanceState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; Simulation t ContractActivityStatus
forall t env.
(InstanceState -&gt; STM (Maybe ContractActivityStatus))
-&gt; ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceState"><span class="hs-identifier hs-var">Core.waitForInstanceState</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-type">waitForInstanceStateWithResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393576"><span class="annot"><a href="#local-6989586621680393576"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393576"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractActivityStatus</span></a></span><span>
</span><span id="line-397"></span><span id="waitForInstanceStateWithResult"><span class="annot"><span class="annottext">waitForInstanceStateWithResult :: ContractInstanceId -&gt; Simulation t ContractActivityStatus
</span><a href="Plutus.PAB.Simulator.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-var hs-var">waitForInstanceStateWithResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t ContractActivityStatus
forall t env.
ContractInstanceId -&gt; PABAction t env ContractActivityStatus
</span><a href="Plutus.PAB.Core.html#waitForInstanceStateWithResult"><span class="hs-identifier hs-var">Core.waitForInstanceStateWithResult</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | The list of endpoints that are currently open</span><span>
</span><span id="line-400"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#activeEndpoints"><span class="hs-identifier hs-type">activeEndpoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393574"><span class="annot"><a href="#local-6989586621680393574"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393574"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#OpenEndpoint"><span class="hs-identifier hs-type">OpenEndpoint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span id="activeEndpoints"><span class="annot"><span class="annottext">activeEndpoints :: ContractInstanceId -&gt; Simulation t (STM [OpenEndpoint])
</span><a href="Plutus.PAB.Simulator.html#activeEndpoints"><span class="hs-identifier hs-var hs-var">activeEndpoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t (STM [OpenEndpoint])
forall t env.
ContractInstanceId -&gt; PABAction t env (STM [OpenEndpoint])
</span><a href="Plutus.PAB.Core.html#activeEndpoints"><span class="hs-identifier hs-var">Core.activeEndpoints</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | The final result of the instance (waits until it is available)</span><span>
</span><span id="line-404"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#finalResult"><span class="hs-identifier hs-type">finalResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393572"><span class="annot"><a href="#local-6989586621680393572"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393572"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span id="finalResult"><span class="annot"><span class="annottext">finalResult :: ContractInstanceId -&gt; Simulation t (STM (Maybe Value))
</span><a href="Plutus.PAB.Simulator.html#finalResult"><span class="hs-identifier hs-var hs-var">finalResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t (STM (Maybe Value))
forall t env.
ContractInstanceId -&gt; PABAction t env (STM (Maybe Value))
</span><a href="Plutus.PAB.Core.html#finalResult"><span class="hs-identifier hs-var">Core.finalResult</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- | Wait until the contract is done, then return</span><span>
</span><span id="line-408"></span><span class="hs-comment">--   the error (if any)</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitUntilFinished"><span class="hs-identifier hs-type">waitUntilFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393570"><span class="annot"><a href="#local-6989586621680393570"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393570"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-type">JSON.Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span id="waitUntilFinished"><span class="annot"><span class="annottext">waitUntilFinished :: ContractInstanceId -&gt; Simulation t (Maybe Value)
</span><a href="Plutus.PAB.Simulator.html#waitUntilFinished"><span class="hs-identifier hs-var hs-var">waitUntilFinished</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t (Maybe Value)
forall t env. ContractInstanceId -&gt; PABAction t env (Maybe Value)
</span><a href="Plutus.PAB.Core.html#waitUntilFinished"><span class="hs-identifier hs-var">Core.waitUntilFinished</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- | Wait until the status of the transaction changes</span><span>
</span><span id="line-413"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForTxStatusChange"><span class="hs-identifier hs-type">waitForTxStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393568"><span class="annot"><a href="#local-6989586621680393568"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393568"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxStatus</span></a></span><span>
</span><span id="line-414"></span><span id="waitForTxStatusChange"><span class="annot"><span class="annottext">waitForTxStatusChange :: TxId -&gt; Simulation t TxStatus
</span><a href="Plutus.PAB.Simulator.html#waitForTxStatusChange"><span class="hs-identifier hs-var hs-var">waitForTxStatusChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; Simulation t TxStatus
forall t env. TxId -&gt; PABAction t env TxStatus
</span><a href="Plutus.PAB.Core.html#waitForTxStatusChange"><span class="hs-identifier hs-var">Core.waitForTxStatusChange</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Wait until the status of the transaction changes</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForTxOutStatusChange"><span class="hs-identifier hs-type">waitForTxOutStatusChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393566"><span class="annot"><a href="#local-6989586621680393566"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393566"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxOutStatus</span></a></span><span>
</span><span id="line-418"></span><span id="waitForTxOutStatusChange"><span class="annot"><span class="annottext">waitForTxOutStatusChange :: TxOutRef -&gt; Simulation t TxOutStatus
</span><a href="Plutus.PAB.Simulator.html#waitForTxOutStatusChange"><span class="hs-identifier hs-var hs-var">waitForTxOutStatusChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Simulation t TxOutStatus
forall t env. TxOutRef -&gt; PABAction t env TxOutStatus
</span><a href="Plutus.PAB.Core.html#waitForTxOutStatusChange"><span class="hs-identifier hs-var">Core.waitForTxOutStatusChange</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Wait until the endpoint becomes active.</span><span>
</span><span id="line-421"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForEndpoint"><span class="hs-identifier hs-type">waitForEndpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393564"><span class="annot"><a href="#local-6989586621680393564"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393564"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span id="waitForEndpoint"><span class="annot"><span class="annottext">waitForEndpoint :: ContractInstanceId -&gt; [Char] -&gt; Simulation t ()
</span><a href="Plutus.PAB.Simulator.html#waitForEndpoint"><span class="hs-identifier hs-var hs-var">waitForEndpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; [Char] -&gt; Simulation t ()
forall t env. ContractInstanceId -&gt; [Char] -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitForEndpoint"><span class="hs-identifier hs-var">Core.waitForEndpoint</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393562"><span class="annot"><a href="#local-6989586621680393562"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393562"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span id="currentSlot"><span class="annot"><span class="annottext">currentSlot :: Simulation t (STM Slot)
</span><a href="Plutus.PAB.Simulator.html#currentSlot"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Simulation t (STM Slot)
forall t env. PABAction t env (STM Slot)
</span><a href="Plutus.PAB.Core.html#currentSlot"><span class="hs-identifier hs-var">Core.currentSlot</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Wait until the target slot number has been reached</span><span>
</span><span id="line-428"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitUntilSlot"><span class="hs-identifier hs-type">waitUntilSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393560"><span class="annot"><a href="#local-6989586621680393560"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Slot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393560"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span id="waitUntilSlot"><span class="annot"><span class="annottext">waitUntilSlot :: Slot -&gt; Simulation t ()
</span><a href="Plutus.PAB.Simulator.html#waitUntilSlot"><span class="hs-identifier hs-var hs-var">waitUntilSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Simulation t ()
forall t env. Slot -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitUntilSlot"><span class="hs-identifier hs-var">Core.waitUntilSlot</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Wait for the given number of slots.</span><span>
</span><span id="line-432"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393559"><span class="annot"><a href="#local-6989586621680393559"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393559"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span id="waitNSlots"><span class="annot"><span class="annottext">waitNSlots :: Int -&gt; Simulation t ()
</span><a href="Plutus.PAB.Simulator.html#waitNSlots"><span class="hs-identifier hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Simulation t ()
forall t env. Int -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#waitNSlots"><span class="hs-identifier hs-var">Core.waitNSlots</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-keyword">type</span><span> </span><span id="Simulation"><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-var">Simulation</span></a></span></span><span> </span><span id="local-6989586621680393557"><span class="annot"><a href="#local-6989586621680393557"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393556"><span class="annot"><a href="#local-6989586621680393556"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutus.PAB.Core.html#PABAction"><span class="hs-identifier hs-type">Core.PABAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393557"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393557"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393556"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span id="local-6989586621680393554"><span id="local-6989586621680393555"><span class="annot"><a href="Plutus.PAB.Simulator.html#runSimulationWith"><span class="hs-identifier hs-type">runSimulationWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorEffectHandlers"><span class="hs-identifier hs-type">SimulatorEffectHandlers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393555"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393555"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393554"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393554"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-438"></span><span id="runSimulationWith"><span class="annot"><span class="annottext">runSimulationWith :: SimulatorEffectHandlers t
-&gt; Simulation t a -&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Simulator.html#runSimulationWith"><span class="hs-identifier hs-var hs-var">runSimulationWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timeout
-&gt; Timeout
-&gt; SimulatorEffectHandlers t
-&gt; Simulation t a
-&gt; IO (Either PABError a)
forall t env a.
Timeout
-&gt; Timeout
-&gt; EffectHandlers t env
-&gt; PABAction t env a
-&gt; IO (Either PABError a)
</span><a href="Plutus.PAB.Core.html#runPAB"><span class="hs-identifier hs-var">Core.runPAB</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
forall a. Default a =&gt; a
</span><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
forall a. Default a =&gt; a
</span><a href="../file:///nix/store/ibwdmf5kswrsjw9gmzksnspzzk6vivp5-data-default-class-lib-data-default-class-0.1.2.0-haddock-doc/share/doc/data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Handle a 'LogMsg' effect in terms of a &quot;larger&quot; 'State' effect from which we have a setter.</span><span>
</span><span id="line-441"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-type">logIntoTQueue</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394263"><span class="annot"><a href="#local-6989586621680394263"><span class="hs-identifier hs-type">s1</span></a></span></span><span> </span><span id="local-6989586621680394265"><span class="annot"><a href="#local-6989586621680394265"><span class="hs-identifier hs-type">s2</span></a></span></span><span> </span><span id="local-6989586621680394264"><span class="annot"><a href="#local-6989586621680394264"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394265"><span class="hs-identifier hs-type">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394264"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394264"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680394265"><span class="hs-identifier hs-type">s2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-type">TQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394263"><span class="hs-identifier hs-type">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394263"><span class="hs-identifier hs-type">s1</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394264"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-449"></span><span id="logIntoTQueue"><span class="annot"><span class="annottext">logIntoTQueue :: (s2 -&gt; TQueue (LogMessage s1)) -&gt; LogMsg s1 ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#logIntoTQueue"><span class="hs-identifier hs-var hs-var">logIntoTQueue</span></a></span></span><span> </span><span id="local-6989586621680393552"><span class="annot"><span class="annottext">s2 -&gt; TQueue (LogMessage s1)
</span><a href="#local-6989586621680393552"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LMessage</span></a></span><span> </span><span id="local-6989586621680393551"><span class="annot"><span class="annottext">LogMessage s1
</span><a href="#local-6989586621680393551"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>        </span><span id="local-6989586621680393550"><span class="annot"><span class="annottext">TQueue (LogMessage s1)
</span><a href="#local-6989586621680393550"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(s2 -&gt; TQueue (LogMessage s1)) -&gt; Eff effs (TQueue (LogMessage s1))
forall r (effs :: [* -&gt; *]) a.
Member (Reader r) effs =&gt;
(r -&gt; a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">s2 -&gt; TQueue (LogMessage s1)
</span><a href="#local-6989586621680393552"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TQueue (LogMessage s1) -&gt; LogMessage s1 -&gt; STM ()
forall a. TQueue a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.writeTQueue</span></a></span><span> </span><span class="annot"><span class="annottext">TQueue (LogMessage s1)
</span><a href="#local-6989586621680393550"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage s1
</span><a href="#local-6989586621680393551"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleChainControl"><span class="hs-identifier hs-type">handleChainControl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394140"><span class="annot"><a href="#local-6989586621680394140"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394141"><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394140"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">Instances.InstancesState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">ChainControlEffect</span></a></span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394141"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-465"></span><span id="handleChainControl"><span class="annot"><span class="annottext">handleChainControl :: ChainControlEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainControl"><span class="hs-identifier hs-var hs-var">handleChainControl</span></a></span></span><span> </span><span id="local-6989586621680393548"><span class="annot"><span class="annottext">ChainControlEffect x
</span><a href="#local-6989586621680393548"><span class="hs-identifier hs-var">eff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621680393547"><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680393547"><span class="hs-identifier hs-var">blockchainEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader BlockchainEnv) effs =&gt;
Eff effs BlockchainEnv
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393546"><span class="annot"><span class="annottext">params :: Params
</span><a href="#local-6989586621680393546"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockchainEnv -&gt; Params
</span><a href="Plutus.PAB.Core.ContractInstance.STM.html#beParams"><span class="hs-identifier hs-var hs-var">beParams</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680393547"><span class="hs-identifier hs-var">blockchainEnv</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChainControlEffect x
</span><a href="#local-6989586621680393548"><span class="hs-identifier hs-var">eff</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><span class="annottext">ChainControlEffect x
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.ProcessBlock</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>            </span><span id="local-6989586621680393544"><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680393544"><span class="hs-identifier hs-var">instancesState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader InstancesState) effs =&gt;
Eff effs InstancesState
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">Instances.InstancesState</span></a></span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680393543"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680393543"><span class="hs-identifier hs-var">txns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393542"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680393542"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) (Block, Slot)
-&gt; Eff effs (Block, Slot)
forall t a (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainEvent) effs, LastMember IO effs) =&gt;
Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-var">runChainEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394140"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393546"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Block -&gt; Slot -&gt; (Block, Slot))
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) Block
-&gt; Eff
     (ChainEffect : ChainControlEffect : ChainEffs)
     (Slot -&gt; (Block, Slot))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ChainEffect : ChainControlEffect : ChainEffs) Block
forall (effs :: [* -&gt; *]).
Member ChainControlEffect effs =&gt;
Eff effs Block
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.processBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  (ChainEffect : ChainControlEffect : ChainEffs)
  (Slot -&gt; (Block, Slot))
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) (Block, Slot)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
forall (effs :: [* -&gt; *]). Member ChainEffect effs =&gt; Eff effs Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.getCurrentSlot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-comment">-- Adds a new tip on the chain index given the block and slot number</span><span>
</span><span id="line-474"></span><span>            </span><span class="annot"><span class="annottext">forall t a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs, LastMember m effs,
 MonadIO m) =&gt;
Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
-&gt; Eff effs a
forall a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs, LastMember m effs,
 MonadIO m) =&gt;
Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainIndexEffects"><span class="hs-identifier hs-var">runChainIndexEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394140"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[ChainIndexQueryEffect, ChainIndexControlEffect,
     State ChainIndexEmulatorState, LogMsg ChainIndexLog,
     Error ChainIndexError]
   ()
 -&gt; Eff effs ())
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     ()
-&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>              </span><span id="local-6989586621680393538"><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680393538"><span class="hs-identifier hs-var">currentTip</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  Tip
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
Eff effs Tip
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">getTip</span></a></span><span>
</span><span id="line-476"></span><span>              </span><span class="annot"><span class="annottext">Tip
-&gt; Block
-&gt; Slot
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     ()
forall (effs :: [* -&gt; *]).
Member ChainIndexControlEffect effs =&gt;
Tip -&gt; Block -&gt; Slot -&gt; Eff effs ()
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">appendNewTipBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Tip
</span><a href="#local-6989586621680393538"><span class="hs-identifier hs-var">currentTip</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680393543"><span class="hs-identifier hs-var">txns</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680393542"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>            </span><span class="annot"><span class="annottext">Eff effs (Either SyncActionFailure (Slot, BlockNumber))
-&gt; Eff effs ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff effs (Either SyncActionFailure (Slot, BlockNumber))
 -&gt; Eff effs ())
-&gt; Eff effs (Either SyncActionFailure (Slot, BlockNumber))
-&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either SyncActionFailure (Slot, BlockNumber))
-&gt; Eff effs (Either SyncActionFailure (Slot, BlockNumber))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstancesState
-&gt; BlockchainEnv
-&gt; Block
-&gt; Slot
-&gt; IO (STM (Either SyncActionFailure (Slot, BlockNumber)))
</span><a href="Plutus.PAB.Core.ContractInstance.BlockchainEnv.html#processMockBlock"><span class="hs-identifier hs-var">BlockchainEnv.processMockBlock</span></a></span><span> </span><span class="annot"><span class="annottext">InstancesState
</span><a href="#local-6989586621680393544"><span class="hs-identifier hs-var">instancesState</span></a></span><span> </span><span class="annot"><span class="annottext">BlockchainEnv
</span><a href="#local-6989586621680393547"><span class="hs-identifier hs-var">blockchainEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680393543"><span class="hs-identifier hs-var">txns</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621680393542"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">IO (STM (Either SyncActionFailure (Slot, BlockNumber)))
-&gt; (STM (Either SyncActionFailure (Slot, BlockNumber))
    -&gt; IO (Either SyncActionFailure (Slot, BlockNumber)))
-&gt; IO (Either SyncActionFailure (Slot, BlockNumber))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Either SyncActionFailure (Slot, BlockNumber))
-&gt; IO (Either SyncActionFailure (Slot, BlockNumber))
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>            </span><span class="annot"><span class="annottext">Block -&gt; Eff effs Block
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621680393543"><span class="hs-identifier hs-var">txns</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ModifySlot</span></a></span><span> </span><span id="local-6989586621680393535"><span class="annot"><span class="annottext">Slot -&gt; Slot
</span><a href="#local-6989586621680393535"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
-&gt; Eff effs Slot
forall t a (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainEvent) effs, LastMember IO effs) =&gt;
Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-var">runChainEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394140"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393546"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Slot -&gt; Slot)
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
forall (effs :: [* -&gt; *]).
Member ChainControlEffect effs =&gt;
(Slot -&gt; Slot) -&gt; Eff effs Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.modifySlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot
</span><a href="#local-6989586621680393535"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-type">runChainEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394066"><span class="annot"><a href="#local-6989586621680394066"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394064"><span class="annot"><a href="#local-6989586621680394064"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680394065"><span class="annot"><a href="#local-6989586621680394065"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394066"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394065"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394065"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394065"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainControlEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEffs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394064"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394065"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394064"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-492"></span><span id="runChainEffects"><span class="annot"><span class="annottext">runChainEffects :: Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-var hs-var">runChainEffects</span></a></span></span><span> </span><span id="local-6989586621680393534"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393534"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680393533"><span class="annot"><span class="annottext">Eff (ChainEffect : ChainControlEffect : ChainEffs) a
</span><a href="#local-6989586621680393533"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393532"><span class="annot"><span class="annottext">TVar ChainState
_chainState :: TVar ChainState
_chainState :: forall t. SimulatorState t -&gt; TVar ChainState
</span><a href="#local-6989586621680393532"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (SimulatorState t)) effs =&gt;
Eff effs (SimulatorState t)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394066"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680393531"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393531"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393530"><span class="annot"><span class="annottext">[LogMessage ChainEvent]
</span><a href="#local-6989586621680393530"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (a, [LogMessage ChainEvent])
-&gt; Eff effs (a, [LogMessage ChainEvent])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (a, [LogMessage ChainEvent])
 -&gt; Eff effs (a, [LogMessage ChainEvent]))
-&gt; IO (a, [LogMessage ChainEvent])
-&gt; Eff effs (a, [LogMessage ChainEvent])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (a, [LogMessage ChainEvent]) -&gt; IO (a, [LogMessage ChainEvent])
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (a, [LogMessage ChainEvent])
 -&gt; IO (a, [LogMessage ChainEvent]))
-&gt; STM (a, [LogMessage ChainEvent])
-&gt; IO (a, [LogMessage ChainEvent])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-495"></span><span>                        </span><span id="local-6989586621680393529"><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393529"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar ChainState -&gt; STM ChainState
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393532"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-496"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680393528"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393528"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393527"><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393527"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393526"><span class="annot"><span class="annottext">[LogMessage ChainEvent]
</span><a href="#local-6989586621680393526"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>                                </span><span class="annot"><span class="annottext">Eff '[] ((a, ChainState), [LogMessage ChainEvent])
-&gt; ((a, ChainState), [LogMessage ChainEvent])
forall a. Eff '[] a -&gt; a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-498"></span><span>                                </span><span class="annot"><span class="annottext">(Eff '[] ((a, ChainState), [LogMessage ChainEvent])
 -&gt; ((a, ChainState), [LogMessage ChainEvent]))
-&gt; Eff '[] ((a, ChainState), [LogMessage ChainEvent])
-&gt; ((a, ChainState), [LogMessage ChainEvent])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Monoid [LogMessage ChainEvent] =&gt;
Eff (Writer [LogMessage ChainEvent] : effs) a
-&gt; Eff effs (a, [LogMessage ChainEvent])
forall w (effs :: [* -&gt; *]) a.
Monoid w =&gt;
Eff (Writer w : effs) a -&gt; Eff effs (a, w)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>                                </span><span class="annot"><span class="annottext">(Eff '[Writer [LogMessage ChainEvent]] (a, ChainState)
 -&gt; Eff '[] ((a, ChainState), [LogMessage ChainEvent]))
-&gt; Eff '[Writer [LogMessage ChainEvent]] (a, ChainState)
-&gt; Eff '[] ((a, ChainState), [LogMessage ChainEvent])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent ~&gt; Eff '[Writer [LogMessage ChainEvent]])
-&gt; Eff '[LogMsg ChainEvent]
   ~&gt; Eff '[Writer [LogMessage ChainEvent]]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Writer</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview [LogMessage ChainEvent] (LogMessage ChainEvent)
-&gt; LogMsg ChainEvent ~&gt; Eff '[Writer [LogMessage ChainEvent]]
forall a w (effs :: [* -&gt; *]).
Member (Writer w) effs =&gt;
AReview w (LogMessage a) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">handleLogWriter</span></a></span><span> </span><span class="annot"><span class="annottext">AReview [LogMessage ChainEvent] (LogMessage ChainEvent)
forall a. AReview [a] a
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">_singleton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>                                </span><span class="annot"><span class="annottext">(Eff '[LogMsg ChainEvent] (a, ChainState)
 -&gt; Eff '[Writer [LogMessage ChainEvent]] (a, ChainState))
-&gt; Eff '[LogMsg ChainEvent] (a, ChainState)
-&gt; Eff '[Writer [LogMessage ChainEvent]] (a, ChainState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState
-&gt; Eff ChainEffs a -&gt; Eff '[LogMsg ChainEvent] (a, ChainState)
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs (a, s)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393529"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-501"></span><span>                                </span><span class="annot"><span class="annottext">(Eff ChainEffs a -&gt; Eff '[LogMsg ChainEvent] (a, ChainState))
-&gt; Eff ChainEffs a -&gt; Eff '[LogMsg ChainEvent] (a, ChainState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainControlEffect ~&gt; Eff ChainEffs)
-&gt; Eff (ChainControlEffect : ChainEffs) ~&gt; Eff ChainEffs
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; ChainControlEffect ~&gt; Eff ChainEffs
forall (effs :: [* -&gt; *]).
Members ChainEffs effs =&gt;
Params -&gt; ChainControlEffect ~&gt; Eff effs
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.handleControlChain</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393534"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>                                </span><span class="annot"><span class="annottext">(Eff (ChainControlEffect : ChainEffs) a -&gt; Eff ChainEffs a)
-&gt; Eff (ChainControlEffect : ChainEffs) a -&gt; Eff ChainEffs a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainEffect ~&gt; Eff (ChainControlEffect : ChainEffs))
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff (ChainControlEffect : ChainEffs) a
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; ChainEffect ~&gt; Eff (ChainControlEffect : ChainEffs)
forall (effs :: [* -&gt; *]).
Members ChainEffs effs =&gt;
Params -&gt; ChainEffect ~&gt; Eff effs
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.handleChain</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393534"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff (ChainEffect : ChainControlEffect : ChainEffs) a
</span><a href="#local-6989586621680393533"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-503"></span><span>                        </span><span class="annot"><span class="annottext">TVar ChainState -&gt; ChainState -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393532"><span class="hs-identifier hs-var">_chainState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393527"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-504"></span><span>                        </span><span class="annot"><span class="annottext">(a, [LogMessage ChainEvent]) -&gt; STM (a, [LogMessage ChainEvent])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393528"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LogMessage ChainEvent]
</span><a href="#local-6989586621680393526"><span class="hs-identifier hs-var">logs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">(LogMessage ChainEvent -&gt; Eff effs ())
-&gt; [LogMessage ChainEvent] -&gt; Eff effs ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogMsg ChainEvent () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainEvent () -&gt; Eff effs ())
-&gt; (LogMessage ChainEvent -&gt; LogMsg ChainEvent ())
-&gt; LogMessage ChainEvent
-&gt; Eff effs ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage ChainEvent -&gt; LogMsg ChainEvent ()
forall a. LogMessage a -&gt; LogMsg a ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">LMessage</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LogMessage ChainEvent]
</span><a href="#local-6989586621680393530"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Eff effs a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393531"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#runChainIndexEffects"><span class="hs-identifier hs-type">runChainIndexEffects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394060"><span class="annot"><a href="#local-6989586621680394060"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394057"><span class="annot"><a href="#local-6989586621680394057"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680394058"><span class="annot"><a href="#local-6989586621680394058"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621680394059"><span class="annot"><a href="#local-6989586621680394059"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394060"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394059"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394059"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394058"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394059"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394058"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexControlEffect</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexEmulatorState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394057"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394059"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394057"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-517"></span><span id="runChainIndexEffects"><span class="annot"><span class="annottext">runChainIndexEffects :: Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainIndexEffects"><span class="hs-identifier hs-var hs-var">runChainIndexEffects</span></a></span></span><span> </span><span id="local-6989586621680393523"><span class="annot"><span class="annottext">Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
</span><a href="#local-6989586621680393523"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393522"><span class="annot"><span class="annottext">TVar ChainIndexEmulatorState
_chainIndex :: TVar ChainIndexEmulatorState
_chainIndex :: forall t. SimulatorState t -&gt; TVar ChainIndexEmulatorState
</span><a href="#local-6989586621680393522"><span class="hs-identifier hs-var hs-var">_chainIndex</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (SimulatorState t)) effs =&gt;
Eff effs (SimulatorState t)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394060"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680393521"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393521"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393520"><span class="annot"><span class="annottext">[LogMessage ChainIndexLog]
</span><a href="#local-6989586621680393520"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (a, [LogMessage ChainIndexLog])
-&gt; Eff effs (a, [LogMessage ChainIndexLog])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (a, [LogMessage ChainIndexLog])
 -&gt; Eff effs (a, [LogMessage ChainIndexLog]))
-&gt; IO (a, [LogMessage ChainIndexLog])
-&gt; Eff effs (a, [LogMessage ChainIndexLog])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (a, [LogMessage ChainIndexLog])
-&gt; IO (a, [LogMessage ChainIndexLog])
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (a, [LogMessage ChainIndexLog])
 -&gt; IO (a, [LogMessage ChainIndexLog]))
-&gt; STM (a, [LogMessage ChainIndexLog])
-&gt; IO (a, [LogMessage ChainIndexLog])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>                    </span><span id="local-6989586621680393519"><span class="annot"><span class="annottext">ChainIndexEmulatorState
</span><a href="#local-6989586621680393519"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar ChainIndexEmulatorState -&gt; STM ChainIndexEmulatorState
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainIndexEmulatorState
</span><a href="#local-6989586621680393522"><span class="hs-identifier hs-var">_chainIndex</span></a></span><span>
</span><span id="line-521"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393518"><span class="annot"><span class="annottext">resultE :: Either
  ChainIndexError
  ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
</span><a href="#local-6989586621680393518"><span class="hs-identifier hs-var hs-var">resultE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>                            </span><span class="annot"><span class="annottext">Eff
  '[]
  (Either
     ChainIndexError
     ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
-&gt; Either
     ChainIndexError
     ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
forall a. Eff '[] a -&gt; a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-523"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[]
   (Either
      ChainIndexError
      ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
 -&gt; Either
      ChainIndexError
      ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
-&gt; Eff
     '[]
     (Either
        ChainIndexError
        ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
-&gt; Either
     ChainIndexError
     ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[Error ChainIndexError]
  ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
-&gt; Eff
     '[]
     (Either
        ChainIndexError
        ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; Eff effs (Either e a)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runError</span></a></span><span>
</span><span id="line-524"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[Error ChainIndexError]
   ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
 -&gt; Eff
      '[]
      (Either
         ChainIndexError
         ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])))
-&gt; Eff
     '[Error ChainIndexError]
     ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
-&gt; Eff
     '[]
     (Either
        ChainIndexError
        ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Monoid [LogMessage ChainIndexLog] =&gt;
Eff (Writer [LogMessage ChainIndexLog] : effs) a
-&gt; Eff effs (a, [LogMessage ChainIndexLog])
forall w (effs :: [* -&gt; *]) a.
Monoid w =&gt;
Eff (Writer w : effs) a -&gt; Eff effs (a, w)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runWriter</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-525"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
   (a, ChainIndexEmulatorState)
 -&gt; Eff
      '[Error ChainIndexError]
      ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog]))
-&gt; Eff
     '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
     (a, ChainIndexEmulatorState)
-&gt; Eff
     '[Error ChainIndexError]
     ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog
 ~&gt; Eff '[Writer [LogMessage ChainIndexLog], Error ChainIndexError])
-&gt; Eff '[LogMsg ChainIndexLog, Error ChainIndexError]
   ~&gt; Eff '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
forall (f :: * -&gt; *) (g :: * -&gt; *) (effs :: [* -&gt; *]).
(f ~&gt; Eff (g : effs)) -&gt; Eff (f : effs) ~&gt; Eff (g : effs)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">reinterpret</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Writer</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview [LogMessage ChainIndexLog] (LogMessage ChainIndexLog)
-&gt; LogMsg ChainIndexLog
   ~&gt; Eff '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
forall a w (effs :: [* -&gt; *]).
Member (Writer w) effs =&gt;
AReview w (LogMessage a) -&gt; LogMsg a ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">handleLogWriter</span></a></span><span> </span><span class="annot"><span class="annottext">AReview [LogMessage ChainIndexLog] (LogMessage ChainIndexLog)
forall a. AReview [a] a
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">_singleton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[LogMsg ChainIndexLog, Error ChainIndexError]
   (a, ChainIndexEmulatorState)
 -&gt; Eff
      '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
      (a, ChainIndexEmulatorState))
-&gt; Eff
     '[LogMsg ChainIndexLog, Error ChainIndexError]
     (a, ChainIndexEmulatorState)
-&gt; Eff
     '[Writer [LogMessage ChainIndexLog], Error ChainIndexError]
     (a, ChainIndexEmulatorState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexEmulatorState
-&gt; Eff
     '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     a
-&gt; Eff
     '[LogMsg ChainIndexLog, Error ChainIndexError]
     (a, ChainIndexEmulatorState)
forall s (effs :: [* -&gt; *]) a.
s -&gt; Eff (State s : effs) a -&gt; Eff effs (a, s)
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexEmulatorState
</span><a href="#local-6989586621680393519"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-527"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
     Error ChainIndexError]
   a
 -&gt; Eff
      '[LogMsg ChainIndexLog, Error ChainIndexError]
      (a, ChainIndexEmulatorState))
-&gt; Eff
     '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     a
-&gt; Eff
     '[LogMsg ChainIndexLog, Error ChainIndexError]
     (a, ChainIndexEmulatorState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexControlEffect
 ~&gt; Eff
      '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
        Error ChainIndexError])
-&gt; Eff
     '[ChainIndexControlEffect, State ChainIndexEmulatorState,
       LogMsg ChainIndexLog, Error ChainIndexError]
   ~&gt; Eff
        '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
          Error ChainIndexError]
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (State ChainIndexEmulatorState) effs,
 Member (Error ChainIndexError) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexControlEffect ~&gt; Eff effs
ChainIndexControlEffect
~&gt; Eff
     '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.handleControl</span></a></span><span>
</span><span id="line-528"></span><span>                            </span><span class="annot"><span class="annottext">(Eff
   '[ChainIndexControlEffect, State ChainIndexEmulatorState,
     LogMsg ChainIndexLog, Error ChainIndexError]
   a
 -&gt; Eff
      '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
        Error ChainIndexError]
      a)
-&gt; Eff
     '[ChainIndexControlEffect, State ChainIndexEmulatorState,
       LogMsg ChainIndexLog, Error ChainIndexError]
     a
-&gt; Eff
     '[State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ChainIndexQueryEffect
 ~&gt; Eff
      '[ChainIndexControlEffect, State ChainIndexEmulatorState,
        LogMsg ChainIndexLog, Error ChainIndexError])
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     a
-&gt; Eff
     '[ChainIndexControlEffect, State ChainIndexEmulatorState,
       LogMsg ChainIndexLog, Error ChainIndexError]
     a
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]).
(eff ~&gt; Eff effs) -&gt; Eff (eff : effs) ~&gt; Eff effs
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(Member (State ChainIndexEmulatorState) effs,
 Member (Error ChainIndexError) effs,
 Member (LogMsg ChainIndexLog) effs) =&gt;
ChainIndexQueryEffect ~&gt; Eff effs
ChainIndexQueryEffect
~&gt; Eff
     '[ChainIndexControlEffect, State ChainIndexEmulatorState,
       LogMsg ChainIndexLog, Error ChainIndexError]
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.handleQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
</span><a href="#local-6989586621680393523"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-529"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either
  ChainIndexError
  ((a, ChainIndexEmulatorState), [LogMessage ChainIndexLog])
</span><a href="#local-6989586621680393518"><span class="hs-identifier hs-var">resultE</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-530"></span><span>                      </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680393515"><span class="annot"><span class="annottext">ChainIndexError
</span><a href="#local-6989586621680393515"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; STM (a, [LogMessage ChainIndexLog])
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChainIndexError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexError
</span><a href="#local-6989586621680393515"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>                      </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680393513"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393513"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393512"><span class="annot"><span class="annottext">ChainIndexEmulatorState
</span><a href="#local-6989586621680393512"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393511"><span class="annot"><span class="annottext">[LogMessage ChainIndexLog]
</span><a href="#local-6989586621680393511"><span class="hs-identifier hs-var">logs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>                        </span><span class="annot"><span class="annottext">TVar ChainIndexEmulatorState -&gt; ChainIndexEmulatorState -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainIndexEmulatorState
</span><a href="#local-6989586621680393522"><span class="hs-identifier hs-var">_chainIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexEmulatorState
</span><a href="#local-6989586621680393512"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-533"></span><span>                        </span><span class="annot"><span class="annottext">(a, [LogMessage ChainIndexLog])
-&gt; STM (a, [LogMessage ChainIndexLog])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393513"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LogMessage ChainIndexLog]
</span><a href="#local-6989586621680393511"><span class="hs-identifier hs-var">logs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><span class="annottext">(LogMessage ChainIndexLog -&gt; Eff effs ())
-&gt; [LogMessage ChainIndexLog] -&gt; Eff effs ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogMsg ChainIndexLog () -&gt; Eff effs ()
forall (eff :: * -&gt; *) (effs :: [* -&gt; *]) a.
Member eff effs =&gt;
eff a -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">(LogMsg ChainIndexLog () -&gt; Eff effs ())
-&gt; (LogMessage ChainIndexLog -&gt; LogMsg ChainIndexLog ())
-&gt; LogMessage ChainIndexLog
-&gt; Eff effs ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage ChainIndexLog -&gt; LogMsg ChainIndexLog ()
forall a. LogMessage a -&gt; LogMsg a ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">LMessage</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LogMessage ChainIndexLog]
</span><a href="#local-6989586621680393520"><span class="hs-identifier hs-var">logs</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; Eff effs a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680393521"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | Handle the 'NodeClientEffect' using the 'SimulatorState'.</span><span>
</span><span id="line-538"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleNodeClient"><span class="hs-identifier hs-type">handleNodeClient</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394210"><span class="annot"><a href="#local-6989586621680394210"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394211"><span class="annot"><a href="#local-6989586621680394211"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394211"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394211"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394210"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394211"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">NodeClientEffect</span></a></span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394211"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-548"></span><span id="handleNodeClient"><span class="annot"><span class="annottext">handleNodeClient :: Params -&gt; Wallet -&gt; NodeClientEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleNodeClient"><span class="hs-identifier hs-var hs-var">handleNodeClient</span></a></span></span><span> </span><span id="local-6989586621680393510"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393510"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621680393509"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393509"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">PublishTx</span></a></span><span> </span><span id="local-6989586621680393508"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>        </span><span class="annot"><span class="annottext">CardanoTx -&gt; Eff effs ()
forall (effs :: [* -&gt; *]).
Member ChainEffect effs =&gt;
CardanoTx -&gt; Eff effs ()
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.queueTx</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-551"></span><span>        </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393506"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393506"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (SimulatorState t)) effs =&gt;
Eff effs (SimulatorState t)
forall r (effs :: [* -&gt; *]). Member (Reader r) effs =&gt; Eff effs r
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394210"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-553"></span><span>            </span><span id="local-6989586621680393505"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393505"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393506"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-554"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Map Wallet (AgentState t) -&gt; Maybe (AgentState t)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393509"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393505"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-555"></span><span>                </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393504"><span class="annot"><span class="annottext">newState :: AgentState t
</span><a href="#local-6989586621680393504"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; AgentState Any
forall t. Wallet -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#initialStateFromWallet"><span class="hs-identifier hs-var">initialStateFromWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393509"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState Any -&gt; (AgentState Any -&gt; AgentState t) -&gt; AgentState t
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxId Value -&gt; Identity (Map TxId Value))
-&gt; AgentState Any -&gt; Identity (AgentState t)
forall t t.
Lens
  (AgentState t) (AgentState t) (Map TxId Value) (Map TxId Value)
</span><a href="Plutus.PAB.Simulator.html#submittedFees"><span class="hs-identifier hs-var">submittedFees</span></a></span><span> </span><span class="annot"><span class="annottext">((Map TxId Value -&gt; Identity (Map TxId Value))
 -&gt; AgentState Any -&gt; Identity (AgentState t))
-&gt; ((Maybe Value -&gt; Identity (Maybe Value))
    -&gt; Map TxId Value -&gt; Identity (Map TxId Value))
-&gt; (Maybe Value -&gt; Identity (Maybe Value))
-&gt; AgentState Any
-&gt; Identity (AgentState t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map TxId Value)
-&gt; Lens' (Map TxId Value) (Maybe (IxValue (Map TxId Value)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">getCardanoTxId</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Value -&gt; Identity (Maybe Value))
 -&gt; AgentState Any -&gt; Identity (AgentState t))
-&gt; Value -&gt; AgentState Any -&gt; AgentState t
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">getCardanoTxFee</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-557"></span><span>                    </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t) -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393506"><span class="hs-identifier hs-var">_agentStates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; AgentState t
-&gt; Map Wallet (AgentState t)
-&gt; Map Wallet (AgentState t)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393509"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393504"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393505"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680393503"><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393503"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-559"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393502"><span class="annot"><span class="annottext">newState :: AgentState t
</span><a href="#local-6989586621680393502"><span class="hs-identifier hs-var hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393503"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t -&gt; (AgentState t -&gt; AgentState t) -&gt; AgentState t
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxId Value -&gt; Identity (Map TxId Value))
-&gt; AgentState t -&gt; Identity (AgentState t)
forall t t.
Lens
  (AgentState t) (AgentState t) (Map TxId Value) (Map TxId Value)
</span><a href="Plutus.PAB.Simulator.html#submittedFees"><span class="hs-identifier hs-var">submittedFees</span></a></span><span> </span><span class="annot"><span class="annottext">((Map TxId Value -&gt; Identity (Map TxId Value))
 -&gt; AgentState t -&gt; Identity (AgentState t))
-&gt; ((Maybe Value -&gt; Identity (Maybe Value))
    -&gt; Map TxId Value -&gt; Identity (Map TxId Value))
-&gt; (Maybe Value -&gt; Identity (Maybe Value))
-&gt; AgentState t
-&gt; Identity (AgentState t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map TxId Value)
-&gt; Lens' (Map TxId Value) (Maybe (IxValue (Map TxId Value)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">getCardanoTxId</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Value -&gt; Identity (Maybe Value))
 -&gt; AgentState t -&gt; Identity (AgentState t))
-&gt; Value -&gt; AgentState t -&gt; AgentState t
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">getCardanoTxFee</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393508"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-560"></span><span>                    </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t) -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393506"><span class="hs-identifier hs-var">_agentStates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
-&gt; AgentState t
-&gt; Map Wallet (AgentState t)
-&gt; Map Wallet (AgentState t)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393509"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393502"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393505"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">NodeClientEffect x
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">GetClientSlot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff effs x
forall (effs :: [* -&gt; *]). Member ChainEffect effs =&gt; Eff effs Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.getCurrentSlot</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><span class="annottext">NodeClientEffect x
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">GetClientParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Eff effs Params
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393510"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | Handle the 'Chain.ChainEffect' using the 'SimulatorState'.</span><span>
</span><span id="line-565"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleChainEffect"><span class="hs-identifier hs-type">handleChainEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394218"><span class="annot"><a href="#local-6989586621680394218"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394219"><span class="annot"><a href="#local-6989586621680394219"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394219"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394218"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394219"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEvent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394219"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainEffect</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394219"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-574"></span><span id="handleChainEffect"><span class="annot"><span class="annottext">handleChainEffect :: Params -&gt; ChainEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainEffect"><span class="hs-identifier hs-var hs-var">handleChainEffect</span></a></span></span><span> </span><span id="local-6989586621680393501"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393501"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.QueueTx</span></a></span><span> </span><span id="local-6989586621680393499"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393499"><span class="hs-identifier hs-var">tx</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) ()
-&gt; Eff effs ()
forall t a (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainEvent) effs, LastMember IO effs) =&gt;
Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-var">runChainEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394218"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393501"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (ChainEffect : ChainControlEffect : ChainEffs) ()
 -&gt; Eff effs ())
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) ()
-&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) ()
forall (effs :: [* -&gt; *]).
Member ChainEffect effs =&gt;
CardanoTx -&gt; Eff effs ()
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.queueTx</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621680393499"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">ChainEffect x
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.GetCurrentSlot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
-&gt; Eff effs Slot
forall t a (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainEvent) effs, LastMember IO effs) =&gt;
Params
-&gt; Eff (ChainEffect : ChainControlEffect : ChainEffs) a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainEffects"><span class="hs-identifier hs-var">runChainEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394218"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393501"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (ChainEffect : ChainControlEffect : ChainEffs) Slot
forall (effs :: [* -&gt; *]). Member ChainEffect effs =&gt; Eff effs Slot
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.getCurrentSlot</span></a></span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><span class="annottext">ChainEffect x
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain.GetParams</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Eff effs Params
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393501"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleChainIndexEffect"><span class="hs-identifier hs-type">handleChainIndexEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394206"><span class="annot"><a href="#local-6989586621680394206"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394207"><span class="annot"><a href="#local-6989586621680394207"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394207"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394206"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394207"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexLog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394207"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-584"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ChainIndexQueryEffect</span></a></span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394207"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-587"></span><span id="handleChainIndexEffect"><span class="annot"><span class="annottext">handleChainIndexEffect :: ChainIndexQueryEffect ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleChainIndexEffect"><span class="hs-identifier hs-var hs-var">handleChainIndexEffect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs, LastMember m effs,
 MonadIO m) =&gt;
Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
-&gt; Eff effs a
forall a (m :: * -&gt; *) (effs :: [* -&gt; *]).
(Member (Reader (SimulatorState t)) effs,
 Member (LogMsg ChainIndexLog) effs, LastMember m effs,
 MonadIO m) =&gt;
Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  a
-&gt; Eff effs a
</span><a href="Plutus.PAB.Simulator.html#runChainIndexEffects"><span class="hs-identifier hs-var">runChainIndexEffects</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394206"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   '[ChainIndexQueryEffect, ChainIndexControlEffect,
     State ChainIndexEmulatorState, LogMsg ChainIndexLog,
     Error ChainIndexError]
   x
 -&gt; Eff effs x)
-&gt; (ChainIndexQueryEffect x
    -&gt; Eff
         '[ChainIndexQueryEffect, ChainIndexControlEffect,
           State ChainIndexEmulatorState, LogMsg ChainIndexLog,
           Error ChainIndexError]
         x)
-&gt; ChainIndexQueryEffect x
-&gt; Eff effs x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">DatumFromHash</span></a></span><span> </span><span id="local-6989586621680393495"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680393495"><span class="hs-identifier hs-var">h</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe Datum)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
DatumHash -&gt; Eff effs (Maybe Datum)
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.datumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621680393495"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">ValidatorFromHash</span></a></span><span> </span><span id="local-6989586621680393492"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680393492"><span class="hs-identifier hs-var">h</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ValidatorHash
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe (Versioned Validator))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
ValidatorHash -&gt; Eff effs (Maybe (Versioned Validator))
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.validatorFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621680393492"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">MintingPolicyFromHash</span></a></span><span> </span><span id="local-6989586621680393489"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680393489"><span class="hs-identifier hs-var">h</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe (Versioned MintingPolicy))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
MintingPolicyHash -&gt; Eff effs (Maybe (Versioned MintingPolicy))
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.mintingPolicyFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621680393489"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">StakeValidatorFromHash</span></a></span><span> </span><span id="local-6989586621680393486"><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680393486"><span class="hs-identifier hs-var">h</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe (Versioned StakeValidator))
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
StakeValidatorHash -&gt; Eff effs (Maybe (Versioned StakeValidator))
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.stakeValidatorFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">StakeValidatorHash
</span><a href="#local-6989586621680393486"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">RedeemerFromHash</span></a></span><span> </span><span id="local-6989586621680393483"><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680393483"><span class="hs-identifier hs-var">h</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RedeemerHash
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe Redeemer)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
RedeemerHash -&gt; Eff effs (Maybe Redeemer)
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.redeemerFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerHash
</span><a href="#local-6989586621680393483"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxOutFromRef</span></a></span><span> </span><span id="local-6989586621680393480"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393480"><span class="hs-identifier hs-var">ref</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.txOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393480"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxFromTxId</span></a></span><span> </span><span id="local-6989586621680393477"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680393477"><span class="hs-identifier hs-var">txid</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxId
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe ChainIndexTx)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxId -&gt; Eff effs (Maybe ChainIndexTx)
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.txFromTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621680393477"><span class="hs-identifier hs-var">txid</span></a></span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">UnspentTxOutFromRef</span></a></span><span> </span><span id="local-6989586621680393474"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393474"><span class="hs-identifier hs-var">ref</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (Maybe DecoratedTxOut)
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs (Maybe DecoratedTxOut)
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.unspentTxOutFromRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393474"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">UtxoSetMembership</span></a></span><span> </span><span id="local-6989586621680393471"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393471"><span class="hs-identifier hs-var">ref</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     IsUtxoResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
TxOutRef -&gt; Eff effs IsUtxoResponse
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.utxoSetMembership</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621680393471"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">UtxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621680393468"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393468"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680393467"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393467"><span class="hs-identifier hs-var">addr</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     UtxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; Credential -&gt; Eff effs UtxosResponse
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.utxoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393468"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393467"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-598"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">UnspentTxOutSetAtAddress</span></a></span><span> </span><span id="local-6989586621680393464"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393464"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680393463"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393463"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (QueryResponse [(TxOutRef, DecoratedTxOut)])
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef
-&gt; Credential
-&gt; Eff effs (QueryResponse [(TxOutRef, DecoratedTxOut)])
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.unspentTxOutSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393464"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393463"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">DatumsAtAddress</span></a></span><span> </span><span id="local-6989586621680393460"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393460"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680393459"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393459"><span class="hs-identifier hs-var">addr</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     (QueryResponse [Datum])
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef
-&gt; Credential -&gt; Eff effs (QueryResponse [Datum])
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.datumsAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393460"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393459"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">UtxoSetWithCurrency</span></a></span><span> </span><span id="local-6989586621680393456"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393456"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680393455"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680393455"><span class="hs-identifier hs-var">ac</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; AssetClass
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     UtxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; AssetClass -&gt; Eff effs UtxosResponse
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.utxoSetWithCurrency</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393456"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621680393455"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxoSetAtAddress</span></a></span><span> </span><span id="local-6989586621680393452"><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393452"><span class="hs-identifier hs-var">pq</span></a></span></span><span> </span><span id="local-6989586621680393451"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393451"><span class="hs-identifier hs-var">addr</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
-&gt; Credential
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     TxosResponse
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
PageQuery TxOutRef -&gt; Credential -&gt; Eff effs TxosResponse
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.txoSetAtAddress</span></a></span><span> </span><span class="annot"><span class="annottext">PageQuery TxOutRef
</span><a href="#local-6989586621680393452"><span class="hs-identifier hs-var">pq</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621680393451"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-type">TxsFromTxIds</span></a></span><span> </span><span id="local-6989586621680393448"><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680393448"><span class="hs-identifier hs-var">txids</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TxId]
-&gt; Eff
     '[ChainIndexQueryEffect, ChainIndexControlEffect,
       State ChainIndexEmulatorState, LogMsg ChainIndexLog,
       Error ChainIndexError]
     [ChainIndexTx]
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
[TxId] -&gt; Eff effs [ChainIndexTx]
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.txsFromTxIds</span></a></span><span> </span><span class="annot"><span class="annottext">[TxId]
</span><a href="#local-6989586621680393448"><span class="hs-identifier hs-var">txids</span></a></span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><span class="annottext">ChainIndexQueryEffect x
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">GetTip</span></a></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff
  '[ChainIndexQueryEffect, ChainIndexControlEffect,
    State ChainIndexEmulatorState, LogMsg ChainIndexLog,
    Error ChainIndexError]
  x
forall (effs :: [* -&gt; *]).
Member ChainIndexQueryEffect effs =&gt;
Eff effs Tip
</span><a href="../../../../plutus-chain-index-core/html/src"><span class="hs-identifier hs-var">ChainIndex.getTip</span></a></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-comment">-- | Start a thread that prints log messages to the terminal when they come in.</span><span>
</span><span id="line-606"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#printLogMessages"><span class="hs-identifier hs-type">printLogMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394301"><span class="annot"><a href="#local-6989586621680394301"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-608"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394301"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-type">TQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMessage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394301"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ log messages</span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span id="printLogMessages"><span class="annot"><span class="annottext">printLogMessages :: TQueue (LogMessage t) -&gt; IO ()
</span><a href="Plutus.PAB.Simulator.html#printLogMessages"><span class="hs-identifier hs-var hs-var">printLogMessages</span></a></span></span><span> </span><span id="local-6989586621680393445"><span class="annot"><span class="annottext">TQueue (LogMessage t)
</span><a href="#local-6989586621680393445"><span class="hs-identifier hs-var">queue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ThreadId -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ThreadId -&gt; IO ()) -&gt; IO ThreadId -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forkIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ThreadId) -&gt; IO () -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forever</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621680393444"><span class="annot"><span class="annottext">LogMessage t
</span><a href="#local-6989586621680393444"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM (LogMessage t) -&gt; IO (LogMessage t)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (LogMessage t) -&gt; IO (LogMessage t))
-&gt; STM (LogMessage t) -&gt; IO (LogMessage t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TQueue (LogMessage t) -&gt; STM (LogMessage t)
forall a. TQueue a -&gt; STM a
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.readTQueue</span></a></span><span> </span><span class="annot"><span class="annottext">TQueue (LogMessage t)
</span><a href="#local-6989586621680393445"><span class="hs-identifier hs-var">queue</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogMessage t
</span><a href="#local-6989586621680393444"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage t
-&gt; Getting LogLevel (LogMessage t) LogLevel -&gt; LogLevel
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting LogLevel (LogMessage t) LogLevel
forall a. Lens' (LogMessage a) LogLevel
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logLevel</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; LogLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Info</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">Text.putStrLn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogMessage t -&gt; Text
forall a. Pretty a =&gt; a -&gt; Text
</span><a href="Plutus.PAB.Simulator.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">LogMessage t
</span><a href="#local-6989586621680393444"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Call 'makeBlock' forever.</span><span>
</span><span id="line-616"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#advanceClock"><span class="hs-identifier hs-type">advanceClock</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394277"><span class="annot"><a href="#local-6989586621680394277"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394278"><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394277"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">BlockchainEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#InstancesState"><span class="hs-identifier hs-type">Instances.InstancesState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Control.Monad.Freer.Delay.html#DelayEffect"><span class="hs-identifier hs-type">DelayEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.TimeEffect.html#TimeEffect"><span class="hs-identifier hs-type">TimeEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394278"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span id="advanceClock"><span class="annot"><span class="annottext">advanceClock :: Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#advanceClock"><span class="hs-identifier hs-var hs-var">advanceClock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff effs () -&gt; Eff effs ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forever</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs, Member DelayEffect effs,
 Member TimeEffect effs) =&gt;
Eff effs ()
forall t (effs :: [* -&gt; *]).
(LastMember IO effs, Member (Reader (SimulatorState t)) effs,
 Member (Reader BlockchainEnv) effs,
 Member (Reader InstancesState) effs, Member DelayEffect effs,
 Member TimeEffect effs) =&gt;
Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#makeBlock"><span class="hs-identifier hs-var">makeBlock</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394277"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | Handle the 'ContractStore' effect by writing the state to the</span><span>
</span><span id="line-629"></span><span class="hs-comment">--   TVar in 'SimulatorState'</span><span>
</span><span id="line-630"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleContractStore"><span class="hs-identifier hs-type">handleContractStore</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680394321"><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680394322"><span class="annot"><a href="#local-6989586621680394322"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">LastMember</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394322"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#PABEnvironment"><span class="hs-identifier hs-type">Core.PABEnvironment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394322"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Types.html#PABError"><span class="hs-identifier hs-type">PABError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680394322"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#ContractStore"><span class="hs-identifier hs-type">ContractStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="../file:///nix/store/nkim7nifcqpdb4r433zhbv94ima3fwqb-natural-transformation-lib-natural-transformation-0.4-haddock-doc/share/doc/natural-transformation/html/src"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394322"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-638"></span><span id="handleContractStore"><span class="annot"><span class="annottext">handleContractStore :: ContractStore t ~&gt; Eff effs
</span><a href="Plutus.PAB.Simulator.html#handleContractStore"><span class="hs-identifier hs-var hs-var">handleContractStore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-639"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutState"><span class="hs-identifier hs-type">Contract.PutState</span></a></span><span> </span><span id="local-6989586621680393439"><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680393439"><span class="hs-identifier hs-var">definition</span></a></span></span><span> </span><span id="local-6989586621680393438"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680393438"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span id="local-6989586621680393437"><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680393437"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-640"></span><span>        </span><span id="local-6989586621680393436"><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393436"><span class="hs-identifier hs-var">instancesTVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; SimulatorState t
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall t.
Lens'
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
</span><a href="Plutus.PAB.Simulator.html#instances"><span class="hs-identifier hs-var">instances</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t
 -&gt; TVar
      (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; Eff effs (SimulatorState t)
-&gt; Eff
     effs
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-642"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393435"><span class="annot"><span class="annottext">instState :: SimulatorContractInstanceState t
</span><a href="#local-6989586621680393435"><span class="hs-identifier hs-var hs-var">instState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimulatorContractInstanceState :: forall t.
ContractActivationArgs (ContractDef t)
-&gt; State t -&gt; SimulatorContractInstanceState t
</span><a href="Plutus.PAB.Simulator.html#SimulatorContractInstanceState"><span class="hs-identifier hs-type">SimulatorContractInstanceState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_contractDef :: ContractActivationArgs (ContractDef t)
</span><a href="Plutus.PAB.Simulator.html#_contractDef"><span class="hs-identifier hs-var">_contractDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractActivationArgs (ContractDef t)
</span><a href="#local-6989586621680393439"><span class="hs-identifier hs-var">definition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_contractState :: State t
</span><a href="Plutus.PAB.Simulator.html#_contractState"><span class="hs-identifier hs-var">_contractState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State t
</span><a href="#local-6989586621680393437"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-643"></span><span>            </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; (Map ContractInstanceId (SimulatorContractInstanceState t)
    -&gt; Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; STM ()
forall a. TVar a -&gt; (a -&gt; a) -&gt; STM ()
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.modifyTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393436"><span class="hs-identifier hs-var">instancesTVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter
  (Map ContractInstanceId (SimulatorContractInstanceState t))
  (Map ContractInstanceId (SimulatorContractInstanceState t))
  (Maybe (SimulatorContractInstanceState t))
  (Maybe (SimulatorContractInstanceState t))
-&gt; Maybe (SimulatorContractInstanceState t)
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Lens'
     (Map ContractInstanceId (SimulatorContractInstanceState t))
     (Maybe
        (IxValue
           (Map ContractInstanceId (SimulatorContractInstanceState t))))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map ContractInstanceId (SimulatorContractInstanceState t))
ContractInstanceId
</span><a href="#local-6989586621680393438"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimulatorContractInstanceState t
-&gt; Maybe (SimulatorContractInstanceState t)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SimulatorContractInstanceState t
</span><a href="#local-6989586621680393435"><span class="hs-identifier hs-var">instState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#GetState"><span class="hs-identifier hs-type">Contract.GetState</span></a></span><span> </span><span id="local-6989586621680393432"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680393432"><span class="hs-identifier hs-var">instanceId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-645"></span><span>        </span><span id="local-6989586621680393431"><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393431"><span class="hs-identifier hs-var">instancesTVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; SimulatorState t
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall t.
Lens'
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
</span><a href="Plutus.PAB.Simulator.html#instances"><span class="hs-identifier hs-var">instances</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t
 -&gt; TVar
      (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; Eff effs (SimulatorState t)
-&gt; Eff
     effs
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>        </span><span id="local-6989586621680393430"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621680393430"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting
  (First x)
  (Map ContractInstanceId (SimulatorContractInstanceState t))
  x
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
-&gt; Maybe x
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Lens'
     (Map ContractInstanceId (SimulatorContractInstanceState t))
     (Maybe
        (IxValue
           (Map ContractInstanceId (SimulatorContractInstanceState t))))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map ContractInstanceId (SimulatorContractInstanceState t))
ContractInstanceId
</span><a href="#local-6989586621680393432"><span class="hs-identifier hs-var">instanceId</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (SimulatorContractInstanceState t)
  -&gt; Const (First x) (Maybe (SimulatorContractInstanceState t)))
 -&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
 -&gt; Const
      (First x)
      (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; ((x -&gt; Const (First x) x)
    -&gt; Maybe (SimulatorContractInstanceState t)
    -&gt; Const (First x) (Maybe (SimulatorContractInstanceState t)))
-&gt; Getting
     (First x)
     (Map ContractInstanceId (SimulatorContractInstanceState t))
     x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorContractInstanceState t
 -&gt; Const (First x) (SimulatorContractInstanceState t))
-&gt; Maybe (SimulatorContractInstanceState t)
-&gt; Const (First x) (Maybe (SimulatorContractInstanceState t))
forall a b. Prism (Maybe a) (Maybe b) a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_Just</span></a></span><span> </span><span class="annot"><span class="annottext">((SimulatorContractInstanceState t
  -&gt; Const (First x) (SimulatorContractInstanceState t))
 -&gt; Maybe (SimulatorContractInstanceState t)
 -&gt; Const (First x) (Maybe (SimulatorContractInstanceState t)))
-&gt; ((x -&gt; Const (First x) x)
    -&gt; SimulatorContractInstanceState t
    -&gt; Const (First x) (SimulatorContractInstanceState t))
-&gt; (x -&gt; Const (First x) x)
-&gt; Maybe (SimulatorContractInstanceState t)
-&gt; Const (First x) (Maybe (SimulatorContractInstanceState t))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; Const (First x) x)
-&gt; SimulatorContractInstanceState t
-&gt; Const (First x) (SimulatorContractInstanceState t)
forall t. Lens' (SimulatorContractInstanceState t) (State t)
</span><a href="Plutus.PAB.Simulator.html#contractState"><span class="hs-identifier hs-var">contractState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map ContractInstanceId (SimulatorContractInstanceState t)
 -&gt; Maybe x)
-&gt; Eff
     effs (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Eff effs (Maybe x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Eff
     effs (Map ContractInstanceId (SimulatorContractInstanceState t))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; IO (Map ContractInstanceId (SimulatorContractInstanceState t))
forall a. TVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393431"><span class="hs-identifier hs-var">instancesTVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621680393430"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-648"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680393428"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680393428"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; Eff effs x
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621680393428"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-649"></span><span>            </span><span class="annot"><span class="annottext">Maybe x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Eff effs x
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId -&gt; PABError
</span><a href="Plutus.PAB.Types.html#ContractInstanceNotFound"><span class="hs-identifier hs-var">ContractInstanceNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680393432"><span class="hs-identifier hs-var">instanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#GetContracts"><span class="hs-identifier hs-type">Contract.GetContracts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractActivityStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-651"></span><span>        </span><span id="local-6989586621680393426"><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393426"><span class="hs-identifier hs-var">instancesTVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; SimulatorState t
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall t.
Lens'
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
</span><a href="Plutus.PAB.Simulator.html#instances"><span class="hs-identifier hs-var">instances</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t
 -&gt; TVar
      (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; Eff effs (SimulatorState t)
-&gt; Eff
     effs
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>        </span><span class="annot"><span class="annottext">(SimulatorContractInstanceState t
 -&gt; ContractActivationArgs (ContractDef t))
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
-&gt; Map ContractInstanceId (ContractActivationArgs (ContractDef t))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">SimulatorContractInstanceState t
-&gt; ContractActivationArgs (ContractDef t)
forall t.
SimulatorContractInstanceState t
-&gt; ContractActivationArgs (ContractDef t)
</span><a href="Plutus.PAB.Simulator.html#_contractDef"><span class="hs-identifier hs-var hs-var">_contractDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ContractInstanceId (SimulatorContractInstanceState t)
 -&gt; Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
-&gt; Eff
     effs (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Eff
     effs
     (Map ContractInstanceId (ContractActivationArgs (ContractDef t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; Eff
     effs (Map ContractInstanceId (SimulatorContractInstanceState t))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; IO (Map ContractInstanceId (SimulatorContractInstanceState t))
forall a. TVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393426"><span class="hs-identifier hs-var">instancesTVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutStartInstance"><span class="hs-identifier hs-type">Contract.PutStartInstance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#PutStopInstance"><span class="hs-identifier hs-type">Contract.PutStopInstance</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Effects.Contract.html#DeleteState"><span class="hs-identifier hs-type">Contract.DeleteState</span></a></span><span> </span><span id="local-6989586621680393422"><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680393422"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-656"></span><span>        </span><span id="local-6989586621680393421"><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393421"><span class="hs-identifier hs-var">instancesTVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; SimulatorState t
-&gt; TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall t.
Lens'
  (SimulatorState t)
  (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
</span><a href="Plutus.PAB.Simulator.html#instances"><span class="hs-identifier hs-var">instances</span></a></span><span> </span><span class="annot"><span class="annottext">(SimulatorState t
 -&gt; TVar
      (Map ContractInstanceId (SimulatorContractInstanceState t)))
-&gt; Eff effs (SimulatorState t)
-&gt; Eff
     effs
     (TVar (Map ContractInstanceId (SimulatorContractInstanceState t)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680394321"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>        </span><span class="annot"><span class="annottext">Eff effs () -&gt; Eff effs ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff effs () -&gt; Eff effs ()) -&gt; Eff effs () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Eff effs ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff effs ()) -&gt; IO () -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; (Map ContractInstanceId (SimulatorContractInstanceState t)
    -&gt; Map ContractInstanceId (SimulatorContractInstanceState t))
-&gt; STM ()
forall a. TVar a -&gt; (a -&gt; a) -&gt; STM ()
</span><a href="../file:///nix/store/b738x068mpk6m31fqb2w33rzbqb41k86-stm-lib-stm-2.5.0.1-haddock-doc/share/doc/stm/html/src"><span class="hs-identifier hs-var">STM.modifyTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map ContractInstanceId (SimulatorContractInstanceState t))
</span><a href="#local-6989586621680393421"><span class="hs-identifier hs-var">instancesTVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContractInstanceId
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
-&gt; Map ContractInstanceId (SimulatorContractInstanceState t)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">ContractInstanceId
</span><a href="#local-6989586621680393422"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#render"><span class="hs-identifier hs-type">render</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393942"><span class="annot"><a href="#local-6989586621680393942"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680393942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-660"></span><span id="render"><span class="annot"><span class="annottext">render :: a -&gt; Text
</span><a href="Plutus.PAB.Simulator.html#render"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleDocStream Any -&gt; Text
forall ann. SimpleDocStream ann -&gt; Text
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">Render.renderStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(SimpleDocStream Any -&gt; Text)
-&gt; (a -&gt; SimpleDocStream Any) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutOptions -&gt; Doc Any -&gt; SimpleDocStream Any
forall ann. LayoutOptions -&gt; Doc ann -&gt; SimpleDocStream ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">layoutPretty</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutOptions
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">defaultLayoutOptions</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; SimpleDocStream Any)
-&gt; (a -&gt; Doc Any) -&gt; a -&gt; SimpleDocStream Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc Any
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Statistics about the transactions that have been validated by the emulated</span><span>
</span><span id="line-664"></span><span class="hs-comment">--   node.</span><span>
</span><span id="line-665"></span><span class="hs-keyword">data</span><span> </span><span id="TxCounts"><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-var">TxCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>    </span><span id="TxCounts"><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-var">TxCounts</span></a></span></span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="_txValidated"><span class="annot"><span class="annottext">TxCounts -&gt; Int
</span><a href="Plutus.PAB.Simulator.html#_txValidated"><span class="hs-identifier hs-var hs-var">_txValidated</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-comment">-- ^ How many transactions were checked and added to the ledger</span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_txMemPool"><span class="annot"><span class="annottext">TxCounts -&gt; Int
</span><a href="Plutus.PAB.Simulator.html#_txMemPool"><span class="hs-identifier hs-var hs-var">_txMemPool</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span class="hs-comment">-- ^ How many transactions remain in the mempool of the emulated node</span><span>
</span><span id="line-671"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680393412"><span id="local-6989586621680393414"><span class="annot"><span class="annottext">TxCounts -&gt; TxCounts -&gt; Bool
(TxCounts -&gt; TxCounts -&gt; Bool)
-&gt; (TxCounts -&gt; TxCounts -&gt; Bool) -&gt; Eq TxCounts
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxCounts -&gt; TxCounts -&gt; Bool
$c/= :: TxCounts -&gt; TxCounts -&gt; Bool
== :: TxCounts -&gt; TxCounts -&gt; Bool
$c== :: TxCounts -&gt; TxCounts -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393396"><span id="local-6989586621680393398"><span id="local-6989586621680393400"><span id="local-6989586621680393402"><span id="local-6989586621680393404"><span id="local-6989586621680393406"><span id="local-6989586621680393408"><span class="annot"><span class="annottext">Eq TxCounts
Eq TxCounts
-&gt; (TxCounts -&gt; TxCounts -&gt; Ordering)
-&gt; (TxCounts -&gt; TxCounts -&gt; Bool)
-&gt; (TxCounts -&gt; TxCounts -&gt; Bool)
-&gt; (TxCounts -&gt; TxCounts -&gt; Bool)
-&gt; (TxCounts -&gt; TxCounts -&gt; Bool)
-&gt; (TxCounts -&gt; TxCounts -&gt; TxCounts)
-&gt; (TxCounts -&gt; TxCounts -&gt; TxCounts)
-&gt; Ord TxCounts
TxCounts -&gt; TxCounts -&gt; Bool
TxCounts -&gt; TxCounts -&gt; Ordering
TxCounts -&gt; TxCounts -&gt; TxCounts
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TxCounts -&gt; TxCounts -&gt; TxCounts
$cmin :: TxCounts -&gt; TxCounts -&gt; TxCounts
max :: TxCounts -&gt; TxCounts -&gt; TxCounts
$cmax :: TxCounts -&gt; TxCounts -&gt; TxCounts
&gt;= :: TxCounts -&gt; TxCounts -&gt; Bool
$c&gt;= :: TxCounts -&gt; TxCounts -&gt; Bool
&gt; :: TxCounts -&gt; TxCounts -&gt; Bool
$c&gt; :: TxCounts -&gt; TxCounts -&gt; Bool
&lt;= :: TxCounts -&gt; TxCounts -&gt; Bool
$c&lt;= :: TxCounts -&gt; TxCounts -&gt; Bool
&lt; :: TxCounts -&gt; TxCounts -&gt; Bool
$c&lt; :: TxCounts -&gt; TxCounts -&gt; Bool
compare :: TxCounts -&gt; TxCounts -&gt; Ordering
$ccompare :: TxCounts -&gt; TxCounts -&gt; Ordering
$cp1Ord :: Eq TxCounts
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393389"><span id="local-6989586621680393391"><span id="local-6989586621680393393"><span class="annot"><span class="annottext">Int -&gt; TxCounts -&gt; ShowS
[TxCounts] -&gt; ShowS
TxCounts -&gt; [Char]
(Int -&gt; TxCounts -&gt; ShowS)
-&gt; (TxCounts -&gt; [Char]) -&gt; ([TxCounts] -&gt; ShowS) -&gt; Show TxCounts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxCounts] -&gt; ShowS
$cshowList :: [TxCounts] -&gt; ShowS
show :: TxCounts -&gt; [Char]
$cshow :: TxCounts -&gt; [Char]
showsPrec :: Int -&gt; TxCounts -&gt; ShowS
$cshowsPrec :: Int -&gt; TxCounts -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span id="txMemPool"><span id="txValidated"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">TxCounts</span></span></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="hs-comment">-- | Get the 'TxCounts' of the emulated blockchain</span><span>
</span><span id="line-676"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#txCounts"><span class="hs-identifier hs-type">txCounts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393387"><span class="annot"><a href="#local-6989586621680393387"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393387"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-type">TxCounts</span></a></span><span>
</span><span id="line-677"></span><span id="txCounts"><span class="annot"><span class="annottext">txCounts :: Simulation t TxCounts
</span><a href="Plutus.PAB.Simulator.html#txCounts"><span class="hs-identifier hs-var hs-var">txCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Simulation t (STM TxCounts)
forall t. Simulation t (STM TxCounts)
</span><a href="Plutus.PAB.Simulator.html#txCountsSTM"><span class="hs-identifier hs-var">txCountsSTM</span></a></span><span> </span><span class="annot"><span class="annottext">Simulation t (STM TxCounts)
-&gt; (STM TxCounts -&gt; Simulation t TxCounts) -&gt; Simulation t TxCounts
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">IO TxCounts -&gt; Simulation t TxCounts
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO TxCounts -&gt; Simulation t TxCounts)
-&gt; (STM TxCounts -&gt; IO TxCounts)
-&gt; STM TxCounts
-&gt; Simulation t TxCounts
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">STM TxCounts -&gt; IO TxCounts
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="hs-comment">-- | Get an STM transaction with the 'TxCounts' of the emulated blockchain</span><span>
</span><span id="line-680"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#txCountsSTM"><span class="hs-identifier hs-type">txCountsSTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393908"><span class="annot"><a href="#local-6989586621680393908"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393908"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-type">TxCounts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span id="txCountsSTM"><span class="annot"><span class="annottext">txCountsSTM :: Simulation t (STM TxCounts)
</span><a href="Plutus.PAB.Simulator.html#txCountsSTM"><span class="hs-identifier hs-var hs-var">txCountsSTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393386"><span class="annot"><span class="annottext">TVar ChainState
_chainState :: TVar ChainState
_chainState :: forall t. SimulatorState t -&gt; TVar ChainState
</span><a href="#local-6989586621680393386"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393908"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393908"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><span class="annottext">STM TxCounts -&gt; Simulation t (STM TxCounts)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(STM TxCounts -&gt; Simulation t (STM TxCounts))
-&gt; STM TxCounts -&gt; Simulation t (STM TxCounts)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393384"><span class="annot"><span class="annottext">Blockchain
_chainNewestFirst :: ChainState -&gt; Blockchain
_chainNewestFirst :: Blockchain
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var hs-var">Chain._chainNewestFirst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393382"><span class="annot"><span class="annottext">TxPool
_txPool :: ChainState -&gt; TxPool
_txPool :: TxPool
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var hs-var">Chain._txPool</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar ChainState -&gt; STM ChainState
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393386"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="annottext">TxCounts -&gt; STM TxCounts
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-686"></span><span>            </span><span class="annot"><span class="annottext">(TxCounts -&gt; STM TxCounts) -&gt; TxCounts -&gt; STM TxCounts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxCounts :: Int -&gt; Int -&gt; TxCounts
</span><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-type">TxCounts</span></a></span><span>
</span><span id="line-687"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_txValidated :: Int
</span><a href="Plutus.PAB.Simulator.html#_txValidated"><span class="hs-identifier hs-var">_txValidated</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Block -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(Block -&gt; Int) -&gt; Blockchain -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Blockchain
</span><a href="#local-6989586621680393384"><span class="hs-identifier hs-var">_chainNewestFirst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_txMemPool :: Int
</span><a href="Plutus.PAB.Simulator.html#_txMemPool"><span class="hs-identifier hs-var">_txMemPool</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxPool -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">TxPool
</span><a href="#local-6989586621680393382"><span class="hs-identifier hs-var">_txPool</span></a></span><span>
</span><span id="line-689"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-comment">-- | Wait until at least the given number of valid transactions are on the simulated blockchain.</span><span>
</span><span id="line-692"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#waitForValidatedTxCount"><span class="hs-identifier hs-type">waitForValidatedTxCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393378"><span class="annot"><a href="#local-6989586621680393378"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393378"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span id="waitForValidatedTxCount"><span class="annot"><span class="annottext">waitForValidatedTxCount :: Int -&gt; Simulation t ()
</span><a href="Plutus.PAB.Simulator.html#waitForValidatedTxCount"><span class="hs-identifier hs-var hs-var">waitForValidatedTxCount</span></a></span></span><span> </span><span id="local-6989586621680393377"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680393377"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621680393376"><span class="annot"><span class="annottext">STM TxCounts
</span><a href="#local-6989586621680393376"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Simulation t (STM TxCounts)
forall t. Simulation t (STM TxCounts)
</span><a href="Plutus.PAB.Simulator.html#txCountsSTM"><span class="hs-identifier hs-var">txCountsSTM</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; Simulation t ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Simulation t ()) -&gt; IO () -&gt; Simulation t ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-696"></span><span>        </span><span class="annot"><a href="Plutus.PAB.Simulator.html#TxCounts"><span class="hs-identifier hs-type">TxCounts</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393375"><span class="annot"><span class="annottext">Int
_txValidated :: Int
_txValidated :: TxCounts -&gt; Int
</span><a href="#local-6989586621680393375"><span class="hs-identifier hs-var hs-var">_txValidated</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM TxCounts
</span><a href="#local-6989586621680393376"><span class="hs-identifier hs-var">counts</span></a></span><span>
</span><span id="line-697"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; STM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680393375"><span class="hs-identifier hs-var">_txValidated</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680393377"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">-- | The set of all active contracts.</span><span>
</span><span id="line-700"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#activeContracts"><span class="hs-identifier hs-type">activeContracts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393374"><span class="annot"><a href="#local-6989586621680393374"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393374"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span id="activeContracts"><span class="annot"><span class="annottext">activeContracts :: Simulation t (Set ContractInstanceId)
</span><a href="Plutus.PAB.Simulator.html#activeContracts"><span class="hs-identifier hs-var hs-var">activeContracts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Simulation t (Set ContractInstanceId)
forall t env. PABAction t env (Set ContractInstanceId)
</span><a href="Plutus.PAB.Core.html#activeContracts"><span class="hs-identifier hs-var">Core.activeContracts</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-comment">-- | The total value currently at an address</span><span>
</span><span id="line-704"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#valueAtSTM"><span class="hs-identifier hs-type">valueAtSTM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393881"><span class="annot"><a href="#local-6989586621680393881"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393881"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">STM</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span id="valueAtSTM"><span class="annot"><span class="annottext">valueAtSTM :: CardanoAddress -&gt; Simulation t (STM Value)
</span><a href="Plutus.PAB.Simulator.html#valueAtSTM"><span class="hs-identifier hs-var hs-var">valueAtSTM</span></a></span></span><span> </span><span id="local-6989586621680393372"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680393372"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393371"><span class="annot"><span class="annottext">TVar ChainState
_chainState :: TVar ChainState
_chainState :: forall t. SimulatorState t -&gt; TVar ChainState
</span><a href="#local-6989586621680393371"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393881"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393881"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><span class="annottext">STM Value -&gt; Simulation t (STM Value)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Value -&gt; Simulation t (STM Value))
-&gt; STM Value -&gt; Simulation t (STM Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-708"></span><span>        </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_index :: ChainState -&gt; UtxoIndex
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">Chain._index</span></a></span><span class="hs-glyph">=</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">UtxoIndex.UtxoIndex</span></a></span><span> </span><span id="local-6989586621680393368"><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621680393368"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar ChainState -&gt; STM ChainState
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393371"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><span class="annottext">Value -&gt; STM Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; STM Value) -&gt; Value -&gt; STM Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value) -&gt; [TxOut] -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">txOutValue</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOut] -&gt; Value) -&gt; [TxOut] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Bool) -&gt; [TxOut] -&gt; [TxOut]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680393366"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621680393366"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; CardanoAddress
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">txOutAddress</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621680393366"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; CardanoAddress -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680393372"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TxOut] -&gt; [TxOut]) -&gt; [TxOut] -&gt; [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; TxOut) -&gt; [(TxOutRef, TxOut)] -&gt; [TxOut]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [TxOut]) -&gt; [(TxOutRef, TxOut)] -&gt; [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621680393368"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span class="hs-comment">-- | The total value currently at an address</span><span>
</span><span id="line-712"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#valueAt"><span class="hs-identifier hs-type">valueAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393364"><span class="annot"><a href="#local-6989586621680393364"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoAddress</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393364"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-713"></span><span id="valueAt"><span class="annot"><span class="annottext">valueAt :: CardanoAddress -&gt; Simulation t Value
</span><a href="Plutus.PAB.Simulator.html#valueAt"><span class="hs-identifier hs-var hs-var">valueAt</span></a></span></span><span> </span><span id="local-6989586621680393363"><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680393363"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-714"></span><span>    </span><span id="local-6989586621680393362"><span class="annot"><span class="annottext">STM Value
</span><a href="#local-6989586621680393362"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CardanoAddress -&gt; Simulation t (STM Value)
forall t. CardanoAddress -&gt; Simulation t (STM Value)
</span><a href="Plutus.PAB.Simulator.html#valueAtSTM"><span class="hs-identifier hs-var">valueAtSTM</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoAddress
</span><a href="#local-6989586621680393363"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="annot"><span class="annottext">IO Value -&gt; Simulation t Value
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Value -&gt; Simulation t Value) -&gt; IO Value -&gt; Simulation t Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM Value -&gt; IO Value
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">STM Value
</span><a href="#local-6989586621680393362"><span class="hs-identifier hs-var">stm</span></a></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">-- | The fees paid by the wallet.</span><span>
</span><span id="line-718"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#walletFees"><span class="hs-identifier hs-type">walletFees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393361"><span class="annot"><a href="#local-6989586621680393361"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393361"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-719"></span><span id="walletFees"><span class="annot"><span class="annottext">walletFees :: Wallet -&gt; Simulation t Value
</span><a href="Plutus.PAB.Simulator.html#walletFees"><span class="hs-identifier hs-var hs-var">walletFees</span></a></span></span><span> </span><span id="local-6989586621680393360"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393360"><span class="hs-identifier hs-var">wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxId Value -&gt; Blockchain -&gt; Value
</span><a href="#local-6989586621680393359"><span class="hs-identifier hs-var">succeededFees</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxId Value -&gt; Blockchain -&gt; Value)
-&gt; Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
-&gt; Eff (PABEffects t (SimulatorState t)) (Blockchain -&gt; Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
</span><a href="#local-6989586621680393358"><span class="hs-identifier hs-var">walletSubmittedFees</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) (Blockchain -&gt; Value)
-&gt; Eff (PABEffects t (SimulatorState t)) Blockchain
-&gt; Simulation t Value
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) Blockchain
forall t. Simulation t Blockchain
</span><a href="Plutus.PAB.Simulator.html#blockchain"><span class="hs-identifier hs-var">blockchain</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><a href="#local-6989586621680393359"><span class="hs-identifier hs-type">succeededFees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Blockchain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-722"></span><span>        </span><span id="local-6989586621680393359"><span class="annot"><span class="annottext">succeededFees :: Map TxId Value -&gt; Blockchain -&gt; Value
</span><a href="#local-6989586621680393359"><span class="hs-identifier hs-var hs-var">succeededFees</span></a></span></span><span> </span><span id="local-6989586621680393357"><span class="annot"><span class="annottext">Map TxId Value
</span><a href="#local-6989586621680393357"><span class="hs-identifier hs-var">submitted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Block -&gt; Value) -&gt; Blockchain -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">((Block -&gt; Value) -&gt; Blockchain -&gt; Value)
-&gt; ((OnChainTx -&gt; Value) -&gt; Block -&gt; Value)
-&gt; (OnChainTx -&gt; Value)
-&gt; Blockchain
-&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(OnChainTx -&gt; Value) -&gt; Block -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">((OnChainTx -&gt; Value) -&gt; Blockchain -&gt; Value)
-&gt; (OnChainTx -&gt; Value) -&gt; Blockchain -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Value
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Value)
-&gt; (OnChainTx -&gt; Maybe Value) -&gt; OnChainTx -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxId Value
</span><a href="#local-6989586621680393357"><span class="hs-identifier hs-var">submitted</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxId Value -&gt; TxId -&gt; Maybe Value
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-operator hs-var">Map.!?</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxId -&gt; Maybe Value)
-&gt; (OnChainTx -&gt; TxId) -&gt; OnChainTx -&gt; Maybe Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">getCardanoTxId</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; TxId)
-&gt; (OnChainTx -&gt; CardanoTx) -&gt; OnChainTx -&gt; TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OnChainTx -&gt; CardanoTx
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">unOnChain</span></a></span><span>
</span><span id="line-723"></span><span>        </span><span id="local-6989586621680393358"><span class="annot"><span class="annottext">walletSubmittedFees :: Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
</span><a href="#local-6989586621680393358"><span class="hs-identifier hs-var hs-var">walletSubmittedFees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-724"></span><span>            </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393355"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393355"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393361"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393361"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>            </span><span id="local-6989586621680393354"><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="#local-6989586621680393354"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (AgentState t))
-&gt; Eff (PABEffects t (SimulatorState t)) (Maybe (AgentState t))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe (AgentState t))
 -&gt; Eff (PABEffects t (SimulatorState t)) (Maybe (AgentState t)))
-&gt; IO (Maybe (AgentState t))
-&gt; Eff (PABEffects t (SimulatorState t)) (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t))
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t)))
-&gt; STM (Maybe (AgentState t)) -&gt; IO (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-726"></span><span>                </span><span id="local-6989586621680393353"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393353"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393355"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-727"></span><span>                </span><span class="annot"><span class="annottext">Maybe (AgentState t) -&gt; STM (Maybe (AgentState t))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AgentState t) -&gt; STM (Maybe (AgentState t)))
-&gt; Maybe (AgentState t) -&gt; STM (Maybe (AgentState t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Map Wallet (AgentState t) -&gt; Maybe (AgentState t)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393360"><span class="hs-identifier hs-var">wallet</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393353"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-728"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="#local-6989586621680393354"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-729"></span><span>                </span><span class="annot"><span class="annottext">Maybe (AgentState t)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PABError -&gt; Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError
 -&gt; Eff (PABEffects t (SimulatorState t)) (Map TxId Value))
-&gt; PABError
-&gt; Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletNotFound"><span class="hs-identifier hs-var">WalletNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393360"><span class="hs-identifier hs-var">wallet</span></a></span><span>
</span><span id="line-730"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680393352"><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393352"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map TxId Value
-&gt; Eff (PABEffects t (SimulatorState t)) (Map TxId Value)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgentState t -&gt; Map TxId Value
forall t. AgentState t -&gt; Map TxId Value
</span><a href="Plutus.PAB.Simulator.html#_submittedFees"><span class="hs-identifier hs-var hs-var">_submittedFees</span></a></span><span> </span><span class="annot"><span class="annottext">AgentState t
</span><a href="#local-6989586621680393352"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="hs-comment">-- | The entire chain (newest transactions first)</span><span>
</span><span id="line-733"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#blockchain"><span class="hs-identifier hs-type">blockchain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393879"><span class="annot"><a href="#local-6989586621680393879"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393879"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Blockchain</span></a></span><span>
</span><span id="line-734"></span><span id="blockchain"><span class="annot"><span class="annottext">blockchain :: Simulation t Blockchain
</span><a href="Plutus.PAB.Simulator.html#blockchain"><span class="hs-identifier hs-var hs-var">blockchain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393351"><span class="annot"><span class="annottext">TVar ChainState
_chainState :: TVar ChainState
_chainState :: forall t. SimulatorState t -&gt; TVar ChainState
</span><a href="#local-6989586621680393351"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393879"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393879"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Chain.ChainState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393350"><span class="annot"><span class="annottext">Blockchain
_chainNewestFirst :: Blockchain
_chainNewestFirst :: ChainState -&gt; Blockchain
</span><a href="#local-6989586621680393350"><span class="hs-identifier hs-var hs-var">Chain._chainNewestFirst</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ChainState -&gt; Eff (PABEffects t (SimulatorState t)) ChainState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ChainState -&gt; Eff (PABEffects t (SimulatorState t)) ChainState)
-&gt; IO ChainState
-&gt; Eff (PABEffects t (SimulatorState t)) ChainState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState -&gt; IO ChainState
forall a. TVar a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393351"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-737"></span><span>    </span><span class="annot"><span class="annottext">Blockchain -&gt; Simulation t Blockchain
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Blockchain
</span><a href="#local-6989586621680393350"><span class="hs-identifier hs-var">_chainNewestFirst</span></a></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#handleAgentThread"><span class="hs-identifier hs-type">handleAgentThread</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393850"><span class="annot"><a href="#local-6989586621680393850"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393849"><span class="annot"><a href="#local-6989586621680393849"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-741"></span><span>    </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-742"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span>
</span><span id="line-743"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Core.html#ContractInstanceEffects"><span class="hs-identifier hs-type">Core.ContractInstanceEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393850"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393850"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393849"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-744"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393850"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393849"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-745"></span><span id="handleAgentThread"><span class="annot"><span class="annottext">handleAgentThread :: Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) a
-&gt; Simulation t a
</span><a href="Plutus.PAB.Simulator.html#handleAgentThread"><span class="hs-identifier hs-var hs-var">handleAgentThread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) a
-&gt; Simulation t a
forall t env a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t env '[IO]) a
-&gt; PABAction t env a
</span><a href="Plutus.PAB.Core.html#handleAgentThread"><span class="hs-identifier hs-var">Core.handleAgentThread</span></a></span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="hs-comment">-- | Stop the instance.</span><span>
</span><span id="line-748"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#stopInstance"><span class="hs-identifier hs-type">stopInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393348"><span class="annot"><a href="#local-6989586621680393348"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393348"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span id="stopInstance"><span class="annot"><span class="annottext">stopInstance :: ContractInstanceId -&gt; Simulation t ()
</span><a href="Plutus.PAB.Simulator.html#stopInstance"><span class="hs-identifier hs-var hs-var">stopInstance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t ()
forall t env. ContractInstanceId -&gt; PABAction t env ()
</span><a href="Plutus.PAB.Core.html#stopInstance"><span class="hs-identifier hs-var">Core.stopInstance</span></a></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span class="hs-comment">-- | The 'Activity' state of the instance</span><span>
</span><span id="line-752"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#instanceActivity"><span class="hs-identifier hs-type">instanceActivity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393346"><span class="annot"><a href="#local-6989586621680393346"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">ContractInstanceId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393346"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#Activity"><span class="hs-identifier hs-type">Activity</span></a></span><span>
</span><span id="line-753"></span><span id="instanceActivity"><span class="annot"><span class="annottext">instanceActivity :: ContractInstanceId -&gt; Simulation t Activity
</span><a href="Plutus.PAB.Simulator.html#instanceActivity"><span class="hs-identifier hs-var hs-var">instanceActivity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContractInstanceId -&gt; Simulation t Activity
forall t env. ContractInstanceId -&gt; PABAction t env Activity
</span><a href="Plutus.PAB.Core.html#instanceActivity"><span class="hs-identifier hs-var">Core.instanceActivity</span></a></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="hs-comment">-- | Create a new wallet with a random key, give it some funds</span><span>
</span><span id="line-756"></span><span class="hs-comment">--   and add it to the list of simulated wallets.</span><span>
</span><span id="line-757"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#addWallet"><span class="hs-identifier hs-type">addWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393344"><span class="annot"><a href="#local-6989586621680393344"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393344"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span id="addWallet"><span class="annot"><span class="annottext">addWallet :: Simulation t (Wallet, PaymentPubKeyHash)
</span><a href="Plutus.PAB.Simulator.html#addWallet"><span class="hs-identifier hs-var hs-var">addWallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ada -&gt; Simulation t (Wallet, PaymentPubKeyHash)
forall t. Maybe Ada -&gt; Simulation t (Wallet, PaymentPubKeyHash)
</span><a href="Plutus.PAB.Simulator.html#addWalletWith"><span class="hs-identifier hs-var">addWalletWith</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ada
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">-- | Create a new wallet with a random key, give it provided funds</span><span>
</span><span id="line-761"></span><span class="hs-comment">--   and add it to the list of simulated wallets.</span><span>
</span><span id="line-762"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#addWalletWith"><span class="hs-identifier hs-type">addWalletWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393857"><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Ada.Ada</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span id="addWalletWith"><span class="annot"><span class="annottext">addWalletWith :: Maybe Ada -&gt; Simulation t (Wallet, PaymentPubKeyHash)
</span><a href="Plutus.PAB.Simulator.html#addWalletWith"><span class="hs-identifier hs-var hs-var">addWalletWith</span></a></span></span><span> </span><span id="local-6989586621680393343"><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680393343"><span class="hs-identifier hs-var">funds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393342"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393342"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>    </span><span id="local-6989586621680393341"><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) MockWallet
forall (m :: * -&gt; *) (effs :: [* -&gt; *]).
(LastMember m effs, MonadIO m) =&gt;
Eff effs MockWallet
</span><a href="Cardano.Wallet.Mock.Handlers.html#newWallet"><span class="hs-identifier hs-var">MockWallet.newWallet</span></a></span><span>
</span><span id="line-766"></span><span>    </span><span class="annot"><span class="annottext">Eff (PABEffects t (SimulatorState t)) ()
-&gt; Eff (PABEffects t (SimulatorState t)) ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (PABEffects t (SimulatorState t)) ()
 -&gt; Eff (PABEffects t (SimulatorState t)) ())
-&gt; Eff (PABEffects t (SimulatorState t)) ()
-&gt; Eff (PABEffects t (SimulatorState t)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Eff (PABEffects t (SimulatorState t)) ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Eff (PABEffects t (SimulatorState t)) ())
-&gt; IO () -&gt; Eff (PABEffects t (SimulatorState t)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM () -&gt; IO ()
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; IO ()) -&gt; STM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>        </span><span id="local-6989586621680393339"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393339"><span class="hs-identifier hs-var">currentWallets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393342"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680393338"><span class="annot"><span class="annottext">newWallets :: Map Wallet (AgentState t)
</span><a href="#local-6989586621680393338"><span class="hs-identifier hs-var hs-var">newWallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393339"><span class="hs-identifier hs-var">currentWallets</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
-&gt; (Map Wallet (AgentState t) -&gt; Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Index (Map Wallet (AgentState t))
-&gt; Lens'
     (Map Wallet (AgentState t))
     (Maybe (IxValue (Map Wallet (AgentState t))))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.toMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe (AgentState t) -&gt; Identity (Maybe (AgentState t)))
 -&gt; Map Wallet (AgentState t)
 -&gt; Identity (Map Wallet (AgentState t)))
-&gt; AgentState t
-&gt; Map Wallet (AgentState t)
-&gt; Map Wallet (AgentState t)
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">WalletState -&gt; Map TxId Value -&gt; AgentState t
forall t. WalletState -&gt; Map TxId Value -&gt; AgentState t
</span><a href="Plutus.PAB.Simulator.html#AgentState"><span class="hs-identifier hs-var">AgentState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; WalletState
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.fromMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxId Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-769"></span><span>        </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
-&gt; Map Wallet (AgentState t) -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393342"><span class="hs-identifier hs-var">_agentStates</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393338"><span class="hs-identifier hs-var">newWallets</span></a></span><span>
</span><span id="line-770"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">Instances.BlockchainEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393336"><span class="annot"><span class="annottext">Params
beParams :: Params
beParams :: BlockchainEnv -&gt; Params
</span><a href="#local-6989586621680393336"><span class="hs-identifier hs-var hs-var">beParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs BlockchainEnv
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs BlockchainEnv
</span><a href="Plutus.PAB.Core.html#askBlockchainEnv"><span class="hs-identifier hs-var">Core.askBlockchainEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393857"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>    </span><span class="annot"><span class="annottext">CardanoTx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
-&gt; Simulation t CardanoTx
forall t a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) a
-&gt; Simulation t a
</span><a href="Plutus.PAB.Simulator.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">knownWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-772"></span><span>            </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
 -&gt; Simulation t CardanoTx)
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
-&gt; Simulation t CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(WalletAPIError -&gt; PABError)
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
   ~&gt; Eff (ContractInstanceEffects t (SimulatorState t) '[IO])
forall e f (effs :: [* -&gt; *]).
Member (Error f) effs =&gt;
(e -&gt; f) -&gt; Eff (Error e : effs) ~&gt; Eff effs
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">Modify.wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier hs-var">WalletError</span></a></span><span>
</span><span id="line-773"></span><span>            </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : ContractInstanceEffects t (SimulatorState t) '[IO])
   CardanoTx
 -&gt; Eff
      (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
     CardanoTx
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Maybe Ada
-&gt; PaymentPubKeyHash
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
     CardanoTx
forall (effs :: [* -&gt; *]).
(Member WalletEffect effs, Member (Error WalletAPIError) effs,
 Member (LogMsg Text) effs,
 Member (LogMsg RequestHandlerLogMsg) effs) =&gt;
Params -&gt; Maybe Ada -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
</span><a href="Cardano.Wallet.Mock.Handlers.html#distributeNewWalletFunds"><span class="hs-identifier hs-var">MockWallet.distributeNewWalletFunds</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393336"><span class="hs-identifier hs-var">beParams</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ada
</span><a href="#local-6989586621680393343"><span class="hs-identifier hs-var">funds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; PaymentPubKeyHash
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.paymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>    </span><span class="annot"><span class="annottext">(Wallet, PaymentPubKeyHash)
-&gt; Simulation t (Wallet, PaymentPubKeyHash)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockWallet -&gt; Wallet
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.toMockWallet</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MockWallet -&gt; PaymentPubKeyHash
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">CW.paymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">MockWallet
</span><a href="#local-6989586621680393341"><span class="hs-identifier hs-var">mockWallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span class="hs-comment">-- | Retrieve the balances of all the entities in the simulator.</span><span>
</span><span id="line-777"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#currentBalances"><span class="hs-identifier hs-type">currentBalances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393331"><span class="annot"><a href="#local-6989586621680393331"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393331"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.Entity</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span id="currentBalances"><span class="annot"><span class="annottext">currentBalances :: Simulation t (Map Entity Value)
</span><a href="Plutus.PAB.Simulator.html#currentBalances"><span class="hs-identifier hs-var hs-var">currentBalances</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-779"></span><span>  </span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393330"><span class="annot"><span class="annottext">TVar ChainState
_chainState :: TVar ChainState
_chainState :: forall t. SimulatorState t -&gt; TVar ChainState
</span><a href="#local-6989586621680393330"><span class="hs-identifier hs-var hs-var">_chainState</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393329"><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
_agentStates :: TVar (Map Wallet (AgentState t))
_agentStates :: forall t. SimulatorState t -&gt; TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393329"><span class="hs-identifier hs-var hs-var">_agentStates</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs (SimulatorState t)
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs env
</span><a href="Plutus.PAB.Core.html#askUserEnv"><span class="hs-identifier hs-var">Core.askUserEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393331"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393331"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>  </span><span class="annot"><span class="annottext">IO (Map Entity Value) -&gt; Simulation t (Map Entity Value)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Map Entity Value) -&gt; Simulation t (Map Entity Value))
-&gt; IO (Map Entity Value) -&gt; Simulation t (Map Entity Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">STM (Map Entity Value) -&gt; IO (Map Entity Value)
forall a. STM a -&gt; IO a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM (Map Entity Value) -&gt; IO (Map Entity Value))
-&gt; STM (Map Entity Value) -&gt; IO (Map Entity Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-781"></span><span>    </span><span id="local-6989586621680393328"><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393328"><span class="hs-identifier hs-var">currentWallets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t)) -&gt; STM (Map Wallet (AgentState t))
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar (Map Wallet (AgentState t))
</span><a href="#local-6989586621680393329"><span class="hs-identifier hs-var">_agentStates</span></a></span><span>
</span><span id="line-782"></span><span>    </span><span id="local-6989586621680393327"><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393327"><span class="hs-identifier hs-var">chainState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar ChainState -&gt; STM ChainState
forall a. TVar a -&gt; STM a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">STM.readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar ChainState
</span><a href="#local-6989586621680393330"><span class="hs-identifier hs-var">_chainState</span></a></span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><span class="annottext">Map Entity Value -&gt; STM (Map Entity Value)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Entity Value -&gt; STM (Map Entity Value))
-&gt; Map Entity Value -&gt; STM (Map Entity Value)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState -&gt; WalletSet -&gt; Map Entity Value
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Wallet.balances</span></a></span><span> </span><span class="annot"><span class="annottext">ChainState
</span><a href="#local-6989586621680393327"><span class="hs-identifier hs-var">chainState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgentState t -&gt; WalletState
forall t. AgentState t -&gt; WalletState
</span><a href="Plutus.PAB.Simulator.html#_walletState"><span class="hs-identifier hs-var hs-var">_walletState</span></a></span><span> </span><span class="annot"><span class="annottext">(AgentState t -&gt; WalletState)
-&gt; Map Wallet (AgentState t) -&gt; WalletSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet (AgentState t)
</span><a href="#local-6989586621680393328"><span class="hs-identifier hs-var">currentWallets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">-- | Write the 'balances' out to the log.</span><span>
</span><span id="line-786"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#logBalances"><span class="hs-identifier hs-type">logBalances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393325"><span class="annot"><a href="#local-6989586621680393325"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393324"><span class="annot"><a href="#local-6989586621680393324"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393325"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393324"><span class="hs-identifier hs-type">effs</span></a></span><span>
</span><span id="line-787"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet.Entity</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-788"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393324"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span id="logBalances"><span class="annot"><span class="annottext">logBalances :: Map Entity Value -&gt; Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#logBalances"><span class="hs-identifier hs-var hs-var">logBalances</span></a></span></span><span> </span><span id="local-6989586621680393323"><span class="annot"><span class="annottext">Map Entity Value
</span><a href="#local-6989586621680393323"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-790"></span><span>    </span><span class="annot"><span class="annottext">[(Entity, Value)]
-&gt; ((Entity, Value) -&gt; Eff effs ()) -&gt; Eff effs ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Entity Value -&gt; [(Entity, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map Entity Value
</span><a href="#local-6989586621680393323"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Entity, Value) -&gt; Eff effs ()) -&gt; Eff effs ())
-&gt; ((Entity, Value) -&gt; Eff effs ()) -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680393322"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621680393322"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393321"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680393321"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-791"></span><span>        </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (LogMsg (PABMultiAgentMsg t)) effs =&gt;
[Char] -&gt; Eff effs ()
forall t (effs :: [* -&gt; *]).
Member (LogMsg (PABMultiAgentMsg t)) effs =&gt;
[Char] -&gt; Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#logString"><span class="hs-identifier hs-var">logString</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393325"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Eff effs ()) -&gt; [Char] -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Entity -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621680393322"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">[(CurrencySymbol, TokenName, Integer)]
-&gt; ((CurrencySymbol, TokenName, Integer) -&gt; Eff effs ())
-&gt; Eff effs ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">flattenValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680393321"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((CurrencySymbol, TokenName, Integer) -&gt; Eff effs ())
 -&gt; Eff effs ())
-&gt; ((CurrencySymbol, TokenName, Integer) -&gt; Eff effs ())
-&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680393320"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621680393320"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393319"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621680393319"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680393318"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680393318"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-793"></span><span>            </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (LogMsg (PABMultiAgentMsg t)) effs =&gt;
[Char] -&gt; Eff effs ()
forall t (effs :: [* -&gt; *]).
Member (LogMsg (PABMultiAgentMsg t)) effs =&gt;
[Char] -&gt; Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#logString"><span class="hs-identifier hs-var">logString</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393325"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Eff effs ()) -&gt; [Char] -&gt; Eff effs ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    {&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621680393320"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621680393319"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680393318"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- | Log some output to the console</span><span>
</span><span id="line-796"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#logString"><span class="hs-identifier hs-type">logString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393833"><span class="annot"><a href="#local-6989586621680393833"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621680393834"><span class="annot"><a href="#local-6989586621680393834"><span class="hs-identifier hs-type">effs</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-type">LogMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393833"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680393834"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393834"><span class="hs-identifier hs-type">effs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span id="logString"><span class="annot"><span class="annottext">logString :: [Char] -&gt; Eff effs ()
</span><a href="Plutus.PAB.Simulator.html#logString"><span class="hs-identifier hs-var hs-var">logString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (LogMsg (PABMultiAgentMsg t)) effs =&gt;
PABMultiAgentMsg t -&gt; Eff effs ()
forall a (effs :: [* -&gt; *]).
Member (LogMsg a) effs =&gt;
a -&gt; Eff effs ()
</span><a href="../../../../freer-extras/html/src"><span class="hs-identifier hs-var">logInfo</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Monitoring.PABLogMsg.html#PABMultiAgentMsg"><span class="hs-identifier hs-type">PABMultiAgentMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393833"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PABMultiAgentMsg t -&gt; Eff effs ())
-&gt; ([Char] -&gt; PABMultiAgentMsg t) -&gt; [Char] -&gt; Eff effs ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PABMultiAgentMsg t
forall t. Text -&gt; PABMultiAgentMsg t
</span><a href="Plutus.PAB.Monitoring.PABLogMsg.html#UserLog"><span class="hs-identifier hs-var">UserLog</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PABMultiAgentMsg t)
-&gt; ([Char] -&gt; Text) -&gt; [Char] -&gt; PABMultiAgentMsg t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><a href="../file:///nix/store/71gg7bx8f4jr17lsf2w77qrjmdg3xvan-text-lib-text-1.2.4.1-haddock-doc/share/doc/text/html/src"><span class="hs-identifier hs-var">Text.pack</span></a></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">-- | Make a payment from one wallet to another</span><span>
</span><span id="line-800"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#payToWallet"><span class="hs-identifier hs-type">payToWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393316"><span class="annot"><a href="#local-6989586621680393316"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393316"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoTx</span></a></span><span>
</span><span id="line-801"></span><span id="payToWallet"><span class="annot"><span class="annottext">payToWallet :: Wallet -&gt; Wallet -&gt; Value -&gt; Simulation t CardanoTx
</span><a href="Plutus.PAB.Simulator.html#payToWallet"><span class="hs-identifier hs-var hs-var">payToWallet</span></a></span></span><span> </span><span id="local-6989586621680393315"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393315"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span id="local-6989586621680393314"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393314"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PaymentPubKeyHash -&gt; Value -&gt; Simulation t CardanoTx
forall t.
Wallet -&gt; PaymentPubKeyHash -&gt; Value -&gt; Simulation t CardanoTx
</span><a href="Plutus.PAB.Simulator.html#payToPaymentPublicKeyHash"><span class="hs-identifier hs-var">payToPaymentPublicKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393315"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; PaymentPubKeyHash
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">Emulator.mockWalletPaymentPubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393314"><span class="hs-identifier hs-var">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="hs-comment">-- | Make a payment from one wallet to a public key address</span><span>
</span><span id="line-804"></span><span class="annot"><a href="Plutus.PAB.Simulator.html#payToPaymentPublicKeyHash"><span class="hs-identifier hs-type">payToPaymentPublicKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680393824"><span class="annot"><a href="#local-6989586621680393824"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">PaymentPubKeyHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutus.PAB.Simulator.html#Simulation"><span class="hs-identifier hs-type">Simulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393824"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">CardanoTx</span></a></span><span>
</span><span id="line-805"></span><span id="payToPaymentPublicKeyHash"><span class="annot"><span class="annottext">payToPaymentPublicKeyHash :: Wallet -&gt; PaymentPubKeyHash -&gt; Value -&gt; Simulation t CardanoTx
</span><a href="Plutus.PAB.Simulator.html#payToPaymentPublicKeyHash"><span class="hs-identifier hs-var hs-var">payToPaymentPublicKeyHash</span></a></span></span><span> </span><span id="local-6989586621680393312"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393312"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span id="local-6989586621680393311"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680393311"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621680393310"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680393310"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>    </span><span class="annot"><a href="Plutus.PAB.Core.ContractInstance.STM.html#BlockchainEnv"><span class="hs-identifier hs-type">Instances.BlockchainEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680393309"><span class="annot"><span class="annottext">Params
beParams :: Params
beParams :: BlockchainEnv -&gt; Params
</span><a href="#local-6989586621680393309"><span class="hs-identifier hs-var hs-var">beParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t (SimulatorState t))) effs =&gt;
Eff effs BlockchainEnv
forall t env (effs :: [* -&gt; *]).
Member (Reader (PABEnvironment t env)) effs =&gt;
Eff effs BlockchainEnv
</span><a href="Plutus.PAB.Core.html#askBlockchainEnv"><span class="hs-identifier hs-var">Core.askBlockchainEnv</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621680393824"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutus.PAB.Simulator.html#SimulatorState"><span class="hs-identifier hs-type">SimulatorState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680393824"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>    </span><span class="annot"><span class="annottext">Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
-&gt; Simulation t CardanoTx
forall t a.
Wallet
-&gt; Maybe ContractInstanceId
-&gt; Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) a
-&gt; Simulation t a
</span><a href="Plutus.PAB.Simulator.html#handleAgentThread"><span class="hs-identifier hs-var">handleAgentThread</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621680393312"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ContractInstanceId
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-808"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
 -&gt; Simulation t CardanoTx)
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
-&gt; Simulation t CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : ContractInstanceEffects t (SimulatorState t) '[IO])
   CardanoTx
 -&gt; (WalletAPIError
     -&gt; Eff
          (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
 -&gt; Eff
      (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
-&gt; (WalletAPIError
    -&gt; Eff
         (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
     CardanoTx
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (effs :: [* -&gt; *]) a.
Eff (Error WalletAPIError : effs) a
-&gt; (WalletAPIError -&gt; Eff effs a) -&gt; Eff effs a
forall e (effs :: [* -&gt; *]) a.
Eff (Error e : effs) a -&gt; (e -&gt; Eff effs a) -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">handleError</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-type">WAPI.WalletAPIError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PABError
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
forall e (effs :: [* -&gt; *]) a.
Member (Error e) effs =&gt;
e -&gt; Eff effs a
</span><a href="../file:///nix/store/bvsf6n0jyy81dv6f71yfdy6shyr2f8sf-freer-simple-lib-freer-simple-1.2.1.2-haddock-doc/share/doc/freer-simple/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(PABError
 -&gt; Eff
      (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
-&gt; (WalletAPIError -&gt; PABError)
-&gt; WalletAPIError
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">WalletAPIError -&gt; PABError
</span><a href="Plutus.PAB.Types.html#WalletError"><span class="hs-identifier hs-var">WalletError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>        </span><span class="annot"><span class="annottext">(Eff
   (Error WalletAPIError
      : ContractInstanceEffects t (SimulatorState t) '[IO])
   CardanoTx
 -&gt; Eff
      (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx)
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
     CardanoTx
-&gt; Eff
     (ContractInstanceEffects t (SimulatorState t) '[IO]) CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params
-&gt; SlotRange
-&gt; Value
-&gt; PaymentPubKeyHash
-&gt; Eff
     (Error WalletAPIError
        : ContractInstanceEffects t (SimulatorState t) '[IO])
     CardanoTx
forall (effs :: [* -&gt; *]).
(Member WalletEffect effs, Member (Error WalletAPIError) effs,
 Member (LogMsg Text) effs,
 Member (LogMsg RequestHandlerLogMsg) effs) =&gt;
Params
-&gt; SlotRange -&gt; Value -&gt; PaymentPubKeyHash -&gt; Eff effs CardanoTx
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.payToPaymentPublicKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621680393309"><span class="hs-identifier hs-var">beParams</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="../../../../plutus-contract/html/src"><span class="hs-identifier hs-var">WAPI.defaultSlotRange</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621680393310"><span class="hs-identifier hs-var">amount</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621680393311"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-810"></span></pre></body></html>
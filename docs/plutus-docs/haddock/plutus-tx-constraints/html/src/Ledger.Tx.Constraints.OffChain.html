<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds                 #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass            #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric             #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia               #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase                 #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts          #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs                     #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase                #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns            #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings         #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds                 #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell           #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TupleSections             #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications          #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies              #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators             #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances      #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns              #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-missing-import-lists #-}</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ledger.Tx.Constraints.OffChain</span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Lookups</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.ScriptLookups</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.typedValidatorLookups</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.generalise</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.unspentOutputs</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.mintingPolicy</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.plutusV1MintingPolicy</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.plutusV2MintingPolicy</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.otherScript</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.plutusV1OtherScript</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.plutusV2OtherScript</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.otherData</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.ownPaymentPubKeyHash</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.ownStakingCredential</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.paymentPubKey</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.paymentPubKeyHash</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constraints resolution</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.SomeLookupsAndConstraints</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">UnbalancedTx</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">unBalancedTxTx</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier">tx</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txValidityRange"><span class="hs-identifier">txValidityRange</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txOuts"><span class="hs-identifier">txOuts</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.utxoIndex</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#emptyUnbalancedTx"><span class="hs-identifier">emptyUnbalancedTx</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">P.adjustUnbalancedTx</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier">MkTxError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#mkTx"><span class="hs-identifier">mkTx</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#mkSomeTx"><span class="hs-identifier">mkSomeTx</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Params</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">networkIdL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">pProtocolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">Cardano.Node.Emulator.TimeSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier">posixTimeRangeToContainedSlotRange</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Lens'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Traversal'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">_2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">coerced</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">iso</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">makeLensesFor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">use</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">uses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(.=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(&lt;&gt;=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(^.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator">(^?)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">Control.Lens.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">Except</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">lift</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">mapExcept</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">runExcept</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">throwError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">withExcept</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">runReaderT</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">ask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">mapReaderT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">Control.Monad.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">MonadState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">StateT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">execStateT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier">gets</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier">mapStateT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">partitionEithers</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/azj0kfbgizyr4qj49lql36z31i3346pb-cardano-ledger-alonzo-lib-cardano-ledger-alonzo-0.1.0.0-haddock-doc/share/doc/cardano-ledger-alonzo/html/src"><span class="hs-identifier">Language</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/azj0kfbgizyr4qj49lql36z31i3346pb-cardano-ledger-alonzo-lib-cardano-ledger-alonzo-0.1.0.0-haddock-doc/share/doc/cardano-ledger-alonzo/html/src"><span class="hs-identifier">PlutusV2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">MintingPolicy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">MintingPolicyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">POSIXTimeRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Versioned</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>               </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">decoratedTxOutReferenceScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints.OffChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">UnbalancedTx</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">cpsUnbalancedTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">unBalancedTxTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">unbalancedTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints.OffChain</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints.TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">ScriptOutputConstraint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxConstraint</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>                                         </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">txConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">txOwnInputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">txOwnOutputs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>                                         </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxOutDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxOutDatumHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxOutDatumInTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">TxOutDatumInline</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">Ledger.Constraints.ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier">toPlutusInterval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">Plutus.Script.Utils.V2.Typed.Scripts</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Typed</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Value</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V2.Ledger.Tx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PV2</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Interval</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">ScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">getRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">getValidator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Tx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tx</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoBuildTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">CardanoBuildTx</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">toCardanoMintWitness</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">toCardanoPolicyId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier">Ledger.Typed.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">ConnectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">UnknownRef</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">ValidatorTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">DatumType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier">RedeemerType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">FromData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">toBuiltinData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx.Lattice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">BoundedMeetSemiLattice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">top</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">MeetSemiLattice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-operator">(/\)</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier">colon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="txValidityRange%27"><span id="txOuts%27"><span id="txMintValue%27"><span id="txInsReference%27"><span id="txInsCollateral%27"><span id="txIns%27"><span id="txExtraKeyWits%27"><span id="local-6989586621679387011"><span id="local-6989586621679387012"><span class="hs-identifier">makeLensesFor</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txIns&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txIns'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txInsCollateral&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txInsCollateral'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txInsReference&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txInsReference'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txExtraKeyWits&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txExtraKeyWits'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txOuts&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txOuts'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txValidityRange&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txValidityRange'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txMintValue&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txMintValue'&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">C.TxBodyContent</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txIns"><span class="hs-identifier hs-type">txIns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTxWith</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Witness</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.WitCtxTxIn</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span id="txIns"><span class="annot"><span class="annottext">txIns :: ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
 -&gt; f [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txIns"><span class="hs-identifier hs-var hs-var">txIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; f [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; f [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
 -&gt; f [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era. Lens' (TxBodyContent build era) (TxIns build era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txIns%27"><span class="hs-identifier hs-var">txIns'</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txInsCollateral"><span class="hs-identifier hs-type">txInsCollateral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxIn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span id="txInsCollateral"><span class="annot"><span class="annottext">txInsCollateral :: ([TxIn] -&gt; f [TxIn]) -&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsCollateral"><span class="hs-identifier hs-var hs-var">txInsCollateral</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (([TxIn] -&gt; f [TxIn])
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ([TxIn] -&gt; f [TxIn])
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInsCollateral BabbageEra -&gt; f (TxInsCollateral BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era.
Lens' (TxBodyContent build era) (TxInsCollateral era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsCollateral%27"><span class="hs-identifier hs-var">txInsCollateral'</span></a></span><span> </span><span class="annot"><span class="annottext">((TxInsCollateral BabbageEra -&gt; f (TxInsCollateral BabbageEra))
 -&gt; TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; (([TxIn] -&gt; f [TxIn])
    -&gt; TxInsCollateral BabbageEra -&gt; f (TxInsCollateral BabbageEra))
-&gt; ([TxIn] -&gt; f [TxIn])
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInsCollateral BabbageEra -&gt; [TxIn])
-&gt; ([TxIn] -&gt; TxInsCollateral BabbageEra)
-&gt; Iso
     (TxInsCollateral BabbageEra)
     (TxInsCollateral BabbageEra)
     [TxIn]
     [TxIn]
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra -&gt; [TxIn]
forall era. TxInsCollateral era -&gt; [TxIn]
</span><a href="#local-6989586621679386547"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn] -&gt; TxInsCollateral BabbageEra
</span><a href="#local-6989586621679386546"><span class="hs-identifier hs-var">fromList</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>        </span><span id="local-6989586621679386547"><span class="annot"><span class="annottext">toList :: TxInsCollateral era -&gt; [TxIn]
</span><a href="#local-6989586621679386547"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxInsCollateral era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsCollateralNone</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><a href="#local-6989586621679386547"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxInsCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386543"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386543"><span class="hs-identifier hs-var">txins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386543"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span id="local-6989586621679386546"><span class="annot"><span class="annottext">fromList :: [TxIn] -&gt; TxInsCollateral BabbageEra
</span><a href="#local-6989586621679386546"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
forall era. TxInsCollateral era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsCollateralNone</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="#local-6989586621679386546"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span id="local-6989586621679386542"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386542"><span class="hs-identifier hs-var">txins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
-&gt; [TxIn] -&gt; TxInsCollateral BabbageEra
forall era.
CollateralSupportedInEra era -&gt; [TxIn] -&gt; TxInsCollateral era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.CollateralInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386542"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txExtraKeyWits"><span class="hs-identifier hs-type">txExtraKeyWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Hash</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.PaymentKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span id="txExtraKeyWits"><span class="annot"><span class="annottext">txExtraKeyWits :: (Set (Hash PaymentKey) -&gt; f (Set (Hash PaymentKey)))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txExtraKeyWits"><span class="hs-identifier hs-var hs-var">txExtraKeyWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; ((Set (Hash PaymentKey) -&gt; f (Set (Hash PaymentKey)))
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; (Set (Hash PaymentKey) -&gt; f (Set (Hash PaymentKey)))
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxExtraKeyWitnesses BabbageEra
 -&gt; f (TxExtraKeyWitnesses BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era.
Lens' (TxBodyContent build era) (TxExtraKeyWitnesses era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txExtraKeyWits%27"><span class="hs-identifier hs-var">txExtraKeyWits'</span></a></span><span> </span><span class="annot"><span class="annottext">((TxExtraKeyWitnesses BabbageEra
  -&gt; f (TxExtraKeyWitnesses BabbageEra))
 -&gt; TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ((Set (Hash PaymentKey) -&gt; f (Set (Hash PaymentKey)))
    -&gt; TxExtraKeyWitnesses BabbageEra
    -&gt; f (TxExtraKeyWitnesses BabbageEra))
-&gt; (Set (Hash PaymentKey) -&gt; f (Set (Hash PaymentKey)))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxExtraKeyWitnesses BabbageEra -&gt; Set (Hash PaymentKey))
-&gt; (Set (Hash PaymentKey) -&gt; TxExtraKeyWitnesses BabbageEra)
-&gt; Iso
     (TxExtraKeyWitnesses BabbageEra)
     (TxExtraKeyWitnesses BabbageEra)
     (Set (Hash PaymentKey))
     (Set (Hash PaymentKey))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses BabbageEra -&gt; Set (Hash PaymentKey)
forall era. TxExtraKeyWitnesses era -&gt; Set (Hash PaymentKey)
</span><a href="#local-6989586621679386539"><span class="hs-identifier hs-var">toSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey) -&gt; TxExtraKeyWitnesses BabbageEra
</span><a href="#local-6989586621679386538"><span class="hs-identifier hs-var">fromSet</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>        </span><span id="local-6989586621679386539"><span class="annot"><span class="annottext">toSet :: TxExtraKeyWitnesses era -&gt; Set (Hash PaymentKey)
</span><a href="#local-6989586621679386539"><span class="hs-identifier hs-var hs-var">toSet</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxExtraKeyWitnessesNone</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey)
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href="#local-6989586621679386539"><span class="hs-identifier hs-var">toSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxExtraKeyWitnesses</span></a></span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnessesSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386535"><span class="annot"><span class="annottext">[Hash PaymentKey]
</span><a href="#local-6989586621679386535"><span class="hs-identifier hs-var">txwits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Hash PaymentKey] -&gt; Set (Hash PaymentKey)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Hash PaymentKey]
</span><a href="#local-6989586621679386535"><span class="hs-identifier hs-var">txwits</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span id="local-6989586621679386538"><span class="annot"><span class="annottext">fromSet :: Set (Hash PaymentKey) -&gt; TxExtraKeyWitnesses BabbageEra
</span><a href="#local-6989586621679386538"><span class="hs-identifier hs-var hs-var">fromSet</span></a></span></span><span> </span><span id="local-6989586621679386533"><span class="annot"><span class="annottext">Set (Hash PaymentKey)
</span><a href="#local-6989586621679386533"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey)
</span><a href="#local-6989586621679386533"><span class="hs-identifier hs-var">s</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses BabbageEra
forall era. TxExtraKeyWitnesses era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxExtraKeyWitnessesNone</span></a></span><span>
</span><span id="line-120"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnessesSupportedInEra BabbageEra
-&gt; [Hash PaymentKey] -&gt; TxExtraKeyWitnesses BabbageEra
forall era.
TxExtraKeyWitnessesSupportedInEra era
-&gt; [Hash PaymentKey] -&gt; TxExtraKeyWitnesses era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxExtraKeyWitnesses</span></a></span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnessesSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ExtraKeyWitnessesInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">([Hash PaymentKey] -&gt; TxExtraKeyWitnesses BabbageEra)
-&gt; [Hash PaymentKey] -&gt; TxExtraKeyWitnesses BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey) -&gt; [Hash PaymentKey]
forall a. Set a -&gt; [a]
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Hash PaymentKey)
</span><a href="#local-6989586621679386533"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference"><span class="hs-identifier hs-type">txInsReference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxIn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span id="txInsReference"><span class="annot"><span class="annottext">txInsReference :: ([TxIn] -&gt; f [TxIn]) -&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference"><span class="hs-identifier hs-var hs-var">txInsReference</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (([TxIn] -&gt; f [TxIn])
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ([TxIn] -&gt; f [TxIn])
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInsReference BuildTx BabbageEra
 -&gt; f (TxInsReference BuildTx BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era.
Lens' (TxBodyContent build era) (TxInsReference build era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference%27"><span class="hs-identifier hs-var">txInsReference'</span></a></span><span> </span><span class="annot"><span class="annottext">((TxInsReference BuildTx BabbageEra
  -&gt; f (TxInsReference BuildTx BabbageEra))
 -&gt; TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; (([TxIn] -&gt; f [TxIn])
    -&gt; TxInsReference BuildTx BabbageEra
    -&gt; f (TxInsReference BuildTx BabbageEra))
-&gt; ([TxIn] -&gt; f [TxIn])
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInsReference BuildTx BabbageEra -&gt; [TxIn])
-&gt; ([TxIn] -&gt; TxInsReference BuildTx BabbageEra)
-&gt; Iso
     (TxInsReference BuildTx BabbageEra)
     (TxInsReference BuildTx BabbageEra)
     [TxIn]
     [TxIn]
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">TxInsReference BuildTx BabbageEra -&gt; [TxIn]
forall build era. TxInsReference build era -&gt; [TxIn]
</span><a href="#local-6989586621679386528"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn] -&gt; TxInsReference BuildTx BabbageEra
forall build. [TxIn] -&gt; TxInsReference build BabbageEra
</span><a href="#local-6989586621679386527"><span class="hs-identifier hs-var">fromList</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621679386528"><span class="annot"><span class="annottext">toList :: TxInsReference build era -&gt; [TxIn]
</span><a href="#local-6989586621679386528"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxInsReference build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsReferenceNone</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><a href="#local-6989586621679386528"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra era
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386524"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386524"><span class="hs-identifier hs-var">txins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386524"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679386527"><span class="annot"><span class="annottext">fromList :: [TxIn] -&gt; TxInsReference build BabbageEra
</span><a href="#local-6989586621679386527"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInsReference build BabbageEra
forall build era. TxInsReference build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsReferenceNone</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><a href="#local-6989586621679386527"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span id="local-6989586621679386523"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386523"><span class="hs-identifier hs-var">txins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra BabbageEra
-&gt; [TxIn] -&gt; TxInsReference build BabbageEra
forall era build.
ReferenceTxInsScriptsInlineDatumsSupportedInEra era
-&gt; [TxIn] -&gt; TxInsReference build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ReferenceTxInsScriptsInlineDatumsInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679386523"><span class="hs-identifier hs-var">txins</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txMintValue"><span class="hs-identifier hs-type">txMintValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span>
</span><span id="line-131"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptWitness</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.WitCtxMint</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span id="txMintValue"><span class="annot"><span class="annottext">txMintValue :: ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
 -&gt; f (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txMintValue"><span class="hs-identifier hs-var hs-var">txMintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
     -&gt; f (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
    -&gt; f (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintValue BuildTx BabbageEra
 -&gt; f (TxMintValue BuildTx BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era.
Lens' (TxBodyContent build era) (TxMintValue build era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txMintValue%27"><span class="hs-identifier hs-var">txMintValue'</span></a></span><span> </span><span class="annot"><span class="annottext">((TxMintValue BuildTx BabbageEra
  -&gt; f (TxMintValue BuildTx BabbageEra))
 -&gt; TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; (((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
     -&gt; f (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
    -&gt; TxMintValue BuildTx BabbageEra
    -&gt; f (TxMintValue BuildTx BabbageEra))
-&gt; ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
    -&gt; f (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintValue BuildTx BabbageEra
 -&gt; (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
    -&gt; TxMintValue BuildTx BabbageEra)
-&gt; Iso
     (TxMintValue BuildTx BabbageEra)
     (TxMintValue BuildTx BabbageEra)
     (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
     (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">iso</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
-&gt; (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
</span><a href="#local-6989586621679386520"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679386519"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="#local-6989586621679386520"><span class="hs-identifier hs-type">toMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxMintValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptWitness</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.WitCtxMint</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>        </span><span id="local-6989586621679386520"><span class="annot"><span class="annottext">toMaybe :: TxMintValue BuildTx BabbageEra
-&gt; (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
</span><a href="#local-6989586621679386520"><span class="hs-identifier hs-var hs-var">toMaybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386517"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386517"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTxWith</span></a></span><span> </span><span id="local-6989586621679386515"><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
</span><a href="#local-6989586621679386515"><span class="hs-identifier hs-var">msc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386517"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
</span><a href="#local-6989586621679386515"><span class="hs-identifier hs-var">msc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="#local-6989586621679386520"><span class="hs-identifier hs-var">toMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
</span><span class="hs-identifier">_</span></span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="#local-6989586621679386519"><span class="hs-identifier hs-type">fromMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptWitness</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.WitCtxMint</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxMintValue</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679386519"><span class="annot"><span class="annottext">fromMaybe :: (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679386519"><span class="hs-identifier hs-var hs-var">fromMaybe</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386514"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386514"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386513"><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
</span><a href="#local-6989586621679386513"><span class="hs-identifier hs-var">msc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
-&gt; Value
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
forall era build.
MultiAssetSupportedInEra era
-&gt; Value
-&gt; BuildTxWith build (Map PolicyId (ScriptWitness WitCtxMint era))
-&gt; TxMintValue build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.MultiAssetInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386514"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
</span><a href="#local-6989586621679386513"><span class="hs-identifier hs-var">msc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txOuts"><span class="hs-identifier hs-type">txOuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxOut</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.CtxTx</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span id="txOuts"><span class="annot"><span class="annottext">txOuts :: ([TxOut CtxTx BabbageEra] -&gt; f [TxOut CtxTx BabbageEra])
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txOuts"><span class="hs-identifier hs-var hs-var">txOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (([TxOut CtxTx BabbageEra] -&gt; f [TxOut CtxTx BabbageEra])
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ([TxOut CtxTx BabbageEra] -&gt; f [TxOut CtxTx BabbageEra])
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOut CtxTx BabbageEra] -&gt; f [TxOut CtxTx BabbageEra])
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era. Lens' (TxBodyContent build era) [TxOut CtxTx era]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txOuts%27"><span class="hs-identifier hs-var">txOuts'</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#txValidityRange"><span class="hs-identifier hs-type">txValidityRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxValidityLowerBound</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxValidityUpperBound</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span id="txValidityRange"><span class="annot"><span class="annottext">txValidityRange :: ((TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
 -&gt; f (TxValidityLowerBound BabbageEra,
       TxValidityUpperBound BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#txValidityRange"><span class="hs-identifier hs-var hs-var">txValidityRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; CardanoBuildTx -&gt; f CardanoBuildTx
forall s t a b. (Coercible s a, Coercible t b) =&gt; Iso s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">coerced</span></a></span><span> </span><span class="annot"><span class="annottext">((TxBodyContent BuildTx BabbageEra
  -&gt; f (TxBodyContent BuildTx BabbageEra))
 -&gt; CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; (((TxValidityLowerBound BabbageEra,
      TxValidityUpperBound BabbageEra)
     -&gt; f (TxValidityLowerBound BabbageEra,
           TxValidityUpperBound BabbageEra))
    -&gt; TxBodyContent BuildTx BabbageEra
    -&gt; f (TxBodyContent BuildTx BabbageEra))
-&gt; ((TxValidityLowerBound BabbageEra,
     TxValidityUpperBound BabbageEra)
    -&gt; f (TxValidityLowerBound BabbageEra,
          TxValidityUpperBound BabbageEra))
-&gt; CardanoBuildTx
-&gt; f CardanoBuildTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
 -&gt; f (TxValidityLowerBound BabbageEra,
       TxValidityUpperBound BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; f (TxBodyContent BuildTx BabbageEra)
forall build era.
Lens'
  (TxBodyContent build era)
  (TxValidityLowerBound era, TxValidityUpperBound era)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txValidityRange%27"><span class="hs-identifier hs-var">txValidityRange'</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-type">tx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-type">Traversal'</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">UnbalancedTx</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span>
</span><span id="line-147"></span><span id="tx"><span class="annot"><span class="annottext">tx :: (CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; UnbalancedTx -&gt; f UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; f CardanoBuildTx)
-&gt; UnbalancedTx -&gt; f UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.cardanoTx</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#emptyCardanoBuildTx"><span class="hs-identifier hs-type">emptyCardanoBuildTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.CardanoBuildTx</span></a></span><span>
</span><span id="line-150"></span><span id="emptyCardanoBuildTx"><span class="annot"><span class="annottext">emptyCardanoBuildTx :: Params -&gt; CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#emptyCardanoBuildTx"><span class="hs-identifier hs-var hs-var">emptyCardanoBuildTx</span></a></span></span><span> </span><span id="local-6989586621679386509"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386509"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; CardanoBuildTx
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.CardanoBuildTx</span></a></span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra -&gt; CardanoBuildTx)
-&gt; TxBodyContent BuildTx BabbageEra -&gt; CardanoBuildTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent :: forall build era.
TxIns build era
-&gt; TxInsCollateral era
-&gt; TxInsReference build era
-&gt; [TxOut CtxTx era]
-&gt; TxTotalCollateral era
-&gt; TxReturnCollateral CtxTx era
-&gt; TxFee era
-&gt; (TxValidityLowerBound era, TxValidityUpperBound era)
-&gt; TxMetadataInEra era
-&gt; TxAuxScripts era
-&gt; TxExtraKeyWitnesses era
-&gt; BuildTxWith build (Maybe ProtocolParameters)
-&gt; TxWithdrawals build era
-&gt; TxCertificates build era
-&gt; TxUpdateProposal era
-&gt; TxMintValue build era
-&gt; TxScriptValidity era
-&gt; TxBodyContent build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txIns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txInsCollateral :: TxInsCollateral BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txInsCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
-&gt; [TxIn] -&gt; TxInsCollateral BabbageEra
forall era.
CollateralSupportedInEra era -&gt; [TxIn] -&gt; TxInsCollateral era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">CollateralSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.CollateralInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txInsReference :: TxInsReference BuildTx BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txInsReference</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInsReference BuildTx BabbageEra
forall build era. TxInsReference build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsReferenceNone</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOut CtxTx BabbageEra]
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txTotalCollateral :: TxTotalCollateral BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txTotalCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxTotalCollateral BabbageEra
forall era. TxTotalCollateral era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxTotalCollateralNone</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txReturnCollateral :: TxReturnCollateral CtxTx BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txReturnCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxReturnCollateral CtxTx BabbageEra
forall ctx era. TxReturnCollateral ctx era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxReturnCollateralNone</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txFee :: TxFee BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txFee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra BabbageEra -&gt; Lovelace -&gt; TxFee BabbageEra
forall era. TxFeesExplicitInEra era -&gt; Lovelace -&gt; TxFee era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxFeeExplicit</span></a></span><span> </span><span class="annot"><span class="annottext">TxFeesExplicitInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxFeesExplicitInBabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txValidityRange :: (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txValidityRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxValidityLowerBound BabbageEra
forall era. TxValidityLowerBound era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxValidityNoLowerBound</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra BabbageEra
-&gt; TxValidityUpperBound BabbageEra
forall era.
ValidityNoUpperBoundSupportedInEra era -&gt; TxValidityUpperBound era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxValidityNoUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ValidityNoUpperBoundInBabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txMintValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
forall build era. TxMintValue build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMintNone</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txProtocolParams :: BuildTxWith BuildTx (Maybe ProtocolParameters)
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txProtocolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ProtocolParameters
 -&gt; BuildTxWith BuildTx (Maybe ProtocolParameters))
-&gt; Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Maybe ProtocolParameters
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ProtocolParameters -&gt; Maybe ProtocolParameters)
-&gt; ProtocolParameters -&gt; Maybe ProtocolParameters
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params -&gt; ProtocolParameters
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">pProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386509"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txScriptValidity :: TxScriptValidity BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txScriptValidity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxScriptValidity BabbageEra
forall era. TxScriptValidity era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxScriptValidityNone</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txExtraKeyWits :: TxExtraKeyWitnesses BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txExtraKeyWits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses BabbageEra
forall era. TxExtraKeyWitnesses era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxExtraKeyWitnessesNone</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txMetadata :: TxMetadataInEra BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txMetadata</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMetadataInEra BabbageEra
forall era. TxMetadataInEra era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMetadataNone</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txAuxScripts :: TxAuxScripts BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txAuxScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxAuxScripts BabbageEra
forall era. TxAuxScripts era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxAuxScriptsNone</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txWithdrawals :: TxWithdrawals BuildTx BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txWithdrawals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxWithdrawals BuildTx BabbageEra
forall build era. TxWithdrawals build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxWithdrawalsNone</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txCertificates :: TxCertificates BuildTx BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txCertificates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxCertificates BuildTx BabbageEra
forall build era. TxCertificates build era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxCertificatesNone</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txUpdateProposal :: TxUpdateProposal BabbageEra
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.txUpdateProposal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxUpdateProposal BabbageEra
forall era. TxUpdateProposal era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxUpdateProposalNone</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#emptyUnbalancedTx"><span class="hs-identifier hs-type">emptyUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">UnbalancedTx</span></a></span><span>
</span><span id="line-171"></span><span id="emptyUnbalancedTx"><span class="annot"><span class="annottext">emptyUnbalancedTx :: Params -&gt; UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#emptyUnbalancedTx"><span class="hs-identifier hs-var hs-var">emptyUnbalancedTx</span></a></span></span><span> </span><span id="local-6989586621679386476"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386476"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoBuildTx -&gt; Map TxOutRef TxOut -&gt; UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">UnbalancedCardanoTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#emptyCardanoBuildTx"><span class="hs-identifier hs-var">emptyCardanoBuildTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386476"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#initialState"><span class="hs-identifier hs-type">initialState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span>
</span><span id="line-174"></span><span id="initialState"><span class="annot"><span class="annottext">initialState :: Params -&gt; ConstraintProcessingState
</span><a href="Ledger.Tx.Constraints.OffChain.html#initialState"><span class="hs-identifier hs-var hs-var">initialState</span></a></span></span><span> </span><span id="local-6989586621679386473"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386473"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintProcessingState :: UnbalancedTx
-&gt; ValueSpentBalances
-&gt; ValueSpentBalances
-&gt; Params
-&gt; ConstraintProcessingState
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cpsUnbalancedTx :: UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.cpsUnbalancedTx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#emptyUnbalancedTx"><span class="hs-identifier hs-var">emptyUnbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386473"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cpsValueSpentBalancesInputs :: ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.cpsValueSpentBalancesInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.ValueSpentBalances</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cpsValueSpentBalancesOutputs :: ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.cpsValueSpentBalancesOutputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.ValueSpentBalances</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cpsParams :: Params
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.cpsParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386473"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679386466"><span id="local-6989586621679386467"></span></span><span class="hs-keyword">data</span><span> </span><span id="MkTxError"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-var">MkTxError</span></a></span></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ToCardanoError"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">C.ToCardanoError</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LedgerMkTxError"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MkTxError</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386460"><span id="local-6989586621679386462"><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError -&gt; Bool
(MkTxError -&gt; MkTxError -&gt; Bool)
-&gt; (MkTxError -&gt; MkTxError -&gt; Bool) -&gt; Eq MkTxError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MkTxError -&gt; MkTxError -&gt; Bool
$c/= :: MkTxError -&gt; MkTxError -&gt; Bool
== :: MkTxError -&gt; MkTxError -&gt; Bool
$c== :: MkTxError -&gt; MkTxError -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386453"><span id="local-6989586621679386455"><span id="local-6989586621679386457"><span class="annot"><span class="annottext">Int -&gt; MkTxError -&gt; ShowS
[MkTxError] -&gt; ShowS
MkTxError -&gt; String
(Int -&gt; MkTxError -&gt; ShowS)
-&gt; (MkTxError -&gt; String)
-&gt; ([MkTxError] -&gt; ShowS)
-&gt; Show MkTxError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MkTxError] -&gt; ShowS
$cshowList :: [MkTxError] -&gt; ShowS
show :: MkTxError -&gt; String
$cshow :: MkTxError -&gt; String
showsPrec :: Int -&gt; MkTxError -&gt; ShowS
$cshowsPrec :: Int -&gt; MkTxError -&gt; ShowS
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. MkTxError -&gt; Rep MkTxError x)
-&gt; (forall x. Rep MkTxError x -&gt; MkTxError) -&gt; Generic MkTxError
forall x. Rep MkTxError x -&gt; MkTxError
forall x. MkTxError -&gt; Rep MkTxError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep MkTxError x -&gt; MkTxError
$cfrom :: forall x. MkTxError -&gt; Rep MkTxError x
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386441"><span id="local-6989586621679386443"><span id="local-6989586621679386445"><span id="local-6989586621679386447"><span class="annot"><span class="annottext">[MkTxError] -&gt; Encoding
[MkTxError] -&gt; Value
MkTxError -&gt; Encoding
MkTxError -&gt; Value
(MkTxError -&gt; Value)
-&gt; (MkTxError -&gt; Encoding)
-&gt; ([MkTxError] -&gt; Value)
-&gt; ([MkTxError] -&gt; Encoding)
-&gt; ToJSON MkTxError
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [MkTxError] -&gt; Encoding
$ctoEncodingList :: [MkTxError] -&gt; Encoding
toJSONList :: [MkTxError] -&gt; Value
$ctoJSONList :: [MkTxError] -&gt; Value
toEncoding :: MkTxError -&gt; Encoding
$ctoEncoding :: MkTxError -&gt; Encoding
toJSON :: MkTxError -&gt; Value
$ctoJSON :: MkTxError -&gt; Value
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386436"><span id="local-6989586621679386438"><span class="annot"><span class="annottext">Value -&gt; Parser [MkTxError]
Value -&gt; Parser MkTxError
(Value -&gt; Parser MkTxError)
-&gt; (Value -&gt; Parser [MkTxError]) -&gt; FromJSON MkTxError
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [MkTxError]
$cparseJSONList :: Value -&gt; Parser [MkTxError]
parseJSON :: Value -&gt; Parser MkTxError
$cparseJSON :: Value -&gt; Parser MkTxError
</span><a href="../file:///nix/store/2m29g1mlr4lg9v93x77b5w3l6pyhq2vj-aeson-lib-aeson-2.0.2.0-haddock-doc/share/doc/aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679386432"><span class="annot"><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679386430"><span class="annot"><span class="annottext">pretty :: MkTxError -&gt; Doc ann
</span><a href="#local-6989586621679386430"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-type">ToCardanoError</span></a></span><span> </span><span id="local-6989586621679386429"><span class="annot"><span class="annottext">ToCardanoError
</span><a href="#local-6989586621679386429"><span class="hs-identifier hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;ToCardanoError&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">colon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError
</span><a href="#local-6989586621679386429"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-type">LedgerMkTxError</span></a></span><span> </span><span id="local-6989586621679386428"><span class="annot"><span class="annottext">MkTxError
</span><a href="#local-6989586621679386428"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../file:///nix/store/sbv9pqjhqdwa0bq7cll6wmzgwjf0al3r-prettyprinter-lib-prettyprinter-1.7.1-haddock-doc/share/doc/prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError
</span><a href="#local-6989586621679386428"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Given a list of 'SomeLookupsAndConstraints' describing the constraints</span><span>
</span><span id="line-194"></span><span class="hs-comment">--   for several scripts, build a single transaction that runs all the scripts.</span><span>
</span><span id="line-195"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#mkSomeTx"><span class="hs-identifier hs-type">mkSomeTx</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.SomeLookupsAndConstraints</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">UnbalancedTx</span></a></span><span>
</span><span id="line-199"></span><span id="mkSomeTx"><span class="annot"><span class="annottext">mkSomeTx :: Params
-&gt; [SomeLookupsAndConstraints] -&gt; Either MkTxError UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#mkSomeTx"><span class="hs-identifier hs-var hs-var">mkSomeTx</span></a></span></span><span> </span><span id="local-6989586621679386427"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386427"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679386426"><span class="annot"><span class="annottext">[SomeLookupsAndConstraints]
</span><a href="#local-6989586621679386426"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386425"><span class="annot"><span class="annottext">process :: SomeLookupsAndConstraints
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="#local-6989586621679386425"><span class="hs-identifier hs-var hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-201"></span><span>            </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.SomeLookupsAndConstraints</span></a></span><span> </span><span id="local-6989586621679386423"><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386423"><span class="hs-identifier hs-var">lookups</span></a></span></span><span> </span><span id="local-6989586621679386422"><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621679386422"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="annottext">ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall a.
(FromData (DatumType a), ToData (DatumType a),
 ToData (RedeemerType a)) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#processLookupsAndConstraints"><span class="hs-identifier hs-var">processLookupsAndConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386423"><span class="hs-identifier hs-var">lookups</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621679386422"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">(ConstraintProcessingState -&gt; UnbalancedTx)
-&gt; Either MkTxError ConstraintProcessingState
-&gt; Either MkTxError UnbalancedTx
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintProcessingState -&gt; UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">cpsUnbalancedTx</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">(Either MkTxError ConstraintProcessingState
 -&gt; Either MkTxError UnbalancedTx)
-&gt; Either MkTxError ConstraintProcessingState
-&gt; Either MkTxError UnbalancedTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Except MkTxError ConstraintProcessingState
-&gt; Either MkTxError ConstraintProcessingState
forall e a. Except e a -&gt; Either e a
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">(Except MkTxError ConstraintProcessingState
 -&gt; Either MkTxError ConstraintProcessingState)
-&gt; Except MkTxError ConstraintProcessingState
-&gt; Either MkTxError ConstraintProcessingState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT ConstraintProcessingState (Except MkTxError) [()]
-&gt; ConstraintProcessingState
-&gt; Except MkTxError ConstraintProcessingState
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">execStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SomeLookupsAndConstraints
 -&gt; StateT ConstraintProcessingState (Except MkTxError) ())
-&gt; [SomeLookupsAndConstraints]
-&gt; StateT ConstraintProcessingState (Except MkTxError) [()]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">SomeLookupsAndConstraints
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="#local-6989586621679386425"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeLookupsAndConstraints]
</span><a href="#local-6989586621679386426"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; ConstraintProcessingState
</span><a href="Ledger.Tx.Constraints.OffChain.html#initialState"><span class="hs-identifier hs-var">initialState</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386427"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="SortedConstraints"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#SortedConstraints"><span class="hs-identifier hs-var">SortedConstraints</span></a></span></span><span>
</span><span id="line-208"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="MkSortedConstraints"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkSortedConstraints"><span class="hs-identifier hs-var">MkSortedConstraints</span></a></span></span><span>
</span><span id="line-209"></span><span>   </span><span class="hs-special">{</span><span> </span><span id="rangeConstraints"><span class="annot"><span class="annottext">SortedConstraints -&gt; [POSIXTimeRange]
</span><a href="Ledger.Tx.Constraints.OffChain.html#rangeConstraints"><span class="hs-identifier hs-var hs-var">rangeConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTimeRange</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="otherConstraints"><span class="annot"><span class="annottext">SortedConstraints -&gt; [TxConstraint]
</span><a href="Ledger.Tx.Constraints.OffChain.html#otherConstraints"><span class="hs-identifier hs-var hs-var">otherConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span id="local-6989586621679386839"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#prepareConstraints"><span class="hs-identifier hs-type">prepareConstraints</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">ScriptOutputConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#SortedConstraints"><span class="hs-identifier hs-type">SortedConstraints</span></a></span></span><span>
</span><span id="line-218"></span><span id="prepareConstraints"><span class="annot"><span class="annottext">prepareConstraints :: [ScriptOutputConstraint (DatumType a)]
-&gt; [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     SortedConstraints
</span><a href="Ledger.Tx.Constraints.OffChain.html#prepareConstraints"><span class="hs-identifier hs-var hs-var">prepareConstraints</span></a></span></span><span> </span><span id="local-6989586621679386415"><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
</span><a href="#local-6989586621679386415"><span class="hs-identifier hs-var">ownOutputs</span></a></span></span><span> </span><span id="local-6989586621679386414"><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386414"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679386413"><span class="annot"><span class="annottext">extractPosixTimeRange :: TxConstraint -&gt; Either POSIXTimeRange TxConstraint
</span><a href="#local-6989586621679386413"><span class="hs-identifier hs-var hs-var">extractPosixTimeRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustValidateInTimeRange</span></a></span><span> </span><span id="local-6989586621679386411"><span class="annot"><span class="annottext">ValidityInterval POSIXTime
</span><a href="#local-6989586621679386411"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange -&gt; Either POSIXTimeRange TxConstraint
forall a b. a -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTimeRange -&gt; Either POSIXTimeRange TxConstraint)
-&gt; POSIXTimeRange -&gt; Either POSIXTimeRange TxConstraint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval POSIXTime -&gt; POSIXTimeRange
forall a. ValidityInterval a -&gt; Interval a
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">toPlutusInterval</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval POSIXTime
</span><a href="#local-6989586621679386411"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span id="local-6989586621679386410"><span class="annot"><span class="annottext">TxConstraint
</span><a href="#local-6989586621679386410"><span class="hs-identifier hs-var">other</span></a></span></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxConstraint -&gt; Either POSIXTimeRange TxConstraint
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraint
</span><a href="#local-6989586621679386410"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679386409"><span class="annot"><span class="annottext">[POSIXTimeRange]
</span><a href="#local-6989586621679386409"><span class="hs-identifier hs-var">ranges</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386408"><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386408"><span class="hs-identifier hs-var">nonRangeConstraints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either POSIXTimeRange TxConstraint]
-&gt; ([POSIXTimeRange], [TxConstraint])
forall a b. [Either a b] -&gt; ([a], [b])
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">partitionEithers</span></a></span><span> </span><span class="annot"><span class="annottext">([Either POSIXTimeRange TxConstraint]
 -&gt; ([POSIXTimeRange], [TxConstraint]))
-&gt; [Either POSIXTimeRange TxConstraint]
-&gt; ([POSIXTimeRange], [TxConstraint])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraint -&gt; Either POSIXTimeRange TxConstraint
</span><a href="#local-6989586621679386413"><span class="hs-identifier hs-var">extractPosixTimeRange</span></a></span><span> </span><span class="annot"><span class="annottext">(TxConstraint -&gt; Either POSIXTimeRange TxConstraint)
-&gt; [TxConstraint] -&gt; [Either POSIXTimeRange TxConstraint]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386414"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679386406"><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386406"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     [TxConstraint]
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   [TxConstraint]
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      [TxConstraint])
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     [TxConstraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
-&gt; [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     [TxConstraint]
forall a (m :: * -&gt; *).
(ToData (DatumType a), MonadReader (ScriptLookups a) m,
 MonadError MkTxError m) =&gt;
[ScriptOutputConstraint (DatumType a)]
-&gt; [TxConstraint] -&gt; m [TxConstraint]
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.prepareConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
</span><a href="#local-6989586621679386415"><span class="hs-identifier hs-var">ownOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386408"><span class="hs-identifier hs-var">nonRangeConstraints</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">SortedConstraints
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     SortedConstraints
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(SortedConstraints
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      SortedConstraints)
-&gt; SortedConstraints
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     SortedConstraints
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[POSIXTimeRange] -&gt; [TxConstraint] -&gt; SortedConstraints
</span><a href="Ledger.Tx.Constraints.OffChain.html#MkSortedConstraints"><span class="hs-identifier hs-var">MkSortedConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">[POSIXTimeRange]
</span><a href="#local-6989586621679386409"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386406"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Resolve some 'TxConstraints' by modifying the 'UnbalancedTx' in the</span><span>
</span><span id="line-229"></span><span class="hs-comment">--   'ConstraintProcessingState'</span><span>
</span><span id="line-230"></span><span id="local-6989586621679386893"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#processLookupsAndConstraints"><span class="hs-identifier hs-type">processLookupsAndConstraints</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">::</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386893"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="processLookupsAndConstraints"><span class="annot"><span class="annottext">processLookupsAndConstraints :: ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#processLookupsAndConstraints"><span class="hs-identifier hs-var hs-var">processLookupsAndConstraints</span></a></span></span><span> </span><span id="local-6989586621679386403"><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386403"><span class="hs-identifier hs-var">lookups</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span class="hs-special">{</span><span id="local-6989586621679386402"><span class="annot"><span class="annottext">[TxConstraint]
txConstraints :: [TxConstraint]
txConstraints :: forall i o. TxConstraints i o -&gt; [TxConstraint]
</span><a href="#local-6989586621679386402"><span class="hs-identifier hs-var hs-var">txConstraints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386401"><span class="annot"><span class="annottext">[ScriptInputConstraint (RedeemerType a)]
txOwnInputs :: [ScriptInputConstraint (RedeemerType a)]
txOwnInputs :: forall i o. TxConstraints i o -&gt; [ScriptInputConstraint i]
</span><a href="#local-6989586621679386401"><span class="hs-identifier hs-var hs-var">txOwnInputs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386400"><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
txOwnOutputs :: [ScriptOutputConstraint (DatumType a)]
txOwnOutputs :: forall i o. TxConstraints i o -&gt; [ScriptOutputConstraint o]
</span><a href="#local-6989586621679386400"><span class="hs-identifier hs-var hs-var">txOwnOutputs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   ()
 -&gt; ScriptLookups a
 -&gt; StateT ConstraintProcessingState (Except MkTxError) ())
-&gt; ScriptLookups a
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  ()
-&gt; ScriptLookups a
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386403"><span class="hs-identifier hs-var">lookups</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   ()
 -&gt; StateT ConstraintProcessingState (Except MkTxError) ())
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>            </span><span id="local-6989586621679386398"><span class="annot"><span class="annottext">SortedConstraints
</span><a href="#local-6989586621679386398"><span class="hs-identifier hs-var">sortedConstraints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
-&gt; [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     SortedConstraints
forall a.
ToData (DatumType a) =&gt;
[ScriptOutputConstraint (DatumType a)]
-&gt; [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     SortedConstraints
</span><a href="Ledger.Tx.Constraints.OffChain.html#prepareConstraints"><span class="hs-identifier hs-var">prepareConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">[ScriptOutputConstraint (DatumType a)]
</span><a href="#local-6989586621679386400"><span class="hs-identifier hs-var">txOwnOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxConstraint]
</span><a href="#local-6989586621679386402"><span class="hs-identifier hs-var">txConstraints</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span class="annot"><span class="annottext">(TxConstraint
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      ())
-&gt; [TxConstraint]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraint
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall a.
TxConstraint
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#processConstraint"><span class="hs-identifier hs-var">processConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SortedConstraints -&gt; [TxConstraint]
</span><a href="Ledger.Tx.Constraints.OffChain.html#otherConstraints"><span class="hs-identifier hs-var hs-var">otherConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SortedConstraints
</span><a href="#local-6989586621679386398"><span class="hs-identifier hs-var">sortedConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-comment">-- traverse_ P.processConstraintFun txCnsFuns</span><span>
</span><span id="line-244"></span><span>            </span><span class="annot"><span class="annottext">(ScriptInputConstraint (RedeemerType a)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      ())
-&gt; [ScriptInputConstraint (RedeemerType a)]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptInputConstraint (RedeemerType a)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m,
 MonadState ConstraintProcessingState m, FromData (DatumType a),
 ToData (DatumType a), ToData (RedeemerType a)) =&gt;
ScriptInputConstraint (RedeemerType a) -&gt; m ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#addOwnInput"><span class="hs-identifier hs-var">addOwnInput</span></a></span><span> </span><span class="annot"><span class="annottext">[ScriptInputConstraint (RedeemerType a)]
</span><a href="#local-6989586621679386401"><span class="hs-identifier hs-var">txOwnInputs</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-comment">-- P.addMintingRedeemers</span><span>
</span><span id="line-246"></span><span>            </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  ()
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m,
 MonadState ConstraintProcessingState m, MonadError MkTxError m) =&gt;
m ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#checkValueSpent"><span class="hs-identifier hs-var">checkValueSpent</span></a></span><span>
</span><span id="line-247"></span><span>            </span><span class="annot"><span class="annottext">(StateT ConstraintProcessingState (Except MkTxError) ()
 -&gt; StateT ConstraintProcessingState (Except MkTxError) ())
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (m :: * -&gt; *) a (n :: * -&gt; *) b r.
(m a -&gt; n b) -&gt; ReaderT r m a -&gt; ReaderT r n b
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">mapReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExceptT MkTxError Identity ((), ConstraintProcessingState)
 -&gt; ExceptT MkTxError Identity ((), ConstraintProcessingState))
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall (m :: * -&gt; *) a s (n :: * -&gt; *) b.
(m (a, s) -&gt; n (b, s)) -&gt; StateT s m a -&gt; StateT s n b
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">mapStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError)
-&gt; ExceptT MkTxError Identity ((), ConstraintProcessingState)
-&gt; ExceptT MkTxError Identity ((), ConstraintProcessingState)
forall e e' a. (e -&gt; e') -&gt; Except e a -&gt; Except e' a
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">withExcept</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  ()
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m,
 MonadState ConstraintProcessingState m, MonadError MkTxError m) =&gt;
m ()
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.updateUtxoIndex</span></a></span><span>
</span><span id="line-248"></span><span>            </span><span class="annot"><span class="annottext">StateT ConstraintProcessingState (Except MkTxError) ()
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT ConstraintProcessingState (Except MkTxError) ()
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      ())
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[POSIXTimeRange]
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#setValidityRange"><span class="hs-identifier hs-var">setValidityRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SortedConstraints -&gt; [POSIXTimeRange]
</span><a href="Ledger.Tx.Constraints.OffChain.html#rangeConstraints"><span class="hs-identifier hs-var hs-var">rangeConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">SortedConstraints
</span><a href="#local-6989586621679386398"><span class="hs-identifier hs-var">sortedConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621679386829"><span id="local-6989586621679386830"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#checkValueSpent"><span class="hs-identifier hs-type">checkValueSpent</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679386829"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-252"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386829"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-253"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386829"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-254"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679386829"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-256"></span><span id="checkValueSpent"><span class="annot"><span class="annottext">checkValueSpent :: m ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#checkValueSpent"><span class="hs-identifier hs-var hs-var">checkValueSpent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679386392"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386392"><span class="hs-identifier hs-var">missingInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Const Value) ConstraintProcessingState ValueSpentBalances
-&gt; (ValueSpentBalances -&gt; Value) -&gt; m Value
forall s (m :: * -&gt; *) r a.
MonadState s m =&gt;
LensLike' (Const r) s a -&gt; (a -&gt; r) -&gt; m r
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Const Value) ConstraintProcessingState ValueSpentBalances
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">ValueSpentBalances -&gt; Value
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.missingValueSpent</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.isZero</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386392"><span class="hs-identifier hs-var">missingInputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m ()) -&gt; MkTxError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.DeclaredInputMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386392"><span class="hs-identifier hs-var">missingInputs</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679386387"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386387"><span class="hs-identifier hs-var">missingOutputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Const Value) ConstraintProcessingState ValueSpentBalances
-&gt; (ValueSpentBalances -&gt; Value) -&gt; m Value
forall s (m :: * -&gt; *) r a.
MonadState s m =&gt;
LensLike' (Const r) s a -&gt; (a -&gt; r) -&gt; m r
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">uses</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike'
  (Const Value) ConstraintProcessingState ValueSpentBalances
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">ValueSpentBalances -&gt; Value
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.missingValueSpent</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.isZero</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386387"><span class="hs-identifier hs-var">missingOutputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m ()) -&gt; MkTxError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.DeclaredOutputMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386387"><span class="hs-identifier hs-var">missingOutputs</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Reinject the validityRange inside the unbalanced Tx.</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   As the Tx is a Caradano transaction, and as we have access to the SlotConfig,</span><span>
</span><span id="line-264"></span><span class="hs-comment">--   we can already internalize the constraints for the test</span><span>
</span><span id="line-265"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#setValidityRange"><span class="hs-identifier hs-type">setValidityRange</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTimeRange</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span id="setValidityRange"><span class="annot"><span class="annottext">setValidityRange :: [POSIXTimeRange]
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#setValidityRange"><span class="hs-identifier hs-var hs-var">setValidityRange</span></a></span></span><span> </span><span id="local-6989586621679386384"><span class="annot"><span class="annottext">[POSIXTimeRange]
</span><a href="#local-6989586621679386384"><span class="hs-identifier hs-var">ranges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679386383"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679386383"><span class="hs-identifier hs-var">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConstraintProcessingState -&gt; SlotConfig)
-&gt; StateT ConstraintProcessingState (Except MkTxError) SlotConfig
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; SlotConfig
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var hs-var">pSlotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; SlotConfig)
-&gt; (ConstraintProcessingState -&gt; Params)
-&gt; ConstraintProcessingState
-&gt; SlotConfig
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintProcessingState -&gt; Params
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">P.cpsParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386381"><span class="annot"><span class="annottext">slotRange :: SlotRange
</span><a href="#local-6989586621679386381"><span class="hs-identifier hs-var hs-var">slotRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; SlotRange -&gt; SlotRange)
-&gt; SlotRange -&gt; [SlotRange] -&gt; SlotRange
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange -&gt; SlotRange -&gt; SlotRange
forall a. MeetSemiLattice a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-operator hs-var">(/\)</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
forall a. BoundedMeetSemiLattice a =&gt; a
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">([SlotRange] -&gt; SlotRange) -&gt; [SlotRange] -&gt; SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTimeRange -&gt; SlotRange
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">posixTimeRangeToContainedSlotRange</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679386383"><span class="hs-identifier hs-var">slotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTimeRange -&gt; SlotRange) -&gt; [POSIXTimeRange] -&gt; [SlotRange]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[POSIXTimeRange]
</span><a href="#local-6989586621679386384"><span class="hs-identifier hs-var">ranges</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679386379"><span class="annot"><span class="annottext">(TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="#local-6989586621679386379"><span class="hs-identifier hs-var">cTxTR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
-&gt; StateT
     ConstraintProcessingState
     (Except MkTxError)
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   ToCardanoError
   (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
 -&gt; StateT
      ConstraintProcessingState
      (Except MkTxError)
      (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
-&gt; StateT
     ConstraintProcessingState
     (Except MkTxError)
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoValidityRange</span></a></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="#local-6989586621679386381"><span class="hs-identifier hs-var">slotRange</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (((TxValidityLowerBound BabbageEra,
      TxValidityUpperBound BabbageEra)
     -&gt; Identity
          (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ((TxValidityLowerBound BabbageEra,
     TxValidityUpperBound BabbageEra)
    -&gt; Identity
         (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (((TxValidityLowerBound BabbageEra,
      TxValidityUpperBound BabbageEra)
     -&gt; Identity
          (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ((TxValidityLowerBound BabbageEra,
     TxValidityUpperBound BabbageEra)
    -&gt; Identity
         (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
 -&gt; Identity
      (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens'
  CardanoBuildTx
  (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="Ledger.Tx.Constraints.OffChain.html#txValidityRange"><span class="hs-identifier hs-var">txValidityRange</span></a></span><span> </span><span class="annot"><span class="annottext">(((TxValidityLowerBound BabbageEra,
   TxValidityUpperBound BabbageEra)
  -&gt; Identity
       (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra))
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (TxValidityLowerBound BabbageEra,
    TxValidityUpperBound BabbageEra)
-&gt; StateT ConstraintProcessingState (Except MkTxError) ()
forall s (m :: * -&gt; *) a b.
MonadState s m =&gt;
ASetter s s a b -&gt; b -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">(TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="#local-6989586621679386379"><span class="hs-identifier hs-var">cTxTR</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Turn a 'TxConstraints' value into an unbalanced transaction that satisfies</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   the constraints. To use this in a contract, see</span><span>
</span><span id="line-275"></span><span class="hs-comment">--   'Plutus.Contract.submitTxConstraints'</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   and related functions.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679386376"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#mkTx"><span class="hs-identifier hs-type">mkTx</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386376"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">UnbalancedTx</span></a></span></span><span>
</span><span id="line-286"></span><span id="mkTx"><span class="annot"><span class="annottext">mkTx :: Params
-&gt; ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; Either MkTxError UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#mkTx"><span class="hs-identifier hs-var hs-var">mkTx</span></a></span></span><span> </span><span id="local-6989586621679386375"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386375"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679386374"><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386374"><span class="hs-identifier hs-var">lookups</span></a></span></span><span> </span><span id="local-6989586621679386373"><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621679386373"><span class="hs-identifier hs-var">txc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; [SomeLookupsAndConstraints] -&gt; Either MkTxError UnbalancedTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#mkSomeTx"><span class="hs-identifier hs-var">mkSomeTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679386375"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; SomeLookupsAndConstraints
forall a.
(FromData (DatumType a), ToData (DatumType a),
 ToData (RedeemerType a)) =&gt;
ScriptLookups a
-&gt; TxConstraints (RedeemerType a) (DatumType a)
-&gt; SomeLookupsAndConstraints
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.SomeLookupsAndConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLookups a
</span><a href="#local-6989586621679386374"><span class="hs-identifier hs-var">lookups</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraints (RedeemerType a) (DatumType a)
</span><a href="#local-6989586621679386373"><span class="hs-identifier hs-var">txc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span id="local-6989586621679386781"><span id="local-6989586621679386782"><span id="local-6989586621679386783"><span id="local-6989586621679386784"><span id="local-6989586621679386785"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-type">throwLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386785"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386784"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386783"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386784"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679386782"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679386783"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386782"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386781"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679386784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386781"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-289"></span><span id="throwLeft"><span class="annot"><span class="annottext">throwLeft :: (b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var hs-var">throwLeft</span></a></span></span><span> </span><span id="local-6989586621679386372"><span class="annot"><span class="annottext">b -&gt; err
</span><a href="#local-6989586621679386372"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; m r) -&gt; (r -&gt; m r) -&gt; Either b r -&gt; m r
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">err -&gt; m r
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(err -&gt; m r) -&gt; (b -&gt; err) -&gt; b -&gt; m r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; err
</span><a href="#local-6989586621679386372"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; m r
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Modify the 'UnbalancedTx' so that it satisfies the constraints, if</span><span>
</span><span id="line-292"></span><span class="hs-comment">--   possible. Fails if a hash is missing from the lookups, or if an output</span><span>
</span><span id="line-293"></span><span class="hs-comment">--   of the wrong type is spent.</span><span>
</span><span id="line-294"></span><span id="local-6989586621679386834"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#processConstraint"><span class="hs-identifier hs-type">processConstraint</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxConstraint</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386834"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-297"></span><span id="processConstraint"><span class="annot"><span class="annottext">processConstraint :: TxConstraint
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#processConstraint"><span class="hs-identifier hs-var hs-var">processConstraint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustIncludeDatumInTxWithHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- always succeeds</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustIncludeDatumInTx</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- always succeeds</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustSpendPubKeyOutput</span></a></span><span> </span><span id="local-6989586621679386367"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386367"><span class="hs-identifier hs-var">txo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679386366"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386366"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a.
TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-var">lookupTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386367"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621679386364"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386364"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  Value
-&gt; (Value
    -&gt; ReaderT
         (ScriptLookups a)
         (StateT ConstraintProcessingState (Except MkTxError))
         Value)
-&gt; Maybe Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TxOutRefWrongType</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386367"><span class="hs-identifier hs-var">txo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Value
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      Value)
-&gt; Maybe Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">APrism
  DecoratedTxOut
  DecoratedTxOut
  (PubKeyHash, Maybe StakingCredential, Value,
   Maybe (DatumHash, DatumFromQuery), Maybe (Versioned Script))
  (PubKeyHash, Maybe StakingCredential, Value,
   Maybe (DatumHash, DatumFromQuery), Maybe (Versioned Script))
-&gt; DecoratedTxOut -&gt; Bool
forall s t a b. APrism s t a b -&gt; s -&gt; Bool
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">APrism
  DecoratedTxOut
  DecoratedTxOut
  (PubKeyHash, Maybe StakingCredential, Value,
   Maybe (DatumHash, DatumFromQuery), Maybe (Versioned Script))
  (PubKeyHash, Maybe StakingCredential, Value,
   Maybe (DatumHash, DatumFromQuery), Maybe (Versioned Script))
Prism'
  DecoratedTxOut
  (PubKeyHash, Maybe StakingCredential, Value,
   Maybe (DatumHash, DatumFromQuery), Maybe (Versioned Script))
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx._PublicKeyDecoratedTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386366"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386366"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut -&gt; Getting Value DecoratedTxOut Value -&gt; Value
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Value DecoratedTxOut Value
Lens' DecoratedTxOut Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.decoratedTxOutValue</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621679386359"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386359"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386367"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
 -&gt; Identity
      [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens'
  CardanoBuildTx
  [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txIns"><span class="hs-identifier hs-var">txIns</span></a></span><span> </span><span class="annot"><span class="annottext">(([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
  -&gt; Identity
       [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386359"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn BabbageEra
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386364"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustBeSignedBy</span></a></span><span> </span><span id="local-6989586621679386353"><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621679386353"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>        </span><span id="local-6989586621679386352"><span class="annot"><span class="annottext">Hash PaymentKey
</span><a href="#local-6989586621679386352"><span class="hs-identifier hs-var">ekw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="annot"><span class="annottext">(ToCardanoError
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Hash PaymentKey))
-&gt; (Hash PaymentKey
    -&gt; ReaderT
         (ScriptLookups a)
         (StateT ConstraintProcessingState (Except MkTxError))
         (Hash PaymentKey))
-&gt; Either ToCardanoError (Hash PaymentKey)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Hash PaymentKey)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Hash PaymentKey)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Hash PaymentKey))
-&gt; (ToCardanoError -&gt; MkTxError)
-&gt; ToCardanoError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Hash PaymentKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Hash PaymentKey)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (Hash PaymentKey)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Hash PaymentKey))
-&gt; Either ToCardanoError (Hash PaymentKey)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Hash PaymentKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Either ToCardanoError (Hash PaymentKey)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoPaymentKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKeyHash
</span><a href="#local-6989586621679386353"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ((Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ((Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; (Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx (Set (Hash PaymentKey))
</span><a href="Ledger.Tx.Constraints.OffChain.html#txExtraKeyWits"><span class="hs-identifier hs-var">txExtraKeyWits</span></a></span><span> </span><span class="annot"><span class="annottext">((Set (Hash PaymentKey) -&gt; Identity (Set (Hash PaymentKey)))
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; Set (Hash PaymentKey)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey -&gt; Set (Hash PaymentKey)
forall a. a -&gt; Set a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Hash PaymentKey
</span><a href="#local-6989586621679386352"><span class="hs-identifier hs-var">ekw</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustSpendScriptOutput</span></a></span><span> </span><span id="local-6989586621679386348"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386348"><span class="hs-identifier hs-var">txo</span></a></span></span><span> </span><span id="local-6989586621679386347"><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679386347"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span> </span><span id="local-6989586621679386346"><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679386346"><span class="hs-identifier hs-var">mref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>        </span><span id="local-6989586621679386345"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386345"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a.
TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-var">lookupTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386348"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679386344"><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679386344"><span class="hs-identifier hs-var">mkWitness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679386346"><span class="hs-identifier hs-var">mref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-315"></span><span>          </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679386343"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386343"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>            </span><span id="local-6989586621679386342"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386342"><span class="hs-identifier hs-var">refTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a.
TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-var">lookupTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386343"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386342"><span class="hs-identifier hs-var">refTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
-&gt; Getting
     (Maybe (Versioned Script))
     DecoratedTxOut
     (Maybe (Versioned Script))
-&gt; Maybe (Versioned Script)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Maybe (Versioned Script))
  DecoratedTxOut
  (Maybe (Versioned Script))
Lens' DecoratedTxOut (Maybe (Versioned Script))
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.decoratedTxOutReferenceScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-318"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">Tx.Versioned</span></a></span><span> </span><span class="annot"><span class="annottext">Script
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386340"><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679386340"><span class="hs-identifier hs-var">lang</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>                    </span><span id="local-6989586621679386339"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386339"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386343"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-320"></span><span>                    </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; Identity [TxIn])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx [TxIn]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference"><span class="hs-identifier hs-var">txInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxIn] -&gt; Identity [TxIn])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [TxIn]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386339"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>                    </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError WitnessHeader
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError WitnessHeader
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      WitnessHeader)
-&gt; Either ToCardanoError WitnessHeader
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned TxOutRef -&gt; Either ToCardanoError WitnessHeader
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxInReferenceWitnessHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; Language -&gt; Versioned TxOutRef
forall script. script -&gt; Language -&gt; Versioned script
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Tx.Versioned</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386343"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679386340"><span class="hs-identifier hs-var">lang</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Versioned Script)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TxOutRefNoReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386343"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>          </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>            </span><span id="local-6989586621679386336"><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679386336"><span class="hs-identifier hs-var">mscriptTXO</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  (Maybe (Versioned Validator))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (Versioned Validator))
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   (Maybe (Versioned Validator))
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Maybe (Versioned Validator)))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (Versioned Validator))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (Versioned Validator))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (Versioned Validator))
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m) =&gt;
DecoratedTxOut -&gt; m (Maybe (Versioned Validator))
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.resolveScriptTxOutValidator</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386345"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679386336"><span class="hs-identifier hs-var">mscriptTXO</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>                </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679386334"><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679386334"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>                    </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError WitnessHeader
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError WitnessHeader
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      WitnessHeader)
-&gt; Either ToCardanoError WitnessHeader
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; Either ToCardanoError WitnessHeader
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxInScriptWitnessHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Validator -&gt; Script
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">getValidator</span></a></span><span> </span><span class="annot"><span class="annottext">(Validator -&gt; Script) -&gt; Versioned Validator -&gt; Versioned Script
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679386334"><span class="hs-identifier hs-var">validator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     WitnessHeader
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TxOutRefWrongType</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386348"><span class="hs-identifier hs-var">txo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621679386332"><span class="annot"><span class="annottext">Maybe (DatumWithOrigin, Value)
</span><a href="#local-6989586621679386332"><span class="hs-identifier hs-var">mscriptTXO</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  (Maybe (DatumWithOrigin, Value))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (DatumWithOrigin, Value))
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   (Maybe (DatumWithOrigin, Value))
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Maybe (DatumWithOrigin, Value)))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (DatumWithOrigin, Value))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (DatumWithOrigin, Value))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Maybe (DatumWithOrigin, Value))
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m) =&gt;
DecoratedTxOut -&gt; m (Maybe (DatumWithOrigin, Value))
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.resolveScriptTxOutDatumAndValue</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386345"><span class="hs-identifier hs-var">txout</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (DatumWithOrigin, Value)
</span><a href="#local-6989586621679386332"><span class="hs-identifier hs-var">mscriptTXO</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386330"><span class="annot"><span class="annottext">DatumWithOrigin
</span><a href="#local-6989586621679386330"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386329"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386329"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>                </span><span id="local-6989586621679386328"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386328"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386348"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-333"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386327"><span class="annot"><span class="annottext">witness :: Witness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679386327"><span class="hs-identifier hs-var hs-var">witness</span></a></span></span><span>
</span><span id="line-334"></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
-&gt; ScriptWitness WitCtxTxIn BabbageEra
-&gt; Witness WitCtxTxIn BabbageEra
forall witctx era.
ScriptWitnessInCtx witctx
-&gt; ScriptWitness witctx era -&gt; Witness witctx era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitnessForSpending</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptWitness WitCtxTxIn BabbageEra
 -&gt; Witness WitCtxTxIn BabbageEra)
-&gt; ScriptWitness WitCtxTxIn BabbageEra
-&gt; Witness WitCtxTxIn BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-335"></span><span>                            </span><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679386344"><span class="hs-identifier hs-var">mkWitness</span></a></span><span>
</span><span id="line-336"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Datum -&gt; ScriptDatum WitCtxTxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoDatumWitness</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; ScriptDatum WitCtxTxIn)
-&gt; Maybe Datum -&gt; ScriptDatum WitCtxTxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatumWithOrigin -&gt; Maybe Datum
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.datumWitness</span></a></span><span> </span><span class="annot"><span class="annottext">DatumWithOrigin
</span><a href="#local-6989586621679386330"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; ScriptData
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoScriptData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Redeemer -&gt; BuiltinData
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">getRedeemer</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679386347"><span class="hs-identifier hs-var">redeemer</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>                            </span><span class="annot"><span class="annottext">ExecutionUnits
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>                </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
 -&gt; Identity
      [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens'
  CardanoBuildTx
  [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txIns"><span class="hs-identifier hs-var">txIns</span></a></span><span> </span><span class="annot"><span class="annottext">(([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
  -&gt; Identity
       [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386328"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679386327"><span class="hs-identifier hs-var">witness</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>                </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386329"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>            </span><span class="annot"><span class="annottext">Maybe (DatumWithOrigin, Value)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TxOutRefWrongType</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386348"><span class="hs-identifier hs-var">txo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustUseOutputAsCollateral</span></a></span><span> </span><span id="local-6989586621679386319"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386319"><span class="hs-identifier hs-var">txo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679386318"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386318"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386319"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; Identity [TxIn])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx [TxIn]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsCollateral"><span class="hs-identifier hs-var">txInsCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxIn] -&gt; Identity [TxIn])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [TxIn]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386318"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustReferenceOutput</span></a></span><span> </span><span id="local-6989586621679386316"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386316"><span class="hs-identifier hs-var">txo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>        </span><span id="local-6989586621679386315"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386315"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386316"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; Identity [TxIn])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx [TxIn]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference"><span class="hs-identifier hs-var">txInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxIn] -&gt; Identity [TxIn])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [TxIn]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386315"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustMintValue</span></a></span><span> </span><span id="local-6989586621679386313"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386313"><span class="hs-identifier hs-var">mpsHash</span></a></span></span><span> </span><span id="local-6989586621679386312"><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679386312"><span class="hs-identifier hs-var">red</span></a></span></span><span> </span><span id="local-6989586621679386311"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679386311"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span id="local-6989586621679386310"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679386310"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679386309"><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679386309"><span class="hs-identifier hs-var">mref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386308"><span class="annot"><span class="annottext">value :: Integer -&gt; Value
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; TokenName -&gt; Integer -&gt; Value
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; CurrencySymbol
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Value.mpsSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386313"><span class="hs-identifier hs-var">mpsHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679386311"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-comment">-- If i is negative we are burning tokens. The tokens burned must</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-comment">-- be provided as an input. So we add the value burnt to</span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-comment">-- 'valueSpentInputs'. If i is positive then new tokens are created</span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-comment">-- which must be added to 'valueSpentOutputs'.</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679386310"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-362"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679386310"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679386310"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>        </span><span id="local-6989586621679386304"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      Value)
-&gt; (Value
    -&gt; ReaderT
         (ScriptLookups a)
         (StateT ConstraintProcessingState (Except MkTxError))
         Value)
-&gt; Either ToCardanoError Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError Value
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      Value)
-&gt; Either ToCardanoError Value
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either ToCardanoError Value
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Either ToCardanoError Value)
-&gt; Value -&gt; Either ToCardanoError Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679386310"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span id="local-6989586621679386301"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679386301"><span class="hs-identifier hs-var">pId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      PolicyId)
-&gt; (PolicyId
    -&gt; ReaderT
         (ScriptLookups a)
         (StateT ConstraintProcessingState (Except MkTxError))
         PolicyId)
-&gt; Either ToCardanoError PolicyId
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     PolicyId
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     PolicyId
forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     PolicyId
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError PolicyId
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      PolicyId)
-&gt; Either ToCardanoError PolicyId
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     PolicyId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash -&gt; Either ToCardanoError PolicyId
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">toCardanoPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386313"><span class="hs-identifier hs-var">mpsHash</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span id="local-6989586621679386300"><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679386300"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679386309"><span class="hs-identifier hs-var">mref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679386299"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386299"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>                </span><span id="local-6989586621679386298"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386298"><span class="hs-identifier hs-var">refTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a.
TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-var">lookupTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386299"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-370"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386298"><span class="hs-identifier hs-var">refTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
-&gt; Getting
     (First (Maybe (Versioned Script)))
     DecoratedTxOut
     (Maybe (Versioned Script))
-&gt; Maybe (Maybe (Versioned Script))
forall s a. s -&gt; Getting (First a) s a -&gt; Maybe a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (First (Maybe (Versioned Script)))
  DecoratedTxOut
  (Maybe (Versioned Script))
Lens' DecoratedTxOut (Maybe (Versioned Script))
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">decoratedTxOutReferenceScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-371"></span><span>                    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Script)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>                      </span><span id="local-6989586621679386297"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386297"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      TxIn)
-&gt; Either ToCardanoError TxIn
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; Either ToCardanoError TxIn)
-&gt; (TxOutRef -&gt; TxOutRef) -&gt; TxOutRef -&gt; Either ToCardanoError TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxInput -&gt; TxOutRef
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var hs-var">Tx.txInputRef</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInput -&gt; TxOutRef)
-&gt; (TxOutRef -&gt; TxInput) -&gt; TxOutRef -&gt; TxOutRef
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxInput
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.pubKeyTxInput</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; Either ToCardanoError TxIn)
-&gt; TxOutRef -&gt; Either ToCardanoError TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386299"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-373"></span><span>                      </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([TxIn] -&gt; Identity [TxIn])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([TxIn] -&gt; Identity [TxIn])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; Identity [TxIn])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx [TxIn]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txInsReference"><span class="hs-identifier hs-var">txInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxIn] -&gt; Identity [TxIn])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [TxIn]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386297"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>                      </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ScriptWitness WitCtxMint BabbageEra)
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span>
</span><span id="line-375"></span><span>                        </span><span class="annot"><span class="annottext">(Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ScriptWitness WitCtxMint BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
-&gt; Maybe (Versioned TxOutRef)
-&gt; Maybe (Versioned MintingPolicy)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">toCardanoMintWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679386312"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; Language -&gt; Versioned TxOutRef)
-&gt; Language -&gt; TxOutRef -&gt; Versioned TxOutRef
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Language -&gt; Versioned TxOutRef
forall script. script -&gt; Language -&gt; Versioned script
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Tx.Versioned</span></a></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="../file:///nix/store/azj0kfbgizyr4qj49lql36z31i3346pb-cardano-ledger-alonzo-lib-cardano-ledger-alonzo-0.1.0.0-haddock-doc/share/doc/cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-var">PlutusV2</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; Versioned TxOutRef)
-&gt; Maybe TxOutRef -&gt; Maybe (Versioned TxOutRef)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="#local-6989586621679386309"><span class="hs-identifier hs-var">mref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned MintingPolicy)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-376"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (Maybe (Versioned Script))
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MkTxError
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ScriptWitness WitCtxMint BabbageEra)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError) -&gt; MkTxError -&gt; MkTxError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TxOutRefNoReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386299"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>            </span><span class="annot"><span class="annottext">Maybe TxOutRef
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>                </span><span id="local-6989586621679386294"><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679386294"><span class="hs-identifier hs-var">mintingPolicyScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
forall a.
MintingPolicyHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupMintingPolicy"><span class="hs-identifier hs-var">lookupMintingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386313"><span class="hs-identifier hs-var">mpsHash</span></a></span><span>
</span><span id="line-379"></span><span>                </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ScriptWitness WitCtxMint BabbageEra)
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span>
</span><span id="line-380"></span><span>                  </span><span class="annot"><span class="annottext">(Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ScriptWitness WitCtxMint BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
-&gt; Maybe (Versioned TxOutRef)
-&gt; Maybe (Versioned MintingPolicy)
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">toCardanoMintWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679386312"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned TxOutRef)
forall a. Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Versioned MintingPolicy -&gt; Maybe (Versioned MintingPolicy)
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679386294"><span class="hs-identifier hs-var">mintingPolicyScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
     -&gt; Identity
          (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
    -&gt; Identity
         (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
     -&gt; Identity
          (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
    -&gt; Identity
         (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
 -&gt; Identity
      (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens'
  CardanoBuildTx
  (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
</span><a href="Ledger.Tx.Constraints.OffChain.html#txMintValue"><span class="hs-identifier hs-var">txMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">(((Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
  -&gt; Identity
       (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra)))
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (Value, Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386304"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PolicyId
-&gt; ScriptWitness WitCtxMint BabbageEra
-&gt; Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679386301"><span class="hs-identifier hs-var">pId</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679386300"><span class="hs-identifier hs-var">witness</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustPayToAddress</span></a></span><span> </span><span id="local-6989586621679386290"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679386290"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679386289"><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum)
</span><a href="#local-6989586621679386289"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span id="local-6989586621679386288"><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679386288"><span class="hs-identifier hs-var">refScriptHashM</span></a></span></span><span> </span><span id="local-6989586621679386287"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386287"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>        </span><span id="local-6989586621679386286"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679386286"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Getting NetworkId ConstraintProcessingState NetworkId
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     NetworkId
forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Params -&gt; Const NetworkId Params)
-&gt; ConstraintProcessingState
-&gt; Const NetworkId ConstraintProcessingState
Lens' ConstraintProcessingState Params
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.paramsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Params -&gt; Const NetworkId Params)
 -&gt; ConstraintProcessingState
 -&gt; Const NetworkId ConstraintProcessingState)
-&gt; ((NetworkId -&gt; Const NetworkId NetworkId)
    -&gt; Params -&gt; Const NetworkId Params)
-&gt; Getting NetworkId ConstraintProcessingState NetworkId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(NetworkId -&gt; Const NetworkId NetworkId)
-&gt; Params -&gt; Const NetworkId Params
Lens' Params NetworkId
</span><a href="../../../../cardano-node-emulator/html/src"><span class="hs-identifier hs-var">networkIdL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>        </span><span id="local-6989586621679386284"><span class="annot"><span class="annottext">ReferenceScript BabbageEra
</span><a href="#local-6989586621679386284"><span class="hs-identifier hs-var">refScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
forall a.
Maybe ScriptHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupScriptAsReferenceScript"><span class="hs-identifier hs-var">lookupScriptAsReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679386288"><span class="hs-identifier hs-var">refScriptHashM</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679386282"><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra
</span><a href="#local-6989586621679386282"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; MkTxError)
-&gt; Either ToCardanoError (TxOut CtxTx BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (TxOut CtxTx BabbageEra)
forall s (m :: * -&gt; *) err b r.
(MonadState s m, MonadError err m) =&gt;
(b -&gt; err) -&gt; Either b r -&gt; m r
</span><a href="Ledger.Tx.Constraints.OffChain.html#throwLeft"><span class="hs-identifier hs-var">throwLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (TxOut CtxTx BabbageEra)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (TxOut CtxTx BabbageEra))
-&gt; Either ToCardanoError (TxOut CtxTx BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (TxOut CtxTx BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra BabbageEra
-&gt; TxOutValue BabbageEra
-&gt; TxOutDatum CtxTx BabbageEra
-&gt; ReferenceScript BabbageEra
-&gt; TxOut CtxTx BabbageEra
forall ctx era.
AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum ctx era
-&gt; ReferenceScript era
-&gt; TxOut ctx era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.TxOut</span></a></span><span>
</span><span id="line-387"></span><span>            </span><span class="annot"><span class="annottext">(AddressInEra BabbageEra
 -&gt; TxOutValue BabbageEra
 -&gt; TxOutDatum CtxTx BabbageEra
 -&gt; ReferenceScript BabbageEra
 -&gt; TxOut CtxTx BabbageEra)
-&gt; Either ToCardanoError (AddressInEra BabbageEra)
-&gt; Either
     ToCardanoError
     (TxOutValue BabbageEra
      -&gt; TxOutDatum CtxTx BabbageEra
      -&gt; ReferenceScript BabbageEra
      -&gt; TxOut CtxTx BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; Address -&gt; Either ToCardanoError (AddressInEra BabbageEra)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoAddressInEra</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679386286"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679386290"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (TxOutValue BabbageEra
   -&gt; TxOutDatum CtxTx BabbageEra
   -&gt; ReferenceScript BabbageEra
   -&gt; TxOut CtxTx BabbageEra)
-&gt; Either ToCardanoError (TxOutValue BabbageEra)
-&gt; Either
     ToCardanoError
     (TxOutDatum CtxTx BabbageEra
      -&gt; ReferenceScript BabbageEra -&gt; TxOut CtxTx BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either ToCardanoError (TxOutValue BabbageEra)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxOutValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386287"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (TxOutDatum CtxTx BabbageEra
   -&gt; ReferenceScript BabbageEra -&gt; TxOut CtxTx BabbageEra)
-&gt; Either ToCardanoError (TxOutDatum CtxTx BabbageEra)
-&gt; Either
     ToCardanoError
     (ReferenceScript BabbageEra -&gt; TxOut CtxTx BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx BabbageEra
-&gt; Either ToCardanoError (TxOutDatum CtxTx BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum) -&gt; TxOutDatum CtxTx BabbageEra
</span><a href="Ledger.Tx.Constraints.OffChain.html#toTxOutDatum"><span class="hs-identifier hs-var">toTxOutDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum)
</span><a href="#local-6989586621679386289"><span class="hs-identifier hs-var">md</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ReferenceScript BabbageEra -&gt; TxOut CtxTx BabbageEra)
-&gt; Either ToCardanoError (ReferenceScript BabbageEra)
-&gt; Either ToCardanoError (TxOut CtxTx BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript BabbageEra
-&gt; Either ToCardanoError (ReferenceScript BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript BabbageEra
</span><a href="#local-6989586621679386284"><span class="hs-identifier hs-var">refScript</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens' CardanoBuildTx [TxOut CtxTx BabbageEra]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txOuts"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="annot"><span class="annottext">(([TxOut CtxTx BabbageEra] -&gt; Identity [TxOut CtxTx BabbageEra])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [TxOut CtxTx BabbageEra]
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra
</span><a href="#local-6989586621679386282"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386287"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustSpendAtLeast</span></a></span><span> </span><span id="local-6989586621679386276"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386276"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.required</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386276"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MustProduceAtLeast</span></a></span><span> </span><span id="local-6989586621679386273"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386273"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.required</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386273"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679386272"><span class="annot"><span class="annottext">TxConstraint
</span><a href="#local-6989586621679386272"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      ())
-&gt; String
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ledger.Tx.Constraints.OffChain: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraint -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TxConstraint
</span><a href="#local-6989586621679386272"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not implemented yet&quot;</span></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621679386762"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-type">lookupTxOutRef</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Tx.TxOutRef</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386762"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-type">Tx.DecoratedTxOut</span></a></span></span><span>
</span><span id="line-403"></span><span id="lookupTxOutRef"><span class="annot"><span class="annottext">lookupTxOutRef :: TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupTxOutRef"><span class="hs-identifier hs-var hs-var">lookupTxOutRef</span></a></span></span><span> </span><span id="local-6989586621679386269"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386269"><span class="hs-identifier hs-var">txo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  DecoratedTxOut
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   DecoratedTxOut
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      DecoratedTxOut)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     DecoratedTxOut
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m) =&gt;
TxOutRef -&gt; m DecoratedTxOut
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.lookupTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386269"><span class="hs-identifier hs-var">txo</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span id="local-6989586621679386706"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#lookupMintingPolicy"><span class="hs-identifier hs-type">lookupMintingPolicy</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">MintingPolicyHash</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">Versioned</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">MintingPolicy</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-408"></span><span id="lookupMintingPolicy"><span class="annot"><span class="annottext">lookupMintingPolicy :: MintingPolicyHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupMintingPolicy"><span class="hs-identifier hs-var hs-var">lookupMintingPolicy</span></a></span></span><span> </span><span id="local-6989586621679386267"><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386267"><span class="hs-identifier hs-var">mph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  (Versioned MintingPolicy)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   (Versioned MintingPolicy)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (Versioned MintingPolicy))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (Versioned MintingPolicy)
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m) =&gt;
MintingPolicyHash -&gt; m (Versioned MintingPolicy)
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.lookupMintingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicyHash
</span><a href="#local-6989586621679386267"><span class="hs-identifier hs-var">mph</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span id="local-6989586621679386695"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#lookupScriptAsReferenceScript"><span class="hs-identifier hs-type">lookupScriptAsReferenceScript</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386695"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.ReferenceScript</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-413"></span><span id="lookupScriptAsReferenceScript"><span class="annot"><span class="annottext">lookupScriptAsReferenceScript :: Maybe ScriptHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
</span><a href="Ledger.Tx.Constraints.OffChain.html#lookupScriptAsReferenceScript"><span class="hs-identifier hs-var hs-var">lookupScriptAsReferenceScript</span></a></span></span><span> </span><span id="local-6989586621679386265"><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679386265"><span class="hs-identifier hs-var">msh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  (ReferenceScript BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
forall a b.
ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var">mapLedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (ScriptLookups a)
   (StateT ConstraintProcessingState (Except MkTxError))
   (ReferenceScript BabbageEra)
 -&gt; ReaderT
      (ScriptLookups a)
      (StateT ConstraintProcessingState (Except MkTxError))
      (ReferenceScript BabbageEra))
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     (ReferenceScript BabbageEra)
forall a (m :: * -&gt; *).
(MonadReader (ScriptLookups a) m, MonadError MkTxError m) =&gt;
Maybe ScriptHash -&gt; m (ReferenceScript BabbageEra)
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.lookupScriptAsReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679386265"><span class="hs-identifier hs-var">msh</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621679386860"><span id="local-6989586621679386861"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-type">mapLedgerMkTxError</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679386860"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386861"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679386860"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-418"></span><span id="mapLedgerMkTxError"><span class="annot"><span class="annottext">mapLedgerMkTxError :: ReaderT
  (ScriptLookups a)
  (StateT ConstraintProcessingState (Except MkTxError))
  b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
</span><a href="Ledger.Tx.Constraints.OffChain.html#mapLedgerMkTxError"><span class="hs-identifier hs-var hs-var">mapLedgerMkTxError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StateT ConstraintProcessingState (Except MkTxError) b
 -&gt; StateT ConstraintProcessingState (Except MkTxError) b)
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
-&gt; ReaderT
     (ScriptLookups a)
     (StateT ConstraintProcessingState (Except MkTxError))
     b
forall (m :: * -&gt; *) a (n :: * -&gt; *) b r.
(m a -&gt; n b) -&gt; ReaderT r m a -&gt; ReaderT r n b
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">mapReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExceptT MkTxError Identity (b, ConstraintProcessingState)
 -&gt; ExceptT MkTxError Identity (b, ConstraintProcessingState))
-&gt; StateT ConstraintProcessingState (Except MkTxError) b
-&gt; StateT ConstraintProcessingState (Except MkTxError) b
forall (m :: * -&gt; *) a s (n :: * -&gt; *) b.
(m (a, s) -&gt; n (b, s)) -&gt; StateT s m a -&gt; StateT s n b
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">mapStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either MkTxError (b, ConstraintProcessingState)
 -&gt; Either MkTxError (b, ConstraintProcessingState))
-&gt; ExceptT MkTxError Identity (b, ConstraintProcessingState)
-&gt; ExceptT MkTxError Identity (b, ConstraintProcessingState)
forall e a e' b.
(Either e a -&gt; Either e' b) -&gt; Except e a -&gt; Except e' b
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">mapExcept</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError)
-&gt; Either MkTxError (b, ConstraintProcessingState)
-&gt; Either MkTxError (b, ConstraintProcessingState)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#toTxOutDatum"><span class="hs-identifier hs-type">toTxOutDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxOutDatum</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Datum</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.TxOutDatum</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.CtxTx</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span>
</span><span id="line-421"></span><span id="toTxOutDatum"><span class="annot"><span class="annottext">toTxOutDatum :: Maybe (TxOutDatum Datum) -&gt; TxOutDatum CtxTx BabbageEra
</span><a href="Ledger.Tx.Constraints.OffChain.html#toTxOutDatum"><span class="hs-identifier hs-var hs-var">toTxOutDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TxOutDatum Datum)
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx BabbageEra
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxOutNoDatum</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxOutDatumHash</span></a></span><span> </span><span id="local-6989586621679386262"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386262"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; TxOutDatum CtxTx BabbageEra
forall ctx. Datum -&gt; TxOutDatum ctx BabbageEra
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxOutDatumHashFromDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386262"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxOutDatumInTx</span></a></span><span> </span><span id="local-6989586621679386260"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386260"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; TxOutDatum CtxTx BabbageEra
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxOutDatumInTx</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386260"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">TxOutDatumInline</span></a></span><span> </span><span id="local-6989586621679386258"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386258"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; TxOutDatum CtxTx BabbageEra
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxOutDatumInline</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386258"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Add a typed input, checking the type of the output it spends. Return the value</span><span>
</span><span id="line-428"></span><span class="hs-comment">--   of the spent output.</span><span>
</span><span id="line-429"></span><span id="local-6989586621679386832"><span id="local-6989586621679386833"><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#addOwnInput"><span class="hs-identifier hs-type">addOwnInput</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679386832"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-431"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Ledger.Tx.Constraints.OffChain.html#MkTxError"><span class="hs-identifier hs-type">MkTxError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386832"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-432"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ConstraintProcessingState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386832"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-433"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">FromData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-type">ToData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptInputConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">RedeemerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679386832"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-439"></span><span id="addOwnInput"><span class="annot"><span class="annottext">addOwnInput :: ScriptInputConstraint (RedeemerType a) -&gt; m ()
</span><a href="Ledger.Tx.Constraints.OffChain.html#addOwnInput"><span class="hs-identifier hs-var hs-var">addOwnInput</span></a></span></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptInputConstraint</span></a></span><span class="hs-special">{</span><span id="local-6989586621679386255"><span class="annot"><span class="annottext">RedeemerType a
icRedeemer :: forall a. ScriptInputConstraint a -&gt; a
icRedeemer :: RedeemerType a
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">P.icRedeemer</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386253"><span class="annot"><span class="annottext">TxOutRef
icTxOutRef :: forall a. ScriptInputConstraint a -&gt; TxOutRef
icTxOutRef :: TxOutRef
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">P.icTxOutRef</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-type">P.ScriptLookups</span></a></span><span class="hs-special">{</span><span id="local-6989586621679386250"><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
slTxOutputs :: forall a. ScriptLookups a -&gt; Map TxOutRef DecoratedTxOut
slTxOutputs :: Map TxOutRef DecoratedTxOut
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">P.slTxOutputs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386248"><span class="annot"><span class="annottext">Maybe (TypedValidator a)
slTypedValidator :: forall a. ScriptLookups a -&gt; Maybe (TypedValidator a)
slTypedValidator :: Maybe (TypedValidator a)
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var hs-var">P.slTypedValidator</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (ScriptLookups a)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679386246"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679386246"><span class="hs-identifier hs-var">inst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (TypedValidator a)
-&gt; (TypedValidator a -&gt; m (TypedValidator a))
-&gt; Maybe (TypedValidator a)
-&gt; m (TypedValidator a)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; m (TypedValidator a)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m (TypedValidator a))
-&gt; MkTxError -&gt; m (TypedValidator a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TypedValidatorMissing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; m (TypedValidator a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TypedValidator a)
</span><a href="#local-6989586621679386248"><span class="hs-identifier hs-var">slTypedValidator</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">Typed.TypedScriptTxOutRef</span></a></span><span class="hs-special">{</span><span id="local-6989586621679386243"><span class="annot"><span class="annottext">TxOutRef
tyTxOutRefRef :: forall a. TypedScriptTxOutRef a -&gt; TxOutRef
tyTxOutRefRef :: TxOutRef
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var hs-var">Typed.tyTxOutRefRef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386241"><span class="annot"><span class="annottext">TypedScriptTxOut a
tyTxOutRefOut :: forall a. TypedScriptTxOutRef a -&gt; TypedScriptTxOut a
tyTxOutRefOut :: TypedScriptTxOut a
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var hs-var">Typed.tyTxOutRefOut</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-443"></span><span>      </span><span class="annot"><span class="annottext">(ConnectionError -&gt; m (TypedScriptTxOutRef a))
-&gt; (TypedScriptTxOutRef a -&gt; m (TypedScriptTxOutRef a))
-&gt; Either ConnectionError (TypedScriptTxOutRef a)
-&gt; m (TypedScriptTxOutRef a)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; m (TypedScriptTxOutRef a)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m (TypedScriptTxOutRef a))
-&gt; (ConnectionError -&gt; MkTxError)
-&gt; ConnectionError
-&gt; m (TypedScriptTxOutRef a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MkTxError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#LedgerMkTxError"><span class="hs-identifier hs-var">LedgerMkTxError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; MkTxError)
-&gt; (ConnectionError -&gt; MkTxError) -&gt; ConnectionError -&gt; MkTxError
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionError -&gt; MkTxError
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.TypeCheckFailed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypedScriptTxOutRef a -&gt; m (TypedScriptTxOutRef a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="annottext">(Either ConnectionError (TypedScriptTxOutRef a)
 -&gt; m (TypedScriptTxOutRef a))
-&gt; Either ConnectionError (TypedScriptTxOutRef a)
-&gt; m (TypedScriptTxOutRef a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Except ConnectionError a -&gt; Either ConnectionError a
forall e a. Except e a -&gt; Either e a
</span><a href="../file:///nix/store/8r01jj9dl6h1x2byph07y6wxfb3ysd8c-transformers-lib-transformers-0.5.6.2-haddock-doc/share/doc/transformers/html/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-type">Typed.ConnectionError</span></a></span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><span class="annottext">(Except ConnectionError (TypedScriptTxOutRef a)
 -&gt; Either ConnectionError (TypedScriptTxOutRef a))
-&gt; Except ConnectionError (TypedScriptTxOutRef a)
-&gt; Either ConnectionError (TypedScriptTxOutRef a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679386238"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679386238"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679386237"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386237"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExceptT ConnectionError Identity (TxOut, Datum)
-&gt; ((TxOut, Datum)
    -&gt; ExceptT ConnectionError Identity (TxOut, Datum))
-&gt; Maybe (TxOut, Datum)
-&gt; ExceptT ConnectionError Identity (TxOut, Datum)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionError -&gt; ExceptT ConnectionError Identity (TxOut, Datum)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(ConnectionError
 -&gt; ExceptT ConnectionError Identity (TxOut, Datum))
-&gt; ConnectionError
-&gt; ExceptT ConnectionError Identity (TxOut, Datum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; ConnectionError
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">UnknownRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">icTxOutRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxOut, Datum) -&gt; ExceptT ConnectionError Identity (TxOut, Datum)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (TxOut, Datum)
 -&gt; ExceptT ConnectionError Identity (TxOut, Datum))
-&gt; Maybe (TxOut, Datum)
-&gt; ExceptT ConnectionError Identity (TxOut, Datum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-447"></span><span>                                </span><span id="local-6989586621679386236"><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386236"><span class="hs-identifier hs-var">ciTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Map TxOutRef DecoratedTxOut -&gt; Maybe DecoratedTxOut
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../file:///nix/store/5giw0zbshrdz1qlvzc0csv9mspljr1ax-containers-lib-containers-0.6.5.1-haddock-doc/share/doc/containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">icTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef DecoratedTxOut
</span><a href="#local-6989586621679386250"><span class="hs-identifier hs-var">slTxOutputs</span></a></span><span>
</span><span id="line-448"></span><span>                                </span><span id="local-6989586621679386234"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386234"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386236"><span class="hs-identifier hs-var">ciTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
-&gt; Getting (First Datum) DecoratedTxOut Datum -&gt; Maybe Datum
forall s a. s -&gt; Getting (First a) s a -&gt; Maybe a
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="annot"><span class="annottext">((DatumHash, DatumFromQuery)
 -&gt; Const (First Datum) (DatumHash, DatumFromQuery))
-&gt; DecoratedTxOut -&gt; Const (First Datum) DecoratedTxOut
Traversal' DecoratedTxOut (DatumHash, DatumFromQuery)
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.decoratedTxOutDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(((DatumHash, DatumFromQuery)
  -&gt; Const (First Datum) (DatumHash, DatumFromQuery))
 -&gt; DecoratedTxOut -&gt; Const (First Datum) DecoratedTxOut)
-&gt; ((Datum -&gt; Const (First Datum) Datum)
    -&gt; (DatumHash, DatumFromQuery)
    -&gt; Const (First Datum) (DatumHash, DatumFromQuery))
-&gt; Getting (First Datum) DecoratedTxOut Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumFromQuery -&gt; Const (First Datum) DatumFromQuery)
-&gt; (DatumHash, DatumFromQuery)
-&gt; Const (First Datum) (DatumHash, DatumFromQuery)
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-identifier hs-var">_2</span></a></span><span> </span><span class="annot"><span class="annottext">((DatumFromQuery -&gt; Const (First Datum) DatumFromQuery)
 -&gt; (DatumHash, DatumFromQuery)
 -&gt; Const (First Datum) (DatumHash, DatumFromQuery))
-&gt; ((Datum -&gt; Const (First Datum) Datum)
    -&gt; DatumFromQuery -&gt; Const (First Datum) DatumFromQuery)
-&gt; (Datum -&gt; Const (First Datum) Datum)
-&gt; (DatumHash, DatumFromQuery)
-&gt; Const (First Datum) (DatumHash, DatumFromQuery)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; Const (First Datum) Datum)
-&gt; DatumFromQuery -&gt; Const (First Datum) DatumFromQuery
Traversal' DatumFromQuery Datum
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.datumInDatumFromQuery</span></a></span><span>
</span><span id="line-449"></span><span>                                </span><span class="annot"><span class="annottext">(TxOut, Datum) -&gt; Maybe (TxOut, Datum)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecoratedTxOut -&gt; TxOut
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">Tx.toTxInfoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">DecoratedTxOut
</span><a href="#local-6989586621679386236"><span class="hs-identifier hs-var">ciTxOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386234"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>          </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; TxOutRef
-&gt; TxOut
-&gt; Datum
-&gt; Except ConnectionError (TypedScriptTxOutRef a)
forall out (m :: * -&gt; *).
(FromData (DatumType out), ToData (DatumType out),
 MonadError ConnectionError m) =&gt;
TypedValidator out
-&gt; TxOutRef -&gt; TxOut -&gt; Datum -&gt; m (TypedScriptTxOutRef out)
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Typed.typeScriptTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679386246"><span class="hs-identifier hs-var">inst</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">icTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679386238"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679386237"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386229"><span class="annot"><span class="annottext">vl :: Value
</span><a href="#local-6989586621679386229"><span class="hs-identifier hs-var hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">PV2.txOutValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value) -&gt; TxOut -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScriptTxOut a -&gt; TxOut
forall a. TypedScriptTxOut a -&gt; TxOut
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var hs-var">Typed.tyTxOutTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScriptTxOut a
</span><a href="#local-6989586621679386241"><span class="hs-identifier hs-var">tyTxOutRefOut</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">(ValueSpentBalances -&gt; Identity ValueSpentBalances)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.valueSpentInputs</span></a></span><span> </span><span class="annot"><span class="annottext">((ValueSpentBalances -&gt; Identity ValueSpentBalances)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; ValueSpentBalances -&gt; m ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ValueSpentBalances
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">P.provided</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679386229"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386226"><span class="annot"><span class="annottext">datum :: ScriptDatum WitCtxTxIn
</span><a href="#local-6989586621679386226"><span class="hs-identifier hs-var hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptData -&gt; ScriptDatum WitCtxTxIn
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptDatumForTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptData -&gt; ScriptDatum WitCtxTxIn)
-&gt; ScriptData -&gt; ScriptDatum WitCtxTxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; ScriptData
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoScriptData</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; ScriptData) -&gt; BuiltinData -&gt; ScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumType a -&gt; BuiltinData) -&gt; DatumType a -&gt; BuiltinData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScriptTxOut a -&gt; DatumType a
forall a. TypedScriptTxOut a -&gt; DatumType a
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var hs-var">Typed.tyTxOutData</span></a></span><span> </span><span class="annot"><span class="annottext">TypedScriptTxOut a
</span><a href="#local-6989586621679386241"><span class="hs-identifier hs-var">tyTxOutRefOut</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679386223"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386223"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m TxIn)
-&gt; (TxIn -&gt; m TxIn) -&gt; Either ToCardanoError TxIn -&gt; m TxIn
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; m TxIn
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m TxIn)
-&gt; (ToCardanoError -&gt; MkTxError) -&gt; ToCardanoError -&gt; m TxIn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; m TxIn
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError TxIn -&gt; m TxIn)
-&gt; Either ToCardanoError TxIn -&gt; m TxIn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679386243"><span class="hs-identifier hs-var">tyTxOutRefRef</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679386222"><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679386222"><span class="hs-identifier hs-var">mkWitness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m WitnessHeader)
-&gt; (WitnessHeader -&gt; m WitnessHeader)
-&gt; Either ToCardanoError WitnessHeader
-&gt; m WitnessHeader
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MkTxError -&gt; m WitnessHeader
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../file:///nix/store/50z9mfcyab831xv3ljzrgw24b0c22y3g-mtl-lib-mtl-2.2.2-haddock-doc/share/doc/mtl/html/src"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MkTxError -&gt; m WitnessHeader)
-&gt; (ToCardanoError -&gt; MkTxError)
-&gt; ToCardanoError
-&gt; m WitnessHeader
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; MkTxError
</span><a href="Ledger.Tx.Constraints.OffChain.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WitnessHeader -&gt; m WitnessHeader
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-456"></span><span>                     </span><span class="annot"><span class="annottext">(Either ToCardanoError WitnessHeader -&gt; m WitnessHeader)
-&gt; Either ToCardanoError WitnessHeader -&gt; m WitnessHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; Either ToCardanoError WitnessHeader
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoTxInScriptWitnessHeader</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Script -&gt; Either ToCardanoError WitnessHeader)
-&gt; Versioned Script -&gt; Either ToCardanoError WitnessHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Validator -&gt; Script) -&gt; Versioned Validator -&gt; Versioned Script
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Validator -&gt; Script
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">getValidator</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Validator -&gt; Versioned Script)
-&gt; Versioned Validator -&gt; Versioned Script
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Versioned Validator
forall a. TypedValidator a -&gt; Versioned Validator
</span><a href="../../../../plutus-script-utils/html/src"><span class="hs-identifier hs-var">Typed.vValidatorScript</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679386246"><span class="hs-identifier hs-var">inst</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679386220"><span class="annot"><span class="annottext">witIn :: Witness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var hs-var">witIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
-&gt; ScriptWitness WitCtxTxIn BabbageEra
-&gt; Witness WitCtxTxIn BabbageEra
forall witctx era.
ScriptWitnessInCtx witctx
-&gt; ScriptWitness witctx era -&gt; Witness witctx era
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitness</span></a></span><span>
</span><span id="line-458"></span><span>                    </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitnessForSpending</span></a></span><span>
</span><span id="line-459"></span><span>                    </span><span class="annot"><span class="annottext">(ScriptWitness WitCtxTxIn BabbageEra
 -&gt; Witness WitCtxTxIn BabbageEra)
-&gt; ScriptWitness WitCtxTxIn BabbageEra
-&gt; Witness WitCtxTxIn BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679386222"><span class="hs-identifier hs-var">mkWitness</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxTxIn
</span><a href="#local-6989586621679386226"><span class="hs-identifier hs-var">datum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; ScriptData
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.toCardanoScriptData</span></a></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; ScriptData) -&gt; BuiltinData -&gt; ScriptData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerType a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toBuiltinData</span></a></span><span> </span><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679386255"><span class="hs-identifier hs-var">icRedeemer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExecutionUnits
</span><a href="../../../../plutus-ledger/html/src"><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><span class="annottext">(UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState
Lens' ConstraintProcessingState UnbalancedTx
</span><a href="../../../../plutus-ledger-constraints/html/src"><span class="hs-identifier hs-var">unbalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">((UnbalancedTx -&gt; Identity UnbalancedTx)
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; ConstraintProcessingState
-&gt; Identity ConstraintProcessingState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; UnbalancedTx -&gt; Identity UnbalancedTx
Traversal' UnbalancedTx CardanoBuildTx
</span><a href="Ledger.Tx.Constraints.OffChain.html#tx"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">((CardanoBuildTx -&gt; Identity CardanoBuildTx)
 -&gt; UnbalancedTx -&gt; Identity UnbalancedTx)
-&gt; (([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
     -&gt; Identity
          [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
    -&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx)
-&gt; ([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
    -&gt; Identity
         [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; UnbalancedTx
-&gt; Identity UnbalancedTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
 -&gt; Identity
      [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
-&gt; CardanoBuildTx -&gt; Identity CardanoBuildTx
Lens'
  CardanoBuildTx
  [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
</span><a href="Ledger.Tx.Constraints.OffChain.html#txIns"><span class="hs-identifier hs-var">txIns</span></a></span><span> </span><span class="annot"><span class="annottext">(([(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
  -&gt; Identity
       [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))])
 -&gt; ConstraintProcessingState -&gt; Identity ConstraintProcessingState)
-&gt; [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))]
-&gt; m ()
forall s (m :: * -&gt; *) a.
(MonadState s m, Semigroup a) =&gt;
ASetter' s a -&gt; a -&gt; m ()
</span><a href="../file:///nix/store/lwkxqy8dgzjvz62gfx89dnvl9mm03scy-lens-lib-lens-4.19.2-haddock-doc/share/doc/lens/html/src"><span class="hs-operator hs-var">&lt;&gt;=</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679386223"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../file:///nix/store/r16vjy39pj2p47ag6d6qd397xdpngrlp-cardano-api-lib-cardano-api-1.35.4-haddock-doc/share/doc/cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var">witIn</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/sc7phsrhp1xzn7n38mdjvapkbif3753i-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span></pre></body></html>
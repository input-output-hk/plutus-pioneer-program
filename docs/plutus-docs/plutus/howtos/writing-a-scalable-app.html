<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to write a scalable Plutus app &mdash; Plutus Tools SDK User Guide 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to handle blockchain events" href="handling-blockchain-events.html" />
    <link rel="prev" title="How to get started with the Plutus Platform" href="getting-started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #fcfcfc" >
            <a href="../../index.html" class="icon icon-home"> Plutus Tools SDK User Guide
            <img src="../../_static/cardano-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Explore Plutus</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../explanations/index.html">Explanations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html">Plutus tools in development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#logical-components">Logical components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#marconi">1. Marconi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-use-case-examples">2. Plutus use case examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#pab-plutus-application-backend">3. PAB (Plutus application backend)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#contract-monad-emulator">4. Contract monad emulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-contract-model-testing">5. Plutus contract model testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-contract-state-machine">6. Plutus contract state machine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#contract-api-also-known-as-contract-monad">7. Contract API (also known as Contract monad)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-chain-index">8. Plutus chain index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-ledger-constraints">9. Plutus ledger constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-tx-constraints">10. Plutus Tx constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#id10">11. Plutus ledger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/plutus-tools-component-descriptions.html#plutus-script-utils">12. Plutus script utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../explanations/rollback.html">What is a rollback?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../explanations/rollback.html#what-does-this-mean-for-dapps">What does this mean for dapps?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../explanations/pab.html">What is the PAB?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../explanations/pab.html#client-interface">Client interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../explanations/pab.html#other-components">Other components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../explanations/pab.html#chain-index">Chain index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/pab.html#alonzo-node">Alonzo node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/pab.html#wallet">Wallet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../explanations/pab.html#deployment-scenarios">Deployment Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../explanations/pab.html#hosted">Hosted</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/pab.html#in-browser">In-browser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../explanations/order-book-pattern.html">What is the order book pattern?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../explanations/order-book-pattern.html#example-distributed-exchange">Example: Distributed exchange</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../explanations/order-book-pattern.html#orders-and-plutus-scripts">Orders and Plutus scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/order-book-pattern.html#decentralisation">Decentralisation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../explanations/order-book-pattern.html#generalising-the-pattern">Generalising the pattern</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../explanations/order-book-pattern.html#off-chain-oracles">Off-chain oracles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/order-book-pattern.html#on-chain-oracles">On-chain oracles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explanations/order-book-pattern.html#state-machines">State machines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../explanations/order-book-pattern.html#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic-apps.html">Writing a basic Plutus app in an emulated environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#defining-the-types">Defining the types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/basic-apps.html#instances-for-data-types">Instances for data types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#defining-the-validator-script">Defining the validator script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#asking-for-input">Asking for input</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#locking-the-funds">Locking the funds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#unlocking-the-funds">Unlocking the funds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#running-the-app-on-the-plutus-apps-emulator">Running the app on the Plutus apps emulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/basic-apps.html#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/basic-apps-constraints.html">Extending the basic Plutus app with the constraints API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/contract-testing.html">Property-based testing of Plutus contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#an-overview-of-the-guessing-game">An overview of the guessing game</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#emulated-wallets">Emulated wallets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#values-and-tokens">Values and <span class="xref std std-term">tokens</span></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#introducing-contract-models">Introducing contract models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#generating-actions">Generating actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#modelling-expectations">Modelling expectations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#restricting-test-cases-with-preconditions">Restricting test cases with preconditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#performing-actions">Performing actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#shrinking-actions">Shrinking Actions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#debugging-the-model">Debugging the model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#adding-delays-to-test-cases">Adding delays to test cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#rerunning-a-failed-test">Rerunning a failed test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#controlling-the-log-level">Controlling the log-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#refining-preconditions">Refining preconditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#measuring-and-tuning-distributions">Measuring and tuning distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#custom-generators-vs-preconditions">Custom generators vs preconditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#instrumenting-contract-models-to-gather-statistics">Instrumenting contract models to gather statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#goal-directed-testing-with-dynamic-logic">Goal-directed testing with dynamic logic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#introducing-the-dynamic-logic-monad">Introducing the dynamic logic monad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#quantifiers-in-dynamic-logic">Quantifiers in dynamic logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#repeating-a-dynamic-logic-test">Repeating a dynamic logic test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#something-good-is-always-possible">Something good is always possible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#monitoring-and-tuning-dynamic-logic-tests">Monitoring and tuning dynamic logic tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#more-dynamic-logic">More dynamic logic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#limitations">Limitations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#testing-only-via-contract-endpoints">Testing only via <span class="xref std std-term">contract endpoints</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#test-assumptions-on-timing">Test assumptions on timing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-testing.html#testing-for-information-leaks">Testing for information leaks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-testing.html#further-examples">Further Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/contract-models.html">Testing Plutus Contracts with Contract Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#basic-contract-models">Basic Contract Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#example-a-simple-escrow-contract">Example: A Simple Escrow Contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#the-contract-model-type">The Contract Model Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#what-contracts-shall-we-test">What contracts shall we test?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#what-actions-should-tests-perform">What actions should tests perform?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#generating-actions">Generating Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#running-tests-and-debugging-the-model">Running tests and debugging the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#analysing-the-distribution-of-tests">Analysing the distribution of tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#parameterising-models-and-dynamic-contract-instances">Parameterising Models and Dynamic Contract Instances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#adding-an-initial-action-and-test-case-phases">Adding an initial action, and test case phases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#dynamic-contract-instances">Dynamic contract instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#running-our-extended-tests-another-design-issue">Running our extended tests; another design issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id3">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#testing-no-locked-funds-with-dynamic-logic">Testing “No Locked Funds” with Dynamic Logic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#writing-and-testing-properties-using-dynamic-logic">Writing and testing properties using Dynamic Logic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#digression-revisiting-a-design-decision">Digression: revisiting a design decision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#fair-s-fair-unilateral-strategies">Fair’s fair: Unilateral strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#fixing-the-contract-refunds">Fixing the contract: refunds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id4">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#taking-time-into-account">Taking Time into Account</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#slots-and-posixtime">Slots and POSIXTime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#initialising-the-deadline">Initialising the deadline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#modelling-the-passage-of-time">Modelling the passage of time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#monitoring-and-the-distribution-of-tests">Monitoring and the distribution of tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#no-locked-funds">No locked funds?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#digression-testing-the-model-alone-for-speed">Digression: testing the model alone for speed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id5">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#measuring-coverage-of-on-chain-code">Measuring coverage of on-chain code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#adding-a-coverage-index">Adding a coverage index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#measuring-coverage">Measuring coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#interpreting-the-coverage-annotations">Interpreting the coverage annotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#the-generated-coverage-report">The generated coverage report</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#crashes-and-how-to-tolerate-them">Crashes, and how to tolerate them</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id6">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#debugging-the-auction-contract-with-model-assertions">Debugging the Auction contract with model assertions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#modelling-the-auction-contract">Modelling the Auction contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id7">No locked funds?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#model-assertions-and-unexpected-expectations">Model assertions, and unexpected expectations.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#crashing-the-auction">Crashing the auction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#coverage-of-the-auction-contract">Coverage of the Auction contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id8">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/contract-models.html#becoming-level-1-certification-ready">Becoming Level 1 Certification Ready</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/contract-models.html#id9">Exercises</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">How-to guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting-started.html">How to get started with the Plutus Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to write a scalable Plutus app</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-building-blocks">The building blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#transaction-outputs">Transaction outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#state-of-transaction-outputs">State of transaction outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-state-of-our-app">Changing the state of our app</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minting-policy-scripts">Minting Policy Scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scalability-guidelines">Scalability guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#decentralised-exchange">Decentralised exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#marlowe">Marlowe</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="handling-blockchain-events.html">How to handle blockchain events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="handling-blockchain-events.html#transaction-output-lifecycle">Transaction output lifecycle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="handling-blockchain-events.html#transaction-states">Transaction states</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="handling-blockchain-events.html#pab-functions-for-listening-to-state-changes">PAB functions for listening to state changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="analysing-scripts.html">How to analyse the cost and size of Plutus scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="analysing-scripts.html#resource-use-of-plutus-scripts">Resource use of Plutus scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="analysing-scripts.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="analysing-scripts.html#validator-scripts">Validator scripts</a></li>
<li class="toctree-l4"><a class="reference internal" href="analysing-scripts.html#partial-transactions">Partial transactions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plutus-spending-script-example.html">Plutus Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plutus-spending-script-example.html#what-is-a-plutus-spending-script">What is a Plutus spending script?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plutus-spending-script-example.html#an-example-of-using-a-plutus-spending-script">An example of using a Plutus spending script</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#error-codes">Error codes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architectural decision records</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../adr/index.html">Architectural Decision Records</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html">ADR 1: Record architectural decisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#implications">Implications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0001-record-architecture-decisions.html#adr-template">ADR template</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0002-repository-standardization.html">ADR 2: Repository Standardization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0002-repository-standardization.html#implications">Implications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html">ADR 3: Move Marconi into a separate repository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0003-marconi-monorepo.html#related-decisions">Related Decisions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0004-marconi-initiative.html">ADR 4: Making a case for Marconi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#design-principles-of-marconi">Design principles of Marconi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#indexing-solution">Indexing solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#query-and-storage">Query and storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#identification-of-events">Identification of events</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0004-marconi-initiative.html#event-streams">Event streams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html">ADR 5: PAB and indexing component integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#decisions">Decisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#alternative-solutions">Alternative solutions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#make-sure-all-components-are-in-sync">Make sure all components are in sync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#add-indexing-specific-functions-in-the-contract-api">Add indexing specific functions in the Contract API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#query-functions-should-interact-with-a-single-source-of-truth">Query functions should interact with a single source of truth</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0005-pab-indexing-solution-integration.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0006-common-contract-api.html">ADR 6: Common Contract API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#authors">Authors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0006-common-contract-api.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html">ADR 7: Support reference inputs in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0007-support-reference-inputs-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html">ADR 8: Support inline datums in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0008-support-inline-datums-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html">ADR 9: Support reference scripts in constraint library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0009-support-reference-scripts-in-constraint-library.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html">ADR 10: Rolling back on-disk data for Marconi indexers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#decision">Decision</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#queries">Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#api-design">API Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0010-marconi-indexer-rollbacks.html#implementation">Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html">ADR 11: Support return and total collateral when building transactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#alternatives">Alternatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0011-support-return-and-total-collateral-when-building-transactions.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html">ADR 12: Commit to data types in cardano-api</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#define-our-own-data-types-for-off-chain-use">Define our own data types for off-chain use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0012-commit-to-data-types-in-cardano-api.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html">ADR 13: Transaction validity time range fix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#add-mustvalidateinslotrange-constraint">Add <code class="docutils literal notranslate"><span class="pre">MustValidateInSlotRange</span></code> constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#remove-mustvalidateintimerange">Remove <code class="docutils literal notranslate"><span class="pre">mustValidateInTimeRange</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#alter-mustvalidateintimerange">Alter <code class="docutils literal notranslate"><span class="pre">mustValidateInTimeRange</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0013-tx-validity-time-range-fix.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html">ADR 14: Marconi Query Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html#decision">Decision</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0014-marconi-query-interface.html#implications">Implications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0015-time-conversion.html">ADR 15: Time conversion semantic change</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#implications">Implications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#alternatives">Alternatives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0015-time-conversion.html#changing-the-representation-of-slotconfig-to-the-correct-one">Changing the representation of <code class="docutils literal notranslate"><span class="pre">SlotConfig</span></code> to the correct one</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0015-time-conversion.html#directly-use-epochinfo-in-the-emulator-and-contract-api">Directly use EpochInfo in the emulator and Contract API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0015-time-conversion.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html">ADR 16: Self-contained cardano-node emulator component</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#argument">Argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0016-cardano-node-emulator.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html">ADR 17: End-to-end testing strategy for Plutus, cardano-ledger-api and cardano-node-client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#author-s">Author(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#status">Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#decision">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#types-of-plutus-tests-for-the-plutus-e2e-tests-haskell-framework">Types of Plutus tests for the <code class="docutils literal notranslate"><span class="pre">plutus-e2e-tests</span></code> Haskell framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#argument">Argument</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#pros-of-building-and-maintaining-our-own-test-framework">Pros of building and maintaining our own test framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#cons-of-building-and-maintaining-our-own-test-framework">Cons of building and maintaining our own test framework</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#additional-considerations">Additional Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#alternatives">Alternatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#notes">Notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../adr/0017-end-to-end-testing-strategy.html#other-places-spinning-up-a-local-testnet">Other places spinning up a local testnet</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/cost-model-parameters.html">Cost model parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/bibliography.html">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/index.html#elsewhere">Elsewhere</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #fcfcfc" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Plutus Tools SDK User Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">How-to guides</a> &raquo;</li>
      <li>How to write a scalable Plutus app</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/input-output-hk/plutus/blob/master/doc/plutus/howtos/writing-a-scalable-app.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-write-a-scalable-plutus-app">
<span id="plutus-scalable-app"></span><h1>How to write a scalable Plutus app<a class="headerlink" href="#how-to-write-a-scalable-plutus-app" title="Permalink to this heading"></a></h1>
<p>Every dapp has its own requirements for throughput and performance, often quantified in terms of number of concurrent users, number of events per time window, and so forth.
When building a dapp, developers need to find a design that achieves the desired performance within the constraints of the underlying blockchain.</p>
<p>The Cardano blockchain uses the <a class="reference internal" href="../../reference/glossary.html#term-Extended-UTXO-Model"><span class="xref std std-term">extended UTXO model with scripts</span></a> to represent the ledger state.
The UTXO model with its graph structure is fundamentally different from the account model used by some existing smart-contract enabled blockchains.
As a result, the design patterns that work for dapps on account-based blockchains do not translate directly to Cardano.
We need new design patterns, because the underlying representation of the data is different.</p>
<p>In this document we discuss the structure of the UTXO model and its implications for scalability, arriving at a list of <a class="reference internal" href="#scalability-guidelines"><span class="std std-ref">scalability guidelines</span></a> that can guide the design of distributed applications on Plutus.
We use the <a class="reference internal" href="#scalability-example"><span class="std std-ref">example of a decentralised exchange</span></a> to illustrate the pros and cons of the different approaches.</p>
<section id="the-building-blocks">
<h2>The building blocks<a class="headerlink" href="#the-building-blocks" title="Permalink to this heading"></a></h2>
<p>Let’s look at the building blocks of the ledger’s scripting features.</p>
<section id="transaction-outputs">
<h3>Transaction outputs<a class="headerlink" href="#transaction-outputs" title="Permalink to this heading"></a></h3>
<p>At its core, the on-chain state of our app is captured in <em>transaction outputs</em>.
The extended UTXO model has two types of transaction outputs: Script outputs and public key outputs.
Public key outputs contain the hash of a public key. Script outputs contain two hashes: The hash of a validator script and the hash of a data value.
Both types of outputs hold crypto currency values.</p>
<p>They differ in the kind of witness that is required to spend them.
A public key output can be spent by a transaction that carry a signature of the private key that corresponds to the output’s public key.
A script output can be spent by a transaction that carries the validator script which hashes to the script hash, and two pieces of data - the redeemer and the datum.
The latter must be the value that hashes to the output’s datum hash.
In addition, any transaction attempting to spend a script output must meet the requirements set out in the validator script.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Output type</p></th>
<th class="head"><p>Witness</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Data</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Public key</p></td>
<td><p>Signature</p></td>
<td><p>Public key hash</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Script</p></td>
<td><p>composite</p></td>
<td><p>Script hash</p></td>
<td><p>Datum hash</p></td>
</tr>
</tbody>
</table>
<p>The address of an output is used to group similar outputs together on the ledger.
If we have a validator script then we can look at the ledger to see which outputs are currently at the script’s address, that is, which outputs are locked by the hash of our validator script.</p>
<p>Each transaction output is uniquely identified by two pieces of data: The hash of the transaction that produced the output, and the index of this output in the transaction’s list of outputs.</p>
</section>
<section id="state-of-transaction-outputs">
<h3>State of transaction outputs<a class="headerlink" href="#state-of-transaction-outputs" title="Permalink to this heading"></a></h3>
<p>It is tempting to think of the datum hash of a script output as the <em>state</em> of the output.
After all, the datum hash is a piece of data that must be supplied with the spending transaction, and it doesn’t affect the script address.
This is a bit misleading because the datum hash of a transaction output never changes.
The datum hash is determined by the transaction that produces the output, and it is immutable.</p>
<p>There is only one bit of information that changes: Whether the output has been spent.
Every transaction output starts in the <strong>unspent</strong> state, then it may transition to the <strong>spent</strong> state.
The transition happens when a transaction that spends the output is appended to the blockchain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reality is slightly more complicated: Since transactions can be rolled back, the state of a transaction output can change back to <em>unspent</em> if the spending transaction gets rolled back.
Only when a certain number of blocks have been added is the spending transaction firmly committed and the state of the output cannot change back to <em>unspent</em> anymore.
Rollbacks are reflected in the <a class="reference internal" href="../explanations/pab.html#what-is-the-pab"><span class="std std-ref">Plutus Application Backend (PAB)</span></a>’s interface for <a class="reference internal" href="handling-blockchain-events.html#handling-blockchain-events"><span class="std std-ref">dealing with blockchain events</span></a>, and they need to be considered when thinking about the business logic of your applications.</p>
</div>
</section>
<section id="changing-the-state-of-our-app">
<h3>Changing the state of our app<a class="headerlink" href="#changing-the-state-of-our-app" title="Permalink to this heading"></a></h3>
<p>Let’s think of the on-chain state of our application as a <strong>set of unspent transactions outputs</strong> (a subset of the global UTXO set that is maintained by the ledger).
There are no hard restrictions on how many different outputs or addresses our app can have – a one-off trade between two parties only needs a single output, while a complex distributed application with governance, tokens and so forth might involve multiple Plutus scripts and a large number of unspent transaction outputs.</p>
<figure class="align-default" id="id3">
<img alt="../../_images/utxos-1.png" src="../../_images/utxos-1.png" />
<figcaption>
<p><span class="caption-text">A UTXO set with four unspent outputs, two of which belong to our app (green box).</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Any transaction that changes the set of UTXOs that belong to our app also changes the state of the app.
Transactions can change our application’s set of UTXOs by adding new outputs to it, or by spending existing unspent outputs.</p>
<figure class="align-default" id="id4">
<img alt="../../_images/utxos-2.png" src="../../_images/utxos-2.png" />
<figcaption>
<p><span class="caption-text">A block with two transactions, Tx1 and Tx2, both changing the on-chain state of our app. Adding the block to the chain caused outputs (B) and (D) to become spent, and (E), (F), and (G) to be created in the unspent state.</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The number of new outputs that can be added to our application state in a single block is ultimately limited by the block size. The block size is a protocol parameter that can be adapted over time to match the growth in smart contract usage.
The number of outputs that can be removed from our application state in a block is limited both by the block size <em>and</em> by the number of outputs that are currently unspent.</p>
<p>To produce a script output we only need to provide the hashes of the script and the datum, whereas to spend a script output we need to provide the script, datum and redeemer values in full.
Transactions that produce script outputs therefore tend to be smaller (and cheaper) than transactions that spend them.
In addition, a transaction that only produces script outputs and doesn’t spend them cannot fail due to UTXO congestion on script outputs.</p>
<section id="utxo-congestion">
<span id="id1"></span><h4>UTXO congestion<a class="headerlink" href="#utxo-congestion" title="Permalink to this heading"></a></h4>
<p>Two transactions conflict if they try to spend the same unspent output.
When this happens, only one of the transactions is added to the ledger.
The other transaction is rejected.
The author of the rejected transaction must build a new transaction spending a different output and try again.
If many users are trying to spend the same output there can quickly arise a situation where most users spend a lot of time waiting, because their clients all try to spend the same output.
Almost all of them will fail and try again in the next block.</p>
<p>Congestion can happen on any type of output, but the chances of it happening to public key outputs are low, because the private key required to spend the output is usually only known to a single wallet, which can keep track of which outputs it has attempted to spend.
For example, let’s assume the user wants to make a payment and run a Plutus script in two different transactions.
When the wallet has constructed and submitted the payment transaction, it remembers the public key inputs that were used to fund it.
Then when the wallet balances the Plutus transaction it knows not to use the same public key inputs again, even if the inputs are still technically unspent at that time (while the payment transaction is in the mempool).</p>
<p>Script outputs are more likely to fall victim to UTXO congestion <em>if</em> they can be spent by more than one party.
To avoid UTXO congestion we should therefore design our system such that the number of simultaneous attempts made to spend the same script output is as low as possible.
What does this mean for the state of our distributed application?</p>
<p>We need to minimise the number of transactions that are trying to spend the same script output.
At the same time, we should design the system so that the access patterns which require relatively high throughput can be realised exclusively by producing script outputs, not by spending script outputs.</p>
</section>
</section>
<section id="minting-policy-scripts">
<h3>Minting Policy Scripts<a class="headerlink" href="#minting-policy-scripts" title="Permalink to this heading"></a></h3>
<p>Another way to run Plutus scripts on the ledger is by creating tokens with a custom minting policy.
From a scalability perspective, minting scripts are great because they do not consume a script input.
They aren’t subject to UTXO congestion on script outputs, while allowing us to run a script in the transaction that <em>produces</em> the tokens.
Seeing the token on the ledger is therefore evidence that the minting policy script has been executed successfully (as opposed to seeing a script output on the ledger, which can be produced without running any scripts at all).
Whenever we need to run a Plutus script in our application we should ask ourselves if we can make this script a minting policy, and only use validators if we absolutely have to store some information or crypto currency value in a transaction output.</p>
</section>
</section>
<section id="scalability-guidelines">
<span id="id2"></span><h2>Scalability guidelines<a class="headerlink" href="#scalability-guidelines" title="Permalink to this heading"></a></h2>
<p>The discussion of the UTXO model above can be summarised in three guiding principles for avoiding bottlenecks in your app:</p>
<ol class="arabic simple">
<li><p><strong>Minimise the number of transactions that are trying to spend the same script output.</strong> The number of entities (users) that try to spend a given script output at a single time should be small. It should certainly not grow with the total number of concurrent users of the system. A good distributed app design ensures that the number of UTXOs that make up the application state grows with the number of active users, and that each user interacts with a small subset of the application’s UTXOs only.</p></li>
<li><p><strong>Decouple the spending of script outputs from producing script outputs.</strong> Transactions that don’t spend script outputs are not liable to UTXO congestion on script outputs.</p></li>
<li><p><strong>Use minting policy scripts and tokens.</strong> Minting policies are Plutus scripts that can be run without spending a script output. Besides being useful for NFTs and other currency-like applications, tokens created by Plutus minting policies can act as <em>evidence</em> that some event happened in the past. For example, we could write a state machine that produces a token in its last transition. This token can then be used as proof that the state machine has finished, long after the last output has been spent. In this way, minting policies could be used to implement certain forms of oracles.</p></li>
</ol>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<section id="decentralised-exchange">
<span id="scalability-example"></span><h3>Decentralised exchange<a class="headerlink" href="#decentralised-exchange" title="Permalink to this heading"></a></h3>
<p>A decentralised exchange (DEX) can be realised either as an automated market maker (AMM) contract or using an order book.
The AMM approach results in one UTXO per liquidity pair.
This is fine for rarely-traded pairs, but pairs that have even close to one trade per block will soon run into UTXO congestion issues.
Frequently traded pairs are better off with an order book model.
Each order (bid/ask) is represented as a single UTXO.
Creating a new order only requires adding a script output, so it cannot be subject to UTXO congestion.
Matching orders is performed by a service that scans the blockchain for script outputs, maintains an order book and creates spending transactions when a match has been made.
This is an example decoupling the spending of script outputs from producing them (Guideline 2).
It is an instance of the <a class="reference internal" href="../explanations/order-book-pattern.html#what-is-the-order-book-pattern"><span class="std std-ref">order book pattern</span></a>.</p>
<p>The basic idea could be extended in many different ways.
For example, minting policies can be used to enforce payment for market makers or to create governance tokens.
If the code was open sourced, anyone could run a match making service and earn fees, thus creating incentives for fast settlement.
This would result in a truly decentralised exchange, because the match making could be performed by anyone without central coordination.</p>
</section>
<section id="marlowe">
<h3>Marlowe<a class="headerlink" href="#marlowe" title="Permalink to this heading"></a></h3>
<p>Marlowe is implemented using the Plutus state machine libraries.
The number of concurrent users on a given Marlowe instance is fixed and limited, and it rarely exceeds a handful.
Updates that require spending and producing the instance UTXO happen with a frequency of much less than once per block.
The chances of UTXO congestion happening on a Marlowe contract instance are therefore small (Guideline 1).
If they do happen, they only affect a single instance of Marlowe, and not the entire system.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading"></a></h2>
<p>Apart from the <a class="reference internal" href="#scalability-guidelines"><span class="std std-ref">guidelines</span></a>, the main lesson of this article is that Plutus apps need to be designed with the UTXO ledger in mind.
Porting an existing contract from an account-based blockchain such as Ethereum is likely to result in <a class="reference internal" href="#utxo-congestion"><span class="std std-ref">UTXO congestion</span></a> if the entire on-chain state of the app is kept in a single unspent output.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting-started.html" class="btn btn-neutral float-left" title="How to get started with the Plutus Platform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="handling-blockchain-events.html" class="btn btn-neutral float-right" title="How to handle blockchain events" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1980, IOHK.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>